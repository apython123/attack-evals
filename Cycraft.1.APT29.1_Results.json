{
    "PublicRelease": "2020 The MITRE Corporation. ALL RIGHTS RESERVED. Approved for Public Release; Distribution Unlimited. Public Release Case Number 19-03607-4",
    "Techniques": [
        {
            "TechniqueId": "T1003",
            "TechniqueName": "Credential Dumping",
            "Tactics": [
                {
                    "TacticName": "Credential Access",
                    "TacticId": "TA0006"
                }
            ],
            "Steps": [
                {
                    "SubStep": "6.A.2",
                    "Procedure": "Executed the CryptUnprotectedData API call to decrypt Chrome passwords",
                    "Criteria": "accesschk.exe executing the CryptUnprotectedData API",
                    "Tactics": [
                        {
                            "TacticName": "Credential Access",
                            "TacticId": "TA0006"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "No detection capability demonstrated for this procedure.",
                            "DetectionType": "None",
                            "Modifiers": []
                        }
                    ]
                },
                {
                    "SubStep": "6.C.1",
                    "Procedure": "Dumped password hashes from the Windows Registry by injecting a malicious DLL into Lsass.exe",
                    "Criteria": "powershell.exe injecting into lsass.exe OR lsass.exe\u00a0reading Registry keys under HKLM:\\SAM\\SAM\\Domains\\Account\\Users\\",
                    "Tactics": [
                        {
                            "TacticName": "Credential Access",
                            "TacticId": "TA0006"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (yellow indicator) for \"Credential Dumping\" was generated when powershell.exe attempted to read the lsass.exe process memory. The event was correlated to a parent Technique detection for User Execution on rcs.3aka3.doc\u200b.",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert",
                                "Correlated"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2233.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Credential Dumping\" was received that described PowerShell dumping credentials from LSASS process memory.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12445.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "14.B.4",
                    "Procedure": "Dumped plaintext credentials using Mimikatz (m.exe)",
                    "Criteria": "m.exe injecting into lsass.exe to dump credentials",
                    "Tactics": [
                        {
                            "TacticName": "Credential Access",
                            "TacticId": "TA0006"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (red indicator) of \"Credential Dumping\" was generated for command-line arguments indicative of Mimikatz credential dumping.",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2453.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "A Technique alert detection (yellow indicator) of \"Credential Dumping\" was generated for dumping credentials/keys from Lsass process memory",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2454.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Credential Dumping\" was received that described the adversary executing m.exe to access LSASS process memory.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12501.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "16.D.2",
                    "Procedure": "Dumped the KRBTGT hash on the domain controller host NewYork (10.0.0.4) using Mimikatz (m.exe)",
                    "Criteria": "m.exe injecting into lsass.exe to dump credentials",
                    "Tactics": [
                        {
                            "TacticName": "Credential Access",
                            "TacticId": "TA0006"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (red indicator) for \"Credential Dumping\" was generated for m.exe with command-line arguments indicative of Mimikatz credential dumping. ",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2475.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "A General alert detection (yellow indicator) was generated identifying m.exe as threat activity.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2474.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Credential Dumping\" was received that described the adversary remotely executing m.exe to dump the krbtgt hash.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12513.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-12506.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-12514.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1032",
            "TechniqueName": "Standard Cryptographic Protocol",
            "Tactics": [
                {
                    "TacticName": "Command and Control",
                    "TacticId": "TA0011"
                }
            ],
            "Steps": [
                {
                    "SubStep": "1.A.4",
                    "Procedure": "Used RC4 stream cipher to encrypt C2 (192.168.0.5) traffic",
                    "Criteria": "Evidence that the network data sent over the C2 channel is encrypted",
                    "Tactics": [
                        {
                            "TacticName": "Command and Control",
                            "TacticId": "TA0011"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "No detection capability demonstrated for this procedure.",
                            "DetectionType": "None",
                            "Modifiers": []
                        }
                    ]
                },
                {
                    "SubStep": "3.B.5",
                    "Procedure": "Used HTTPS to encrypt C2 (192.168.0.5) traffic",
                    "Criteria": "Evidence that the network data sent over the C2 channel is encrypted",
                    "Tactics": [
                        {
                            "TacticName": "Command and Control",
                            "TacticId": "TA0011"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "No detection capability demonstrated for this procedure.",
                            "DetectionType": "None",
                            "Modifiers": []
                        }
                    ]
                },
                {
                    "SubStep": "11.A.15",
                    "Procedure": "Used HTTPS to encrypt C2 (192.168.0.4) traffic",
                    "Criteria": "Evidence that the network data sent over the C2 channel is encrypted",
                    "Tactics": [
                        {
                            "TacticName": "Command and Control",
                            "TacticId": "TA0011"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "No detection capability demonstrated for this procedure.\t",
                            "DetectionType": "None",
                            "Modifiers": []
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1047",
            "TechniqueName": "Windows Management Instrumentation",
            "Tactics": [
                {
                    "TacticName": "Execution",
                    "TacticId": "TA0002"
                }
            ],
            "Steps": [
                {
                    "SubStep": "14.B.1",
                    "Procedure": "Created and executed a WMI class using PowerShell",
                    "Criteria": "WMI Process (WmiPrvSE.exe) executing powershell.exe",
                    "Tactics": [
                        {
                            "TacticName": "Execution",
                            "TacticId": "TA0002"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (red indicator) called \"Execution\" with \"T1047 Windows Management Instrumentation\" label was generated for WmiPrvSE.exe executing powershell.exe.",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-14976.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-14975.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Windows Management Instrumentation\" was received that included a PowerShell script and explained that it was used to set up execution of Mimikatz.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12499.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-12500.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1085",
            "TechniqueName": "Rundll32",
            "Tactics": [
                {
                    "TacticName": "Execution",
                    "TacticId": "TA0002"
                }
            ],
            "Steps": [
                {
                    "SubStep": "20.A.1",
                    "Procedure": "Executed Run key persistence payload on user login using RunDll32",
                    "Criteria": "rundll32.exe executing kxwn.lock",
                    "Tactics": [
                        {
                            "TacticName": "Execution",
                            "TacticId": "TA0002"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (red indicator) was generated for rundll32.exe executing kxwn.lock.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2491.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Rundll32\" described rundll32.exe executing kxwn.lock, triggered by Registry Run Keys / Startup Folder persistence.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12521.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1115",
            "TechniqueName": "Clipboard Data",
            "Tactics": [
                {
                    "TacticName": "Collection",
                    "TacticId": "TA0009"
                }
            ],
            "Steps": [
                {
                    "SubStep": "7.A.2",
                    "Procedure": "Captured clipboard contents using PowerShell",
                    "Criteria": "powershell.exe executing Get-Clipboard",
                    "Tactics": [
                        {
                            "TacticName": "Collection",
                            "TacticId": "TA0009"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (blue indicator) was generated for powershell.exe executing Get-Clipboard. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc\u200b.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert",
                                "Correlated"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-14850.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection occurred containing evidence of a PowerShell script used to gather information from the clipboard.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12448.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1033",
            "TechniqueName": "System Owner/User Discovery",
            "Tactics": [
                {
                    "TacticName": "Discovery",
                    "TacticId": "TA0007"
                }
            ],
            "Steps": [
                {
                    "SubStep": "4.C.2",
                    "Procedure": "Enumerated the current username using PowerShell",
                    "Criteria": "powershell.exe executing $env:USERNAME",
                    "Tactics": [
                        {
                            "TacticName": "Discovery",
                            "TacticId": "TA0007"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "An MSSP detection for \"System Owner/User Discovery\" was received that included a PowerShell script and explained that it was used to obtain the current user name.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12466.png"
                                }
                            ],
                            "Footnotes": [
                                "MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity."
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "11.A.6",
                    "Procedure": "Checked that the username is not related to admin or a generic value (ex: user) using PowerShell",
                    "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem",
                    "Tactics": [
                        {
                            "TacticName": "Discovery",
                            "TacticId": "TA0007"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (red indicator) was generated identying a PowerShell gwmi query for Win32_ComputerSystem as threat activity.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2421.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"System Owner/User Discovery\" was received that included a PowerShell script and explained that it was used to query Win32_ComputerSystem via WMI.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12476.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-2503.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "13.C.1",
                    "Procedure": "Enumerated the current username using the GetUserNameEx API",
                    "Criteria": "powershell.exe executing the GetUserNameEx API",
                    "Tactics": [
                        {
                            "TacticName": "Discovery",
                            "TacticId": "TA0007"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection was generated for powershell.exe executing the script which contained GetUserNameEx API function. The event was correlated to a parent Technique detection for PowerShell.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Correlated",
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2443.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"System Owner/User Discovery\" was received that included a PowerShell script and explained that it was used enumerate users.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12489.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "15.A.1",
                    "Procedure": "Enumerated logged on users using PowerShell",
                    "Criteria": "powershell.exe executing $env:UserName",
                    "Tactics": [
                        {
                            "TacticName": "Discovery",
                            "TacticId": "TA0007"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (red indicator) was generated when powershell.exe ran the script, which obtained the name of the current user. ",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2457.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "16.B.1",
                    "Procedure": "Enumerated the domain SID (from current user SID) using\u00a0the ConvertSidToStringSid API",
                    "Criteria": "powershell.exe executing the ConvertSidToStringSid API",
                    "Tactics": [
                        {
                            "TacticName": "Discovery",
                            "TacticId": "TA0007"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (blue indicator) for threat activity was generated for PowerShell executing the ConvertSidToStringSid API function.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2357.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"System Owner/User Discovery\" was received that included a PowerShell script and explained that it was used to obtain the domain SID from the current user's SID.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12506.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1071",
            "TechniqueName": "Standard Application Layer Protocol",
            "Tactics": [
                {
                    "TacticName": "Command and Control",
                    "TacticId": "TA0011"
                }
            ],
            "Steps": [
                {
                    "SubStep": "3.B.4",
                    "Procedure": "Used HTTPS to transport\u00a0C2 (192.168.0.5) traffic",
                    "Criteria": "Evidence that the network data sent over the C2 channel is HTTPS",
                    "Tactics": [
                        {
                            "TacticName": "Command and Control",
                            "TacticId": "TA0011"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "No detection capability demonstrated for this procedure.",
                            "DetectionType": "None",
                            "Modifiers": []
                        }
                    ]
                },
                {
                    "SubStep": "11.A.14",
                    "Procedure": "Used HTTPS to transport\u00a0C2 (192.168.0.4) traffic",
                    "Criteria": "Established network channel over the HTTPS protocol",
                    "Tactics": [
                        {
                            "TacticName": "Command and Control",
                            "TacticId": "TA0011"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "No detection capability demonstrated for this procedure.\t",
                            "DetectionType": "None",
                            "Modifiers": []
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1134",
            "TechniqueName": "Access Token Manipulation",
            "Tactics": [
                {
                    "TacticName": "Defense Evasion",
                    "TacticId": "TA0005"
                }
            ],
            "Steps": [
                {
                    "SubStep": "10.B.3",
                    "Procedure": "Manipulated the token of the PowerShell payload via the CreateProcessWithToken API",
                    "Criteria": "hostui.exe manipulating the token of powershell.exe via the CreateProcessWithToken API OR \npowershell.exe executing with the stolen token of explorer.exe",
                    "Tactics": [
                        {
                            "TacticName": "Defense Evasion",
                            "TacticId": "TA0005"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (red indicator) for \"Access Token Manipulation\" was generated when hostui.exe created a powershell.exe process with the CreateProcessWithToken WinAPI function.",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2269.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1112",
            "TechniqueName": "Modify Registry",
            "Tactics": [
                {
                    "TacticName": "Defense Evasion",
                    "TacticId": "TA0005"
                }
            ],
            "Steps": [
                {
                    "SubStep": "3.C.1",
                    "Procedure": "Modified the Registry to remove artifacts of COM hijacking",
                    "Criteria": "Deletion of of\u00a0the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command subkey",
                    "Tactics": [
                        {
                            "TacticName": "Defense Evasion",
                            "TacticId": "TA0005"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (blue indicator) was generated for the PowerShell command to remove DelegateExecute Registry Value. The event was correlated to a parent Technique detection for User Execution of rcs.3aka3.doc\u200b.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Correlated",
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2213.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Modify Registry\" was received that included a PowerShell script and explained that it was used to delete previously created registry keys.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12437.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "14.A.3",
                    "Procedure": "Modified the Registry to remove artifacts of COM hijacking using PowerShell",
                    "Criteria": "Deletion of\u00a0the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command\u00a0subkey",
                    "Tactics": [
                        {
                            "TacticName": "Defense Evasion",
                            "TacticId": "TA0005"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "An MSSP detection was received that included a PowerShell script and explained that it was used to clean the Registry after a UAC Bypass.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12498.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1140",
            "TechniqueName": "Deobfuscate/Decode Files or Information",
            "Tactics": [
                {
                    "TacticName": "Defense Evasion",
                    "TacticId": "TA0005"
                }
            ],
            "Steps": [
                {
                    "SubStep": "4.A.3",
                    "Procedure": "Decompressed ZIP (SysinternalsSuite.zip) file using PowerShell",
                    "Criteria": "powershell.exe executing Expand-Archive",
                    "Tactics": [
                        {
                            "TacticName": "Defense Evasion",
                            "TacticId": "TA0005"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (blue indicator) was generated due to powershell.exe decompressing the ZIP via Expand-Archive. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc\u200b.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert",
                                "Correlated"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-14998.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection was occurred containing evidence of powershell.exe decompressing SysinternalsSuite.zip via Expand-Archive.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12439.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "11.A.10",
                    "Procedure": "Decoded an embedded DLL payload to disk using certutil.exe",
                    "Criteria": "certutil.exe decoding kxwn.lock",
                    "Tactics": [
                        {
                            "TacticName": "Defense Evasion",
                            "TacticId": "TA0005"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (purple indicator) was generated identifying the execution of certutil.exe with command-line parameters for decoding the payload as threat activity.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2426.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-2427.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for was received that described the adversary executing certutil.exe to decode a base64 blob into the payload kxwn.lock.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2503.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-12480.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "14.B.6",
                    "Procedure": "Read and decoded Mimikatz output from a WMI class property using PowerShell",
                    "Criteria": "powershell.exe executing Get-WmiInstance",
                    "Tactics": [
                        {
                            "TacticName": "Defense Evasion",
                            "TacticId": "TA0005"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (red indicator) was generated for PowerShell reading encoded content from the WMI class. ",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2456.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Obfuscated Files or Information\" was received that included a PowerShell script and explained that it was used to write the Mimikatz payload to Win32_AuditCode.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12502.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1145",
            "TechniqueName": "Private Keys",
            "Tactics": [
                {
                    "TacticName": "Credential Access",
                    "TacticId": "TA0006"
                }
            ],
            "Steps": [
                {
                    "SubStep": "6.B.1",
                    "Procedure": "Exported a local certificate to a PFX file using PowerShell",
                    "Criteria": "powershell.exe creating a certificate file exported from the system",
                    "Tactics": [
                        {
                            "TacticName": "Credential Access",
                            "TacticId": "TA0006"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "No detection capability demonstrated for this procedure.",
                            "DetectionType": "None",
                            "Modifiers": []
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1077",
            "TechniqueName": "Windows Admin Shares",
            "Tactics": [
                {
                    "TacticName": "Lateral Movement",
                    "TacticId": "TA0008"
                }
            ],
            "Steps": [
                {
                    "SubStep": "8.C.2",
                    "Procedure": "Established SMB session to remote host Scranton's (10.0.1.4) IPC$ share using PsExec",
                    "Criteria": "SMB session to Scranton (10.0.1.4) over TCP port 445/135 OR evidence of usage of a Windows share",
                    "Tactics": [
                        {
                            "TacticName": "Lateral Movement",
                            "TacticId": "TA0008"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (red indicator) was generated for \"Remote Accessed.\"",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2254.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1088",
            "TechniqueName": "Bypass User Account Control",
            "Tactics": [
                {
                    "TacticName": "Privilege Escalation",
                    "TacticId": "TA0004"
                }
            ],
            "Steps": [
                {
                    "SubStep": "3.B.2",
                    "Procedure": "Executed elevated PowerShell payload",
                    "Criteria": "High integrity powershell.exe spawning from\u00a0control.exe\u200b\u200b (spawned from sdclt.exe)",
                    "Tactics": [
                        {
                            "TacticName": "Privilege Escalation",
                            "TacticId": "TA0004"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (yellow indicator) for \"Bypass UAC\" was generated when sdclt.exe was executed in a high integrity context by cmd.exe. The event was correlated to a parent Technique detection for User Execution of rcs.3aka3.doc\u200b.",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Correlated",
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2208.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "A Tactic alert detection (yellow indicator) was generated for an unprivileged process executing another program with SYSTEM permissions.",
                            "DetectionType": "Tactic",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2083.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Bypass User Account Control\" was received that explained that cmd.exe (medium integrity) executed sdclt.exe (high integrity) to facilitate a UAC bypass resulting in execution of powershell.exe (High Integrity).",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12243.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "14.A.2",
                    "Procedure": "Executed elevated PowerShell payload",
                    "Criteria": "High integrity powrshell.exe spawning from\u00a0control.exe\u200b\u200b (spawned from sdclt.exe)",
                    "Tactics": [
                        {
                            "TacticName": "Privilege Escalation",
                            "TacticId": "TA0004"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (yellow indicator) was generated showing a new High Integrity PowerShell callback spawned from control.exe. ",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2320.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Bypass User Account Control\" was received that included a PowerShell script and explained that it was used to bypass UAC.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12495.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-12498.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1048",
            "TechniqueName": "Exfiltration Over Alternative Protocol",
            "Tactics": [
                {
                    "TacticName": "Exfiltration",
                    "TacticId": "TA0010"
                }
            ],
            "Steps": [
                {
                    "SubStep": "7.B.4",
                    "Procedure": "Exfiltrated collection (OfficeSupplies.7z) to WebDAV network share using PowerShell",
                    "Criteria": "powershell executing Copy-Item pointing to an attack-controlled WebDav\u00a0network share (192.168.0.4:80)",
                    "Tactics": [
                        {
                            "TacticName": "Exfiltration",
                            "TacticId": "TA0010"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (yellow indicator) was generated due to rundll32.exe executing the API Call DavSetCookie in daclnt.dll to map a share using WebDav.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2242.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-2241.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "18.A.2",
                    "Procedure": "Exfiltrated staged collection to an online OneDrive account using PowerShell",
                    "Criteria": "powershell.exe executing Copy-Item pointing to drive mapped to an attack-controlled OneDrive account",
                    "Tactics": [
                        {
                            "TacticName": "Exfiltration",
                            "TacticId": "TA0010"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (blue indicator) was generated identifying PowerShell executing Copy-Item as threat activity.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2485.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Exfiltration Over Alternative Protocol\" was received that described the adversary mapping OneDrive as a network device and exfiltrating data to it.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12518.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-12519.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1099",
            "TechniqueName": "Timestomp",
            "Tactics": [
                {
                    "TacticName": "Defense Evasion",
                    "TacticId": "TA0005"
                }
            ],
            "Steps": [
                {
                    "SubStep": "12.A.2",
                    "Procedure": "Modified the time attributes of the kxwn.lock persistence payload using PowerShell",
                    "Criteria": "powershell.exe modifying the creation, last access, and last write times of kxwn.lock",
                    "Tactics": [
                        {
                            "TacticName": "Defense Evasion",
                            "TacticId": "TA0005"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (purple icon) for \"Timestomp\" was generated when the kxwn.lock was created with falsified creation, last access, and last write times.",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2437.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Timestomp\" occured that noted modified timestamp of kxwn.lock.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12485.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1005",
            "TechniqueName": "Data from Local System",
            "Tactics": [
                {
                    "TacticName": "Collection",
                    "TacticId": "TA0009"
                }
            ],
            "Steps": [
                {
                    "SubStep": "2.A.3",
                    "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell",
                    "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\",
                    "Tactics": [
                        {
                            "TacticName": "Collection",
                            "TacticId": "TA0009"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "No detection capability demonstrated for this procedure.",
                            "DetectionType": "None",
                            "Modifiers": []
                        }
                    ]
                },
                {
                    "SubStep": "7.B.1",
                    "Procedure": "Read data in the user's Downloads directory using PowerShell",
                    "Criteria": "powershell.exe reading files in C:\\Users\\pam\\Downloads\\",
                    "Tactics": [
                        {
                            "TacticName": "Collection",
                            "TacticId": "TA0009"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "No detection capability demonstrated for this procedure.",
                            "DetectionType": "None",
                            "Modifiers": []
                        }
                    ]
                },
                {
                    "SubStep": "9.B.4",
                    "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell",
                    "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\",
                    "Tactics": [
                        {
                            "TacticName": "Collection",
                            "TacticId": "TA0009"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "No detection capability demonstrated for this procedure.",
                            "DetectionType": "None",
                            "Modifiers": []
                        }
                    ]
                },
                {
                    "SubStep": "17.B.1",
                    "Procedure": "Read and collected a local file using PowerShell",
                    "Criteria": "powershell.exe reading the file MITRE-ATTACK-EVALS.HTML",
                    "Tactics": [
                        {
                            "TacticName": "Collection",
                            "TacticId": "TA0009"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "No detection capability demonstrated for this procedure.",
                            "DetectionType": "None",
                            "Modifiers": []
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1113",
            "TechniqueName": "Screen Capture",
            "Tactics": [
                {
                    "TacticName": "Collection",
                    "TacticId": "TA0009"
                }
            ],
            "Steps": [
                {
                    "SubStep": "7.A.1",
                    "Procedure": "Captured and saved screenshots using PowerShell",
                    "Criteria": "powershell.exe executing the CopyFromScreen function from System.Drawing.dll",
                    "Tactics": [
                        {
                            "TacticName": "Collection",
                            "TacticId": "TA0009"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (red indicator) was generated for suspicious threat activity for PowerShell calling CopyFromScreen.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2137.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Screen Capture\" occurred containing evidence of screen capture.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12446.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-12449.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-12447.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1084",
            "TechniqueName": "Windows Management Instrumentation Event Subscription",
            "Tactics": [
                {
                    "TacticName": "Persistence",
                    "TacticId": "TA0003"
                }
            ],
            "Steps": [
                {
                    "SubStep": "15.A.2",
                    "Procedure": "Established WMI event subscription persistence using PowerShell",
                    "Criteria": "powershell.exe creating the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription",
                    "Tactics": [
                        {
                            "TacticName": "Persistence",
                            "TacticId": "TA0003"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (red alert icon) for \"Windows Management Instrumentation Event Subscription\" was generated due to the WindowsParentalControlMigration event filter creation. ",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2458.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Windows Management Instrumentation Event Subscription\" was occurred containing evidence of a PowerShell script and explained that it was used establish persistence.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12504.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "20.A.2",
                    "Procedure": "Executed WMI persistence on user login",
                    "Criteria": "The WMI process (wmiprvse.exe) executing powershell.exe",
                    "Tactics": [
                        {
                            "TacticName": "Persistence",
                            "TacticId": "TA0003"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (red alert icon) for \"Windows Management Instrumentation Event Subscription\" was generated for wmiprvse.exe executing the PowerShell stager.",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-15516.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Windows Management Instrumentation Event Subscription\" was received that described the triggering of a WMI Event Subscription upon logon of user Oscar in order to execute powershell.exe.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12521.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-12522.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1027",
            "TechniqueName": "Obfuscated Files or Information",
            "Tactics": [
                {
                    "TacticName": "Defense Evasion",
                    "TacticId": "TA0005"
                }
            ],
            "Steps": [
                {
                    "SubStep": "3.A.2",
                    "Procedure": "Embedded PowerShell payload in monkey.png using steganography",
                    "Criteria": "Evidence that a PowerShell payload was within\u00a0monkey.png",
                    "Tactics": [
                        {
                            "TacticName": "Defense Evasion",
                            "TacticId": "TA0005"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (purple indicator) was generated for PowerShell extracting and executing the code embedded within monkey.png. The event was correlated to a parent Technique detection for User Execution of rcs.3aka3.doc\u200b.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert",
                                "Correlated"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2206.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Obfuscated Files or Information\" occurred containing evidence of the PowerShell script contained within monkey.png.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12231.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "14.B.5",
                    "Procedure": "Encoded and wrote Mimikatz output to a WMI class property using PowerShell",
                    "Criteria": "powershell.exe executing Set-WmiInstance",
                    "Tactics": [
                        {
                            "TacticName": "Defense Evasion",
                            "TacticId": "TA0005"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (red indicator) was generated showing PowerShell writing encoded content into the WMI class.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2455.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Obfuscated Files or Information\" was received that included a PowerShell script and explained that it was used to write the Mimikatz payload to Win32_AuditCode.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12502.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "17.C.2",
                    "Procedure": "Prepended the GIF file header to a compressed staging file using PowerShell",
                    "Criteria": "powershell.exe executing Set-Content",
                    "Tactics": [
                        {
                            "TacticName": "Defense Evasion",
                            "TacticId": "TA0005"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (blue indicator) was generated for the PowerShell script, which included PowerShell appending the GIF file header to the compressed file.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2481.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Obfuscated Files or Information\" occurred containing evidence PowerShell was used to add noisy data (GIF89) to an archive.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12516.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1057",
            "TechniqueName": "Process Discovery",
            "Tactics": [
                {
                    "TacticName": "Discovery",
                    "TacticId": "TA0007"
                }
            ],
            "Steps": [
                {
                    "SubStep": "4.B.1",
                    "Procedure": "Enumerated current running processes using PowerShell",
                    "Criteria": "powershell.exe executing Get-Process",
                    "Tactics": [
                        {
                            "TacticName": "Discovery",
                            "TacticId": "TA0007"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (blue indicator) was generated due to powershell.exe executing Get-Process. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc\u200b.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert",
                                "Correlated"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2217.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "4.C.5",
                    "Procedure": "Enumerated the current process ID using PowerShell",
                    "Criteria": "powershell.exe executing $PID",
                    "Tactics": [
                        {
                            "TacticName": "Discovery",
                            "TacticId": "TA0007"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "An MSSP detection for \"Process Discovery\" was received that included a PowerShell script and explained that it was used to obtain the current environment information.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12466.png"
                                }
                            ],
                            "Footnotes": [
                                "MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity."
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "8.A.3",
                    "Procedure": "Enumerated processes on remote host Scranton (10.0.1.4) using PowerShell",
                    "Criteria": "powershell.exe executing Get-Process",
                    "Tactics": [
                        {
                            "TacticName": "Discovery",
                            "TacticId": "TA0007"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (red indicator) for \"PowerShell\" was generated due to powershell.exe using Invoke-Command to remotely execute Get-Process on host Scranton (10.0.1.4). The event was correlated to a parent Technique detection for User Execution of rcs.3aka3.doc\u200b.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert",
                                "Correlated"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2244.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Process Discovery\" was received that included a PowerShell script and explained that it was used to execute Get-Process on host Scranton (10.0.1.4).",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12454.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "11.A.8",
                    "Procedure": "Checked that processes such as procexp.exe, taskmgr.exe, or wireshark.exe are not running using PowerShell",
                    "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_Process",
                    "Tactics": [
                        {
                            "TacticName": "Discovery",
                            "TacticId": "TA0007"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (red indicator) for \"Process Discovery\" was generated for a PowerShell gwmi query for Win32_Process.",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2424.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Process Discovery\" was received that included a PowerShell script and explained that it was used to query Win32_Process via WMI.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12478.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "13.D.1",
                    "Procedure": "Enumerated running processes using the CreateToolhelp32Snapshot API",
                    "Criteria": "powershell.exe executing the CreateToolhelp32Snapshot API",
                    "Tactics": [
                        {
                            "TacticName": "Discovery",
                            "TacticId": "TA0007"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (blue indicator) was generated for PowerShell calling the CreateToolhelp32Snapshot API. The detection was correlated to a parent alert for Threat Activity.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Correlated",
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2316.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Process Discovery\" occurred with evidence of a PowerShell script used to enumerate processes.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12489.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "14.B.2",
                    "Procedure": "Enumerated and tracked PowerShell processes using PowerShell",
                    "Criteria": "powershell.exe executing Get-Process",
                    "Tactics": [
                        {
                            "TacticName": "Discovery",
                            "TacticId": "TA0007"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (red indicator) for \"Process Discovery\" was generated for PowerShell executing Get-Process.",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2456.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-2450.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1204",
            "TechniqueName": "User Execution",
            "Tactics": [
                {
                    "TacticName": "Execution",
                    "TacticId": "TA0002"
                }
            ],
            "Steps": [
                {
                    "SubStep": "1.A.1",
                    "Procedure": "User Pam executed payload rcs.3aka3.doc",
                    "Criteria": "The rcs.3aka3.doc process spawning from explorer.exe",
                    "Tactics": [
                        {
                            "TacticName": "Execution",
                            "TacticId": "TA0002"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (red indicator) including \"User Execution\" was generated when explorer.exe executed rcs.3aka3.doc.",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-14868.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection including \"User Execution\" was received that included a description of rcs.3aka3.doc and its execution.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-11803.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-12218.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "11.A.1",
                    "Procedure": "User Oscar executed payload 37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk",
                    "Criteria": "powershell.exe spawning from explorer.exe",
                    "Tactics": [
                        {
                            "TacticName": "Execution",
                            "TacticId": "TA0002"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (orange indicator) for \"User Execution\" was generated when the .lnk file was executed.",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2417.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "A General alert detection (blue indicator) was generated identifying explorer.exe executing powershell.exe as threat activity. ",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2279.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"User Execution\" was received that described the user executing 37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk to launch powershell.exe.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12473.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-2503.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1497",
            "TechniqueName": "Virtualization/Sandbox Evasion",
            "Tactics": [
                {
                    "TacticName": "Discovery",
                    "TacticId": "TA0007"
                }
            ],
            "Steps": [
                {
                    "SubStep": "11.A.3",
                    "Procedure": "Checked that the BIOS version and serial number are not associated with VirtualBox or VMware using PowerShell",
                    "Criteria": "powershell.exe executing a Get-WmiObject\nquery for Win32_BIOS",
                    "Tactics": [
                        {
                            "TacticName": "Discovery",
                            "TacticId": "TA0007"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (red indicator) for \"Virtualization/Sandbox Evasion\" was generated for the PowerShell gwmi query for Win32_BIOS.",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2419.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Virtualization/Sandbox Evasion\" was received that included a PowerShell script and explained that it was used to check for virtualization.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12475.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-2503.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1002",
            "TechniqueName": "Data Compressed",
            "Tactics": [
                {
                    "TacticName": "Exfiltration",
                    "TacticId": "TA0010"
                }
            ],
            "Steps": [
                {
                    "SubStep": "2.A.4",
                    "Procedure": "Compressed and stored files into ZIP (Draft.zip) using PowerShell",
                    "Criteria": "powershell.exe executing\u00a0Compress-Archive",
                    "Tactics": [
                        {
                            "TacticName": "Exfiltration",
                            "TacticId": "TA0010"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (purple indicator) was generated for powershell.exe executing Compress-Archive. The event was correlated to a parent Technique detection for User Execution of rcs.3aka3.doc\u200b.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert",
                                "Correlated"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2205.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Data Compressed\" was received that included an explanation of the PowerShell script used to collect certain file types on host Nashua (10.0.1.6) and then archive them as DRAFT.ZIP.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12220.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "7.B.2",
                    "Procedure": "Compressed\u00a0data from the user's Downloads directory into a ZIP file (OfficeSupplies.7z) using PowerShell",
                    "Criteria": "powershell.exe creating the file OfficeSupplies.7z",
                    "Tactics": [
                        {
                            "TacticName": "Exfiltration",
                            "TacticId": "TA0010"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "No detection capability demonstrated for this procedure.",
                            "DetectionType": "None",
                            "Modifiers": []
                        }
                    ]
                },
                {
                    "SubStep": "9.B.7",
                    "Procedure": "Compressed staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe",
                    "Criteria": "powershell.exe executing rar.exe",
                    "Tactics": [
                        {
                            "TacticName": "Exfiltration",
                            "TacticId": "TA0010"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (yellow indicator) for \"T1002 Data Compressed\" was generated due to powershell.exe executing rar.exe with command-line arguments indicative of compression.  The event was correlated to a parent Technique detection for Service Execution of python.exe by PSEXECSVC.exe.",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert",
                                "Correlated"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2262.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Data Compressed\" was received that showed execution of rar.exe by powershell.exe and explained that it was used to compress data for exfiltration.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12461.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "17.C.1",
                    "Procedure": "Compressed a staging directory using PowerShell",
                    "Criteria": "powershell.exe executing the ZipFile.CreateFromDirectory .NET method",
                    "Tactics": [
                        {
                            "TacticName": "Exfiltration",
                            "TacticId": "TA0010"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (blue indicator) was generated for the PowerShell script which included compressing collection via the ZipFile.CreateFromDirectory .NET method.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2481.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-2386.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection occurred containing evidence of data compression.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12516.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1106",
            "TechniqueName": "Execution through API",
            "Tactics": [
                {
                    "TacticName": "Execution",
                    "TacticId": "TA0002"
                }
            ],
            "Steps": [
                {
                    "SubStep": "4.C.10",
                    "Procedure": "Executed API call by reflectively loading Netapi32.dll",
                    "Criteria": "The NetUserGetGroups API function loaded into powershell.exe from Netapi32.dll",
                    "Tactics": [
                        {
                            "TacticName": "Execution",
                            "TacticId": "TA0002"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "An MSSP detection for \"Permission Groups Discovery\" was received that included a PowerShell script and explained that it was used to search for domain groups through Win32 API calls.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12465.png"
                                }
                            ],
                            "Footnotes": [
                                "MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity."
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "4.C.12",
                    "Procedure": "Executed API call by reflectively loading Netapi32.dll",
                    "Criteria": "The NetUserGetLocalGroups API function loaded into powershelle.exe from Netapi32.dll",
                    "Tactics": [
                        {
                            "TacticName": "Execution",
                            "TacticId": "TA0002"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "An MSSP detection for \"Permission Groups Discovery\" was received that included a PowerShell script and explained that it was used the Invoke-NetUserGetLocalGroups command to search for local groups through Win32 API calls.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12467.png"
                                }
                            ],
                            "Footnotes": [
                                "MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity."
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "10.B.2",
                    "Procedure": "Executed PowerShell payload via the CreateProcessWithToken API",
                    "Criteria": "hostui.exe executing the\nCreateProcessWithToken API",
                    "Tactics": [
                        {
                            "TacticName": "Execution",
                            "TacticId": "TA0002"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "No detection capability demonstrated for this procedure.",
                            "DetectionType": "None",
                            "Modifiers": []
                        }
                    ]
                },
                {
                    "SubStep": "16.B.2",
                    "Procedure": "Executed the ConvertSidToStringSid API call by reflectively loading Advapi32.dll",
                    "Criteria": "powershell.exe executing the ConvertSidToStringSid API function by loading Advapi32.dll",
                    "Tactics": [
                        {
                            "TacticName": "Execution",
                            "TacticId": "TA0002"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (blue indicator) was generated for the PowerShell script which contained ConvertSidToStringSid API function being loaded.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2357.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Execution through API\" was received that included a PowerShell script and explained that it was used to execute the ConvertSidToStringSid API function from Advapi32.dll.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12506.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1069",
            "TechniqueName": "Permission Groups Discovery",
            "Tactics": [
                {
                    "TacticName": "Discovery",
                    "TacticId": "TA0007"
                }
            ],
            "Steps": [
                {
                    "SubStep": "4.C.9",
                    "Procedure": "Enumerated user's domain group membership via the NetUserGetGroups API",
                    "Criteria": "powershell.exe\u00a0executing the NetUserGetGroups\u00a0API",
                    "Tactics": [
                        {
                            "TacticName": "Discovery",
                            "TacticId": "TA0007"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "An MSSP detection for \"Permission Groups Discovery\" was received that included a PowerShell script and explained that it was used the Invoke-NetUserGetGroups command to search for domain groups through Win32 API calls.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12465.png"
                                }
                            ],
                            "Footnotes": [
                                "MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity."
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "4.C.11",
                    "Procedure": "Enumerated user's local group membership via\u00a0the NetUserGetLocalGroups API",
                    "Criteria": "powershell.exe\u00a0executing the NetUserGetLocalGroups\u00a0API",
                    "Tactics": [
                        {
                            "TacticName": "Discovery",
                            "TacticId": "TA0007"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "An MSSP detection for \"Permission Groups Discovery\" was received that included a PowerShell script and explained that it was used the Invoke-NetUserGetLocalGroups command to search for local groups through Win32 API calls.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12467.png"
                                }
                            ],
                            "Footnotes": [
                                "MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity."
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1050",
            "TechniqueName": "New Service",
            "Tactics": [
                {
                    "TacticName": "Persistence",
                    "TacticId": "TA0003"
                }
            ],
            "Steps": [
                {
                    "SubStep": "5.A.1",
                    "Procedure": "Created a new service (javamtsup) that executes a service binary (javamtsup.exe) at system startup",
                    "Criteria": "powershell.exe creating the Javamtsup service",
                    "Tactics": [
                        {
                            "TacticName": "Persistence",
                            "TacticId": "TA0003"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (orange indicator) showed a Registry event for the creation of javamtsup service.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2168.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"New Service\" was received that included events and analysis related to registration and execution of the javamtsup service.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12442.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-12441.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1120",
            "TechniqueName": "Peripheral Device Discovery",
            "Tactics": [
                {
                    "TacticName": "Discovery",
                    "TacticId": "TA0007"
                }
            ],
            "Steps": [
                {
                    "SubStep": "11.A.5",
                    "Procedure": "Enumerated devices/adapters to check for presence of VirtualBox driver(s) using PowerShell",
                    "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_PnPEntity",
                    "Tactics": [
                        {
                            "TacticName": "Discovery",
                            "TacticId": "TA0007"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (red indicator) was generated identifying a PowerShell gwmi query for Win32_PnPEntity as threat activity.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2423.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Peripheral Device Discovery\" was received that included a PowerShell script and explained that it was used to query Win32_PnPEntity via WMI.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12477.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-2503.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1083",
            "TechniqueName": "File and Directory Discovery",
            "Tactics": [
                {
                    "TacticName": "Discovery",
                    "TacticId": "TA0007"
                }
            ],
            "Steps": [
                {
                    "SubStep": "2.A.1",
                    "Procedure": "Searched filesystem for document and media files using PowerShell\u00a0",
                    "Criteria": "powershell.exe executing (Get-)ChildItem",
                    "Tactics": [
                        {
                            "TacticName": "Discovery",
                            "TacticId": "TA0007"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (purple indicator) was generated for powershell.exe executing Get-ChildItem. The event was correlated to a parent Technique detection for User Execution of rcs.3aka3.doc\u200b.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert",
                                "Correlated"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2203.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"File and Directory Discovery\" was received that included an explanation of the PowerShell script used to collect certain file types on host Nashua (10.0.1.6).",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12220.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "4.C.1",
                    "Procedure": "Enumerated user's temporary directory path using PowerShell",
                    "Criteria": "powershell.exe executing\u00a0$env:TEMP",
                    "Tactics": [
                        {
                            "TacticName": "Discovery",
                            "TacticId": "TA0007"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "An MSSP detection for \"File and Directory Discovery\" was received that included a PowerShell script and explained that it was used to obtain the current directory.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12466.png"
                                }
                            ],
                            "Footnotes": [
                                "MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity."
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "9.B.2",
                    "Procedure": "Searched filesystem for document and media files using PowerShell",
                    "Criteria": "powershell.exe executing (Get-)ChildItem\u200b",
                    "Tactics": [
                        {
                            "TacticName": "Discovery",
                            "TacticId": "TA0007"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (blue indicator) was generated for powershell.exe executing Get-ChildItem. The event was correlated to a parent Technique detection for Service Execution of python.exe by PSEXECSVC.exe.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Correlated",
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2258.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "11.A.9",
                    "Procedure": "Checked that the payload is not inside a folder path that contains \"sample\" or is the length of a hash value using PowerShell",
                    "Criteria": "powershell.exe executing (Get-Item -Path \".\\\" -Verbose).FullName",
                    "Tactics": [
                        {
                            "TacticName": "Discovery",
                            "TacticId": "TA0007"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (blue indicator) was generated for PowerShell executing Get-Item for the current path.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2285.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Process Discovery\" was received that included a PowerShell script and explained that it was used to to obtain the current path.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12479.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "12.A.1",
                    "Procedure": "Enumerated the System32 directory using PowerShell",
                    "Criteria": "powershell.exe executing (gci ((gci env:windir).Value + '\\system32')",
                    "Tactics": [
                        {
                            "TacticName": "Discovery",
                            "TacticId": "TA0007"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Tactic alert detection for Discovery (blue icon) was genereated due to PowerShell enumeration of System32.",
                            "DetectionType": "Tactic",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2438.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1119",
            "TechniqueName": "Automated Collection",
            "Tactics": [
                {
                    "TacticName": "Collection",
                    "TacticId": "TA0009"
                }
            ],
            "Steps": [
                {
                    "SubStep": "2.A.2",
                    "Procedure": "Scripted search of filesystem for document and media files using PowerShell\u00a0",
                    "Criteria": "powershell.exe executing (Get-)ChildItem",
                    "Tactics": [
                        {
                            "TacticName": "Collection",
                            "TacticId": "TA0009"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (purple indicator) showed powershell.exe executing Get-ChildItem. The event was correlated to a parent Technique detection for User Execution of rcs.3aka3.doc\u200b.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert",
                                "Correlated"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2203.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection was received that included an explanation of the PowerShell script used to collect certain file types on host Nashua (10.0.1.6).",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12220.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "9.B.3",
                    "Procedure": "Scripted search of filesystem for document and media files using PowerShell\u00a0",
                    "Criteria": "powershell.exe executing (Get-)ChildItem\u200b",
                    "Tactics": [
                        {
                            "TacticName": "Collection",
                            "TacticId": "TA0009"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (blue indicator) was generated for powershell.exe executing Get-ChildItem. The event was correlated to a parent Technique detection for Service Execution of python.exe by PSEXECSVC.exe.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert",
                                "Correlated"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2258.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1018",
            "TechniqueName": "Remote System Discovery",
            "Tactics": [
                {
                    "TacticName": "Discovery",
                    "TacticId": "TA0007"
                }
            ],
            "Steps": [
                {
                    "SubStep": "8.A.1",
                    "Procedure": "Enumerated remote systems using LDAP queries",
                    "Criteria": "powershell.exe making LDAP queries over port 389 to the Domain Controller (10.0.0.4)",
                    "Tactics": [
                        {
                            "TacticName": "Discovery",
                            "TacticId": "TA0007"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "An MSSP detection for \"Remote System Discovery\" was received that explained that the Ad-Search PowerShell command was used to discover remote systems in the domain.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12452.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-12453.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "16.A.1",
                    "Procedure": "Enumerated the domain controller host NewYork (10.0.0.4) using LDAP queries",
                    "Criteria": "powershell.exe making LDAP queries over port 389 via functions from System.DirectoryServices.dll",
                    "Tactics": [
                        {
                            "TacticName": "Discovery",
                            "TacticId": "TA0007"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (blue indicator) was generated for powershell.exe executing the Get-NetDomainController command.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2463.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Remote System Discovery\" was received that included a PowerShell script and explained that it was used to discover a remote system.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12506.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1041",
            "TechniqueName": "Exfiltration Over Command and Control Channel",
            "Tactics": [
                {
                    "TacticName": "Exfiltration",
                    "TacticId": "TA0010"
                }
            ],
            "Steps": [
                {
                    "SubStep": "2.B.1",
                    "Procedure": "Read and downloaded ZIP (Draft.zip) over C2 channel (192.168.0.5 over TCP port 1234)",
                    "Criteria": "The rcs.3aka3.doc process reading the file draft.zip while connected to the C2 channel",
                    "Tactics": [
                        {
                            "TacticName": "Exfiltration",
                            "TacticId": "TA0010"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "No detection capability demonstrated for this procedure.",
                            "DetectionType": "None",
                            "Modifiers": []
                        }
                    ]
                },
                {
                    "SubStep": "9.B.8",
                    "Procedure": "Read and downloaded ZIP (working.zip on Desktop) over C2 channel (192.168.0.5 over TCP port 8443)",
                    "Criteria": "python.exe\u00a0reading the file working.zip while connected to the C2 channel",
                    "Tactics": [
                        {
                            "TacticName": "Exfiltration",
                            "TacticId": "TA0010"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "No detection capability demonstrated for this procedure.",
                            "DetectionType": "None",
                            "Modifiers": []
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1081",
            "TechniqueName": "Credentials in Files",
            "Tactics": [
                {
                    "TacticName": "Credential Access",
                    "TacticId": "TA0006"
                }
            ],
            "Steps": [
                {
                    "SubStep": "6.A.1",
                    "Procedure": "Read the Chrome SQL database file to extract encrypted credentials",
                    "Criteria": "accesschk.exe reading files within %APPDATALOCAL%\\Google\\chrome\\user data\\default\\",
                    "Tactics": [
                        {
                            "TacticName": "Credential Access",
                            "TacticId": "TA0006"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "No detection capability demonstrated for this procedure.",
                            "DetectionType": "None",
                            "Modifiers": []
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1097",
            "TechniqueName": "Pass the Ticket",
            "Tactics": [
                {
                    "TacticName": "Lateral Movement",
                    "TacticId": "TA0008"
                }
            ],
            "Steps": [
                {
                    "SubStep": "20.B.1",
                    "Procedure": "Created Kerberos Golden Ticket using\u00a0Invoke-Mimikatz",
                    "Criteria": "powershell.exe executing Invoke-Mimikatz with command-line arguments to create a golden ticket",
                    "Tactics": [
                        {
                            "TacticName": "Lateral Movement",
                            "TacticId": "TA0008"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (yellow indicator) called of \"Pass the Ticket\" was generated when the user MScott forged a suspicious Kerberos ticket with the domain krbtgt.",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2495.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "A General alert detection (red indicator) was generated identifying PowerShell executing Invoke-Mimikatz as threat activity.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2496.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Pass the Ticket\" was received that described the adversary using Mimikatz to forge a golden ticket.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12521.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-12523.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1136",
            "TechniqueName": "Create Account",
            "Tactics": [
                {
                    "TacticName": "Persistence",
                    "TacticId": "TA0003"
                }
            ],
            "Steps": [
                {
                    "SubStep": "20.B.3",
                    "Procedure": "Added a new user to the remote host Scranton (10.0.1.4) using net.exe",
                    "Criteria": "net.exe adding the user Toby ",
                    "Tactics": [
                        {
                            "TacticName": "Persistence",
                            "TacticId": "TA0003"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (orange indicator) for \"Account Operation\" was generated for the addition of the new user Toby.",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2500.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-2501.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "A Technique alert detection (orange indicator) for \"Create Account\" was generated for net.exe with the command-line arguments to add the new user Toby. The detection was correlated to a parent alert for creation of a Windows Remote Management session.",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert",
                                "Correlated"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2500.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Create Account\" was received that described the attacker creating a new account on host Scranton (10.0.1.4) for persistence.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12523.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1063",
            "TechniqueName": "Security Software Discovery",
            "Tactics": [
                {
                    "TacticName": "Discovery",
                    "TacticId": "TA0007"
                }
            ],
            "Steps": [
                {
                    "SubStep": "4.C.7",
                    "Procedure": "Enumerated anti-virus software using PowerShell",
                    "Criteria": "powershell.exe\u00a0executing\u200b Get-WmiObject ...\u200b -Class\u00a0AntiVirusProduct",
                    "Tactics": [
                        {
                            "TacticName": "Discovery",
                            "TacticId": "TA0007"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "An MSSP detection for \"Security Software Discovery\" was received that included a PowerShell script and explained that it was used to detect the installed anti-virus product.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12466.png"
                                }
                            ],
                            "Footnotes": [
                                "MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity."
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "4.C.8",
                    "Procedure": "Enumerated firewall software using PowerShell",
                    "Criteria": "powershell.exe\u00a0executing Get-WmiObject\u00a0...\u200b\u200b -Class\u00a0FireWallProduct",
                    "Tactics": [
                        {
                            "TacticName": "Discovery",
                            "TacticId": "TA0007"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "An MSSP detection for \"Security Software Discovery\" was received that included a PowerShell script and explained that it was used to detect the installed firewall product.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12466.png"
                                }
                            ],
                            "Footnotes": [
                                "MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity."
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "12.B.1",
                    "Procedure": "Enumerated registered AV products using PowerShell",
                    "Criteria": "powershell.exe executing a Get-WmiObject query for AntiVirusProduct",
                    "Tactics": [
                        {
                            "TacticName": "Discovery",
                            "TacticId": "TA0007"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (red icon) for \"Security Software Discovery\" was generated due to powershell.exe loading a custom script that contained code to detect installed antivirus products.",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2439.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Security Software Discovery\" was received that included PowerShell gwmi query for AntiVirusProduct",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12487.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-12485.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1065",
            "TechniqueName": "Uncommonly Used Port",
            "Tactics": [
                {
                    "TacticName": "Command and Control",
                    "TacticId": "TA0011"
                }
            ],
            "Steps": [
                {
                    "SubStep": "1.A.3",
                    "Procedure": "Established C2 channel (192.168.0.5) via rcs.3aka3.doc payload over TCP port 1234",
                    "Criteria": "Established network channel over port 1234",
                    "Tactics": [
                        {
                            "TacticName": "Command and Control",
                            "TacticId": "TA0011"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "An MSSP detection for \"Uncommonly Used Port\" was received that included a description of rcs.3aka3.doc and explained that it established a network connection to 192.168.0.5:1234.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-11803.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "Telemetry showed the rcs.3aka.doc connected to 192.168.0.5 on TCP port 1234.",
                            "DetectionType": "Telemetry",
                            "Modifiers": [],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2051.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1107",
            "TechniqueName": "File Deletion",
            "Tactics": [
                {
                    "TacticName": "Defense Evasion",
                    "TacticId": "TA0005"
                }
            ],
            "Steps": [
                {
                    "SubStep": "4.B.2",
                    "Procedure": "Deleted rcs.3aka3.doc on disk using SDelete",
                    "Criteria": "sdelete64.exe deleting the file rcs.3aka3.doc",
                    "Tactics": [
                        {
                            "TacticName": "Defense Evasion",
                            "TacticId": "TA0005"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (red indicator) was generated due to sdelete64.exe deleting rcs.3aka3.doc. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc\u200b.",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert",
                                "Correlated"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-15479.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "4.B.3",
                    "Procedure": "Deleted Draft.zip on disk using SDelete",
                    "Criteria": "sdelete64.exe deleting the file draft.zip",
                    "Tactics": [
                        {
                            "TacticName": "Defense Evasion",
                            "TacticId": "TA0005"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (red indicator) was generated due to sdelete64.exe deleting Draft.Zip. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc\u200b.",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert",
                                "Correlated"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-14996.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "4.B.4",
                    "Procedure": "Deleted SysinternalsSuite.zip on disk using SDelete",
                    "Criteria": "sdelete64.exe deleting the file SysinternalsSuite.zip",
                    "Tactics": [
                        {
                            "TacticName": "Defense Evasion",
                            "TacticId": "TA0005"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (yellow indicator) was generated due to sdelete64.exe deleting  SysinternalsSuite.zip. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc\u200b.",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert",
                                "Correlated"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-14994.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"File Deletion\" was received that included a PowerShell script and explained that it was used to execute sdelete64.exe to delete SysInternalsSuite.zip.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12440.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "9.C.1",
                    "Procedure": "Deleted rar.exe on disk using SDelete",
                    "Criteria": "sdelete64.exe deleting the file rar.exe",
                    "Tactics": [
                        {
                            "TacticName": "Defense Evasion",
                            "TacticId": "TA0005"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (yellow indicator) for \"File Deletion T1107\" was generated when sdelete64.exe with command-line arguments was used to delete rar.exe. The event was correlated to a parent Technique detection for Service Execution of python.exe by PSEXECSVC.exe.",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert",
                                "Correlated"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-14982.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"File Deletion\" was received that described the adversary using sdelete64.exe to remove evidence of exfiltration.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12464.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "9.C.2",
                    "Procedure": "Deleted working.zip (from Desktop) on disk using SDelete",
                    "Criteria": "sdelete64.exe deleting the file \\Desktop\\working.zip",
                    "Tactics": [
                        {
                            "TacticName": "Defense Evasion",
                            "TacticId": "TA0005"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (yellow indicator) for \"File Deletion T1107\" was generated when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip. The event was correlated to a parent Technique detection for Service Execution of python.exe by PSEXECSVC.exe.",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert",
                                "Correlated"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2266.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"File Deletion\" was received that described the adversary using sdelete64.exe to remove evidence of exfiltration, including C:\\Users\\pam\\Desktop\\working.zip.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12464.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "9.C.3",
                    "Procedure": "Deleted working.zip (from AppData directory) on disk using SDelete",
                    "Criteria": "sdelete64.exe deleting the file \\AppData\\Roaming\\working.zip",
                    "Tactics": [
                        {
                            "TacticName": "Defense Evasion",
                            "TacticId": "TA0005"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (yellow indicator) for \"File Deletion T1107\" was generated when sdelete64.exe with command-line arguments was used to delete Roaming\\working.zip. The event was correlated to a parent Technique detection for Service Execution of python.exe by PSEXECSVC.exe.",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert",
                                "Correlated"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2265.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"File Deletion\" was received that described the adversary using sdelete64.exe to remove evidence of exfiltration.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12464.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "9.C.4",
                    "Procedure": "Deleted SDelete on disk using cmd.exe del command",
                    "Criteria": "cmd.exe deleting the file sdelete64.exe",
                    "Tactics": [
                        {
                            "TacticName": "Defense Evasion",
                            "TacticId": "TA0005"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "No detection capability demonstrated for this procedure.",
                            "DetectionType": "None",
                            "Modifiers": []
                        }
                    ]
                },
                {
                    "SubStep": "19.A.1",
                    "Procedure": "Deleted Mimikatz (m.exe) on disk using SDelete",
                    "Criteria": "File delete event for C:\\Windows\\System32\\m.exe",
                    "Tactics": [
                        {
                            "TacticName": "Defense Evasion",
                            "TacticId": "TA0005"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.",
                            "DetectionType": "N/A",
                            "Modifiers": []
                        }
                    ]
                },
                {
                    "SubStep": "19.B.1",
                    "Procedure": "Deleted exfiltrated data on disk using SDelete",
                    "Criteria": "File delete event for C:\\Windows\\Temp\\WindowsParentalControlMigration.tmp",
                    "Tactics": [
                        {
                            "TacticName": "Defense Evasion",
                            "TacticId": "TA0005"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.",
                            "DetectionType": "N/A",
                            "Modifiers": []
                        }
                    ]
                },
                {
                    "SubStep": "19.C.1",
                    "Procedure": "Deleted staged data on disk using SDelete",
                    "Criteria": "File delete event for C:\\Windows\\Temp\\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML",
                    "Tactics": [
                        {
                            "TacticName": "Defense Evasion",
                            "TacticId": "TA0005"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.",
                            "DetectionType": "N/A",
                            "Modifiers": []
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1043",
            "TechniqueName": "Commonly Used Port",
            "Tactics": [
                {
                    "TacticName": "Command and Control",
                    "TacticId": "TA0011"
                }
            ],
            "Steps": [
                {
                    "SubStep": "3.B.3",
                    "Procedure": "Established C2 channel (192.168.0.5) via PowerShell payload over TCP port 443",
                    "Criteria": "Established network channel over port 443",
                    "Tactics": [
                        {
                            "TacticName": "Command and Control",
                            "TacticId": "TA0011"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert (red indicator) was generated for powershell.exe execution, which included connecting to 192.168.0.5 on TCP 443. The event was correlated to a parent Technique detection for User Execution of rcs.3aka3.doc\u200b.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Correlated",
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2211.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "11.A.13",
                    "Procedure": "Established C2 channel (192.168.0.4) via PowerShell payload over port 443",
                    "Criteria": "Established network channel over port 443",
                    "Tactics": [
                        {
                            "TacticName": "Command and Control",
                            "TacticId": "TA0011"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "An MSSP detection was received that included a PowerShell script and explained that it was used to download and execute another script from 192.168.0.4 over port 443.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2503.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-12483.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1059",
            "TechniqueName": "Command-Line Interface",
            "Tactics": [
                {
                    "TacticName": "Execution",
                    "TacticId": "TA0002"
                }
            ],
            "Steps": [
                {
                    "SubStep": "1.B.1",
                    "Procedure": "Spawned interactive cmd.exe",
                    "Criteria": "cmd.exe\u00a0spawning from the rcs.3aka3.doc\u200b process",
                    "Tactics": [
                        {
                            "TacticName": "Execution",
                            "TacticId": "TA0002"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Tactic alert detection (yellow indicator) for \"Execution\" was generated for cmd.exe spawning from rcs.3aka3.doc. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc\u200b.",
                            "DetectionType": "Tactic",
                            "Modifiers": [
                                "Correlated",
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2201.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-2200.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for was received that included a description of rcs.3aka3.doc spawning cmd.exe interactively.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-11805.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-11806.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1028",
            "TechniqueName": "Windows Remote Management",
            "Tactics": [
                {
                    "TacticName": "Execution",
                    "TacticId": "TA0002"
                }
            ],
            "Steps": [
                {
                    "SubStep": "8.A.2",
                    "Procedure": "Established WinRM connection to remote host Scranton (10.0.1.4)",
                    "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985",
                    "Tactics": [
                        {
                            "TacticName": "Execution",
                            "TacticId": "TA0002"
                        },
                        {
                            "TacticName": "Lateral Movement",
                            "TacticId": "TA0008"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "No detection capability demonstrated for this procedure.",
                            "DetectionType": "None",
                            "Modifiers": []
                        }
                    ]
                },
                {
                    "SubStep": "16.C.1",
                    "Procedure": "Established a WinRM connection to the domain controller host NewYork (10.0.0.4) ",
                    "Criteria": "Network connection to NewYork (10.0.0.4) over port 5985",
                    "Tactics": [
                        {
                            "TacticName": "Execution",
                            "TacticId": "TA0002"
                        },
                        {
                            "TacticName": "Lateral Movement",
                            "TacticId": "TA0008"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (blue indicator) for threat activity was generated for powershell.exe executing the Invoke-WinRMSession command.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2358.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Windows Remote Management\" was received that included a PowerShell command and explained that it was used to create a WinRM session to host Scranton (10.0.1.4).",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12506.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "20.B.2",
                    "Procedure": "Established a WinRM connection to the remote host Scranton (10.0.1.4) using the Golden Ticket as credentials",
                    "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985",
                    "Tactics": [
                        {
                            "TacticName": "Execution",
                            "TacticId": "TA0002"
                        },
                        {
                            "TacticName": "Lateral Movement",
                            "TacticId": "TA0008"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (blue indicator) was generated identifying PowerShell executing the Enter-PSSession cmdlet to open a network connection to the remote host Scranton (10.0.1.4) as threat activity. ",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2498.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "A General alert detection (orange indicator) for execution and tagged with \"Windows Remote Management\" was generated when net.exe was executed remotely on Scranton by wsmprovhost.exe.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2500.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Windows Remote Management\" was received that described the adversary using a golden ticket to establish a WinRM session to Scranton (10.0.1.4)",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12521.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-12523.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1114",
            "TechniqueName": "Email Collection",
            "Tactics": [
                {
                    "TacticName": "Collection",
                    "TacticId": "TA0009"
                }
            ],
            "Steps": [
                {
                    "SubStep": "17.A.1",
                    "Procedure": "Dumped messages from the local Outlook inbox using PowerShell",
                    "Criteria": "outlook.exe spawning from svchost.exe or powershell.exe",
                    "Tactics": [
                        {
                            "TacticName": "Collection",
                            "TacticId": "TA0009"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (red indicator) for \"Email Collection\" was generated when powershell.exe loaded an Outlook DLL.",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2478.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Email Collection\" was received that included a PowerShell script and explained that it was used to obtain the collect emails.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2479.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1096",
            "TechniqueName": "NTFS File Attributes",
            "Tactics": [
                {
                    "TacticName": "Defense Evasion",
                    "TacticId": "TA0005"
                }
            ],
            "Steps": [
                {
                    "SubStep": "11.A.2",
                    "Procedure": "Executed an alternate data stream (ADS) using PowerShell",
                    "Criteria": "powershell.exe executing the schemas ADS via Get-Content and IEX",
                    "Tactics": [
                        {
                            "TacticName": "Defense Evasion",
                            "TacticId": "TA0005"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (yellow indicator) was generated NTFS File Attributes for 2016_UNITED_STATES_PRESEDENTIAL_ELECTION_-_WIKIPEDIA.HTML:SCHEMAS.",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-14981.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "A General alert detection (blue indicator) was generated identifying powershell.exe executing the schemas ADS with Get-Content and IEX as threat activity.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2432.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"NTFS File Attributes\" was received that described a PowerShell script reading another script from the schemas Alternate Data Stream in 2016_United_States_presidential_election_-_Wikipedia.html and executing it via IEX.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2503.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1035",
            "TechniqueName": "Service Execution",
            "Tactics": [
                {
                    "TacticName": "Execution",
                    "TacticId": "TA0002"
                }
            ],
            "Steps": [
                {
                    "SubStep": "8.C.3",
                    "Procedure": "Executed python.exe using PSExec",
                    "Criteria": "python.exe spawned by PSEXESVC.exe",
                    "Tactics": [
                        {
                            "TacticName": "Execution",
                            "TacticId": "TA0002"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (red indicator) for \"Service Execution\" was generated for the execution of python.exe by PSEXECSVC.exe on host Scranton (10.0.1.4) as SYSTEM.",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2255.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Service Execution\" occurred containing evidence of PSEXESVC.exe executing python.exe.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12456.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-12457.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "10.A.1",
                    "Procedure": "Executed persistent service (javamtsup) on system startup",
                    "Criteria": "javamtsup.exe spawning from services.exe",
                    "Tactics": [
                        {
                            "TacticName": "Execution",
                            "TacticId": "TA0002"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (red indicator) for \"Service Execution\" was generated when services.exe spawned javamtsup.exe.",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2267.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1102",
            "TechniqueName": "Web Service",
            "Tactics": [
                {
                    "TacticName": "Defense Evasion",
                    "TacticId": "TA0005"
                }
            ],
            "Steps": [
                {
                    "SubStep": "18.A.1",
                    "Procedure": "Mapped a network drive to an online OneDrive account using PowerShell",
                    "Criteria": "net.exe with command-line arguments then making a network connection to a public IP over port 443",
                    "Tactics": [
                        {
                            "TacticName": "Defense Evasion",
                            "TacticId": "TA0005"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "An MSSP detection for \"Web Service\" was received that described the adversary mapping OneDrive as a network device and exfiltrating data to it.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12518.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-12519.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1105",
            "TechniqueName": "Remote File Copy",
            "Tactics": [
                {
                    "TacticName": "Command and Control",
                    "TacticId": "TA0011"
                },
                {
                    "TacticName": "Lateral Movement",
                    "TacticId": "TA0008"
                }
            ],
            "Steps": [
                {
                    "SubStep": "3.A.1",
                    "Procedure": "Dropped stage 2 payload (monkey.png) to disk",
                    "Criteria": "The rcs.3aka3.doc process creating the file monkey.png",
                    "Tactics": [
                        {
                            "TacticName": "Command and Control",
                            "TacticId": "TA0011"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "No detection capability demonstrated for this procedure.",
                            "DetectionType": "None",
                            "Modifiers": []
                        }
                    ]
                },
                {
                    "SubStep": "4.A.1",
                    "Procedure": "Dropped additional tools (SysinternalsSuite.zip) to disk over C2 channel (192.168.0.5)",
                    "Criteria": "powershell.exe creating the file SysinternalsSuite.zip",
                    "Tactics": [
                        {
                            "TacticName": "Command and Control",
                            "TacticId": "TA0011"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "No detection capability demonstrated for this procedure.",
                            "DetectionType": "None",
                            "Modifiers": []
                        }
                    ]
                },
                {
                    "SubStep": "8.B.1",
                    "Procedure": "Copied python.exe payload from a WebDAV share (192.168.0.4) to remote host Scranton (10.0.1.4)",
                    "Criteria": "The file python.exe created on Scranton (10.0.1.4)",
                    "Tactics": [
                        {
                            "TacticName": "Lateral Movement",
                            "TacticId": "TA0008"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (orange indicator) for \"Remote Access\" was generated for the file copy of python.exe from host Nashua (10.0.1.6) to host Scranton (10.0.1.4).",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-14872.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "A General alert detection (yellow indicator) for \"File Creation\" for the file create event of python.exe. ",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-14901.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "9.A.1",
                    "Procedure": "Dropped rar.exe to disk on remote host Scranton (10.0.1.4)\u00a0",
                    "Criteria": "python.exe creating the file rar.exe",
                    "Tactics": [
                        {
                            "TacticName": "Command and Control",
                            "TacticId": "TA0011"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "No detection capability demonstrated for this procedure.",
                            "DetectionType": "None",
                            "Modifiers": []
                        }
                    ]
                },
                {
                    "SubStep": "9.A.2",
                    "Procedure": "Dropped sdelete.exe to disk on remote host Scranton (10.0.1.4)\u00a0",
                    "Criteria": "python.exe creating the file sdelete64.exe",
                    "Tactics": [
                        {
                            "TacticName": "Command and Control",
                            "TacticId": "TA0011"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "No detection capability demonstrated for this procedure.",
                            "DetectionType": "None",
                            "Modifiers": []
                        }
                    ]
                },
                {
                    "SubStep": "14.B.3",
                    "Procedure": "Downloaded and dropped Mimikatz (m.exe) to disk",
                    "Criteria": "powershell.exe downloading and/or the file write of m.exe",
                    "Tactics": [
                        {
                            "TacticName": "Command and Control",
                            "TacticId": "TA0011"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (purple indicator) was generated identifying the PowerShell command to download m.exe as threat activity.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2339.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "A General alert detection (purple indicator) was generated showed the file write event for m.exe into the System32 folder.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2452.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-2342.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "16.D.1",
                    "Procedure": "Dropped Mimikatz (m.exe) to disk on the domain controller host NewYork (10.0.0.4) over a WinRM connection",
                    "Criteria": "File write of m.exe by the WinRM process (wsmprovhost.exe)",
                    "Tactics": [
                        {
                            "TacticName": "Lateral Movement",
                            "TacticId": "TA0008"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (purple indicator) for File Movement was generated indicating that m.exe was moved from host Utica (10.0.1.5) to host NewYork (10.0.0.4).",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2473.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Remote File Copy\" was received that described the adversary moving m.exe from host Utica (10.0.1.5) to host NewYork (10.0.0.4).",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12511.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-12510.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1016",
            "TechniqueName": "System Network Configuration Discovery",
            "Tactics": [
                {
                    "TacticName": "Discovery",
                    "TacticId": "TA0007"
                }
            ],
            "Steps": [
                {
                    "SubStep": "4.C.4",
                    "Procedure": "Enumerated the current domain name using PowerShell",
                    "Criteria": "powershell.exe executing $env:USERDOMAIN",
                    "Tactics": [
                        {
                            "TacticName": "Discovery",
                            "TacticId": "TA0007"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "An MSSP detection for \"System Owner/User Discovery\" was received that included a PowerShell script and explained that it was used to obtain the current environment information.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12466.png"
                                }
                            ],
                            "Footnotes": [
                                "MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity."
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "11.A.7",
                    "Procedure": "Checked that the computer is joined to a domain using PowerShell",
                    "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem",
                    "Tactics": [
                        {
                            "TacticName": "Discovery",
                            "TacticId": "TA0007"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (red indicator) was generated identying a PowerShell gwmi query for Win32_ComputerSystem as threat activity.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2421.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"System Network Configuration Discovery\" was received that included a PowerShell script and explained that it was used to query Win32_ComputerSystem via WMI.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2503.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-12476.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "13.B.1",
                    "Procedure": "Enumerated the domain name using the NetWkstaGetInfo API",
                    "Criteria": "powershell.exe executing the NetWkstaGetInfo API",
                    "Tactics": [
                        {
                            "TacticName": "Discovery",
                            "TacticId": "TA0007"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (blue indicator) was generated for PowerShell calling the NetWkstaGetInfo API. The detection was correlated to a parent alert for Threat Activity.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Correlated",
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2442.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"System Network Configuration Discovery\" was received that included a PowerShell script and explained that it was used to obtain the domain name.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Processing)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12490.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1060",
            "TechniqueName": "Registry Run Keys / Startup Folder",
            "Tactics": [
                {
                    "TacticName": "Persistence",
                    "TacticId": "TA0003"
                }
            ],
            "Steps": [
                {
                    "SubStep": "5.B.1",
                    "Procedure": "Created a LNK file (hostui.lnk) in the Startup folder that executes on login",
                    "Criteria": "powershell.exe creating the file hostui.lnk in the Startup folder",
                    "Tactics": [
                        {
                            "TacticName": "Persistence",
                            "TacticId": "TA0003"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (green indicator) for \"Registry Run Keys / Startup Folder\" was generated due to hostui.lnk being written to the Startup folder.",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2232.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Registry Run Keys / Startup Folder\" was received that included a Registry Created event for addition of hostui.lnk to the Startup folder. Additional analysis was received that included a PowerShell script and explained that it used the Invoke-Persistence command to create a LNK file in the Startup folder.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12443.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-12469.png"
                                }
                            ],
                            "Footnotes": [
                                "MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity."
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "10.B.1",
                    "Procedure": "Executed LNK payload (hostui.lnk) in Startup Folder on user login",
                    "Criteria": "Evidence that the file hostui.lnk (which executes hostui.bat as a byproduct) was executed from the Startup Folder",
                    "Tactics": [
                        {
                            "TacticName": "Persistence",
                            "TacticId": "TA0003"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "No detection capability demonstrated for this procedure.",
                            "DetectionType": "None",
                            "Modifiers": []
                        }
                    ]
                },
                {
                    "SubStep": "11.A.11",
                    "Procedure": "Established Registry Run key persistence using PowerShell",
                    "Criteria": "Addition of the Webcache subkey in HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run",
                    "Tactics": [
                        {
                            "TacticName": "Persistence",
                            "TacticId": "TA0003"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (red indicator) for \"Registry Run Keys / Startup Folder\" was generated for a Registry Creation event associated with establishing Registry Run Key persistence.",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2437.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Registry Run Keys / Startup Folder\" was received that included a PowerShell script and explained that it was used to establish Registry Run Key persistence.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2503.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-12497.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1122",
            "TechniqueName": "Component Object Model Hijacking",
            "Tactics": [
                {
                    "TacticName": "Defense Evasion",
                    "TacticId": "TA0005"
                }
            ],
            "Steps": [
                {
                    "SubStep": "3.B.1",
                    "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell",
                    "Criteria": "Addition of\u00a0the DelegateExecute\u00a0\u200bsubkey in\u00a0\u200bHKCU\\Software\\Classes\\Folder\\shell\\open\\\u200b\u200bcommand\u200b\u200b",
                    "Tactics": [
                        {
                            "TacticName": "Defense Evasion",
                            "TacticId": "TA0005"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (blue indicator) was generated for the addition of the DelegateExecute Registry Value.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2106.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Component Object Model Hijacking\" was received that included a PowerShell script and explained that it was used to modify a COM component to delegate execution.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12434.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-12243.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-12435.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "14.A.1",
                    "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell",
                    "Criteria": "Addition of the DelegateExecute subkey in HKCU\\Software\\Classes\\Folder\\shell\\open\\command",
                    "Tactics": [
                        {
                            "TacticName": "Defense Evasion",
                            "TacticId": "TA0005"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (blue indicator) was generated for powershell.exe loading code that creates the DelegateExecute Registry key. ",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2319.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-2446.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1022",
            "TechniqueName": "Data Encrypted",
            "Tactics": [
                {
                    "TacticName": "Exfiltration",
                    "TacticId": "TA0010"
                }
            ],
            "Steps": [
                {
                    "SubStep": "7.B.3",
                    "Procedure": "Encrypted data from the user's Downloads directory using PowerShell",
                    "Criteria": "powershell.exe executing Compress-7Zip with the password argument used for encryption",
                    "Tactics": [
                        {
                            "TacticName": "Exfiltration",
                            "TacticId": "TA0010"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (orange indicator) was generated due to powershell.exe executing Compress-7Zip with arguments for encryption. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc\u200b.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert",
                                "Correlated"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-14984.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-14986.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "9.B.6",
                    "Procedure": "Encrypted staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe",
                    "Criteria": "powershell.exe executing rar.exe with the -a parameter for a password to use for encryption",
                    "Tactics": [
                        {
                            "TacticName": "Exfiltration",
                            "TacticId": "TA0010"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (yellow indicator) for \"T1022 Data Encrypted\" was generated when rar.exe was used to create an encrypted zip archive. The event was correlated to a parent Technique detection for Service Execution of python.exe by PSEXECSVC.exe.",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert",
                                "Correlated"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2262.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1078",
            "TechniqueName": "Valid Accounts",
            "Tactics": [
                {
                    "TacticName": "Defense Evasion",
                    "TacticId": "TA0005"
                },
                {
                    "TacticName": "Privilege Escalation",
                    "TacticId": "TA0004"
                }
            ],
            "Steps": [
                {
                    "SubStep": "8.C.1",
                    "Procedure": "Logged on to remote host Scranton (10.0.1.4) using\u00a0valid credentials for user Pam",
                    "Criteria": "Successful logon as user Pam on\u00a0Scranton (10.0.1.4) ",
                    "Tactics": [
                        {
                            "TacticName": "Defense Evasion",
                            "TacticId": "TA0005"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (orange indicator) was generated showed a valid logon on Scranton (10.0.1.4) as user Pam.",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2253.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Valid Accounts\" was received that showed execution of PSExec64.exe using Pam's valid credentials.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12455.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "16.C.2",
                    "Procedure": "Logged on to the domain controller host NewYork (10.0.0.4) using\u00a0valid credentials for user MScott\u00a0",
                    "Criteria": "Successful logon as user MScott on NewYork (10.0.0.4) ",
                    "Tactics": [
                        {
                            "TacticName": "Privilege Escalation",
                            "TacticId": "TA0004"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (yellow indicator) was generated for the successful logon event  on NewYork (10.0.0.4) as user MScott.",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2362.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Valid Accounts\" was received that described the adversary establishing a WinRM session with MScott's credentials.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12506.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1036",
            "TechniqueName": "Masquerading",
            "Tactics": [
                {
                    "TacticName": "Defense Evasion",
                    "TacticId": "TA0005"
                }
            ],
            "Steps": [
                {
                    "SubStep": "1.A.2",
                    "Procedure": "Used unicode right-to-left override (RTLO) character to obfuscate file name rcs.3aka3.doc (originally cod.3aka.scr)",
                    "Criteria": "Evidence of the right-to-left override character (U+202E) in the rcs.3aka.doc process \u200bOR the original filename (cod.3aka.scr)",
                    "Tactics": [
                        {
                            "TacticName": "Defense Evasion",
                            "TacticId": "TA0005"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (purple severity) was generated for rcs.3aka.doc, identified as an EXE.",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2048.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection was received that included details of the file rcs.3aka3.doc and identified it as an EXE.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12471.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "6.A.3",
                    "Procedure": "Masqueraded a Chrome password dump tool as accesscheck.exe, a legitimate Sysinternals tool",
                    "Criteria": "Evidence that accesschk.exe is not the legitimate Sysinternals tool",
                    "Tactics": [
                        {
                            "TacticName": "Defense Evasion",
                            "TacticId": "TA0005"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "An MSSP detection for \"Masquerading\" was received that included an execution event for accesschk.exe and explained that the file was masquerading as a legitimate SysInternals tool. Additional data was received that included details of the file accesscheck.exe such as the hash, company name, and signer. ",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12444.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-12472.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1074",
            "TechniqueName": "Data Staged",
            "Tactics": [
                {
                    "TacticName": "Collection",
                    "TacticId": "TA0009"
                }
            ],
            "Steps": [
                {
                    "SubStep": "2.A.5",
                    "Procedure": "Staged files for exfiltration into ZIP (Draft.zip) using PowerShell",
                    "Criteria": "powershell.exe creating the file draft.zip",
                    "Tactics": [
                        {
                            "TacticName": "Collection",
                            "TacticId": "TA0009"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "No detection capability demonstrated for this procedure.",
                            "DetectionType": "None",
                            "Modifiers": []
                        }
                    ]
                },
                {
                    "SubStep": "9.B.5",
                    "Procedure": "Staged files for exfiltration into ZIP (working.zip in AppData directory) using PowerShell",
                    "Criteria": "powershell.exe creating the file working.zip",
                    "Tactics": [
                        {
                            "TacticName": "Collection",
                            "TacticId": "TA0009"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "No detection capability demonstrated for this procedure.",
                            "DetectionType": "None",
                            "Modifiers": []
                        }
                    ]
                },
                {
                    "SubStep": "17.B.2",
                    "Procedure": "Staged collected file into directory using PowerShell",
                    "Criteria": "powershell.exe creating the file \\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML",
                    "Tactics": [
                        {
                            "TacticName": "Collection",
                            "TacticId": "TA0009"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "No detection capability demonstrated for this procedure.",
                            "DetectionType": "None",
                            "Modifiers": []
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1086",
            "TechniqueName": "PowerShell",
            "Tactics": [
                {
                    "TacticName": "Execution",
                    "TacticId": "TA0002"
                }
            ],
            "Steps": [
                {
                    "SubStep": "1.B.2",
                    "Procedure": "Spawned interactive powershell.exe",
                    "Criteria": "powershell.exe\u00a0spawning from cmd.exe",
                    "Tactics": [
                        {
                            "TacticName": "Execution",
                            "TacticId": "TA0002"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (yellow indicator) for \"Powershell\" was generated when cmd.exe spawned powershell.exe. The alert was correlated to a parent alert for User Execution of rcs.3aka3.doc\u200b.",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Correlated",
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2056.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-2057.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"PowerShell\" was received that included a description of PowerShell execution and an explanation of the commands executed through it.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12220.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-12222.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "4.A.2",
                    "Procedure": "Spawned interactive powershell.exe",
                    "Criteria": "powershell.exe spawning from powershell.exe",
                    "Tactics": [
                        {
                            "TacticName": "Execution",
                            "TacticId": "TA0002"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Tactic alert detection (yellow indicator) was generated for a new powershell.exe spawning from powershell.exe.",
                            "DetectionType": "Tactic",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-14918.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "9.B.1",
                    "Procedure": "Spawned interactive powershell.exe",
                    "Criteria": "powershell.exe\u200b spawning from python.exe",
                    "Tactics": [
                        {
                            "TacticName": "Execution",
                            "TacticId": "TA0002"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (yellow indicator) for \"PowerShell\" was generated when python.exe spawned powershell.exe. The event was correlated to a parent Technique detection for Service Execution of python.exe by PSEXECSVC.exe.",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert",
                                "Correlated"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2257.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"PowerShell\" was received that showed execution of powershell.exe by python.exe.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12461.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "11.A.12",
                    "Procedure": "Executed PowerShell stager payload",
                    "Criteria": "powershell.exe spawning from from the schemas ADS (powershell.exe)",
                    "Tactics": [
                        {
                            "TacticName": "Execution",
                            "TacticId": "TA0002"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (red indicator) for \"PowerShell\" was generated for powershell.exe spawned from a PowerShell stager.",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2436.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection was received that included a PowerShell script and explained that it was used to download and execute another script via IEX.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2503.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-12483.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "20.A.3",
                    "Procedure": "Executed PowerShell payload from WMI event subscription persistence",
                    "Criteria": "SYSTEM-level powershell.exe spawned from the powershell.exe",
                    "Tactics": [
                        {
                            "TacticName": "Execution",
                            "TacticId": "TA0002"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (yellow indicatorl) for \"Powershell\" was generated due to  a SYSTEM-level powershell.exe spawning from wmiprvse.exe. ",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2494.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"PowerShell\" was received that described execution of powershell.exe triggered by a WMI Event Subscription.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12522.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1045",
            "TechniqueName": "Software Packing",
            "Tactics": [
                {
                    "TacticName": "Defense Evasion",
                    "TacticId": "TA0005"
                }
            ],
            "Steps": [
                {
                    "SubStep": "8.B.2",
                    "Procedure": "python.exe payload was packed with UPX",
                    "Criteria": "Evidence that the file python.exe is packed",
                    "Tactics": [
                        {
                            "TacticName": "Defense Evasion",
                            "TacticId": "TA0005"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A Technique alert detection (yellow indicator) for \"Software Packing\" was generated for the file creation event for python.exe.",
                            "DetectionType": "Technique",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-14901.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1082",
            "TechniqueName": "System Information Discovery",
            "Tactics": [
                {
                    "TacticName": "Discovery",
                    "TacticId": "TA0007"
                }
            ],
            "Steps": [
                {
                    "SubStep": "4.C.3",
                    "Procedure": "Enumerated the computer hostname using PowerShell",
                    "Criteria": "powershell.exe executing $env:COMPUTERNAME",
                    "Tactics": [
                        {
                            "TacticName": "Discovery",
                            "TacticId": "TA0007"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "An MSSP detection for \"System Information Discovery\" was received that included a PowerShell script and explained that it was used to obtain the current computer name.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12466.png"
                                }
                            ],
                            "Footnotes": [
                                "MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity."
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "4.C.6",
                    "Procedure": "Enumerated the OS version using PowerShell",
                    "Criteria": "powershell.exe executing\u200b Gwmi Win32_OperatingSystem",
                    "Tactics": [
                        {
                            "TacticName": "Discovery",
                            "TacticId": "TA0007"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "An MSSP detection for \"System Information Discovery\" was received that included a PowerShell script and explained that it was used to obtain the OS system information.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12466.png"
                                }
                            ],
                            "Footnotes": [
                                "MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity."
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "11.A.4",
                    "Procedure": "Enumerated computer manufacturer, model, and version information using PowerShell",
                    "Criteria": "powershell.exe executing a Get-WmiObject gwmi queries for Win32_BIOS and Win32_ComputerSystem",
                    "Tactics": [
                        {
                            "TacticName": "Discovery",
                            "TacticId": "TA0007"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (red indicator) was generated identifying the PowerShell gwmi queries for Win32_ComputerSystem as threat activity.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2421.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "A General alert detection (red indicator) was generated identifying the PowerShell gwmi query for Win32_BIOS as threat activity.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2421.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-2419.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"System Information Discovery\" was received that included a PowerShell script and explained that it was used to query Win32_ComputerSystem via WMI.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12476.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-2503.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "13.A.1",
                    "Procedure": "Enumerated the computer name using the GetComputerNameEx API",
                    "Criteria": "powershell.exe executing the GetComputerNameEx API",
                    "Tactics": [
                        {
                            "TacticName": "Discovery",
                            "TacticId": "TA0007"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (blue indicator) was generated due to the execution of the comp function.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2441.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"System Information Discovery\" occurred containing evidence of PowerShell calling the GetComputerNameEx API.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12489.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1055",
            "TechniqueName": "Process Injection",
            "Tactics": [
                {
                    "TacticName": "Defense Evasion",
                    "TacticId": "TA0005"
                }
            ],
            "Steps": [
                {
                    "SubStep": "19.A.2",
                    "Procedure": "Reflectively injected SDelete binary into PowerShell",
                    "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection",
                    "Tactics": [
                        {
                            "TacticName": "Defense Evasion",
                            "TacticId": "TA0005"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.",
                            "DetectionType": "N/A",
                            "Modifiers": []
                        }
                    ]
                },
                {
                    "SubStep": "19.B.2",
                    "Procedure": "Reflectively injected SDelete binary into PowerShell",
                    "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection",
                    "Tactics": [
                        {
                            "TacticName": "Defense Evasion",
                            "TacticId": "TA0005"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.",
                            "DetectionType": "N/A",
                            "Modifiers": []
                        }
                    ]
                },
                {
                    "SubStep": "19.C.2",
                    "Procedure": "Reflectively injected SDelete binary into PowerShell",
                    "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection",
                    "Tactics": [
                        {
                            "TacticName": "Defense Evasion",
                            "TacticId": "TA0005"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.",
                            "DetectionType": "N/A",
                            "Modifiers": []
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1056",
            "TechniqueName": "Input Capture",
            "Tactics": [
                {
                    "TacticName": "Collection",
                    "TacticId": "TA0009"
                }
            ],
            "Steps": [
                {
                    "SubStep": "7.A.3",
                    "Procedure": "Captured user keystrokes using the GetAsyncKeyState API",
                    "Criteria": "powershell.exe executing the GetAsyncKeyState API",
                    "Tactics": [
                        {
                            "TacticName": "Collection",
                            "TacticId": "TA0009"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection for Threat Activity (red indicator) was generated for PowerShell calling the GetAsyncKeyState API.",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-14846.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Input Capture\" occurred containing evidence of key logging.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12451.png"
                                },
                                {
                                    "ScreenshotName": "CyCraft-APT29-12450.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1012",
            "TechniqueName": "Query Registry",
            "Tactics": [
                {
                    "TacticName": "Discovery",
                    "TacticId": "TA0007"
                }
            ],
            "Steps": [
                {
                    "SubStep": "12.C.1",
                    "Procedure": "Enumerated installed software via the Registry (Wow6432 Uninstall key) using PowerShell",
                    "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall",
                    "Tactics": [
                        {
                            "TacticName": "Discovery",
                            "TacticId": "TA0007"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (red indicator) was generated for the script block with registry query for installed software. The event was correlated to a previous detection for \"Security Software Discovery.\"",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Correlated",
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2440.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Query Registry\" was received that included a PowerShell script and explained that it was used to detect installed software.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Processing)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12488.png"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "12.C.2",
                    "Procedure": "Enumerated installed software via the Registry (Uninstall key) using PowerShell",
                    "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall",
                    "Tactics": [
                        {
                            "TacticName": "Discovery",
                            "TacticId": "TA0007"
                        }
                    ],
                    "Detections": [
                        {
                            "DetectionNote": "A General alert detection (red indicator) was generated for the scriptblock with registry query for installed software. The event was correlated to a previous detection for \"Security Software Discovery.\"",
                            "DetectionType": "General",
                            "Modifiers": [
                                "Alert"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-2440.png"
                                }
                            ]
                        },
                        {
                            "DetectionNote": "An MSSP detection for \"Query Registry\" was received that included a PowerShell script and explained that it was used to detect installed software.",
                            "DetectionType": "MSSP",
                            "Modifiers": [
                                "Delayed (Manual)"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "CyCraft-APT29-12488.png"
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    ]
}