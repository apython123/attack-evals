{"Round": "1", "Steps": [{"Substep": "1.A.1", "Procedure": "Legitimate user Debbie clicked and executed malicious self-extracting archive (Resume Viewer.exe) on 10.0.1.6 (Nimda)", "Techniques": [{"TechniqueId": "T1204", "TechniqueName": "User Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated indicating that the user Debbie executed Resume Viewer.exe. This alert had a severity score of 51/100 and was based upon \"Newly Executed Applications\".", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-1.A.1-2.png", "ScreenshotCaption": "Telemetry from process tree showing Resume Viewer.exe execution sequence"}, {"ScreenshotName": "CB-1.A.1-1.png", "ScreenshotCaption": "General Behavior alert showing execution of Resume Viewer.exe as a Newly Executed Application"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed Resume Viewer.exe running along with its children.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-1.A.1-2.png", "ScreenshotCaption": "Telemetry from process tree showing Resume Viewer.exe execution sequence"}, {"ScreenshotName": "CB-1.A.1-1.png", "ScreenshotCaption": "General Behavior alert showing execution of Resume Viewer.exe as a Newly Executed Application"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert for Machine Learning showed that Resume Viewer.exe was executed and that it was detected as malicious.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-1.A.1-1.png", "ScreenshotCaption": "Machine Learning General Behavior alert showing execution of Resume Viewer.exe and detection as malicious"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the alert showed that Resume Viewer.exe executed, and would also be available in a separate view.[CS8]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-1.A.1-1.png", "ScreenshotCaption": "Machine Learning General Behavior alert showing execution of Resume Viewer.exe and detection as malicious"}], "Footnotes": ["For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not specifically taken in this instance."]}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated based on explorer.exe attempting to execute a file (Resume Viewer.exe) identified as malicious.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-1.A.1-10.png", "ScreenshotCaption": "General Behavior alert identifying Resume Viewer.exe as unknown malware"}, {"ScreenshotName": "CR-1.A.1-11.png", "ScreenshotCaption": "General Behavior alert for explorer.exe executing Resume Viewer.exe, identified as a known malicious file"}, {"ScreenshotName": "CR-1.A.1-100.png", "ScreenshotCaption": "Telemetry showing Resume Viewer.exe running as a process (tainted by parent alert on explorer.exe)"}], "Footnotes": []}, {"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated based on the identification of Resume Viewer.exe as unknown malware by the Anti-Malware engine. [CR1]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-1.A.1-10.png", "ScreenshotCaption": "General Behavior alert identifying Resume Viewer.exe as unknown malware"}, {"ScreenshotName": "CR-1.A.1-11.png", "ScreenshotCaption": "General Behavior alert for explorer.exe executing Resume Viewer.exe, identified as a known malicious file"}, {"ScreenshotName": "CR-1.A.1-100.png", "ScreenshotCaption": "Telemetry showing Resume Viewer.exe running as a process (tainted by parent alert on explorer.exe)"}], "Footnotes": [" Vendor stated that the capability would have prevented the execution of Resume Viewer.exe."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed that Resume Viewer.exe was executed and running as a process. The telemetry was tainted by a parent alert on explorer.exe attempting to execute a file (Resume Viewer.exe) identified as malicious. [CR2]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-1.A.1-10.png", "ScreenshotCaption": "General Behavior alert identifying Resume Viewer.exe as unknown malware"}, {"ScreenshotName": "CR-1.A.1-11.png", "ScreenshotCaption": "General Behavior alert for explorer.exe executing Resume Viewer.exe, identified as a known malicious file"}, {"ScreenshotName": "CR-1.A.1-100.png", "ScreenshotCaption": "Telemetry showing Resume Viewer.exe running as a process (tainted by parent alert on explorer.exe)"}], "Footnotes": [" The provided screenshot was captured later in the evaluation and includes additional information appended to explorer.exe not relevant to this procedure."]}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for Malicious File Detection on the execution of Resume Viewer.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-01-1.png", "ScreenshotCaption": "Malicious File Detection General Behavior alert on Resume Viewer.exe execution and surrounding telemetry"}, {"ScreenshotName": "EG-01-2.png", "ScreenshotCaption": "Event tree view showing Malicious File Detection General Behavior alert on Resume Viewer.exe execution"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed events surrounding the Resume Viewer.exe event to indicate execution (tainted by a parent Malicious File Detection).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-01-1.png", "ScreenshotCaption": "Malicious File Detection General Behavior alert on Resume Viewer.exe execution and surrounding telemetry"}, {"ScreenshotName": "EG-01-2.png", "ScreenshotCaption": "Event tree view showing Malicious File Detection General Behavior alert on Resume Viewer.exe execution"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for the execution of a rare file (Resume Viewer.exe). [CC1] [CC4]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-1.A.1-4.png", "ScreenshotCaption": "Telemetry showing the execution of Resume Viewer.exe"}], "Footnotes": ["The vendor reported that this behavior would have been prevented from executing.", "Screenshot is unavailable due to sensitivity of alert logic."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution of Resume Viewer.exe as a process.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-1.A.1-4.png", "ScreenshotCaption": "Telemetry showing the execution of Resume Viewer.exe"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for the Resume Viewer.exe file due to it being labeled as malicious by a machine learning engine. The alert was generated after a configuration change of the file size limit for the machine learning engine. [FE1][FE2]", "Modifiers": ["Configuration Change"], "Screenshots": [{"ScreenshotName": "FE-1.A.1-1.png", "ScreenshotCaption": "General Behavior alert showing Resume Viewer.exe labeled as Malware (alert triggered after configuration change)"}, {"ScreenshotName": "FE-1.A.1-5.png", "ScreenshotCaption": "Telemetry showing Resume Viewer.exe being executed by explorer.exe"}], "Footnotes": [" The vendor reported that this file would have been quarantined and prevented from executing.  ", "The scan type used to produce this alert is On-access, which means the scan occurs on file writes and executions."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed Resume Viewer.exe executing with a parent process of explorer.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-1.A.1-1.png", "ScreenshotCaption": "General Behavior alert showing Resume Viewer.exe labeled as Malware (alert triggered after configuration change)"}, {"ScreenshotName": "FE-1.A.1-5.png", "ScreenshotCaption": "Telemetry showing Resume Viewer.exe being executed by explorer.exe"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed that Resume Viewer.exe was executed. The telemetry was tainted by the parent Script File Created alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-1.A.1-2.png", "ScreenshotCaption": "Telemetry showing Resume Viewer.exe running (tainted by the parent Script File Created alert)"}], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed that Resume Viewer.exe was executed by Explorer.exe by user Debbie.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-1.A.1-1.png", "ScreenshotCaption": "Telemetry showing that Resume Viewer.exe was executed by Explorer.exe by user Debbie"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the user execution sequence of Resume Viewer.exe with multiple files written and subsequently executed.[MS1]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-1.A.1-1.png", "ScreenshotCaption": "Telemetry showing execution of Resume Viewer.exe from explorer.exe and dropping pdfhelper.cmd and autoupdate.bat"}, {"ScreenshotName": "MS-1.A.1-2.png", "ScreenshotCaption": "Telemetry showing write of pdfhelper.cmd"}, {"ScreenshotName": "MS-1.A.1-3.png", "ScreenshotCaption": "Telemetry showing write of autoupdate.bat"}, {"ScreenshotName": "MS-1.A.1-4.png", "ScreenshotCaption": "Telemetry showing execution of pdfhelper.cmd and update.dat"}, {"ScreenshotName": "MS-1.A.1-5.png", "ScreenshotCaption": "Telemetry showing execution of decoy PDF by MicrosoftPdfReader.exe"}, {"ScreenshotName": "MS-1.A.1-6.png", "ScreenshotCaption": "Telemetry showing Resume Viewer.exe binary and process metadata"}, {"ScreenshotName": "MS-1.A.1-7.png", "ScreenshotCaption": "Telemetry showing Resume Viewer.exe binary reputation"}, {"ScreenshotName": "MS-1.A.1-8.png", "ScreenshotCaption": "Exploit Guard audit of Resume Viewer.exe"}], "Footnotes": ["Resume Viewer.exe was audited by Exploit Guard and the vendor stated that the audit events demonstrate that execution would have been prevented if Attack Surface Reduction (ASR) was enabled in blocking mode."]}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed that Resume Viewer.exe was executed and running as a process owned by user Debbie.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-1.A.1-1.png", "ScreenshotCaption": "Telemetry showing Resume Viewer.exe running as a process"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of Resume Viewer.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-01-1.png", "ScreenshotCaption": "Telemetry showing Resume Viewer.exe execution"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated due to static analysis of the file through the DFI resulting in it being marked as suspicious, which generated a story (group ID) that subsequent linked events are tainted by.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "S1-1.A.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing execution of Resume Viewer.exe"}, {"ScreenshotName": "S1-1.A.1-2.png", "ScreenshotCaption": "General Behavior alert for execution of Resume Viewer.exe as a suspicious file"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed Resume Viewer.exe execution with subsequent file writes and execution.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "S1-1.A.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing execution of Resume Viewer.exe"}, {"ScreenshotName": "S1-1.A.1-2.png", "ScreenshotCaption": "General Behavior alert for execution of Resume Viewer.exe as a suspicious file"}], "Footnotes": []}]}]}]}, {"Substep": "1.A.1", "Procedure": "Previously executed batch file (pdfhelper.cmd) launched a DLL payload (update.dat) using Rundll32", "Techniques": [{"TechniqueId": "T1085", "TechniqueName": "Rundll32", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the rundll32.exe execution with the correct ATT&CK Technique (T1085, which corresponds to the Rundll32 Technique).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-1.A.1-2.png", "ScreenshotCaption": "Telemetry from process tree showing Resume Viewer.exe execution sequence with rundll32.exe"}, {"ScreenshotName": "CB-1.A.1-1.png", "ScreenshotCaption": "Enrichment of rundll32.exe execution with correct ATT&CK Technique (T1085, corresponding to Rundll32)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed the Resume Viewer.exe execution sequence and rundll32.exe executing.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-1.A.1-2.png", "ScreenshotCaption": "Telemetry from process tree showing Resume Viewer.exe execution sequence with rundll32.exe"}, {"ScreenshotName": "CB-1.A.1-1.png", "ScreenshotCaption": "Enrichment of rundll32.exe execution with correct ATT&CK Technique (T1085, corresponding to Rundll32)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated due to rundll32 launching a suspended process. The alert was mapped to the correct ATT&CK Technique (Rundll32) and Tactic (Defense Evasion).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-1.A.1-6.png", "ScreenshotCaption": "Specific Behavior alert showing rundll32 execution (mapped to correct ATT&CK Technique, Rundll32, and Tactic, Defense Evasion. Green arrow indicates injection.)"}, {"ScreenshotName": "CS-1.A.1-4.png", "ScreenshotCaption": "OverWatch General Behavior alert indicating rundll32 execution was suspicious"}], "Footnotes": []}, {"DetectionType": "General Behavior", "DetectionNote": "OverWatch generated a General Behavior alert indicating rundll32 executing update.dat was suspicious.[CS1]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-1.A.1-6.png", "ScreenshotCaption": "Specific Behavior alert showing rundll32 execution (mapped to correct ATT&CK Technique, Rundll32, and Tactic, Defense Evasion. Green arrow indicates injection.)"}, {"ScreenshotName": "CS-1.A.1-4.png", "ScreenshotCaption": "OverWatch General Behavior alert indicating rundll32 execution was suspicious"}], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the OverWatch alert showed rundll32.exe executing, and would also be available in a separate view.[CS2]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-1.A.1-6.png", "ScreenshotCaption": "Specific Behavior alert showing rundll32 execution (mapped to correct ATT&CK Technique, Rundll32, and Tactic, Defense Evasion. Green arrow indicates injection.)"}, {"ScreenshotName": "CS-1.A.1-4.png", "ScreenshotCaption": "OverWatch General Behavior alert indicating rundll32 execution was suspicious"}], "Footnotes": ["For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for injected shellcode by a compromised legitimate process (rundll32.exe). The alert was tagged with the correct ATT&CK Tactic (Defense Evasion) and a related Technique (Process Injection) and was tainted by parent alert on rundll32.exe injection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-1.A.1-200.png", "ScreenshotCaption": "Specific Behavior alert for rundll32.exe launching a module from a temporary folder and injecting shellcode into a victim process (tainted by parent alert on explorer.exe)"}, {"ScreenshotName": "CR-1.A.1-101.png", "ScreenshotCaption": "Telemetry within the rundll32.exe injection alert showing command-line arguments of rundll32.exe running update.dat (tainted by parent alert on explorer.exe)"}, {"ScreenshotName": "CR-1.A.1-30.png", "ScreenshotCaption": "Specific Behavior alert for rundll32.exe, identified as a compromised legitimate process, injecting shellcode into rundll32.exe, tagged with the correct ATT&CK Tactic (Defense Evasion) and a related Technique (Process Injection)"}], "Footnotes": []}, {"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for rundll32.exe launching a module in a temporary folder and injecting shell code into a victim process. The alert was tainted by a parent alert on explorer.exe attempting to execute a file (Resume Viewer.exe) identified as malicious.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-1.A.1-200.png", "ScreenshotCaption": "Specific Behavior alert for rundll32.exe launching a module from a temporary folder and injecting shellcode into a victim process (tainted by parent alert on explorer.exe)"}, {"ScreenshotName": "CR-1.A.1-101.png", "ScreenshotCaption": "Telemetry within the rundll32.exe injection alert showing command-line arguments of rundll32.exe running update.dat (tainted by parent alert on explorer.exe)"}, {"ScreenshotName": "CR-1.A.1-30.png", "ScreenshotCaption": "Specific Behavior alert for rundll32.exe, identified as a compromised legitimate process, injecting shellcode into rundll32.exe, tagged with the correct ATT&CK Tactic (Defense Evasion) and a related Technique (Process Injection)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the rundll32.exe injection alert also showed full command-line arguments of rundll32.exe executing update.dat. The telemetry was tainted by a parent alert on explorer.exe attempting to execute a file (Resume Viewer.exe) identified as malicious. [CR4]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-1.A.1-200.png", "ScreenshotCaption": "Specific Behavior alert for rundll32.exe launching a module from a temporary folder and injecting shellcode into a victim process (tainted by parent alert on explorer.exe)"}, {"ScreenshotName": "CR-1.A.1-101.png", "ScreenshotCaption": "Telemetry within the rundll32.exe injection alert showing command-line arguments of rundll32.exe running update.dat (tainted by parent alert on explorer.exe)"}, {"ScreenshotName": "CR-1.A.1-30.png", "ScreenshotCaption": "Specific Behavior alert for rundll32.exe, identified as a compromised legitimate process, injecting shellcode into rundll32.exe, tagged with the correct ATT&CK Tactic (Defense Evasion) and a related Technique (Process Injection)"}], "Footnotes": [" For most alerts in the user interface, the telemetry behind it is separately available in the capability and counted as a separate detection."]}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert called RunDLL32 with Suspicious DLL Location was generated due to rundll32.exe running update.dat. The alert was also tagged with the correct ATT&CK Technique (T1085 - Rundll32) and Tactics (Defense Evasion, Execution) and was tainted by a parent Malicious File Detection alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-01-10.png", "ScreenshotCaption": "Telemetry showing rundll32.exe running update.dat execution event"}, {"ScreenshotName": "EG-01-2.png", "ScreenshotCaption": "Event tree view showing the Malicious File Detection alert tainting rundll32.exe telemetry"}, {"ScreenshotName": "EG-01-11.png", "ScreenshotCaption": "Specific Behavior alert for RunDLL32 with Suspicious DLL Location and surrounding telemetry\u00a0 (tagged with correct ATT&CK Technique, T1085 - Rundll32 and Tactics, Defense Evasion, Execution; tainted by parent Malicious File Detection alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed rundll32.exe running update.dat. The telemetry was tainted by a parent Malicious File Detection alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-01-10.png", "ScreenshotCaption": "Telemetry showing rundll32.exe running update.dat execution event"}, {"ScreenshotName": "EG-01-2.png", "ScreenshotCaption": "Event tree view showing the Malicious File Detection alert tainting rundll32.exe telemetry"}, {"ScreenshotName": "EG-01-11.png", "ScreenshotCaption": "Specific Behavior alert for RunDLL32 with Suspicious DLL Location and surrounding telemetry\u00a0 (tagged with correct ATT&CK Technique, T1085 - Rundll32 and Tactics, Defense Evasion, Execution; tainted by parent Malicious File Detection alert)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for rundll32.exe executing in a way typical for rundll32 injections. [CC4]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-1.A.1-4.png", "ScreenshotCaption": "Telemetry showing rundll32.exe executing update.dat"}], "Footnotes": ["Screenshot is unavailable due to sensitivity of alert logic."]}, {"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for an unusual call to rundll32.exe. [CC4]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-1.A.1-4.png", "ScreenshotCaption": "Telemetry showing rundll32.exe executing update.dat"}], "Footnotes": ["Screenshot is unavailable due to sensitivity of alert logic."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed rundll32.exe executing update.dat.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-1.A.1-4.png", "ScreenshotCaption": "Telemetry showing rundll32.exe executing update.dat"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified use of rundll32.exe to execute update.dat with command-line arguments. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-1.A.1-3.png", "ScreenshotCaption": "Enrichment of rundll32.exe execution (tagged with correct ATT&CK Technique, T1085 - Rundll32, and Tactics, Defense Evasion, Execution)"}, {"ScreenshotName": "FE-1.A.1-6.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating rundll32.exe was used for execution (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched rundll32.exe with an alert for Rundll32 Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1085 - Rundll32) and Tactics (Defense Evasion, Execution).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-1.A.1-3.png", "ScreenshotCaption": "Enrichment of rundll32.exe execution (tagged with correct ATT&CK Technique, T1085 - Rundll32, and Tactics, Defense Evasion, Execution)"}, {"ScreenshotName": "FE-1.A.1-6.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating rundll32.exe was used for execution (Specific Behavior)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed that cmd.exe created the rundll32.exe process that started update.dat. The telemetry was tainted by the parent Script File Created alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-1.A.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe launched rundll32.exe (tainted by the Script File Created alert)"}], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "Specific Behavior alerts were generated based on suspicious indicators that a \"Loaded non-DLL and non-CPL file with specified parameters via rundll32.\" The alerts were tagged with the correct ATT&CK Tactic (Defense Evasion, Execution) and Technique (Rundll32).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-1.A.1-5.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing update.dat via rundll32.exe"}, {"ScreenshotName": "MC-1.B.1-6.png", "ScreenshotCaption": "Process tree within trace detection showing rundll32.exe executing (tainted by a parent alert on Resume Viewer.exe)"}, {"ScreenshotName": "MC-1.A.1-23.png", "ScreenshotCaption": "Specific Behavior alerts based on suspicious indicators that a \"Loaded non-DLL and non-CPL file with specified parameters via rundll32.\" The alerts were tagged with the correct ATT&CK Tactic (Defense Evasion, Execution) and Technique (Rundll32)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing update.dat via rundll32.exe. The telemetry was tainted by a trace detection on Resume Viewer.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-1.A.1-5.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing update.dat via rundll32.exe"}, {"ScreenshotName": "MC-1.B.1-6.png", "ScreenshotCaption": "Process tree within trace detection showing rundll32.exe executing (tainted by a parent alert on Resume Viewer.exe)"}, {"ScreenshotName": "MC-1.A.1-23.png", "ScreenshotCaption": "Specific Behavior alerts based on suspicious indicators that a \"Loaded non-DLL and non-CPL file with specified parameters via rundll32.\" The alerts were tagged with the correct ATT&CK Tactic (Defense Evasion, Execution) and Technique (Rundll32)"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A delayed General Behavior alert was generated for a low-reputation DLL loaded by a signed executable due to rundll32.exe execution of update.dat.", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "MS-1.A.1-10.png", "ScreenshotCaption": "Telemetry showing rundll32.exe process injection sequence"}, {"ScreenshotName": "MS-1.A.1-13.png", "ScreenshotCaption": "General Behavior alert on low-reputation DLL load by signed executable"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence for rundll32.exe running update.dat.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-1.A.1-10.png", "ScreenshotCaption": "Telemetry showing rundll32.exe process injection sequence"}, {"ScreenshotName": "MS-1.A.1-13.png", "ScreenshotCaption": "General Behavior alert on low-reputation DLL load by signed executable"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "Specific Behavior alerts were generated for rundll32. The alerts were tagged with the correct ATT&CK Technique (Rundll32) and were tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-1.A.1-4.png", "ScreenshotCaption": "Telemetry showing rundll32.exe executing update.dat (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-1.A.1-5.png", "ScreenshotCaption": "Specific Behavior alerts for rundll32 tagged with the correct ATT&CK Technique (Rundll32) (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-1.A.1-6.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe executing update.dat, identified as a suspicious DLL and malware (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-1.A.1-7.png", "ScreenshotCaption": "Additional details of General Behavior alert for rundll32.exe executing update.dat"}], "Footnotes": []}, {"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated based on rundll32.exe executing update.dat, identified as a suspicious DLL and malware. The alert was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine. [PA1]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-1.A.1-4.png", "ScreenshotCaption": "Telemetry showing rundll32.exe executing update.dat (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-1.A.1-5.png", "ScreenshotCaption": "Specific Behavior alerts for rundll32 tagged with the correct ATT&CK Technique (Rundll32) (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-1.A.1-6.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe executing update.dat, identified as a suspicious DLL and malware (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-1.A.1-7.png", "ScreenshotCaption": "Additional details of General Behavior alert for rundll32.exe executing update.dat"}], "Footnotes": ["Vendor stated the capability would have prevented execution of update.dat."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed rundll32.exe executing update.dat with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-1.A.1-4.png", "ScreenshotCaption": "Telemetry showing rundll32.exe executing update.dat (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-1.A.1-5.png", "ScreenshotCaption": "Specific Behavior alerts for rundll32 tagged with the correct ATT&CK Technique (Rundll32) (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-1.A.1-6.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe executing update.dat, identified as a suspicious DLL and malware (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-1.A.1-7.png", "ScreenshotCaption": "Additional details of General Behavior alert for rundll32.exe executing update.dat"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe launching rundll32.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-01-1.png", "ScreenshotCaption": "Telemetry showing execution of Resume Viewer.exe"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed rundll32.exe executing as a result of Resume Viewer.exe running. The telemetry was tainted by the previous alert generated from Resume Viewer.exe because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-1.A.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing rundll32.exe (tainted by relationship to threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "1.A.1", "Procedure": "Previously executed self-extracting archive (Resume Viewer.exe) launched an embedded batch file (pdfhelper.cmd)", "Techniques": [{"TechniqueId": "T1064", "TechniqueName": "Scripting", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the cmd.exe execution with the correct ATT&CK Technique (T1064 - Scripting).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-1.A.1-3.png", "ScreenshotCaption": "Telemetry from process tree showing cmd.exe running the pdfhelper.cmd script"}, {"ScreenshotName": "CB-1.A.1-1.png", "ScreenshotCaption": "Enrichment of cmd.exe executing pdfhelper.cmd with correct ATT&CK Technique (T1064 - Scripting)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed cmd.exe executing the pdfhelper.cmd script.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-1.A.1-3.png", "ScreenshotCaption": "Telemetry from process tree showing cmd.exe running the pdfhelper.cmd script"}, {"ScreenshotName": "CB-1.A.1-1.png", "ScreenshotCaption": "Enrichment of cmd.exe executing pdfhelper.cmd with correct ATT&CK Technique (T1064 - Scripting)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "OverWatch generated a General Behavior alert indicating the execution of pdfhelper.cmd was suspicious.[CS1]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-1.A.1-5.png", "ScreenshotCaption": "OverWatch General Behavior alert indicating pdfhelper.cmd execution was suspicious"}, {"ScreenshotName": "CS-1.A.1-7.png", "ScreenshotCaption": "Telemetry showing pdfhelper.cmd execution"}], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed pdfhelper.cmd being executed by cmd.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-1.A.1-5.png", "ScreenshotCaption": "OverWatch General Behavior alert indicating pdfhelper.cmd execution was suspicious"}, {"ScreenshotName": "CS-1.A.1-7.png", "ScreenshotCaption": "Telemetry showing pdfhelper.cmd execution"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe launching pdfhelper.cmd. The telemetry was tainted by a parent alert on explorer.exe attempting to execute a file (Resume Viewer.exe) identified as malicious.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-1.A.1-20.png", "ScreenshotCaption": "Telemetry showing cmd.exe launching pdfhelper.cmd (tainted by parent alert on explorer.exe)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing pdfhelper.cmd as well as pdfhelper.cmd spawning as a child process of Resume Viewer.exe. The telemetry was tainted by a parent Malicious File Detection alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-01-3.png", "ScreenshotCaption": "Telemetry showing pdfhelper.cmd spawned as a child process of Resume Viewer.exe (tainted by parent Malicious File Detection alert)"}, {"ScreenshotName": "EG-01-9.png", "ScreenshotCaption": "Telemetry showing cmd.exe process creation and execution of pdfhelper.cmd (tainted by parent Malicious File Detection alert)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (cmd.exe running pdfhelper.cmd) has been tagged for monitoring because its parent process has a detection (Resume Viewer.exe). [CC4]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-1.A.1-4.png", "ScreenshotCaption": "Telemetry showing the execution of pdfhelper.cmd"}], "Footnotes": ["Screenshot is unavailable due to sensitivity of alert logic."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed pdfhelper.cmd was executed by cmd.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-1.A.1-4.png", "ScreenshotCaption": "Telemetry showing the execution of pdfhelper.cmd"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed Resume Viewer.exe spawning the child process cmd.exe to launch pdfhelper.cmd.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-1.A.1-2.png", "ScreenshotCaption": "Telemetry showing the child cmd.exe process running the pdfhelper.cmd script"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed that Resume Viewer.exe created cmd.exe, which ran the script pdfhelper.cmd. The telemetry was tainted by the parent Script File Created alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-1.A.1-4.png", "ScreenshotCaption": "Telemetry showing cmd.exe running pdfhelper.cmd (tainted by the Script File Created alert)"}], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed pdfhelper.cmd being executed by cmd.exe. The telemetry was tainted by a trace detection on Resume Viewer.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-1.B.1-5.png", "ScreenshotCaption": "Telemetry showing pdfhelper.cmd execution"}, {"ScreenshotName": "MC-1.B.1-6.png", "ScreenshotCaption": "Process tree within trace detection containing cmd.exe executing pdfhelper.cmd (tainted by a parent alert on Resume Viewer.exe)"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry within a process tree showed the child cmd.exe process running the script pdfhelper.cmd.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-1.B.1-1.png", "ScreenshotCaption": "Telemetry within the process tree showing the child cmd.exe process running the script pdfhelper.cmd"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for execution of the Windows script engine. The alert was tagged with the correct ATT&CK Technique (Scripting).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-1.A.1-2.png", "ScreenshotCaption": "Telemetry showing cmd.exe launching pdfhelper.cmd"}, {"ScreenshotName": "PA-1.A.1-3.png", "ScreenshotCaption": "Specific Behavior alert for execution of Windows script engine tagged with the correct ATT&CK Technique (Scripting)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe launching pdfhelper.cmd.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-1.A.1-2.png", "ScreenshotCaption": "Telemetry showing cmd.exe launching pdfhelper.cmd"}, {"ScreenshotName": "PA-1.A.1-3.png", "ScreenshotCaption": "Specific Behavior alert for execution of Windows script engine tagged with the correct ATT&CK Technique (Scripting)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed the execution sequence of Resume Viewer.exe executing cmd.exe, which executed rundll32.exe (the pdfhelper.cmd script was not shown).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-01-1.png", "ScreenshotCaption": "Telemetry showing Resume Viewer.exe execution (does not count as a detection)"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing the pdfhelper.cmd script. The telemetry was tainted by the previous alert generated from Resume Viewer.exe because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-1.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing the child cmd.exe process running the script pdfhelper.cmd (tainted by relationship to threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "1.B.1", "Procedure": "Previously executed batch file (pdfhelper.cmd) moved a separate batch file (autoupdate.bat) to the Startup folder", "Techniques": [{"TechniqueId": "T1060", "TechniqueName": "Registry Run Keys / Startup Folder", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched cmd.exe with the correct ATT&CK Technique (T1060 - Registry Run Keys/Start Folder).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-1.B.1-1.png", "ScreenshotCaption": "Telemetry showing filemods indicating update.bat was written to the Startup folder"}, {"ScreenshotName": "CB-1.B.1-2.png", "ScreenshotCaption": "Enrichment of cmd.exe with correct ATT&CK Technique (T1060 - Registry Run Keys/Start Folder)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed filemods indicating the creation and file write of autoupdate.bat to the Startup folder.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-1.B.1-1.png", "ScreenshotCaption": "Telemetry showing filemods indicating update.bat was written to the Startup folder"}, {"ScreenshotName": "CB-1.B.1-2.png", "ScreenshotCaption": "Enrichment of cmd.exe with correct ATT&CK Technique (T1060 - Registry Run Keys/Start Folder)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed Registry activity related to the Startup folder. Though no screenshot of the file write is available, this data maybe indicative of modifications to the folder.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-1.B.1-1.png", "ScreenshotCaption": "Telemetry showing Registry modification related to Startup Folder"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe rewriting autoupdate.bat to the user Debbie's Startup folder. The telemetry was tainted by a parent alert on explorer.exe attempting to execute a file (Resume Viewer.exe) identified as malicious.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-1.B.1-10.png", "ScreenshotCaption": "Telemetry showing rename file event for autoupdate.bat"}, {"ScreenshotName": "CR-1.B.1-100.png", "ScreenshotCaption": "Process tree showing the cmd.exe associated with the autoupdate.bat file event (tainted by parent alert on explorer.exe)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert called \"Detected Persistence - Start Folder Persistence\" was generated due to cmd.exe writing autoupdate.bat to the Startup folder. The alert was also tagged with the correct ATT&CK Technique (T1060 - Registry Run Keys / Start Folder) and Tactic (Persistence). The Specific Behavior alert was tainted by a parent Malicious File Detection alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-01-8.png", "ScreenshotCaption": "Telemetry showing autoupdate.bat written to the Start Menu (tainted by parent Malicious File Detection alert)"}, {"ScreenshotName": "EG-01-7.png", "ScreenshotCaption": "\\\"Detected Persistence - Start Folder Persistence\\\" Specific Behavior alert related to autoupdate.bat (tagged with correct ATT&CK Technique, T1060 - Registry Run Keys / Start Folder, and Tactic, Persistence; tainted by cmd.exe generating the alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed autoupdate.bat written to the Start Menu. The telemetry was tainted by a parent Malicious File Detection alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-01-8.png", "ScreenshotCaption": "Telemetry showing autoupdate.bat written to the Start Menu (tainted by parent Malicious File Detection alert)"}, {"ScreenshotName": "EG-01-7.png", "ScreenshotCaption": "\\\"Detected Persistence - Start Folder Persistence\\\" Specific Behavior alert related to autoupdate.bat (tagged with correct ATT&CK Technique, T1060 - Registry Run Keys / Start Folder, and Tactic, Persistence; tainted by cmd.exe generating the alert)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing autoupdate.bat from within the Startup folder.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-1.B.1-T1060-new.png", "ScreenshotCaption": "Telemetry showing the autoupdate.bat within the Startup folder"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified the backdoor persisted by executing autoupdate.bat at system start due to its presence in the Startup directory.[FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-1.B.1-1.png", "ScreenshotCaption": "Telemetry showing autoupdate.bat file written to the Startup folder"}, {"ScreenshotName": "FE-1.B.1-2.png", "ScreenshotCaption": "Enrichment of autoupdate.bat being written to Startup with Persistence category"}, {"ScreenshotName": "FE-1.B.1-3.png", "ScreenshotCaption": "Additional details on enrichment of autoupdate.dat"}, {"ScreenshotName": "FE-1.B.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the backdoor persisted via autoupdate.bat being written to the Startup directory (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the file write of autoupdate.bat to the Startup folder by categorizing it as Persistence.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-1.B.1-1.png", "ScreenshotCaption": "Telemetry showing autoupdate.bat file written to the Startup folder"}, {"ScreenshotName": "FE-1.B.1-2.png", "ScreenshotCaption": "Enrichment of autoupdate.bat being written to Startup with Persistence category"}, {"ScreenshotName": "FE-1.B.1-3.png", "ScreenshotCaption": "Additional details on enrichment of autoupdate.dat"}, {"ScreenshotName": "FE-1.B.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the backdoor persisted via autoupdate.bat being written to the Startup directory (Specific Behavior)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed autoupdate.bat being written to the Startup folder.[FE50]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-1.B.1-1.png", "ScreenshotCaption": "Telemetry showing autoupdate.bat file written to the Startup folder"}, {"ScreenshotName": "FE-1.B.1-2.png", "ScreenshotCaption": "Enrichment of autoupdate.bat being written to Startup with Persistence category"}, {"ScreenshotName": "FE-1.B.1-3.png", "ScreenshotCaption": "Additional details on enrichment of autoupdate.dat"}, {"ScreenshotName": "FE-1.B.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the backdoor persisted via autoupdate.bat being written to the Startup directory (Specific Behavior)"}], "Footnotes": ["The alert mapped to two ATT&CK Techniques (T1059 - Command-Line Interface and T1105 - Remote File Copy), but they were not directly related to the Registry Run Keys / Startup Folder Technique under test in this procedure."]}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed that autoupdate.bat was created in the Startup folder.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CT-1.B.1-1.png", "ScreenshotCaption": "Telemetry showing autoupdate.bat created in Startup folder"}], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for \"An exe/bat/lnk/dll file has been copied or renamed in the Windows Startup Folder\" for persistence based on pdfhelper.cmd. The alert was tagged with the correct ATT&CK Tactic (Persistence) and Technique (Registry Run Keys / Start Folder).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-1.B.1-1.png", "ScreenshotCaption": "Specific Behavior alert for \"An exe/bat/lnk/dll file has been copied or renamed in the Windows Startup Folder\" for persistence based on pdfhelper.cmd, tagged with the correct ATT&CK Tactic (Persistence) and Technique (Registry Run Keys / Start Folder)"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence for Resume Viewer.exe writing autoupdate.bat to Debbie's Startup folder to establish persistence.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-1.B.1-1.png", "ScreenshotCaption": "Telemetry showing write of autoupdate.bat to startup folder"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched a file being created in the Startup folder with the correct ATT&CK Technique (Registry Run Keys / Start Folder). The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.[PA6]", "Modifiers": ["Configuration Change", "Tainted"], "Screenshots": [{"ScreenshotName": "PA-1.B.1-1.png", "ScreenshotCaption": "Telemetry showing autoupdate.bat being moved to the user Debbie's Startup folder (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-1.B.1-2.png", "ScreenshotCaption": "Enrichment of a file being created in the Startup folder tagged with the correct ATT&CK Technique (Registry Run Keys / Start Folder) (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}], "Footnotes": ["The logic to produce the enrichment was configured after the start of the evaluation so it is identified as a config change."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed autoupdate.bat being moved to the user Debbie's Startup folder. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-1.B.1-1.png", "ScreenshotCaption": "Telemetry showing autoupdate.bat being moved to the user Debbie's Startup folder (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-1.B.1-2.png", "ScreenshotCaption": "Enrichment of a file being created in the Startup folder tagged with the correct ATT&CK Technique (Registry Run Keys / Start Folder) (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a cmd.exe \"rename to executable\" event for autoupdate.bat in the Startup folder.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-01-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe \\\"rename to executable\\\" event for autoupdate.bat in Startup folder"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry on actions performed from Resume Viewer.exe showed autoupdate.bat being written to the Startup Folder. The telemetry was tainted by the previous alert generated from Resume Viewer.exe because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-1.B.1-1.png", "ScreenshotCaption": "Telemetry showing autoupdate.bat write to the Startup folder (tainted by relationship to threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "1.C.1", "Procedure": "Cobalt Strike: C2 channel established using port 53", "Techniques": [{"TechniqueId": "T1043", "TechniqueName": "Commonly Used Port", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a network connection over UDP port 53.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-6.B.1-3.png", "ScreenshotCaption": "Telemetry showing network connection over UDP port 53"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though DNS requests for freegoogleadsenseinfo.com (C2 domain) were observed (no detection showed port 53 specifically).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-1.C.1-1.png", "ScreenshotCaption": "OverWatch alert showing suspicious DNS traffic (does not count as a detection)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed port 53 command and control traffic.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-1.C.1-10.png", "ScreenshotCaption": "Telemetry showing port 53 command and control traffic"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though DNS requests were observed (no detection showed port 53 specifically).", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it observed the use of UDP port 53 for DNS command and control traffic. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-1.C.1-1.png", "ScreenshotCaption": "Telemetry showing port 53 command and control traffic"}, {"ScreenshotName": "FE-1.C.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating command and control occurred over UDP port 53 (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed port 53 command and control traffic.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-1.C.1-1.png", "ScreenshotCaption": "Telemetry showing port 53 command and control traffic"}, {"ScreenshotName": "FE-1.C.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating command and control occurred over UDP port 53 (Specific Behavior)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though DNS requests were observed (no detection showed port 53 specifically).", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[MS99]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-1.C.1-1.png", "ScreenshotCaption": "Telemetry showing DNS requests to the C2 domain (custom query) (does not count as a detection)"}], "Footnotes": ["DNS requests were observed (no detection showed port 53 specifically)."]}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for a scripting engine (rundll32.exe) making a network connection over DNS ports. The alert was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-1.C.1-1.png", "ScreenshotCaption": "Telemetry showing port 53 command and control traffic (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-1.C.1-2.png", "ScreenshotCaption": "Specific Behavior alert for a scripting engine (rundll32.exe) making a network connection over DNS ports (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed port 53 command and control traffic. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.[PA2]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-1.C.1-1.png", "ScreenshotCaption": "Telemetry showing port 53 command and control traffic (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-1.C.1-2.png", "ScreenshotCaption": "Specific Behavior alert for a scripting engine (rundll32.exe) making a network connection over DNS ports (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}], "Footnotes": ["Vendor stated that more information would be available if their firewall appliance was installed and activated."]}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[SO97]", "Modifiers": [], "Screenshots": [], "Footnotes": ["DNS requests were observed (no detection showed port 53 specifically)."]}]}]}]}, {"Substep": "1.C.1", "Procedure": "Cobalt Strike: C2 channel established using DNS traffic to freegoogleadsenseinfo.com", "Techniques": [{"TechniqueId": "T1071", "TechniqueName": "Standard Application Layer Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for abnormally large DNS requests for freegoogleadsenseinfo.com (C2 domain) being sent. The alert was mapped to a related ATT&CK Technique (Exfiltration Over Alternative Protocol) and Tactic (Exfiltration).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-1.C.1-2.png", "ScreenshotCaption": "Specific Behavior alert showing abnormally large DNS requests mapped to related ATT&CK Technique, Exfiltration Over Alternative Protocol, and Tactic, Exfiltration) and OverWatch General Behavior alert indicating that traffic was suspicious"}, {"ScreenshotName": "CS-1.C.1-1.png", "ScreenshotCaption": "Telemetry showing DNS requests"}, {"ScreenshotName": "CS-E-4.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating they observed suspected command and control or data exfiltration via DNS (Specific Behavior)"}], "Footnotes": []}, {"DetectionType": "Specific Behavior", "DetectionNote": "The OverWatch team also sent an email indicating a Specific Behavior occurred because they observed suspected command and control or data exfiltration via DNS.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-1.C.1-2.png", "ScreenshotCaption": "Specific Behavior alert showing abnormally large DNS requests mapped to related ATT&CK Technique, Exfiltration Over Alternative Protocol, and Tactic, Exfiltration) and OverWatch General Behavior alert indicating that traffic was suspicious"}, {"ScreenshotName": "CS-1.C.1-1.png", "ScreenshotCaption": "Telemetry showing DNS requests"}, {"ScreenshotName": "CS-E-4.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating they observed suspected command and control or data exfiltration via DNS (Specific Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "General Behavior", "DetectionNote": "OverWatch also generated a General Behavior alert indicating the DNS traffic was suspicious.[CS1]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-1.C.1-2.png", "ScreenshotCaption": "Specific Behavior alert showing abnormally large DNS requests mapped to related ATT&CK Technique, Exfiltration Over Alternative Protocol, and Tactic, Exfiltration) and OverWatch General Behavior alert indicating that traffic was suspicious"}, {"ScreenshotName": "CS-1.C.1-1.png", "ScreenshotCaption": "Telemetry showing DNS requests"}, {"ScreenshotName": "CS-E-4.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating they observed suspected command and control or data exfiltration via DNS (Specific Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the OverWatch alert showed the DNS requests, and would also be available in a separate view.[CS2]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-1.C.1-2.png", "ScreenshotCaption": "Specific Behavior alert showing abnormally large DNS requests mapped to related ATT&CK Technique, Exfiltration Over Alternative Protocol, and Tactic, Exfiltration) and OverWatch General Behavior alert indicating that traffic was suspicious"}, {"ScreenshotName": "CS-1.C.1-1.png", "ScreenshotCaption": "Telemetry showing DNS requests"}, {"ScreenshotName": "CS-E-4.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating they observed suspected command and control or data exfiltration via DNS (Specific Behavior)"}], "Footnotes": ["For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed rundll32.exe making DNS queries to freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by a parent Injected Shellcode alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-1.C.1-20.png", "ScreenshotCaption": "Telemetry showing rundll32.exe making DNS queries to freegoogleadsenseinfo.com (C2 Domain) (tainted by parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-1.C.1-100.png", "ScreenshotCaption": "Process tree showing rundll32.exe making DNS queries to freegoogleadsenseinfo.com (C2 Domain) (tainted by parent Injected Shellcode alert)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry in the event tree view showed DNS requests spawning from rundll32.exe to freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by a parent Malicious File Detection alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-01-5.png", "ScreenshotCaption": "Telemetry showing DNS requests from rundll32.exe (tainted by parent Malicious File Detection alert)"}, {"ScreenshotName": "EG-01-6.png", "ScreenshotCaption": "Telemetry showing DNS connections"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a trace of DNS queries being made by rundll32.exe to freegoogleadsenseinfo.com (C2 domain).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-1.C.1-T1071-new.png", "ScreenshotCaption": "Telemetry showing rundll32 making DNS queries"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that command and control occurred via DNS. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-1.C.1-2.png", "ScreenshotCaption": "Indicator of Compromise alert for DNS lookups (tagged with correct ATT&CK Technique, T1071 - Standard Application Layer Protocol, and Tactic, Command and Control)"}, {"ScreenshotName": "FE-1.C.1-5.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating command and control occurred via DNS (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Indicator of Compromise", "DetectionNote": "An Indicator of Compromise alert was generated for the hardcoded DNS record name syntax in the DNS lookups for freegoogleadsenseinfo.com (C2 domain). The alert was also tagged with the correct ATT&CK Technique (T1071 - Standard Application Layer Protocol) and Tactic (Command and Control).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-1.C.1-2.png", "ScreenshotCaption": "Indicator of Compromise alert for DNS lookups (tagged with correct ATT&CK Technique, T1071 - Standard Application Layer Protocol, and Tactic, Command and Control)"}, {"ScreenshotName": "FE-1.C.1-5.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating command and control occurred via DNS (Specific Behavior)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed that DNS requests to freegoogleadsenseinfo.com (C2 domain) were being performed out of svchost.exe on Nimda.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CT-1.C.1-1.png", "ScreenshotCaption": "Telemetry showing DNS queries to freegoogleadsenseinfo.com (C2 domain) from svchost.exe"}], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry from showed DNS requests to freegoogleadsenseinfo.com (C2 domain).[MS3]", "Modifiers": ["Configuration Change"], "Screenshots": [{"ScreenshotName": "MS-1.C.1-1.png", "ScreenshotCaption": "Telemetry showing DNS requests to the C2 domain (custom query)"}], "Footnotes": ["The vendor stated that DNS telemetry is captured but it was not immediately visible in the portal. The vendor made changes to the portal during the test to enable by default the visibility of these events."]}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[PA2]", "Modifiers": [], "Screenshots": [], "Footnotes": ["Vendor stated that more information would be available if their firewall appliance was installed and activated."]}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed DNS requests to freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by the previous alert generated from Resume Viewer.exe because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-1.C.1-1.png", "ScreenshotCaption": "Telemetry showing DNS requests to the C2 domain (tainted by relationship to threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "1.C.1", "Procedure": "Cobalt Strike: C2 channel established using both NetBIOS and base64 encoding", "Techniques": [{"TechniqueId": "T1132", "TechniqueName": "Data Encoding", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the base64-encoded DNS requests for freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by the parent Exfiltration alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-1.C.1-2.png", "ScreenshotCaption": "Telemetry within an alert showing encoded DNS requests (tainted by parent Exfiltration alert)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed base64-encoded DNS requests for freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by a parent Injected Shellcode alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-1.C.1-20.png", "ScreenshotCaption": "Telemetry showing rundll32.exe making encoded DNS queries to freegoogleadsenseinfo.com (C2 Domain) (tainted by parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-1.C.1-100.png", "ScreenshotCaption": "Process tree showing rundll32.exe making encoded DNS queries to freegoogleadsenseinfo.com (C2 Domain) (tainted by parent Injected Shellcode alert)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a trace of encoded DNS queries being made by rundll32.exe to freegoogleadsenseinfo.com (C2 domain).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-1.C.1-T1071-new.png", "ScreenshotCaption": "Telemetry showing rundll32 making encoded DNS queries"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed base64-encoded DNS requests to freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by the parent Cobalt Strike DNS Beacon alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "FE-1.C.1-2.png", "ScreenshotCaption": "Telemetry showing encoded DNS requests (tainted by parent Cobalt Strike DNS Beacon alert)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though the capability identified DNS queries (no detection showed data encoding specifically).", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[PA2]", "Modifiers": [], "Screenshots": [], "Footnotes": ["Vendor stated that more information would be available if their firewall appliance was installed and activated."]}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed DNS requests with encoded content to freegoogleadsenseinfo.com (the C2 domain). The telemetry was tainted by the previous alert generated from Resume Viewer.exe because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-1.C.1-2.png", "ScreenshotCaption": "Telemetry showing stream of DNS requests with encoded data"}, {"ScreenshotName": "S1-1.C.1-1.png", "ScreenshotCaption": "Telemetry showing DNS query for freegoogleadsenseinfo.com (C2 domain) (tainted by relationship to threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "2.A.1", "Procedure": "Cobalt Strike: 'ipconfig -all' via cmd", "Techniques": [{"TechniqueId": "T1016", "TechniqueName": "System Network Configuration Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched ipconfig.exe with the correct ATT&CK Technique (T1016 - System Network Configuration Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-2.A.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing ipconfig.exe with command-line arguments"}, {"ScreenshotName": "CB-2.A.1-2.png", "ScreenshotCaption": "Enrichment of ipconfig.exe with correct ATT&CK Technique (T1016 - System Network Configuration Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed cmd.exe executing ipconfig.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-2.A.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing ipconfig.exe with command-line arguments"}, {"ScreenshotName": "CB-2.A.1-2.png", "ScreenshotCaption": "Enrichment of ipconfig.exe with correct ATT&CK Technique (T1016 - System Network Configuration Discovery)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team sent an email indicating a General Behavior was observed because ipconfig was one of the reconnaissance commands performed.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-2.A.1-2.png", "ScreenshotCaption": "Telemetry showing ipconfig with command-line arguments"}, {"ScreenshotName": "CS-2.A.1-1.png", "ScreenshotCaption": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (ipconfig not specifically shown)"}, {"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating ipconfig was a reconnaissance command (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing ipconfig with command-line arguments. The process tree showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran ipconfig) were considered tainted and suspicious.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-2.A.1-2.png", "ScreenshotCaption": "Telemetry showing ipconfig with command-line arguments"}, {"ScreenshotName": "CS-2.A.1-1.png", "ScreenshotCaption": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (ipconfig not specifically shown)"}, {"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating ipconfig was a reconnaissance command (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched cmd.exe executing ipconfig.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery). The data was tainted by a parent Injected Shellcode alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-2.A.1-10.png", "ScreenshotCaption": "Enrichment of ipconfig.exe executing with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-2.B.1-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing ipconfig with command-line arguments"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing ipconfig with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-2.A.1-10.png", "ScreenshotCaption": "Enrichment of ipconfig.exe executing with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-2.B.1-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing ipconfig with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A delayed General Behavior alert triggered for a specified number of discovery techniques over a specified time period, which resulted in four Enumeration Command Sequence alerts for Step 2 (tainted by parent Malicious File Detection).[EG8]", "Modifiers": ["Delayed", "Configuration Change", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-02-1.png", "ScreenshotCaption": "Unusual Child Processes of RunDLL32 General Behavior alert caused by ipconfig.exe (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-2.png", "ScreenshotCaption": "Telemetry showing ipconfig.exe with command-line arguments (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-18.png", "ScreenshotCaption": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period"}, {"ScreenshotName": "EG-02-19.png", "ScreenshotCaption": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)"}], "Footnotes": ["This alert was configured after the start of the evaluation so is identified as a configuration change."]}, {"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert called Unusual Child Process of RunDLL32 was generated for cmd.exe executing ipconfig.exe with command-line arguments. The alert was tainted as part of the event tree under a parent Malicious File Detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-02-1.png", "ScreenshotCaption": "Unusual Child Processes of RunDLL32 General Behavior alert caused by ipconfig.exe (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-2.png", "ScreenshotCaption": "Telemetry showing ipconfig.exe with command-line arguments (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-18.png", "ScreenshotCaption": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period"}, {"ScreenshotName": "EG-02-19.png", "ScreenshotCaption": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the event tree showed cmd.exe executing ipconfig.exe with command-line arguments (tainted by a parent Malicious File Detection).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-02-1.png", "ScreenshotCaption": "Unusual Child Processes of RunDLL32 General Behavior alert caused by ipconfig.exe (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-2.png", "ScreenshotCaption": "Telemetry showing ipconfig.exe with command-line arguments (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-18.png", "ScreenshotCaption": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period"}, {"ScreenshotName": "EG-02-19.png", "ScreenshotCaption": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing ipconfig) which was identified as extremely rare and suspicious.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.A.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing ipconfig)"}, {"ScreenshotName": "CC-2.A.1-2.png", "ScreenshotCaption": "Enrichment of ipconfig.exe with a tag identifying the command as enumeration"}, {"ScreenshotName": "CC-2.A.1-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running ipconfig) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}], "Footnotes": []}, {"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (cmd.exe running ipconfig) has been tagged for monitoring because its parent process has a detection (rundll32.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.A.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing ipconfig)"}, {"ScreenshotName": "CC-2.A.1-2.png", "ScreenshotCaption": "Enrichment of ipconfig.exe with a tag identifying the command as enumeration"}, {"ScreenshotName": "CC-2.A.1-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running ipconfig) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched ipconfig.exe with a tag identifying the command as enumeration.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.A.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing ipconfig)"}, {"ScreenshotName": "CC-2.A.1-2.png", "ScreenshotCaption": "Enrichment of ipconfig.exe with a tag identifying the command as enumeration"}, {"ScreenshotName": "CC-2.A.1-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running ipconfig) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that ipconfig.exe was one of the reconnaissance commands performed to enumerate the network configuration of Nimda. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-2.A.1-1.png", "ScreenshotCaption": "Enrichment of ipconfig.exe with Ipconfig Execution alert (tagged with correct ATT&CK Technique, T1016 - System Network Configuration Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating ipconfig.exe was used to enumerate the network configuration of Nimda (Specific Behavior)"}, {"ScreenshotName": "FE-2.A.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about ipconfig.exe execution"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched ipconfig.exe with an alert for Ipconfig Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1016 - System Network Configuration Discovery) and Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-2.A.1-1.png", "ScreenshotCaption": "Enrichment of ipconfig.exe with Ipconfig Execution alert (tagged with correct ATT&CK Technique, T1016 - System Network Configuration Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating ipconfig.exe was used to enumerate the network configuration of Nimda (Specific Behavior)"}, {"ScreenshotName": "FE-2.A.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about ipconfig.exe execution"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability showed cmd.exe executing ipconfig.exe with command-line arguments and enriched the command with the condition Ipconfig All Reconnaissance Command. The enrichment was tainted by the parent Script File Created alert.[CT21]", "Modifiers": ["Configuration Change", "Tainted"], "Screenshots": [{"ScreenshotName": "CT-2.A.1-1.png", "ScreenshotCaption": "Enrichment of ipconfig.exe with condition Ipconfig All Reconnaissance Command (tainted by the parent Script File Created alert)"}], "Footnotes": ["The condition contributing to Enrichment was added to the capability's detection after the start of the evaluation, so this detection is identified as a configuration change. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched ipconfig.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) and a suspicious indicator that the ipconfig utility displayed configuration information.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-2.B.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing ipconfig.exe (tainted by a trace detection on Resume Viewer.exe)"}, {"ScreenshotName": "MC-2.A.1-23.png", "ScreenshotCaption": "Enrichment of ipconfig.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) and a suspicious indicator that the ipconfig utility displayed configuration information"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing ipconfig.exe with command-line arguments. The telemetry was tainted by a trace detection on Resume Viewer.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-2.B.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing ipconfig.exe (tainted by a trace detection on Resume Viewer.exe)"}, {"ScreenshotName": "MC-2.A.1-23.png", "ScreenshotCaption": "Enrichment of ipconfig.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) and a suspicious indicator that the ipconfig utility displayed configuration information"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A delayed General Behavior alert occurred due to a sequence of exploration commands that was classified as suspicious.", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "MS-2.A.1-1.png", "ScreenshotCaption": "Telemetry showing execution sequence for ipconfig.exe with command-line arguments"}, {"ScreenshotName": "MS-2.A.1-3.png", "ScreenshotCaption": "General Behavior alert on suspicious sequence of discovery techniques"}, {"ScreenshotName": "MS-2.A.1-4.png", "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of discovery techniques"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence of cmd.exe executing ipconfig.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-2.A.1-1.png", "ScreenshotCaption": "Telemetry showing execution sequence for ipconfig.exe with command-line arguments"}, {"ScreenshotName": "MS-2.A.1-3.png", "ScreenshotCaption": "General Behavior alert on suspicious sequence of discovery techniques"}, {"ScreenshotName": "MS-2.A.1-4.png", "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of discovery techniques"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for a commonly abused process (cmd.exe) spawning out of rundll32.exe. The alert was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-2.A.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing ipconfig with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.A.1-2.png", "ScreenshotCaption": "Enrichment of ipconfig.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)"}, {"ScreenshotName": "PA-2.A.1-3.png", "ScreenshotCaption": "Enrichment of the execution of ipconfig.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.A.1-4.png", "ScreenshotCaption": "General Behavior alert for a commonly abused process (cmd.exe) spawning out of rundll32.exe (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched ipconfig.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-2.A.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing ipconfig with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.A.1-2.png", "ScreenshotCaption": "Enrichment of ipconfig.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)"}, {"ScreenshotName": "PA-2.A.1-3.png", "ScreenshotCaption": "Enrichment of the execution of ipconfig.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.A.1-4.png", "ScreenshotCaption": "General Behavior alert for a commonly abused process (cmd.exe) spawning out of rundll32.exe (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the execution of ipconfig.exe as the execution of an enumeration command. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-2.A.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing ipconfig with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.A.1-2.png", "ScreenshotCaption": "Enrichment of ipconfig.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)"}, {"ScreenshotName": "PA-2.A.1-3.png", "ScreenshotCaption": "Enrichment of the execution of ipconfig.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.A.1-4.png", "ScreenshotCaption": "General Behavior alert for a commonly abused process (cmd.exe) spawning out of rundll32.exe (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing ipconfig with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-2.A.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing ipconfig with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.A.1-2.png", "ScreenshotCaption": "Enrichment of ipconfig.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)"}, {"ScreenshotName": "PA-2.A.1-3.png", "ScreenshotCaption": "Enrichment of the execution of ipconfig.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.A.1-4.png", "ScreenshotCaption": "General Behavior alert for a commonly abused process (cmd.exe) spawning out of rundll32.exe (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing ipconfig.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-02-1.png", "ScreenshotCaption": "Telemetry showing ipconfig.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing ipconfig.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-2.A.1-3.png", "ScreenshotCaption": "Telemetry showing ipconfig.exe with command-line arguments (tainted by relationship to threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "2.A.2", "Procedure": "Cobalt Strike: 'arp -a' via cmd", "Techniques": [{"TechniqueId": "T1016", "TechniqueName": "System Network Configuration Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched arp.exe with a related ATT&CK Technique (T1018 - Remote System Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-2.A.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing arp.exe with command-line arguments"}, {"ScreenshotName": "CB-2.A.2-2.png", "ScreenshotCaption": "Enrichment of arp.exe with related ATT&CK Technique (T1018 - Remote System Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed cmd.exe executing arp.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-2.A.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing arp.exe with command-line arguments"}, {"ScreenshotName": "CB-2.A.2-2.png", "ScreenshotCaption": "Enrichment of arp.exe with related ATT&CK Technique (T1018 - Remote System Discovery)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team sent an email indicating a General Behavior was observed because arp was one of the reconnaissance commands performed.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-2.A.2-1.png", "ScreenshotCaption": "Telemetry showing arp with command-line arguments"}, {"ScreenshotName": "CS-2.A.1-1.png", "ScreenshotCaption": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (arp not specifically shown)"}, {"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating arp was a reconnaissance command (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing arp with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran arp) were considered tainted.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-2.A.2-1.png", "ScreenshotCaption": "Telemetry showing arp with command-line arguments"}, {"ScreenshotName": "CS-2.A.1-1.png", "ScreenshotCaption": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (arp not specifically shown)"}, {"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating arp was a reconnaissance command (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed arp.exe executing with command-line arguments. The telemetry was tainted by a parent Injected Shellcode alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-2.A.2-5.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing arp with command-line arguments"}, {"ScreenshotName": "CR-2.B.1-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing arp with command-line arguments"}, {"ScreenshotName": "CR-2.A.2-10.png", "ScreenshotCaption": "Telemetry showing arp.exe executing within the process tree (tainted by a parent Injected Shellcode alert)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A delayed General Behavior alert triggered for a specified number of discovery techniques over a specified time period, which resulted in four Enumeration Command Sequence alerts for Step 2 (tainted by a parent Malicious File Detection).[EG8]", "Modifiers": ["Delayed", "Configuration Change", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-02-18.png", "ScreenshotCaption": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period"}, {"ScreenshotName": "EG-02-19.png", "ScreenshotCaption": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-3.png", "ScreenshotCaption": "Telemetry showing arp.exe with command-line arguments (tainted by parent Malicious File Detection)"}], "Footnotes": ["This alert was configured after the start of the evaluation so is identified as a configuration change."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the event tree showed cmd.exe executing arp.exe with command-line arguments (tainted by a parent Malicious File Detection).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-02-18.png", "ScreenshotCaption": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period"}, {"ScreenshotName": "EG-02-19.png", "ScreenshotCaption": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-3.png", "ScreenshotCaption": "Telemetry showing arp.exe with command-line arguments (tainted by parent Malicious File Detection)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (cmd.exe running arp) has been tagged for monitoring because its parent process has a detection (cmd.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.A.2-2.png", "ScreenshotCaption": "Enrichment of arp.exe indicating its usage can be a sign of reconnaissance"}, {"ScreenshotName": "CC-2.A.2-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running arp) has been tagged for monitoring because its parent process has a detection (cmd.exe)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched arp.exe indicating its usage can be a sign of reconnaissance.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.A.2-2.png", "ScreenshotCaption": "Enrichment of arp.exe indicating its usage can be a sign of reconnaissance"}, {"ScreenshotName": "CC-2.A.2-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running arp) has been tagged for monitoring because its parent process has a detection (cmd.exe)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that arp.exe was one of the reconnaissance commands performed to enumerate the network configuration of Nimda. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-2.A.1-2.png", "ScreenshotCaption": "Enrichment of arp.exe with Arp Execution alert (tagged with correct ATT&CK Technique, T1016 - System Network Configuration Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating arp.exe was used to enumerate the network configuration of Nimda (Specific Behavior)"}, {"ScreenshotName": "FE-2.A.1-5.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about arp.exe execution"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched arp.exe with an alert for Arp Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1016 - System Network Configuration Discovery) and Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-2.A.1-2.png", "ScreenshotCaption": "Enrichment of arp.exe with Arp Execution alert (tagged with correct ATT&CK Technique, T1016 - System Network Configuration Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating arp.exe was used to enumerate the network configuration of Nimda (Specific Behavior)"}, {"ScreenshotName": "FE-2.A.1-5.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about arp.exe execution"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing arp.exe with command-line arguments. The telemetry was tainted by the parent Script File Created alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-2.A.2-1.png", "ScreenshotCaption": "Telemetry showing arp.exe with command-line arguments (tainted by the parent Script File Created alert)"}], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the arp.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) and a suspicious indicator that the contents of the local ARP cache table was viewed.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-2.B.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing arp.exe (tainted by a trace detection on Resume Viewer.exe)"}, {"ScreenshotName": "MC-2.A.1-23.png", "ScreenshotCaption": "Enrichment of arp.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) and a suspicious indicator that the contents of the local ARP cache table was viewed"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing arp.exe with command-line arguments. The telemetry was tainted by a trace detection on Resume Viewer.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-2.B.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing arp.exe (tainted by a trace detection on Resume Viewer.exe)"}, {"ScreenshotName": "MC-2.A.1-23.png", "ScreenshotCaption": "Enrichment of arp.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) and a suspicious indicator that the contents of the local ARP cache table was viewed"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A delayed General Behavior alert occurred due to a sequence of exploration activities that was classified as suspicious.", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "MS-2.A.1-2.png", "ScreenshotCaption": "Telemetry showing execution sequence for arp.exe with command-line arguments"}, {"ScreenshotName": "MS-2.A.1-3.png", "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"}, {"ScreenshotName": "MS-2.A.1-6.png", "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing arp.exe"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence of cmd.exe executing arp.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-2.A.1-2.png", "ScreenshotCaption": "Telemetry showing execution sequence for arp.exe with command-line arguments"}, {"ScreenshotName": "MS-2.A.1-3.png", "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"}, {"ScreenshotName": "MS-2.A.1-6.png", "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing arp.exe"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched arp.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-2.A.2-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing arp with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.A.2-2.png", "ScreenshotCaption": "Enrichment of arp.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)"}, {"ScreenshotName": "PA-2.A.2-3.png", "ScreenshotCaption": "Enrichment the execution of arp.exe as possible reconnaissance (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.A.2-4.png", "ScreenshotCaption": "Enrichment of the execution of arp.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the execution of arp.exe as possible reconnaissance as well as the execution of an enumeration command. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-2.A.2-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing arp with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.A.2-2.png", "ScreenshotCaption": "Enrichment of arp.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)"}, {"ScreenshotName": "PA-2.A.2-3.png", "ScreenshotCaption": "Enrichment the execution of arp.exe as possible reconnaissance (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.A.2-4.png", "ScreenshotCaption": "Enrichment of the execution of arp.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing arp with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-2.A.2-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing arp with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.A.2-2.png", "ScreenshotCaption": "Enrichment of arp.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)"}, {"ScreenshotName": "PA-2.A.2-3.png", "ScreenshotCaption": "Enrichment the execution of arp.exe as possible reconnaissance (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.A.2-4.png", "ScreenshotCaption": "Enrichment of the execution of arp.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing arp.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-02-1.png", "ScreenshotCaption": "Telemetry showing arp.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing arp.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-2.A.2-1.png", "ScreenshotCaption": "Telemetry showing arp.exe with command-line arguments (tainted by relationship to threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "2.B.1", "Procedure": "Cobalt Strike: 'echo' via cmd to enumerate specific environment variables", "Techniques": [{"TechniqueId": "T1033", "TechniqueName": "System Owner/User Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed cmd.exe executing echo with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-2.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing echo with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team sent an email indicating a General Behavior was observed because echo was one of the reconnaissance commands performed.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-2.B.1-1.png", "ScreenshotCaption": "Telemetry showing echo with command-line arguments"}, {"ScreenshotName": "CS-2.A.1-1.png", "ScreenshotCaption": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (echo not specifically shown)"}, {"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating echo was a reconnaissance command (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing echo with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran echo) were considered tainted.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-2.B.1-1.png", "ScreenshotCaption": "Telemetry showing echo with command-line arguments"}, {"ScreenshotName": "CS-2.A.1-1.png", "ScreenshotCaption": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (echo not specifically shown)"}, {"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating echo was a reconnaissance command (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing echo with command-line arguments. The telemetry was tainted by a parent Injected Shellcode alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-2.B.1-100.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing echo with command-line arguments (tainted by a parent Injected Shellcode alert)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A delayed General Behavior alert triggered for a specified number of discovery techniques over a specified time period, which resulted in four Enumeration Command Sequence alerts for Step 2 (tainted by a parent Malicious File Detection).[EG8]", "Modifiers": ["Delayed", "Configuration Change", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-02-18.png", "ScreenshotCaption": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period"}, {"ScreenshotName": "EG-02-19.png", "ScreenshotCaption": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-4.png", "ScreenshotCaption": "Telemetry showing echo with command-line arguments (tainted by parent Malicious File Detection)"}], "Footnotes": ["This alert was configured after the start of the evaluation so is identified as a configuration change."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the event tree showed cmd.exe executing echo with command-line arguments (tainted by a parent Malicious File Detection).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-02-18.png", "ScreenshotCaption": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period"}, {"ScreenshotName": "EG-02-19.png", "ScreenshotCaption": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-4.png", "ScreenshotCaption": "Telemetry showing echo with command-line arguments (tainted by parent Malicious File Detection)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing the echo command) which was identified as extremely rare and suspicious.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.B.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing the echo command)"}, {"ScreenshotName": "CC-2.B.1-2.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing the echo command"}, {"ScreenshotName": "CC-2.B.1-99.png", "ScreenshotCaption": "A General Behavior alert showing that a spawned process (cmd.exe running echo) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}], "Footnotes": []}, {"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (cmd.exe running echo) has been tagged for monitoring because its parent process has a detection (rundll32.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.B.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing the echo command)"}, {"ScreenshotName": "CC-2.B.1-2.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing the echo command"}, {"ScreenshotName": "CC-2.B.1-99.png", "ScreenshotCaption": "A General Behavior alert showing that a spawned process (cmd.exe running echo) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing the echo command.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.B.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing the echo command)"}, {"ScreenshotName": "CC-2.B.1-2.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing the echo command"}, {"ScreenshotName": "CC-2.B.1-99.png", "ScreenshotCaption": "A General Behavior alert showing that a spawned process (cmd.exe running echo) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that echo was one of the commands used to enumerate the current username. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-2.B.1-1.png", "ScreenshotCaption": "Telemetry showing echo with command-line arguments"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating echo was used to enumerate the current username (Specific Behavior)"}, {"ScreenshotName": "FE-2.B.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about echo"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the use of echo with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-2.B.1-1.png", "ScreenshotCaption": "Telemetry showing echo with command-line arguments"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating echo was used to enumerate the current username (Specific Behavior)"}, {"ScreenshotName": "FE-2.B.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about echo"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing echo with command-line arguments. The telemetry was tainted by the parent Script File Created alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-2.B.1-1.png", "ScreenshotCaption": "Telemetry showing echo with command-line arguments (tainted by the parent Script File Created alert)"}], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the cmd.exe echo command with the correct ATT&CK Tactic (Discovery) and Technique (System Owner/User Discovery) and a suspicious indicator that the command tried to identify the user on the system.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-2.A.1-3.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing the echo command"}, {"ScreenshotName": "MC-2.B.1-1.png", "ScreenshotCaption": "Process tree within trace detection containing cmd.exe executing the echo command (tainted by a parent alert on Resume Viewer.exe)"}, {"ScreenshotName": "MC-2.A.1-23.png", "ScreenshotCaption": "Enrichment of echo command with a correct ATT&CK Tactic (Discovery) and Technique (System Owner/User Discovery) and a suspicious indicator that the command tried to identify the user on the system"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing the echo command. The telemetry was tainted by a trace detection on Resume Viewer.exe.[MC2]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-2.A.1-3.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing the echo command"}, {"ScreenshotName": "MC-2.B.1-1.png", "ScreenshotCaption": "Process tree within trace detection containing cmd.exe executing the echo command (tainted by a parent alert on Resume Viewer.exe)"}, {"ScreenshotName": "MC-2.A.1-23.png", "ScreenshotCaption": "Enrichment of echo command with a correct ATT&CK Tactic (Discovery) and Technique (System Owner/User Discovery) and a suspicious indicator that the command tried to identify the user on the system"}], "Footnotes": ["Though not visible in the image, MITRE confirmed that the relevant command was visible within the trace detection's process tree."]}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence of cmd.exe executing echo with command-line arguments (tainted by the alert on suspicious sequence of exploration activities from child processes of rundll32.exe).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-2.B.1-1.png", "ScreenshotCaption": "Telemetry showing execution sequence for echo with command-line arguments"}, {"ScreenshotName": "MS-2.A.1-5.png", "ScreenshotCaption": "Process tree view of suspicious sequence of exploration activities alert with tainted rundll32.exe child processes showing echo command"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched cmd.exe executing echo with the correct ATT&CK Technique (System Owner / User Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-2.B.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing echo with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.B.1-2.png", "ScreenshotCaption": "Enrichment of cmd.exe executing echo with the correct ATT&CK Technique (System Owner / User Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing echo with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-2.B.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing echo with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.B.1-2.png", "ScreenshotCaption": "Enrichment of cmd.exe executing echo with the correct ATT&CK Technique (System Owner / User Discovery)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing echo with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-02-1.png", "ScreenshotCaption": "Telemetry showing echo with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing echo with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-2.A.1-4.png", "ScreenshotCaption": "Telemetry showing echo with command-line arguments (tainted by relationship to threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "2.C.1", "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "Techniques": [{"TechniqueId": "T1057", "TechniqueName": "Process Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the execution of a specific API call as process enumeration and suspicious activity. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.[PA7]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-2.C.1-1.png", "ScreenshotCaption": "Enrichment of the execution of a specific API call as process enumeration and suspicious activity (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}], "Footnotes": ["The process tree showing taintedness is visible within the same UI but did not fit within the current frame."]}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}]}, {"Substep": "2.C.2 ", "Procedure": "Cobalt Strike: 'tasklist -v' via cmd", "Techniques": [{"TechniqueId": "T1057", "TechniqueName": "Process Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched tasklist.exe with the correct ATT&CK Technique (T1057 - Process Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-2.C.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing tasklist.exe with command-line arguments"}, {"ScreenshotName": "CB-2.C.2-2.png", "ScreenshotCaption": "Enrichment of tasklist.exe with correct ATT&CK Technique (T1057 - Process Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed cmd.exe executing tasklist.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-2.C.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing tasklist.exe with command-line arguments"}, {"ScreenshotName": "CB-2.C.2-2.png", "ScreenshotCaption": "Enrichment of tasklist.exe with correct ATT&CK Technique (T1057 - Process Discovery)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team sent an email indicating a General Behavior was observed because tasklist was one of the reconnaissance commands performed.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-2.B.1-1.png", "ScreenshotCaption": "Telemetry showing tasklist with command-line arguments"}, {"ScreenshotName": "CS-2.A.1-1.png", "ScreenshotCaption": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (tasklist not specifically shown)"}, {"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating tasklist was a reconnaissance command (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing tasklist with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran tasklist) were considered tainted.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-2.B.1-1.png", "ScreenshotCaption": "Telemetry showing tasklist with command-line arguments"}, {"ScreenshotName": "CS-2.A.1-1.png", "ScreenshotCaption": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (tasklist not specifically shown)"}, {"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating tasklist was a reconnaissance command (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing tasklist with command-line arguments. The telemetry was tainted by a parent Injected Shellcode alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-2.C.2-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing tasklist with command-line arguments"}, {"ScreenshotName": "CR-2.A.2-10.png", "ScreenshotCaption": "Telemetry showing tasklist.exe executing within the process tree (tainted by a parent Injected Shellcode alert)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A delayed General Behavior alert triggered for a specified number of discovery techniques over a specified time period, which resulted in four Enumeration Command Sequence alerts for Step 2 (tainted by a parent Malicious File Detection).[EG8]", "Modifiers": ["Delayed", "Configuration Change", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-02-18.png", "ScreenshotCaption": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period"}, {"ScreenshotName": "EG-02-19.png", "ScreenshotCaption": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-5.png", "ScreenshotCaption": "Telemetry showing tasklist.exe with command-line arguments (tainted by parent Malicious File Detection)"}], "Footnotes": ["This alert was configured after the start of the evaluation so is identified as a configuration change."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the event tree showed cmd.exe executing tasklist.exe with command-line arguments (tainted by a parent Malicious File Detection).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-02-18.png", "ScreenshotCaption": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period"}, {"ScreenshotName": "EG-02-19.png", "ScreenshotCaption": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-5.png", "ScreenshotCaption": "Telemetry showing tasklist.exe with command-line arguments (tainted by parent Malicious File Detection)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing tasklist) which was identified as extremely rare and suspicious.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.D.2-2.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing tasklist)"}, {"ScreenshotName": "CC-2.C.2-2.png", "ScreenshotCaption": "Telemetry showing tasklist.exe with command-line arguments"}, {"ScreenshotName": "CC-2.D.2-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running tasklist) has been tagged for monitoring because its parent process has a detection (cmd.exe)"}], "Footnotes": []}, {"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (cmd.exe running tasklist) has been tagged for monitoring because its parent process has a detection (cmd.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.D.2-2.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing tasklist)"}, {"ScreenshotName": "CC-2.C.2-2.png", "ScreenshotCaption": "Telemetry showing tasklist.exe with command-line arguments"}, {"ScreenshotName": "CC-2.D.2-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running tasklist) has been tagged for monitoring because its parent process has a detection (cmd.exe)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing tasklist.exe along with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.D.2-2.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing tasklist)"}, {"ScreenshotName": "CC-2.C.2-2.png", "ScreenshotCaption": "Telemetry showing tasklist.exe with command-line arguments"}, {"ScreenshotName": "CC-2.D.2-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running tasklist) has been tagged for monitoring because its parent process has a detection (cmd.exe)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that tasklist was one of the commands used to enumerate current running processes. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-2.C.2-1.png", "ScreenshotCaption": "Enrichment of tasklist.exe with Tasklist Execution alert (tagged with correct ATT&CK Technique, T1057 - Process Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating tasklist was used to enumerate current running processes (Specific Behavior)"}, {"ScreenshotName": "FE-2.C.2-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about tasklist"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched tasklist.exe with an alert for Tasklist Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1057 - Process Discovery) and Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-2.C.2-1.png", "ScreenshotCaption": "Enrichment of tasklist.exe with Tasklist Execution alert (tagged with correct ATT&CK Technique, T1057 - Process Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating tasklist was used to enumerate current running processes (Specific Behavior)"}, {"ScreenshotName": "FE-2.C.2-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about tasklist"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing tasklist.exe with command-line arguments. The telemetry was tainted by the parent Script File Created alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-2.C.2-1.png", "ScreenshotCaption": "Telemetry showing tasklist.exe with command-line arguments (tainted by the parent Script File Created alert)"}], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched tasklist.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (System Service Discovery) and a suspicious indicator that the process discovered running Windows services and/or processes.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-2.B.1-1.png", "ScreenshotCaption": "Process tree within trace detection containing cmd.exe executing tasklist.exe (tainted by a parent alert on Resume Viewer.exe)"}, {"ScreenshotName": "MC-2.A.1-23.png", "ScreenshotCaption": "Enrichment of tasklist.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (System Service Discovery) and a suspicious indicator that the process discovered running Windows services and/or processes"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing tasklist.exe with command-line arguments. The telemetry was tainted by a trace detection on Resume Viewer.exe.[MC2]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-2.B.1-1.png", "ScreenshotCaption": "Process tree within trace detection containing cmd.exe executing tasklist.exe (tainted by a parent alert on Resume Viewer.exe)"}, {"ScreenshotName": "MC-2.A.1-23.png", "ScreenshotCaption": "Enrichment of tasklist.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (System Service Discovery) and a suspicious indicator that the process discovered running Windows services and/or processes"}], "Footnotes": ["Though not visible in the image, MITRE confirmed that the relevant command was visible within the trace detection's process tree."]}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A delayed General Behavior alert occurred due to a sequence of exploration activities that was classified as suspicious.", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "MS-2.A.1-3.png", "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"}, {"ScreenshotName": "MS-2.C.2-1.png", "ScreenshotCaption": "Telemetry showing execution sequence for tasklist.exe with command-line arguments"}, {"ScreenshotName": "MS-2.A.1-4.png", "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing tasklist.exe"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence of cmd.exe executing tasklist.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-2.A.1-3.png", "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"}, {"ScreenshotName": "MS-2.C.2-1.png", "ScreenshotCaption": "Telemetry showing execution sequence for tasklist.exe with command-line arguments"}, {"ScreenshotName": "MS-2.A.1-4.png", "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing tasklist.exe"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched tasklist.exe executing with a related ATT&CK Technique (System Information Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-2.C.2-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing tasklist with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.C.2-2.png", "ScreenshotCaption": "Enrichment of tasklist.exe executing with a related ATT&CK Technique (System Information Discovery)"}, {"ScreenshotName": "PA-2.C.2-3.png", "ScreenshotCaption": "Enrichment of the execution of tasklist.exe as the enumeration of running processes via the command line (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the execution of tasklist.exe as the enumeration of running processes via the command line. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-2.C.2-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing tasklist with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.C.2-2.png", "ScreenshotCaption": "Enrichment of tasklist.exe executing with a related ATT&CK Technique (System Information Discovery)"}, {"ScreenshotName": "PA-2.C.2-3.png", "ScreenshotCaption": "Enrichment of the execution of tasklist.exe as the enumeration of running processes via the command line (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing tasklist with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-2.C.2-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing tasklist with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.C.2-2.png", "ScreenshotCaption": "Enrichment of tasklist.exe executing with a related ATT&CK Technique (System Information Discovery)"}, {"ScreenshotName": "PA-2.C.2-3.png", "ScreenshotCaption": "Enrichment of the execution of tasklist.exe as the enumeration of running processes via the command line (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing tasklist.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-02-1.png", "ScreenshotCaption": "Telemetry showing tasklist.exe with command-line arguments"}, {"ScreenshotName": "RSA-02-2.png", "ScreenshotCaption": "Additional telemetry showing tasklist.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing tasklist.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-2.A.1-5.png", "ScreenshotCaption": "Telemetry showing tasklist.exe with command-line arguments (tainted by relationship to threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "2.D.1", "Procedure": "Cobalt Strike: 'sc query' via cmd", "Techniques": [{"TechniqueId": "T1007", "TechniqueName": "System Service Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched sc.exe with the correct ATT&CK Technique (System Service Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-2.A-ALL.png", "ScreenshotCaption": "Telemetry from process tree showing sc.exe with command-line arguments"}, {"ScreenshotName": "CB-2.D.1-1.png", "ScreenshotCaption": "Enrichment of sc.exe with correct ATT&CK Technique (System Service Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed cmd.exe executing sc.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-2.A-ALL.png", "ScreenshotCaption": "Telemetry from process tree showing sc.exe with command-line arguments"}, {"ScreenshotName": "CB-2.D.1-1.png", "ScreenshotCaption": "Enrichment of sc.exe with correct ATT&CK Technique (System Service Discovery)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team sent an email indicating a General Behavior was observed because sc query was one of the reconnaissance commands performed.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-2.B.1-1.png", "ScreenshotCaption": "Telemetry showing sc with command-line arguments"}, {"ScreenshotName": "CS-2.A.1-1.png", "ScreenshotCaption": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (sc query not specifically shown)"}, {"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating sc query was a reconnaissance command (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing sc with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran sc) were considered tainted.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-2.B.1-1.png", "ScreenshotCaption": "Telemetry showing sc with command-line arguments"}, {"ScreenshotName": "CS-2.A.1-1.png", "ScreenshotCaption": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (sc query not specifically shown)"}, {"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating sc query was a reconnaissance command (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched cmd.exe executing sc.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery). The data was tainted by a parent Injected Shellcode alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-2.D.1-10.png", "ScreenshotCaption": "Enrichment of sc.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-2.B.1-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing sc with command-line arguments"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing sc with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-2.D.1-10.png", "ScreenshotCaption": "Enrichment of sc.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-2.B.1-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing sc with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A delayed General Behavior alert triggered for a specified number of discovery techniques over a specified time period, which resulted in four Enumeration Command Sequence alerts for Step 2 (tainted by a parent Malicious File Detection).[EG8]", "Modifiers": ["Delayed", "Configuration Change", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-02-18.png", "ScreenshotCaption": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period"}, {"ScreenshotName": "EG-02-19.png", "ScreenshotCaption": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-6.png", "ScreenshotCaption": "Telemetry showing sc.exe with command-line arguments (tainted by parent Malicious File Detection)"}], "Footnotes": ["This alert was configured after the start of the evaluation so is identified as a configuration change."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the event tree showed cmd.exe executing sc.exe with command-line arguments (tainted by a parent Malicious File Detection).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-02-18.png", "ScreenshotCaption": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period"}, {"ScreenshotName": "EG-02-19.png", "ScreenshotCaption": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-6.png", "ScreenshotCaption": "Telemetry showing sc.exe with command-line arguments (tainted by parent Malicious File Detection)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (cmd.exe running sc) has been tagged for monitoring because its parent process has a detection (rundll32.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.D.2-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running sc) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing sc with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.D.2-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running sc) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that sc was one of the commands used to enumerate current running services. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-2.D.1-1.png", "ScreenshotCaption": "Enrichment of sc.exe with SC Execution alert (tagged with correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.D.1-2.png", "ScreenshotCaption": "Additional details from enrichment of sc.exe"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating sc was used to enumerate current running services (Specific Behavior)"}, {"ScreenshotName": "FE-2.D.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about sc"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched sc.exe with an alert for SC Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-2.D.1-1.png", "ScreenshotCaption": "Enrichment of sc.exe with SC Execution alert (tagged with correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.D.1-2.png", "ScreenshotCaption": "Additional details from enrichment of sc.exe"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating sc was used to enumerate current running services (Specific Behavior)"}, {"ScreenshotName": "FE-2.D.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about sc"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability showed cmd.exe executing sc.exe with command-line arguments and enriched the command with the condition SC Query Reconnaissance Command. The enrichment was tainted by the parent Script File Created alert.[CT21]", "Modifiers": ["Configuration Change", "Tainted"], "Screenshots": [{"ScreenshotName": "CT-2.D.1-1.png", "ScreenshotCaption": "Enrichment of sc.exe with condition SC Query Reconnaissance Command (tainted by the parent Script File Created alert)"}], "Footnotes": ["The condition contributing to Enrichment was added to the capability's detection after the start of the evaluation, so this detection is identified as a configuration change. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched sc.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that a Windows service was manipulated via sc.exe/net.exe tool.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-2.B.1-1.png", "ScreenshotCaption": "Process tree within trace detection containing cmd.exe executing the sc.exe (tainted by a parent alert on Resume Viewer.exe)"}, {"ScreenshotName": "MC-2.A.1-23.png", "ScreenshotCaption": "Enrichment of sc.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that a Windows service was manipulated via sc.exe/net.exe tool"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing sc.exe with command-line arguments. The telemetry was tainted by a trace detection on Resume Viewer.exe.[MC2]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-2.B.1-1.png", "ScreenshotCaption": "Process tree within trace detection containing cmd.exe executing the sc.exe (tainted by a parent alert on Resume Viewer.exe)"}, {"ScreenshotName": "MC-2.A.1-23.png", "ScreenshotCaption": "Enrichment of sc.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that a Windows service was manipulated via sc.exe/net.exe tool"}], "Footnotes": ["Though not visible in the image, MITRE confirmed that the relevant command was visible within the trace detection's process tree."]}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A delayed General Behavior alert occurred due to a sequence of exploration activities that was classified as suspicious.", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "MS-2.A.1-3.png", "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"}, {"ScreenshotName": "MS-2.D.1-1.png", "ScreenshotCaption": "Telemetry showing execution sequence for sc.exe with command-line arguments"}, {"ScreenshotName": "MS-2.A.1-4.png", "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing sc.exe"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence of cmd.exe executing sc.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-2.A.1-3.png", "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"}, {"ScreenshotName": "MS-2.D.1-1.png", "ScreenshotCaption": "Telemetry showing execution sequence for sc.exe with command-line arguments"}, {"ScreenshotName": "MS-2.A.1-4.png", "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing sc.exe"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing sc with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-2.D.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing sc with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing sc.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-02-2.png", "ScreenshotCaption": "Telemetry showing sc.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing sc.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-2.A.1-6.png", "ScreenshotCaption": "Telemetry showing sc.exe with command-line arguments (tainted by relationship to threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "2.D.2", "Procedure": "Cobalt Strike: 'net start' via cmd", "Techniques": [{"TechniqueId": "T1007", "TechniqueName": "System Service Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with the correct ATT&CK Technique (System Service Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-2.D.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-2.D.2-2.png", "ScreenshotCaption": "Enrichment of net.exe with correct ATT&CK Technique (System Service Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed cmd.exe executing net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-2.D.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-2.D.2-2.png", "ScreenshotCaption": "Enrichment of net.exe with correct ATT&CK Technique (System Service Discovery)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran net) were considered tainted.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-2.D.2-1.png", "ScreenshotCaption": "Telemetry showing net with command-line arguments"}, {"ScreenshotName": "CS-2.A.1-1.png", "ScreenshotCaption": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net start not specifically shown)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched cmd.exe executing net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery). The data was tainted by a parent Injected Shellcode alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-2.D.2-10.png", "ScreenshotCaption": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-2.B.1-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net with command-line arguments"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-2.D.2-10.png", "ScreenshotCaption": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-2.B.1-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A delayed General Behavior alert triggered for a specified number of discovery techniques over a specified time period, which resulted in four Enumeration Command Sequence alerts for Step 2 (tainted by a parent Malicious File Detection).[EG8]", "Modifiers": ["Delayed", "Configuration Change", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-02-18.png", "ScreenshotCaption": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period"}, {"ScreenshotName": "EG-02-19.png", "ScreenshotCaption": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-7.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)"}], "Footnotes": ["This alert was configured after the start of the evaluation so is identified as a configuration change."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the event tree showed cmd.exe executing net.exe with command-line arguments (tainted by a parent Malicious File Detection).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-02-18.png", "ScreenshotCaption": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period"}, {"ScreenshotName": "EG-02-19.png", "ScreenshotCaption": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-7.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing the net) which was identified as extremely rare and suspicious.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.D.2-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing net)"}, {"ScreenshotName": "CC-2.D.2-3.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-2.D.2-98.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}], "Footnotes": []}, {"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.D.2-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing net)"}, {"ScreenshotName": "CC-2.D.2-3.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-2.D.2-98.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.D.2-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing net)"}, {"ScreenshotName": "CC-2.D.2-3.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-2.D.2-98.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that net was one of the commands used to enumerate current running services. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-2.D.2-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Start Command Execution alert (tagged with correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net was used to enumerate current running services (Specific Behavior)"}, {"ScreenshotName": "FE-2.D.2-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about net"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with an alert for Net Start Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-2.D.2-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Start Command Execution alert (tagged with correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net was used to enumerate current running services (Specific Behavior)"}, {"ScreenshotName": "FE-2.D.2-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about net"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by the parent Script File Created alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-2.D.2-1.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by the parent Script File Created alert)"}], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Windows service was manipulated via sc.exe/net.exe tool.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-2.B.1-4.png", "ScreenshotCaption": "Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)"}, {"ScreenshotName": "MC-2.B.1-5.png", "ScreenshotCaption": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Windows service was manipulated via sc.exe/net.exe tool"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by a trace detection on Resume Viewer.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-2.B.1-4.png", "ScreenshotCaption": "Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)"}, {"ScreenshotName": "MC-2.B.1-5.png", "ScreenshotCaption": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Windows service was manipulated via sc.exe/net.exe tool"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence of cmd.exe executing net.exe with command-line arguments (tainted by the alert on suspicious sequence of exploration activities from child processes of rundll32.exe).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-2.D.2-1.png", "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"}, {"ScreenshotName": "MS-2.D.2-2.png", "ScreenshotCaption": "Process tree view of suspicious sequence of exploration activities alert with tainted rundll32.exe child processes showing net.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the execution of net.exe as the execution of an enumeration command. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-2.D.2-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.D.2-3.png", "ScreenshotCaption": "Enrichment of the execution of net.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-2.D.2-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.D.2-3.png", "ScreenshotCaption": "Enrichment of the execution of net.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-02-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-2.A.1-7.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "2.E.1", "Procedure": "Cobalt Strike: 'systeminfo' via cmd", "Techniques": [{"TechniqueId": "T1082", "TechniqueName": "System Information Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched systeminfo.exe with the correct ATT&CK Technique (System Information Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-2.E.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing systeminfo.exe"}, {"ScreenshotName": "CB-2.E.1-2.png", "ScreenshotCaption": "Enrichment of systeminfo.exe with correct ATT&CK Technique (System Information Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed cmd.exe executing systeminfo.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-2.E.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing systeminfo.exe"}, {"ScreenshotName": "CB-2.E.1-2.png", "ScreenshotCaption": "Enrichment of systeminfo.exe with correct ATT&CK Technique (System Information Discovery)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "OverWatch also generated a General Behavior alert indicating systeminfo execution was suspicious.[CS1]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-2.D.2-1.png", "ScreenshotCaption": "Telemetry showing systeminfo"}, {"ScreenshotName": "CS-2.A.1-1.png", "ScreenshotCaption": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (systeminfo not specifically shown)"}, {"ScreenshotName": "CS-2.E.1-1.png", "ScreenshotCaption": "OverWatch General Behavior alert indicating systeminfo.exe was suspicious"}, {"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating systeminfo was a reconnaissance command (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team also sent an email indicating a General Behavior was observed because systeminfo was one of the reconnaissance commands performed.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-2.D.2-1.png", "ScreenshotCaption": "Telemetry showing systeminfo"}, {"ScreenshotName": "CS-2.A.1-1.png", "ScreenshotCaption": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (systeminfo not specifically shown)"}, {"ScreenshotName": "CS-2.E.1-1.png", "ScreenshotCaption": "OverWatch General Behavior alert indicating systeminfo.exe was suspicious"}, {"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating systeminfo was a reconnaissance command (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing systeminfo. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran systeminfo) were considered tainted.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-2.D.2-1.png", "ScreenshotCaption": "Telemetry showing systeminfo"}, {"ScreenshotName": "CS-2.A.1-1.png", "ScreenshotCaption": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (systeminfo not specifically shown)"}, {"ScreenshotName": "CS-2.E.1-1.png", "ScreenshotCaption": "OverWatch General Behavior alert indicating systeminfo.exe was suspicious"}, {"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating systeminfo was a reconnaissance command (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched systeminfo.exe executing with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery). The data was tainted by a parent Injected Shellcode alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-2.E.1-11.png", "ScreenshotCaption": "Enrichment of systeminfo.exe executing with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery) (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-2.B.1-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing systeminfo"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing systeminfo with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-2.E.1-11.png", "ScreenshotCaption": "Enrichment of systeminfo.exe executing with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery) (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-2.B.1-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing systeminfo"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A delayed General Behavior alert triggered for a specified number of discovery techniques over a specified time period, which resulted in four Enumeration Command Sequence alerts for Step 2 (tainted by a parent Malicious File Detection).[EG8]", "Modifiers": ["Delayed", "Configuration Change", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-02-18.png", "ScreenshotCaption": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period"}, {"ScreenshotName": "EG-02-19.png", "ScreenshotCaption": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-8.png", "ScreenshotCaption": "Telemetry showing systeminfo.exe (tainted by parent Malicious File Detection)"}], "Footnotes": ["This alert was configured after the start of the evaluation so is identified as a configuration change."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the event tree showed cmd.exe executing systeminfo.exe (tainted by a parent Malicious File Detection).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-02-18.png", "ScreenshotCaption": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period"}, {"ScreenshotName": "EG-02-19.png", "ScreenshotCaption": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-8.png", "ScreenshotCaption": "Telemetry showing systeminfo.exe (tainted by parent Malicious File Detection)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (cmd.exe running systeminfo) has been tagged for monitoring because its parent process has a detection (rundll32.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.E.1-1.png", "ScreenshotCaption": "Enrichment of systeminfo.exe indicating it could be used for reconnaissance."}, {"ScreenshotName": "CC-2.B.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running systeminfo) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched systeminfo.exe indicating it could be used for reconnaissance.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.E.1-1.png", "ScreenshotCaption": "Enrichment of systeminfo.exe indicating it could be used for reconnaissance."}, {"ScreenshotName": "CC-2.B.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running systeminfo) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified systeminfo as a reconnaissance command used to obtain details from the system.[FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-2.E.1-1.png", "ScreenshotCaption": "Enrichment of systeminfo.exe with Systeminfo Execution alert (tagged with correct ATT&CK Technique, T1082 - System Information Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating systeminfo was a reconnaissance used to obtain system details (Specific Behavior)"}, {"ScreenshotName": "FE-2.E.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about systeminfo"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched systeminfo.exe with an alert for Systeminfo Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1082 - System Information Discovery) and Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-2.E.1-1.png", "ScreenshotCaption": "Enrichment of systeminfo.exe with Systeminfo Execution alert (tagged with correct ATT&CK Technique, T1082 - System Information Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating systeminfo was a reconnaissance used to obtain system details (Specific Behavior)"}, {"ScreenshotName": "FE-2.E.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about systeminfo"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing systeminfo.exe with command-line arguments. The telemetry was tainted by the parent Script File Created alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-2.E.1-1.png", "ScreenshotCaption": "Telemetry showing systeminfo.exe (tainted by the parent Script File Created alert)"}], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched systeminfo.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery) and a suspicious indicator that system configuration info was queried.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-2.B.1-1.png", "ScreenshotCaption": "Process tree within trace detection containing cmd.exe executing the systeminfo.exe (tainted by a parent alert on Resume Viewer.exe)"}, {"ScreenshotName": "MC-2.B.1-5.png", "ScreenshotCaption": "Enrichment of systeminfo.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery) and a suspicious indicator that system configuration info was queried"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing systeminfo.exe with command-line arguments. The telemetry was tainted by a trace detection on Resume Viewer.exe.[MC2]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-2.B.1-1.png", "ScreenshotCaption": "Process tree within trace detection containing cmd.exe executing the systeminfo.exe (tainted by a parent alert on Resume Viewer.exe)"}, {"ScreenshotName": "MC-2.B.1-5.png", "ScreenshotCaption": "Enrichment of systeminfo.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery) and a suspicious indicator that system configuration info was queried"}], "Footnotes": ["Though not visible in the image, MITRE confirmed that the relevant command was visible within the trace detection's process tree."]}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A delayed General Behavior alert occurred due to a sequence of exploration activities that was classified as suspicious.", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "MS-2.A.1-3.png", "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"}, {"ScreenshotName": "MS-2.E.1-1.png", "ScreenshotCaption": "Telemetry showing execution sequence for systeminfo.exe"}, {"ScreenshotName": "MS-2.A.1-4.png", "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing systeminfo.exe"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence of cmd.exe running systeminfo.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-2.A.1-3.png", "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"}, {"ScreenshotName": "MS-2.E.1-1.png", "ScreenshotCaption": "Telemetry showing execution sequence for systeminfo.exe"}, {"ScreenshotName": "MS-2.A.1-4.png", "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing systeminfo.exe"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched cmd.exe executing systeminfo with the correct ATT&CK Technique (System Information Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-2.E.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing systeminfo with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.E.1-2.png", "ScreenshotCaption": "Enrichment of cmd.exe executing systeminfo with the correct ATT&CK Technique (System Information Discovery)"}, {"ScreenshotName": "PA-2.E.1-3.png", "ScreenshotCaption": "Enrichment of the execution of systeminfo.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the execution of systeminfo.exe as the execution of an enumeration command. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-2.E.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing systeminfo with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.E.1-2.png", "ScreenshotCaption": "Enrichment of cmd.exe executing systeminfo with the correct ATT&CK Technique (System Information Discovery)"}, {"ScreenshotName": "PA-2.E.1-3.png", "ScreenshotCaption": "Enrichment of the execution of systeminfo.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing systeminfo with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-2.E.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing systeminfo with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.E.1-2.png", "ScreenshotCaption": "Enrichment of cmd.exe executing systeminfo with the correct ATT&CK Technique (System Information Discovery)"}, {"ScreenshotName": "PA-2.E.1-3.png", "ScreenshotCaption": "Enrichment of the execution of systeminfo.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing systeminfo.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-02-3.png", "ScreenshotCaption": "Telemetry showing systeminfo.exe"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-2.A.1-8.png", "ScreenshotCaption": "Telemetry showing systeminfo.exe (tainted by relationship to threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "2.E.2", "Procedure": "Cobalt Strike: 'net config workstation' via cmd", "Techniques": [{"TechniqueId": "T1082", "TechniqueName": "System Information Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with the correct ATT&CK Technique (System Information Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-2.E.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-2.E.2-2.png", "ScreenshotCaption": "Enrichment of net.exe with correct ATT&CK Technique (System Information Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed cmd.exe executing net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-2.E.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-2.E.2-2.png", "ScreenshotCaption": "Enrichment of net.exe with correct ATT&CK Technique (System Information Discovery)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team also sent an email indicating a General Behavior was observed because net config was one of the reconnaissance commands performed.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-2.D.2-1.png", "ScreenshotCaption": "Telemetry showing net with command-line arguments"}, {"ScreenshotName": "CS-2.A.1-1.png", "ScreenshotCaption": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net config not specifically shown)"}, {"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating net config was a reconnaissance command (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran net) were considered tainted.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-2.D.2-1.png", "ScreenshotCaption": "Telemetry showing net with command-line arguments"}, {"ScreenshotName": "CS-2.A.1-1.png", "ScreenshotCaption": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net config not specifically shown)"}, {"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating net config was a reconnaissance command (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe executing with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery). The data was tainted by a parent Injected Shellcode alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-2.E.2-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net executing with command-line arguments"}, {"ScreenshotName": "CR-2.E.2-12.png", "ScreenshotCaption": "Enrichment of net.exe executing with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery) (tainted by a parent Injected Shellcode alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-2.E.2-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net executing with command-line arguments"}, {"ScreenshotName": "CR-2.E.2-12.png", "ScreenshotCaption": "Enrichment of net.exe executing with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery) (tainted by a parent Injected Shellcode alert)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A delayed General Behavior alert triggered for a specified number of discovery techniques over a specified time period, which resulted in four Enumeration Command Sequence alerts for Step 2 (tainted by a parent Malicious File Detection).[EG8]", "Modifiers": ["Delayed", "Configuration Change", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-02-18.png", "ScreenshotCaption": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period"}, {"ScreenshotName": "EG-02-19.png", "ScreenshotCaption": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-9.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)"}], "Footnotes": ["This alert was configured after the start of the evaluation so is identified as a configuration change."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the event tree showed cmd.exe executing net.exe with command-line arguments (tainted by a parent Malicious File Detection).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-02-18.png", "ScreenshotCaption": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period"}, {"ScreenshotName": "EG-02-19.png", "ScreenshotCaption": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-9.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing the net) which was identified as extremely rare and suspicious.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.A.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing net)"}, {"ScreenshotName": "CC-2.A.2-2.png", "ScreenshotCaption": "Enrichment of net.exe indicating it is commonly used for reconnaissance"}, {"ScreenshotName": "CC-2.E.2-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-2.A.1-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}], "Footnotes": []}, {"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.A.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing net)"}, {"ScreenshotName": "CC-2.A.2-2.png", "ScreenshotCaption": "Enrichment of net.exe indicating it is commonly used for reconnaissance"}, {"ScreenshotName": "CC-2.E.2-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-2.A.1-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe indicating it is commonly used for reconnaissance.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.A.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing net)"}, {"ScreenshotName": "CC-2.A.2-2.png", "ScreenshotCaption": "Enrichment of net.exe indicating it is commonly used for reconnaissance"}, {"ScreenshotName": "CC-2.E.2-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-2.A.1-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.A.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing net)"}, {"ScreenshotName": "CC-2.A.2-2.png", "ScreenshotCaption": "Enrichment of net.exe indicating it is commonly used for reconnaissance"}, {"ScreenshotName": "CC-2.E.2-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-2.A.1-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified net config as a reconnaissance command performed. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-2.E.2-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Config Command Execution alert (tagged with correct ATT&CK Technique, T1082 - System Information Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net config was a reconnaissance command (General Behavior)"}, {"ScreenshotName": "FE-2.E.2-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about net"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with an alert for Net Config Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1082 - System Information Discovery) and Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-2.E.2-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Config Command Execution alert (tagged with correct ATT&CK Technique, T1082 - System Information Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net config was a reconnaissance command (General Behavior)"}, {"ScreenshotName": "FE-2.E.2-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about net"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by the parent Script File Created alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-2.E.2-1.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by the parent Script File Created alert)"}], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery) and a suspicious indicator that system configuration info was queried.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-2.B.1-4.png", "ScreenshotCaption": "Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)"}, {"ScreenshotName": "MC-2.B.1-5.png", "ScreenshotCaption": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery) and a suspicious indicator that system configuration info was queried"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by a trace detection on Resume Viewer.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-2.B.1-4.png", "ScreenshotCaption": "Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)"}, {"ScreenshotName": "MC-2.B.1-5.png", "ScreenshotCaption": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery) and a suspicious indicator that system configuration info was queried"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence of cmd.exe running net.exe with command-line arguments (tainted by the alert on suspicious sequence of exploration activities from child processes of rundll32.exe).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-2.E.2-1.png", "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"}, {"ScreenshotName": "MS-2.E.2-2.png", "ScreenshotCaption": "Process tree view of suspicious sequence of exploration activities alert with tainted rundll32.exe child processes showing net.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched cmd.exe executing net with the correct ATT&CK Technique (System Information Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-2.E.2-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.E.2-2.png", "ScreenshotCaption": "Enrichment of cmd.exe executing net with the correct ATT&CK Technique (System Information Discovery)"}, {"ScreenshotName": "PA-2.E.2-3.png", "ScreenshotCaption": "Enrichment of the execution of net.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the execution of net.exe as the execution of an enumeration command. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-2.E.2-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.E.2-2.png", "ScreenshotCaption": "Enrichment of cmd.exe executing net with the correct ATT&CK Technique (System Information Discovery)"}, {"ScreenshotName": "PA-2.E.2-3.png", "ScreenshotCaption": "Enrichment of the execution of net.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-2.E.2-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.E.2-2.png", "ScreenshotCaption": "Enrichment of cmd.exe executing net with the correct ATT&CK Technique (System Information Discovery)"}, {"ScreenshotName": "PA-2.E.2-3.png", "ScreenshotCaption": "Enrichment of the execution of net.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-02-3.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-2.A.1-9.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "2.F.1", "Procedure": "Cobalt Strike: 'net localgroup administrators' via cmd", "Techniques": [{"TechniqueId": "T1069", "TechniqueName": "Permission Groups Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with the correct ATT&CK Technique (Permission Groups Discovery) as well as the tag Administrator Enumeration.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-2.F.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-2.F.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with tag Administrator Enumeration"}, {"ScreenshotName": "CB-2.F.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with correct ATT&CK Technique (Permission Groups Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed cmd.exe executing net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-2.F.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-2.F.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with tag Administrator Enumeration"}, {"ScreenshotName": "CB-2.F.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with correct ATT&CK Technique (Permission Groups Discovery)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "OverWatch also generated a General Behavior alert indicating net localgroup execution was suspicious.[CS1]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-2.F.1-1.png", "ScreenshotCaption": "Telemetry showing net with command-line arguments"}, {"ScreenshotName": "CS-2.A.1-1.png", "ScreenshotCaption": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net localgroup not specifically shown)"}, {"ScreenshotName": "CS-2.F.1-3.png", "ScreenshotCaption": "OverWatch General Behavior alert for net localgroup"}, {"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating net localgroup was a reconnaissance command (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team also sent an email indicating a General Behavior was observed because net localgroup was one of the reconnaissance commands performed.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-2.F.1-1.png", "ScreenshotCaption": "Telemetry showing net with command-line arguments"}, {"ScreenshotName": "CS-2.A.1-1.png", "ScreenshotCaption": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net localgroup not specifically shown)"}, {"ScreenshotName": "CS-2.F.1-3.png", "ScreenshotCaption": "OverWatch General Behavior alert for net localgroup"}, {"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating net localgroup was a reconnaissance command (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran net) were considered tainted.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-2.F.1-1.png", "ScreenshotCaption": "Telemetry showing net with command-line arguments"}, {"ScreenshotName": "CS-2.A.1-1.png", "ScreenshotCaption": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net localgroup not specifically shown)"}, {"ScreenshotName": "CS-2.F.1-3.png", "ScreenshotCaption": "OverWatch General Behavior alert for net localgroup"}, {"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating net localgroup was a reconnaissance command (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery). The data was tainted by a parent Injected Shellcode alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-2.F.1-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net with command-line arguments"}, {"ScreenshotName": "CR-2.F.1-100.png", "ScreenshotCaption": "Enrichment of net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)"}, {"ScreenshotName": "CR-2.D.2-10.png", "ScreenshotCaption": "Process tree showing enriched net.exe executing\u00a0(tainted by a parent Injected Shellcode alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-2.F.1-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net with command-line arguments"}, {"ScreenshotName": "CR-2.F.1-100.png", "ScreenshotCaption": "Enrichment of net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)"}, {"ScreenshotName": "CR-2.D.2-10.png", "ScreenshotCaption": "Process tree showing enriched net.exe executing\u00a0(tainted by a parent Injected Shellcode alert)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A delayed General Behavior alert triggered for a specified number of discovery techniques over a specified time period, which resulted in four Enumeration Command Sequence alerts for Step 2 (tainted by a parent Malicious File Detection).[EG8]", "Modifiers": ["Delayed", "Configuration Change", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-02-18.png", "ScreenshotCaption": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period"}, {"ScreenshotName": "EG-02-19.png", "ScreenshotCaption": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-10.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-16.png", "ScreenshotCaption": "Enrichment of net.exe execution with command-line arguments with Enumeration of Administrator Accounts alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery; tainted by parent Malicious File Detection)"}], "Footnotes": ["This alert was configured after the start of the evaluation so is identified as a configuration change."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with an alert for Enumeration of Administrator Account (tainted by a parent Malicious File Detection). The alert was also tagged with the correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-02-18.png", "ScreenshotCaption": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period"}, {"ScreenshotName": "EG-02-19.png", "ScreenshotCaption": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-10.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-16.png", "ScreenshotCaption": "Enrichment of net.exe execution with command-line arguments with Enumeration of Administrator Accounts alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery; tainted by parent Malicious File Detection)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the event tree showed cmd.exe executing net.exe with command-line arguments (tainted by a parent Malicious File Detection).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-02-18.png", "ScreenshotCaption": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period"}, {"ScreenshotName": "EG-02-19.png", "ScreenshotCaption": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-10.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-16.png", "ScreenshotCaption": "Enrichment of net.exe execution with command-line arguments with Enumeration of Administrator Accounts alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery; tainted by parent Malicious File Detection)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing the net) which was identified as extremely rare and suspicious.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.F.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing net)"}, {"ScreenshotName": "CC-2.F.1-99.png", "ScreenshotCaption": "Enrichment of net.exe indicating it is commonly used for reconnaissance"}, {"ScreenshotName": "CC-2.F.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-2.F.1-98.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}], "Footnotes": []}, {"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.F.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing net)"}, {"ScreenshotName": "CC-2.F.1-99.png", "ScreenshotCaption": "Enrichment of net.exe indicating it is commonly used for reconnaissance"}, {"ScreenshotName": "CC-2.F.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-2.F.1-98.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe indicating it is commonly used for reconnaissance.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.F.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing net)"}, {"ScreenshotName": "CC-2.F.1-99.png", "ScreenshotCaption": "Enrichment of net.exe indicating it is commonly used for reconnaissance"}, {"ScreenshotName": "CC-2.F.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-2.F.1-98.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.F.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing net)"}, {"ScreenshotName": "CC-2.F.1-99.png", "ScreenshotCaption": "Enrichment of net.exe indicating it is commonly used for reconnaissance"}, {"ScreenshotName": "CC-2.F.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-2.F.1-98.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that the attacker enumerated members of the local administrators group. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-2.F.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker enumerated members of the local administrators group (Specific Behavior)"}, {"ScreenshotName": "FE-2.F.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about net"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with an alert for Net Group Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-2.F.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker enumerated members of the local administrators group (Specific Behavior)"}, {"ScreenshotName": "FE-2.F.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about net"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability showed cmd.exe executing net.exe with command-line arguments and enriched the command with the conditions Net Group Reconnaissance Command and Net LocalGroup Reconnaissance Command. The enrichment was tainted by the parent Script File Created alert.[CT19]", "Modifiers": ["Configuration Change", "Tainted"], "Screenshots": [{"ScreenshotName": "CT-2.F.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with conditions Net Group Reconnaissance Command and Net LocalGroup Reconnaissance Command (tainted by the parent Script File Created alert)"}], "Footnotes": ["The conditions contributing to Enrichment were added to the capability's detection after the start of the evaluation, so this detection is identified as a configuration change. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with the correct ATT&CK Tactic (Discovery) and a suspicious indicator that information of users/groups was obtained.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-2.B.1-4.png", "ScreenshotCaption": "Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)"}, {"ScreenshotName": "MC-2.B.1-6.png", "ScreenshotCaption": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and a suspicious indicator that information of users/groups was obtained"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by a trace detection on Resume Viewer.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-2.B.1-4.png", "ScreenshotCaption": "Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)"}, {"ScreenshotName": "MC-2.B.1-6.png", "ScreenshotCaption": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and a suspicious indicator that information of users/groups was obtained"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A delayed General Behavior alert occurred due to a sequence of exploration activities that was classified as suspicious.", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "MS-2.A.1-3.png", "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"}, {"ScreenshotName": "MS-2.F.1-1.png", "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"}, {"ScreenshotName": "MS-2.F.1-2.png", "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence of cmd.exe running net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-2.A.1-3.png", "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"}, {"ScreenshotName": "MS-2.F.1-1.png", "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"}, {"ScreenshotName": "MS-2.F.1-2.png", "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe executing with the correct ATT&CK Technique (Permission Groups Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-2.F.1-1.png", "ScreenshotCaption": "Enrichment of net.exe executing with the correct ATT&CK Technique (Permission Groups Discovery)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-02-3.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-2.A.1-10.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "2.F.2", "Procedure": "Cobalt Strike: 'net localgroup administrators -domain' via cmd", "Techniques": [{"TechniqueId": "T1069", "TechniqueName": "Permission Groups Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with the correct ATT&CK Technique (Permission Groups Discovery) as well as the tag Administrator Enumeration.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-2.F.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-2.F.2-2.png", "ScreenshotCaption": "Enrichment of net.exe with tag Administrator Enumeration"}, {"ScreenshotName": "CB-2.F.2-3.png", "ScreenshotCaption": "Enrichment of net.exe with correct ATT&CK Technique (Permission Groups Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed cmd.exe executing net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-2.F.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-2.F.2-2.png", "ScreenshotCaption": "Enrichment of net.exe with tag Administrator Enumeration"}, {"ScreenshotName": "CB-2.F.2-3.png", "ScreenshotCaption": "Enrichment of net.exe with correct ATT&CK Technique (Permission Groups Discovery)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team sent an email indicating a General Behavior was observed because net localgroup was one of the reconnaissance commands performed.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-2.F.1-1.png", "ScreenshotCaption": "Telemetry showing net with command-line arguments"}, {"ScreenshotName": "CS-2.A.1-1.png", "ScreenshotCaption": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net localgroup not specifically shown)"}, {"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating net localgroup was a reconnaissance command (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran net) were considered tainted.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-2.F.1-1.png", "ScreenshotCaption": "Telemetry showing net with command-line arguments"}, {"ScreenshotName": "CS-2.A.1-1.png", "ScreenshotCaption": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net localgroup not specifically shown)"}, {"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating net localgroup was a reconnaissance command (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery). The data was tainted by a parent Injected Shellcode alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-2.D.2-10.png", "ScreenshotCaption": "Process tree showing enriched net.exe executing\u00a0(tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-2.F.2-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net with command-line arguments"}, {"ScreenshotName": "CR-2.F.2-100.png", "ScreenshotCaption": "Enrichment of net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-2.D.2-10.png", "ScreenshotCaption": "Process tree showing enriched net.exe executing\u00a0(tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-2.F.2-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net with command-line arguments"}, {"ScreenshotName": "CR-2.F.2-100.png", "ScreenshotCaption": "Enrichment of net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A delayed General Behavior alert triggered for a specified number of discovery techniques over a specified time period, which resulted in four Enumeration Command Sequence alerts for Step 2 (tainted by a parent Malicious File Detection).[EG8]", "Modifiers": ["Delayed", "Configuration Change", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-02-18.png", "ScreenshotCaption": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period"}, {"ScreenshotName": "EG-02-19.png", "ScreenshotCaption": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-16.png", "ScreenshotCaption": "Enrichment of net.exe execution with command-line arguments with Enumeration of Administrator Accounts alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery; tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-11.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)"}], "Footnotes": ["This alert was configured after the start of the evaluation so is identified as a configuration change."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with an alert for Enumeration of Administrator Account (tainted by a parent Malicious File Detection). The alert was also tagged with the correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-02-18.png", "ScreenshotCaption": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period"}, {"ScreenshotName": "EG-02-19.png", "ScreenshotCaption": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-16.png", "ScreenshotCaption": "Enrichment of net.exe execution with command-line arguments with Enumeration of Administrator Accounts alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery; tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-11.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the event tree showed cmd.exe executing net.exe with command-line arguments (tainted by a parent Malicious File Detection).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-02-18.png", "ScreenshotCaption": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period"}, {"ScreenshotName": "EG-02-19.png", "ScreenshotCaption": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-16.png", "ScreenshotCaption": "Enrichment of net.exe execution with command-line arguments with Enumeration of Administrator Accounts alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery; tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-11.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing the net) which was identified as extremely rare and suspicious.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.F.2-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing net)"}, {"ScreenshotName": "CC-2.F.2-99.png", "ScreenshotCaption": "Enrichment of net.exe indicating it is commonly used for reconnaissance"}, {"ScreenshotName": "CC-2.F.2-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-2.F.2-98.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (cmd.exe)"}], "Footnotes": []}, {"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (cmd.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.F.2-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing net)"}, {"ScreenshotName": "CC-2.F.2-99.png", "ScreenshotCaption": "Enrichment of net.exe indicating it is commonly used for reconnaissance"}, {"ScreenshotName": "CC-2.F.2-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-2.F.2-98.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (cmd.exe)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe indicating it is commonly used for reconnaissance.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.F.2-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing net)"}, {"ScreenshotName": "CC-2.F.2-99.png", "ScreenshotCaption": "Enrichment of net.exe indicating it is commonly used for reconnaissance"}, {"ScreenshotName": "CC-2.F.2-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-2.F.2-98.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (cmd.exe)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.F.2-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing net)"}, {"ScreenshotName": "CC-2.F.2-99.png", "ScreenshotCaption": "Enrichment of net.exe indicating it is commonly used for reconnaissance"}, {"ScreenshotName": "CC-2.F.2-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-2.F.2-98.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (cmd.exe)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that the attacker enumerated members of the local administrators group. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker enumerated members of the local administrators group (Specific Behavior)"}, {"ScreenshotName": "FE-2.F.2-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.F.2-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about net"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with an alert for Net Group Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery)", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker enumerated members of the local administrators group (Specific Behavior)"}, {"ScreenshotName": "FE-2.F.2-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.F.2-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about net"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability showed cmd.exe executing net.exe with command-line arguments and enriched the command with the conditions Net Group Reconnaissance Command and Net LocalGroup Reconnaissance Command. The enrichment was tainted by the parent Script File Created alert.[CT19]", "Modifiers": ["Configuration Change", "Tainted"], "Screenshots": [{"ScreenshotName": "CT-2.F.2-1.png", "ScreenshotCaption": "Enrichment of net.exe with conditions Net Group Reconnaissance Command and Net LocalGroup Reconnaissance Command (tainted by the parent Script File Created alert)"}], "Footnotes": ["The conditions contributing to Enrichment were added to the capability's detection after the start of the evaluation, so this detection is identified as a configuration change. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with the correct ATT&CK Tactic (Discovery) and a suspicious indicator that information of users/groups was obtained.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-2.B.1-4.png", "ScreenshotCaption": "Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)"}, {"ScreenshotName": "MC-2.B.1-6.png", "ScreenshotCaption": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and a suspicious indicator that information of users/groups was obtained"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by a trace detection on Resume Viewer.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-2.B.1-4.png", "ScreenshotCaption": "Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)"}, {"ScreenshotName": "MC-2.B.1-6.png", "ScreenshotCaption": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and a suspicious indicator that information of users/groups was obtained"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A delayed General Behavior alert occurred due to a sequence of exploration activities that was classified as suspicious.", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "MS-2.A.1-3.png", "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"}, {"ScreenshotName": "MS-2.F.2-1.png", "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"}, {"ScreenshotName": "MS-2.F.2-2.png", "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence of cmd.exe running net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-2.A.1-3.png", "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"}, {"ScreenshotName": "MS-2.F.2-1.png", "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"}, {"ScreenshotName": "MS-2.F.2-2.png", "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe executing with the correct ATT&CK Technique (Permission Groups Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-2.F.2-1.png", "ScreenshotCaption": "Enrichment of net.exe executing with the correct ATT&CK Technique (Permission Groups Discovery)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-02-3.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-2.A.1-11.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "2.F.3", "Procedure": "Cobalt Strike: 'net group \"Domain Admins\" -domain' via cmd", "Techniques": [{"TechniqueId": "T1069", "TechniqueName": "Permission Groups Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with the correct ATT&CK Technique (Permission Groups Discovery) as well as the tag Administrator Enumeration.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-2.F.3-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-2.F.3-2.png", "ScreenshotCaption": "Enrichment of net.exe with tag Administrator Enumeration"}, {"ScreenshotName": "CB-2.F.3-3.png", "ScreenshotCaption": "Enrichment of net.exe with correct ATT&CK Technique (Permission Groups Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed cmd.exe executing net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-2.F.3-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-2.F.3-2.png", "ScreenshotCaption": "Enrichment of net.exe with tag Administrator Enumeration"}, {"ScreenshotName": "CB-2.F.3-3.png", "ScreenshotCaption": "Enrichment of net.exe with correct ATT&CK Technique (Permission Groups Discovery)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team sent an email indicating a General Behavior was observed because net group was one of the reconnaissance commands performed.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-2.F.1-1.png", "ScreenshotCaption": "Telemetry showing net with command-line arguments"}, {"ScreenshotName": "CS-2.F.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery) (tainted by orange line for medium severity from previous detection)"}, {"ScreenshotName": "CS-2.A.1-1.png", "ScreenshotCaption": "Process tree showing all cmd.exe children under rundll32.exe (including net group) as tainted by orange line for medium severity"}, {"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating net group was a reconnaissance command (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability showed cmd.exe executing net.exe with command-line arguments and enriched the command with a related ATT&CK Technique (Account Discovery) and the correct Tactic (Discovery). The enrichment was tainted by a previous detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-2.F.1-1.png", "ScreenshotCaption": "Telemetry showing net with command-line arguments"}, {"ScreenshotName": "CS-2.F.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery) (tainted by orange line for medium severity from previous detection)"}, {"ScreenshotName": "CS-2.A.1-1.png", "ScreenshotCaption": "Process tree showing all cmd.exe children under rundll32.exe (including net group) as tainted by orange line for medium severity"}, {"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating net group was a reconnaissance command (General Behavior)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran net) were considered tainted.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-2.F.1-1.png", "ScreenshotCaption": "Telemetry showing net with command-line arguments"}, {"ScreenshotName": "CS-2.F.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery) (tainted by orange line for medium severity from previous detection)"}, {"ScreenshotName": "CS-2.A.1-1.png", "ScreenshotCaption": "Process tree showing all cmd.exe children under rundll32.exe (including net group) as tainted by orange line for medium severity"}, {"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating net group was a reconnaissance command (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was also tagged with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery). The alert was tainted by a parent Injected Shellcode alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-2.F.3-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net with command-line arguments"}, {"ScreenshotName": "CR-2.F.3-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)"}, {"ScreenshotName": "CR-2.D.2-10.png", "ScreenshotCaption": "Process tree showing alerted net.exe executing\u00a0(tainted by a parent Injected Shellcode alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-2.F.3-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net with command-line arguments"}, {"ScreenshotName": "CR-2.F.3-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)"}, {"ScreenshotName": "CR-2.D.2-10.png", "ScreenshotCaption": "Process tree showing alerted net.exe executing\u00a0(tainted by a parent Injected Shellcode alert)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A delayed General Behavior alert triggered for a specified number of discovery techniques over a specified time period, which resulted in four Enumeration Command Sequence alerts for Step 2 (tainted by a parent Malicious File Detection).[EG8]", "Modifiers": ["Delayed", "Configuration Change", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-02-18.png", "ScreenshotCaption": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period"}, {"ScreenshotName": "EG-02-19.png", "ScreenshotCaption": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-12.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-17.png", "ScreenshotCaption": "Enrichment of net.exe execution with command-line arguments with Enumeration of Administrator Accounts alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery; tainted by parent Malicious File Detection)"}], "Footnotes": ["This alert was configured after the start of the evaluation so is identified as a configuration change."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with an alert for Enumeration of Administrator Account (tainted by a parent Malicious File Detection). The alert was also tagged with the correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-02-18.png", "ScreenshotCaption": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period"}, {"ScreenshotName": "EG-02-19.png", "ScreenshotCaption": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-12.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-17.png", "ScreenshotCaption": "Enrichment of net.exe execution with command-line arguments with Enumeration of Administrator Accounts alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery; tainted by parent Malicious File Detection)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the event tree showed cmd.exe executing net.exe with command-line arguments (tainted by a parent Malicious File Detection).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-02-18.png", "ScreenshotCaption": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period"}, {"ScreenshotName": "EG-02-19.png", "ScreenshotCaption": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-12.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-17.png", "ScreenshotCaption": "Enrichment of net.exe execution with command-line arguments with Enumeration of Administrator Accounts alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery; tainted by parent Malicious File Detection)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.F.3-1.png", "ScreenshotCaption": "Enrichment of net.exe indicating it is commonly used for reconnaissance"}, {"ScreenshotName": "CC-2.F.3-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-2.F.3-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe indicating it is commonly used for reconnaissance.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.F.3-1.png", "ScreenshotCaption": "Enrichment of net.exe indicating it is commonly used for reconnaissance"}, {"ScreenshotName": "CC-2.F.3-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-2.F.3-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.F.3-1.png", "ScreenshotCaption": "Enrichment of net.exe indicating it is commonly used for reconnaissance"}, {"ScreenshotName": "CC-2.F.3-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-2.F.3-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that the attacker enumerated the Shockwave domain's Domain Administrators group. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-2.F.3-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker enumerated the Domain Administrators group (Specific Behavior)"}, {"ScreenshotName": "FE-2.F.3-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about net"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with an alert for Net Group Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-2.F.3-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker enumerated the Domain Administrators group (Specific Behavior)"}, {"ScreenshotName": "FE-2.F.3-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about net"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability showed cmd.exe executing net.exe with command-line arguments and enriched the command with the conditions Net Group Reconnaissance Command and Net LocalGroup Reconnaissance Command. The enrichment was tainted by the parent Script File Created alert.[CT19]", "Modifiers": ["Configuration Change", "Tainted"], "Screenshots": [{"ScreenshotName": "CT-2.F.3-1.png", "ScreenshotCaption": "Enrichment of net.exe with conditions Net Group Reconnaissance Command and Net LocalGroup Reconnaissance Command (tainted by the parent Script File Created alert)"}], "Footnotes": ["The conditions contributing to Enrichment were added to the capability's detection after the start of the evaluation, so this detection is identified as a configuration change. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with the correct ATT&CK Tactic (Discovery) and Techniques (Permission Groups Discovery) and a suspicious indicator that information of users/groups was obtained.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-2.B.1-4.png", "ScreenshotCaption": "Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)"}, {"ScreenshotName": "MC-2.A.1-27.png", "ScreenshotCaption": "Enrichment of net group with a correct ATT&CK Tactic (Discovery) and Technique (Permission Group Discovery) and a suspicious indicator that a net utility was used to gather information of user groups"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by a trace detection on Resume Viewer.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-2.B.1-4.png", "ScreenshotCaption": "Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)"}, {"ScreenshotName": "MC-2.A.1-27.png", "ScreenshotCaption": "Enrichment of net group with a correct ATT&CK Tactic (Discovery) and Technique (Permission Group Discovery) and a suspicious indicator that a net utility was used to gather information of user groups"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A delayed General Behavior alert occurred due to a sequence of exploration activities that was classified as suspicious.", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "MS-2.A.1-3.png", "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"}, {"ScreenshotName": "MS-2.F.3-1.png", "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"}, {"ScreenshotName": "MS-2.F.3-3.png", "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"}, {"ScreenshotName": "MS-2.F.3-2.png", "ScreenshotCaption": "Telemetry showing domain admins group discovery by Nimda at the domain controller"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence of cmd.exe running net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-2.A.1-3.png", "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"}, {"ScreenshotName": "MS-2.F.3-1.png", "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"}, {"ScreenshotName": "MS-2.F.3-3.png", "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"}, {"ScreenshotName": "MS-2.F.3-2.png", "ScreenshotCaption": "Telemetry showing domain admins group discovery by Nimda at the domain controller"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the execution of net.exe and net1.exe as the possible enumeration of administrator groups. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-2.F.3-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.F.3-2.png", "ScreenshotCaption": "Enrichment of the execution of net.exe as the possible enumeration of administrator groups (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.F.3-5.png", "ScreenshotCaption": "Enrichment of the execution of net1.exe as the possible enumeration of administrator groups (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.F.3-3.png", "ScreenshotCaption": "Enrichment of the execution of net.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.F.3-4.png", "ScreenshotCaption": "Enrichment of the execution of net.exe as the execution of an enumeration command using net or net1 (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the execution of net.exe as the execution of an enumeration command as well as the execution of net1.exe as the execution of an enumeration command using net or net1. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-2.F.3-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.F.3-2.png", "ScreenshotCaption": "Enrichment of the execution of net.exe as the possible enumeration of administrator groups (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.F.3-5.png", "ScreenshotCaption": "Enrichment of the execution of net1.exe as the possible enumeration of administrator groups (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.F.3-3.png", "ScreenshotCaption": "Enrichment of the execution of net.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.F.3-4.png", "ScreenshotCaption": "Enrichment of the execution of net.exe as the execution of an enumeration command using net or net1 (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-2.F.3-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.F.3-2.png", "ScreenshotCaption": "Enrichment of the execution of net.exe as the possible enumeration of administrator groups (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.F.3-5.png", "ScreenshotCaption": "Enrichment of the execution of net1.exe as the possible enumeration of administrator groups (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.F.3-3.png", "ScreenshotCaption": "Enrichment of the execution of net.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.F.3-4.png", "ScreenshotCaption": "Enrichment of the execution of net.exe as the execution of an enumeration command using net or net1 (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "An \"IIOC\" module called \"Enumerates domain administrators\" was generated and provided enrichment.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-02-3.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "RSA-02-5.png", "ScreenshotCaption": "Event enrichment from IIOC module \\\"Enumerates domain administrators\\\""}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-02-3.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "RSA-02-5.png", "ScreenshotCaption": "Event enrichment from IIOC module \\\"Enumerates domain administrators\\\""}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-2.A.1-12.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "2.G.1", "Procedure": "Cobalt Strike: 'net user -domain' via cmd", "Techniques": [{"TechniqueId": "T1087", "TechniqueName": "Account Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with the correct ATT&CK Technique (Account Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-2.G.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-2.G.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with correct ATT&CK Technique (Account Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed cmd.exe executing net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-2.G.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-2.G.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with correct ATT&CK Technique (Account Discovery)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran net.exe) were considered tainted.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-2.G.1-1.png", "ScreenshotCaption": "Telemetry showing net with command-line arguments"}, {"ScreenshotName": "CS-2.A.1-1.png", "ScreenshotCaption": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net user not specifically shown)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe executing with the correct ATT&CK Technique (Account Discovery). The data was tainted by a parent Injected Shellcode alert", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-2.G.1-10.png", "ScreenshotCaption": "Telemetry showing net executing with command-line arguments"}, {"ScreenshotName": "CR-2.G.2-100.png", "ScreenshotCaption": "Enrichment of net.exe executing with the correct ATT&CK Tactic (Account Discovery) and Technique (Discovery)"}, {"ScreenshotName": "CR-2.D.2-10.png", "ScreenshotCaption": "Process tree showing enriched net.exe executing with the correct ATT&CK Technique (Account Discovery) (tainted by a parent Injected Shellcode alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-2.G.1-10.png", "ScreenshotCaption": "Telemetry showing net executing with command-line arguments"}, {"ScreenshotName": "CR-2.G.2-100.png", "ScreenshotCaption": "Enrichment of net.exe executing with the correct ATT&CK Tactic (Account Discovery) and Technique (Discovery)"}, {"ScreenshotName": "CR-2.D.2-10.png", "ScreenshotCaption": "Process tree showing enriched net.exe executing with the correct ATT&CK Technique (Account Discovery) (tainted by a parent Injected Shellcode alert)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A delayed General Behavior alert triggered for a specified number of discovery techniques over a specified time period, which resulted in four Enumeration Command Sequence alerts for Step 2 (tainted by a parent Malicious File Detection).[EG8]", "Modifiers": ["Delayed", "Configuration Change", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-02-18.png", "ScreenshotCaption": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period"}, {"ScreenshotName": "EG-02-19.png", "ScreenshotCaption": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-13.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)"}], "Footnotes": ["This alert was configured after the start of the evaluation so is identified as a configuration change."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the event tree showed cmd.exe executing net.exe with command-line arguments (tainted by a parent Malicious File Detection).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-02-18.png", "ScreenshotCaption": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period"}, {"ScreenshotName": "EG-02-19.png", "ScreenshotCaption": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-13.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing the net) which was identified as extremely rare and suspicious.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.G.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing net)"}, {"ScreenshotName": "CC-2.G.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with a tag identifying the command as enumeration"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with a tag identifying the command as enumeration.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.G.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing net)"}, {"ScreenshotName": "CC-2.G.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with a tag identifying the command as enumeration"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified net user as a reconnaissance command performed. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-2.G.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net User Command Execution alert (tagged with correct ATT&CK Technique, T1087 - Account Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net user was a reconnaissance command (General Behavior)"}, {"ScreenshotName": "FE-2.G.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about net"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with an alert for Net User Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1087 - Account Discovery) and Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-2.G.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net User Command Execution alert (tagged with correct ATT&CK Technique, T1087 - Account Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net user was a reconnaissance command (General Behavior)"}, {"ScreenshotName": "FE-2.G.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about net"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability showed cmd.exe executing net.exe with command-line arguments and enriched the command with the condition Net User Reconnaissance Command. The enrichment was tainted by the parent Script File Created alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-2.G.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with condition Net User Reconnaissance Command (tainted by the parent Script File Created alert)"}], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (System Owner/User Discovery) and a suspicious indicator that information of users/groups was obtained.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-2.B.1-4.png", "ScreenshotCaption": "Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)"}, {"ScreenshotName": "MC-2.A.1-26.png", "ScreenshotCaption": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (System Owner/User Discovery) and a suspicious indicator that information of users/groups was obtained"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by a trace detection on Resume Viewer.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-2.B.1-4.png", "ScreenshotCaption": "Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)"}, {"ScreenshotName": "MC-2.A.1-26.png", "ScreenshotCaption": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (System Owner/User Discovery) and a suspicious indicator that information of users/groups was obtained"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A delayed General Behavior alert occurred due to a sequence of exploration commands that was classified as suspicious.", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "MS-2.A.1-3.png", "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"}, {"ScreenshotName": "MS-2.G.1-1.png", "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"}, {"ScreenshotName": "MS-2.G.1-2.png", "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence of cmd.exe running net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-2.A.1-3.png", "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"}, {"ScreenshotName": "MS-2.G.1-1.png", "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"}, {"ScreenshotName": "MS-2.G.1-2.png", "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the execution of net.exe as the execution of an enumeration command. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-2.G.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.G.1-2.png", "ScreenshotCaption": "Enrichment of the execution of net.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-2.G.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.G.1-2.png", "ScreenshotCaption": "Enrichment of the execution of net.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-02-3.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-2.A.1-13.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "2.G.2", "Procedure": "Cobalt Strike: 'net user george -domain' via cmd", "Techniques": [{"TechniqueId": "T1087", "TechniqueName": "Account Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with the correct ATT&CK Technique (Account Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-2.G.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-2.G.2-2.png", "ScreenshotCaption": "Enrichment of net.exe with correct ATT&CK Technique (Account Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed cmd.exe executing net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-2.G.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-2.G.2-2.png", "ScreenshotCaption": "Enrichment of net.exe with correct ATT&CK Technique (Account Discovery)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team sent an email indicating a General Behavior was observed because net user was one of the reconnaissance commands performed.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-2.G.1-1.png", "ScreenshotCaption": "Telemetry showing net with command-line arguments"}, {"ScreenshotName": "CS-2.A.1-1.png", "ScreenshotCaption": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net user not specifically shown)"}, {"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating net user was a reconnaissance command (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran net) were considered tainted.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-2.G.1-1.png", "ScreenshotCaption": "Telemetry showing net with command-line arguments"}, {"ScreenshotName": "CS-2.A.1-1.png", "ScreenshotCaption": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net user not specifically shown)"}, {"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating net user was a reconnaissance command (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe executing with the correct ATT&CK Technique (Account Discovery). The data was tainted by a parent Injected Shellcode alert", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-2.D.2-10.png", "ScreenshotCaption": "Process tree showing enriched net.exe executing with the correct ATT&CK Technique (Account Discovery) (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-2.G.2-10.png", "ScreenshotCaption": "Telemetry showing net executing with command-line arguments"}, {"ScreenshotName": "CR-2.G.1-100.png", "ScreenshotCaption": "Enrichment of net.exe executing with the correct ATT&CK Tactic (Account Discovery) and Technique (Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-2.D.2-10.png", "ScreenshotCaption": "Process tree showing enriched net.exe executing with the correct ATT&CK Technique (Account Discovery) (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-2.G.2-10.png", "ScreenshotCaption": "Telemetry showing net executing with command-line arguments"}, {"ScreenshotName": "CR-2.G.1-100.png", "ScreenshotCaption": "Enrichment of net.exe executing with the correct ATT&CK Tactic (Account Discovery) and Technique (Discovery)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A delayed General Behavior alert triggered for a specified number of discovery techniques over a specified time period, which resulted in four Enumeration Command Sequence alerts for Step 2 (tainted by a parent Malicious File Detection).[EG8]", "Modifiers": ["Delayed", "Configuration Change", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-02-18.png", "ScreenshotCaption": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period"}, {"ScreenshotName": "EG-02-19.png", "ScreenshotCaption": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-14.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)"}], "Footnotes": ["This alert was configured after the start of the evaluation so is identified as a configuration change."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the event tree showed cmd.exe executing net.exe with command-line arguments (tainted by a parent Malicious File Detection).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-02-18.png", "ScreenshotCaption": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period"}, {"ScreenshotName": "EG-02-19.png", "ScreenshotCaption": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-14.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (cmd.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.H.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with a tag identifying the command as enumeration"}, {"ScreenshotName": "CC-2.G.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (cmd.exe)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with a tag identifying the command as enumeration.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.H.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with a tag identifying the command as enumeration"}, {"ScreenshotName": "CC-2.G.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (cmd.exe)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified net user as a reconnaissance command performed. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-2.E.2-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about net"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net user was a reconnaissance command (General Behavior)"}, {"ScreenshotName": "FE-2.G.2-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net User Command Execution alert (tagged with correct ATT&CK Technique, T1087 - Account Discovery, and Tactic, Discovery)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with an alert for Net User Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1087 - Account Discovery) and Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-2.E.2-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about net"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net user was a reconnaissance command (General Behavior)"}, {"ScreenshotName": "FE-2.G.2-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net User Command Execution alert (tagged with correct ATT&CK Technique, T1087 - Account Discovery, and Tactic, Discovery)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability showed cmd.exe executing net.exe with command-line arguments and enriched the command with the conditions Reconnaissance Tool and Net User Reconnaissance Command. The enrichment was tainted by the parent Script File Created alert.[CT20]", "Modifiers": ["Configuration Change", "Tainted"], "Screenshots": [{"ScreenshotName": "CT-2.G.2-1.png", "ScreenshotCaption": "Enrichment of net.exe with conditions Reconnaissance Tool and Net User Reconnaissance Command (tainted by the parent Script File Created alert)"}], "Footnotes": ["One condition contributing to Enrichment was added to the capability's detection after the start of the evaluation, so this detection is identified as a configuration change. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (System Owner/User Discovery) and a suspicious indicator that information of users/groups was obtained.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-2.B.1-4.png", "ScreenshotCaption": "Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)"}, {"ScreenshotName": "MC-2.A.1-26.png", "ScreenshotCaption": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (System Owner/User Discovery) and a suspicious indicator that information of users/groups was obtained"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by a trace detection on Resume Viewer.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-2.B.1-4.png", "ScreenshotCaption": "Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)"}, {"ScreenshotName": "MC-2.A.1-26.png", "ScreenshotCaption": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (System Owner/User Discovery) and a suspicious indicator that information of users/groups was obtained"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A delayed General Behavior alert occurred due to a sequence of exploration activities that was classified as suspicious.", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "MS-2.A.1-3.png", "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"}, {"ScreenshotName": "MS-2.G.2-1.png", "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"}, {"ScreenshotName": "MS-2.G.2-3.png", "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"}, {"ScreenshotName": "MS-2.G.2-2.png", "ScreenshotCaption": "Telemetry showing discovery of George permissions by Debbie from Nimda at the domain controller"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence of cmd.exe running net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-2.A.1-3.png", "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"}, {"ScreenshotName": "MS-2.G.2-1.png", "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"}, {"ScreenshotName": "MS-2.G.2-3.png", "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"}, {"ScreenshotName": "MS-2.G.2-2.png", "ScreenshotCaption": "Telemetry showing discovery of George permissions by Debbie from Nimda at the domain controller"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net1.exe executing with the correct ATT&CK Technique (Account Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-2.G.2-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.G.2-2.png", "ScreenshotCaption": "Enrichment of net1.exe executing with the correct ATT&CK Technique (Account Discovery)"}, {"ScreenshotName": "PA-2.G.2-3.png", "ScreenshotCaption": "Enrichment of the execution of net.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the execution of net.exe as the execution of an enumeration command. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-2.G.2-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.G.2-2.png", "ScreenshotCaption": "Enrichment of net1.exe executing with the correct ATT&CK Technique (Account Discovery)"}, {"ScreenshotName": "PA-2.G.2-3.png", "ScreenshotCaption": "Enrichment of the execution of net.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-2.G.2-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.G.2-2.png", "ScreenshotCaption": "Enrichment of net1.exe executing with the correct ATT&CK Technique (Account Discovery)"}, {"ScreenshotName": "PA-2.G.2-3.png", "ScreenshotCaption": "Enrichment of the execution of net.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-02-4.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-2.A.1-14.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "2.H.1", "Procedure": "Cobalt Strike: 'reg query' via cmd to enumerate a specific Registry key", "Techniques": [{"TechniqueId": "T1012", "TechniqueName": "Query Registry", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched reg.exe with the correct ATT&CK Technique (T1012 - Query Registry).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-2.H.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing reg.exe with command-line arguments"}, {"ScreenshotName": "CB-2.H.1-2.png", "ScreenshotCaption": "Enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed cmd.exe executing reg.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-2.H.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing reg.exe with command-line arguments"}, {"ScreenshotName": "CB-2.H.1-2.png", "ScreenshotCaption": "Enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team sent an email indicating a General Behavior was observed because reg query was one of the reconnaissance commands performed.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-2.G.1-1.png", "ScreenshotCaption": "Telemetry showing reg with command-line arguments"}, {"ScreenshotName": "CS-2.A.1-1.png", "ScreenshotCaption": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (reg query not specifically shown)"}, {"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating reg query was a reconnaissance command (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing reg with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran reg) were considered tainted.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-2.G.1-1.png", "ScreenshotCaption": "Telemetry showing reg with command-line arguments"}, {"ScreenshotName": "CS-2.A.1-1.png", "ScreenshotCaption": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (reg query not specifically shown)"}, {"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating reg query was a reconnaissance command (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing reg with command-line arguments. The telemetry was tainted by a parent Injected Shellcode alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-2.H.1-10.png", "ScreenshotCaption": "Telemetry within a process tree showing reg.exe executing with command-line arguments (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-2.H.1-11.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing reg with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A delayed General Behavior alert triggered for a specified number of discovery techniques over a specified time period, which resulted in four Enumeration Command Sequence alerts for Step 2 (tainted by a parent Malicious File Detection).[EG8]", "Modifiers": ["Delayed", "Configuration Change", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-02-18.png", "ScreenshotCaption": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period"}, {"ScreenshotName": "EG-02-19.png", "ScreenshotCaption": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-15.png", "ScreenshotCaption": "Telemetry showing reg.exe with command-line arguments (tainted by parent Malicious File Detection)"}], "Footnotes": ["This alert was configured after the start of the evaluation so is identified as a configuration change."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the event tree showed cmd.exe executing reg.exe with command-line arguments (tainted by a parent Malicious File Detection).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-02-18.png", "ScreenshotCaption": "General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period"}, {"ScreenshotName": "EG-02-19.png", "ScreenshotCaption": "Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)"}, {"ScreenshotName": "EG-02-15.png", "ScreenshotCaption": "Telemetry showing reg.exe with command-line arguments (tainted by parent Malicious File Detection)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing the reg) which was identified as extremely rare and suspicious.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.H.1-1.png", "ScreenshotCaption": "Enrichment of reg.exe indicating that a sensitive registry key was accessed, possibly as part of reconnaissance"}, {"ScreenshotName": "CC-2.G.2-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing reg)"}, {"ScreenshotName": "CC-2.H.1-2.png", "ScreenshotCaption": "Telemetry showing reg.exe with command-line arguments"}, {"ScreenshotName": "CC-2.G.2-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running reg) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}], "Footnotes": []}, {"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (cmd.exe running reg) has been tagged for monitoring because its parent process has a detection (rundll32.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.H.1-1.png", "ScreenshotCaption": "Enrichment of reg.exe indicating that a sensitive registry key was accessed, possibly as part of reconnaissance"}, {"ScreenshotName": "CC-2.G.2-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing reg)"}, {"ScreenshotName": "CC-2.H.1-2.png", "ScreenshotCaption": "Telemetry showing reg.exe with command-line arguments"}, {"ScreenshotName": "CC-2.G.2-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running reg) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched reg.exe indicating that a sensitive registry key was accessed, possibly as part of reconnaissance.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.H.1-1.png", "ScreenshotCaption": "Enrichment of reg.exe indicating that a sensitive registry key was accessed, possibly as part of reconnaissance"}, {"ScreenshotName": "CC-2.G.2-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing reg)"}, {"ScreenshotName": "CC-2.H.1-2.png", "ScreenshotCaption": "Telemetry showing reg.exe with command-line arguments"}, {"ScreenshotName": "CC-2.G.2-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running reg) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing reg with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-2.H.1-1.png", "ScreenshotCaption": "Enrichment of reg.exe indicating that a sensitive registry key was accessed, possibly as part of reconnaissance"}, {"ScreenshotName": "CC-2.G.2-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing reg)"}, {"ScreenshotName": "CC-2.H.1-2.png", "ScreenshotCaption": "Telemetry showing reg.exe with command-line arguments"}, {"ScreenshotName": "CC-2.G.2-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running reg) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because the attacker queried a registry key that contains system policy configurations. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-2.H.1-1.png", "ScreenshotCaption": "Enrichment of reg.exe with Reg Execution alert (tagged with correct ATT&CK Technique, T1012 - Query Registry, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker queried a registry key that contains system policy configurations (Specific Behavior)"}, {"ScreenshotName": "FE-2.H.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about reg"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched reg.exe with an alert for Reg Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1012 - Query Registry) and Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-2.H.1-1.png", "ScreenshotCaption": "Enrichment of reg.exe with Reg Execution alert (tagged with correct ATT&CK Technique, T1012 - Query Registry, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker queried a registry key that contains system policy configurations (Specific Behavior)"}, {"ScreenshotName": "FE-2.H.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about reg"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing reg.exe with command-line arguments. The telemetry was tainted by the parent Script File Created alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-2.H.1-1.png", "ScreenshotCaption": "Telemetry showing reg.exe with command-line arguments (tainted by the parent Script File Created alert)"}], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched reg.exe with the correct ATT&CK Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-2.B.1-4.png", "ScreenshotCaption": "Process tree within trace detection containing cmd.exe executing the reg.exe (tainted by a parent alert on Resume Viewer.exe)"}, {"ScreenshotName": "MC-2.A.1-26.png", "ScreenshotCaption": "Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (Query Registry) and a suspicious indicator that the Registry was queried via execution of the reg.exe utility"}, {"ScreenshotName": "MC-2.A.1-99.png", "ScreenshotCaption": "Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery)."}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (Query Registry) and a suspicious indicator that the Registry was queried via execution of the reg.exe utility.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-2.B.1-4.png", "ScreenshotCaption": "Process tree within trace detection containing cmd.exe executing the reg.exe (tainted by a parent alert on Resume Viewer.exe)"}, {"ScreenshotName": "MC-2.A.1-26.png", "ScreenshotCaption": "Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (Query Registry) and a suspicious indicator that the Registry was queried via execution of the reg.exe utility"}, {"ScreenshotName": "MC-2.A.1-99.png", "ScreenshotCaption": "Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery)."}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing reg.exe with command-line arguments. The telemetry was tainted by a trace detection on Resume Viewer.exe.[MC2]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-2.B.1-4.png", "ScreenshotCaption": "Process tree within trace detection containing cmd.exe executing the reg.exe (tainted by a parent alert on Resume Viewer.exe)"}, {"ScreenshotName": "MC-2.A.1-26.png", "ScreenshotCaption": "Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (Query Registry) and a suspicious indicator that the Registry was queried via execution of the reg.exe utility"}, {"ScreenshotName": "MC-2.A.1-99.png", "ScreenshotCaption": "Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery)."}], "Footnotes": ["Though not visible in the image, MITRE confirmed that the relevant command was visible within the trace detection's process tree."]}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence of cmd.exe running reg.exe with command-line arguments (tainted by the alert on suspicious sequence of exploration activities from child processes of rundll32.exe).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-2.H.1-1.png", "ScreenshotCaption": "Telemetry showing execution sequence for reg.exe with command-line arguments"}, {"ScreenshotName": "MS-2.H.1-2.png", "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of discovery techniques (showing tainted reg.exe query command)"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched reg.exe executing with the correct ATT&CK Technique (Query Registry).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-2.H.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing reg with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.H.1-2.png", "ScreenshotCaption": "Enrichment of reg.exe executing with the correct ATT&CK Technique (Query Registry)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing reg with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-2.H.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing reg with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-2.H.1-2.png", "ScreenshotCaption": "Enrichment of reg.exe executing with the correct ATT&CK Technique (Query Registry)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing reg.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-02-4.png", "ScreenshotCaption": "Telemetry showing reg.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing reg.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-2.H.1-1.png", "ScreenshotCaption": "Telemetry showing reg.exe with command-line arguments (tainted by relationship to threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "3.A.1", "Procedure": "Cobalt Strike: Built-in UAC bypass token duplication capability executed to elevate process integrity level", "Techniques": [{"TechniqueId": "T1088", "TechniqueName": "Bypass User Account Control", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed an integrity level change for user Debbie from 8192 (0x2000/Medium) to 12288 (0x3000/High), which is indicative of bypassing UAC.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-3.A.1-1.png", "ScreenshotCaption": "Telemetry showing process integrity level change for Debbie from 8192 (0x2000/Medium) to 12288 (0x3000/High)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe running as medium integrity as user Debbie then another instance running later as high integrity as user Debbie. The telemetry is tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-3.A.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe running as medium integrity as user Debbie"}, {"ScreenshotName": "CR-3.A.1-20.png", "ScreenshotCaption": "Telemetry showing powershell.exe running as high integrity as user Debbie (tainted by a parent PowerShell alert)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a mismatch between the logon id (authentication id) of parent and child processes indicating that a different token was used. Though no screenshot for this data is available, this information can be used to trace back to the logon event for that logon id to display the process integrity level indicative of the elevated token used for bypass UAC. [EG7]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-03-06.png", "ScreenshotCaption": "Telemetry showing authentication (logon) ID mismatch between parent and child processes"}], "Footnotes": [" During the evaluation, Windows Defender was unknowingly reenabled. As a result, Bypass UAC was tested in a slightly modified method. The detection method Endgame exhibited would have been valid regardless."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched an unelevated svchost.exe spawning an elevated powershell.exe process with a tag indicating a possible UAC Bypass.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-3.A.1-2.png", "ScreenshotCaption": "Enrichment of an unelevated svchost.exe spawning an elevated powershell.exe process with a tag indicating a possible UAC Bypass."}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of powershell.exe as a high integrity process as SYSTEM with a token login ID previously associated with user Debbie. [FE6]", "Modifiers": ["Configuration Change"], "Screenshots": [{"ScreenshotName": "FE-3.A.1-3.png", "ScreenshotCaption": "Telemetry showing execution of powershell.exe running as SYSTEM with token login ID 0xfcf5fd"}, {"ScreenshotName": "FE-3.A.1-4.png", "ScreenshotCaption": "Telemetry showing group membership of token logon ID 0xfcf5fd, associated with user Debbie, which includes S-1-16-12288 (High Mandatory Level)"}], "Footnotes": [" A Configuration Change was made in order to collect Windows Event Logs for events 4627 (Group Membership Information) and 4673 (A privileged service was called)."]}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though an alert was triggered due to svchost.exe creating the process powershell.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CT-3.A.1-1.png", "ScreenshotCaption": "Alert for PowerShell process creation (does not count as a detection)"}, {"ScreenshotName": "CT-3.A.1-2.png", "ScreenshotCaption": "Relationships view of alert showing svchost.exe spawning powershell.exe tree (including encoded PowerShell). Red dots indicate malicious behavior and orange indicate suspicious behavior (based off impact value) (does not count as a detection)"}], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for a possible UAC bypass. The alert was tagged with the correct ATT&CK Technique (Bypass User Account Control) and Tactics (Defense Evasion, Privilege Escalation).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-3.A.1-3.png", "ScreenshotCaption": "Specific Behavior alert for a possible UAC bypass, tagged with the correct ATT&CK Technique (Bypass User Account Control) and Tactics (Defense Evasion, Privilege Escalation)"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed rundll32.exe as a medium integrity process as user Debbie and subsequent execution of powershell.exe as a high integrity process as SYSTEM as part of the UAC bypass (tainted by alert on a suspicious PowerShell command-line generated for the svchost.exe invocation of powershell.exe with an encoded script).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-3.C.1-2.png", "ScreenshotCaption": "Alert for 'Suspicious PowerShell command-line' showing tainted association via a process tree containing svchost.exe and elevated powershell.exe"}, {"ScreenshotName": "MS-3.A.1-1.png", "ScreenshotCaption": "Telemetry showing rundll32.exe running as medium integrity as user Debbie"}, {"ScreenshotName": "MS-3.A.1-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe running as high integrity as SYSTEM"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a process integrity level change from parent rundll32.exe (medium / 8192) to child powershell.exe (high / 12288), both running as user Debbie.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-3.A.1-3.png", "ScreenshotCaption": "Telemetry showing process integrity level change from parent rundll32.exe (medium) to child powershell.exe (high), both running as user Debbie"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though an alert was created for PowerShell with the -enc command-line argument.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-03-2.png", "ScreenshotCaption": "Alert for powershell.exe execution with encoded command-line arguments (does not count as a detection)"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed process integrity levels changing from medium to high.[SO11]", "Modifiers": [], "Screenshots": [], "Footnotes": ["Detect was verified, but a screenshot for this data was unavailable. Integrity level values are based upon how the capability tracks integrity levels and not how Windows tracks them causing a difference in values."]}]}]}]}, {"Substep": "3.A.1", "Procedure": "Cobalt Strike: Built-in UAC bypass token duplication capability executed to modify current process token", "Techniques": [{"TechniqueId": "T1134", "TechniqueName": "Access Token Manipulation", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed svchost.exe, with the seclogon command-line argument, performing activity related to token manipulation.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-3.A.1-6.png", "ScreenshotCaption": "Telemetry showing svchost.exe command line arguments, specifically seclogon"}, {"ScreenshotName": "CB-3.A.1-5.png", "ScreenshotCaption": "Telemetry showing svchost.exe activity related to token manipulation"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though an alert was generated for malicious code injection into PowerShell. Telemetry also showed that bypassuactoken.x64.dll was loaded.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-3.C.1-10.png", "ScreenshotCaption": "Alert for malicious code injection into PowerShell (does not count as a detection)"}, {"ScreenshotName": "CR-3.A.1-10.png", "ScreenshotCaption": "Telemetry showing the bypassuactoken.x64.dll was loaded (does not count as a detection)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a svchost.exe seclogon event for a token logon id (authentication id) later used by a new powershell.exe process, highlighting token manipulation via a mismatch in ids between parent and child process tokens. [EG7]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-03-7.png", "ScreenshotCaption": "Telemetry showing svhost.exe seclogon event for token login id 0x5f997f7 (100243447)"}, {"ScreenshotName": "EG-03-06.png", "ScreenshotCaption": "Telemetry showing powershell.exe spawned with token authentication id 100243447"}], "Footnotes": [" During the evaluation, Windows Defender was unknowingly reenabled. As a result, Bypass UAC was tested in a slightly modified method. The detection method Endgame exhibited would have been valid regardless."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed svchost.exe executed with the seclogon command-line argument and a subsequent logon event for user Debbie with an elevated token, indicating token manipulation.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-3.A.1-3.png", "ScreenshotCaption": "Telemetry showing svchost.exe executed with the seclogon command-line argument"}, {"ScreenshotName": "CC-3.A.1-1.png", "ScreenshotCaption": "Telemetry showing logon event for user Debbie with an elevated token"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a svchost.exe seclogon event for a token logon ID later used by a process whose group membership indicated high integrity. [FE6]", "Modifiers": ["Configuration Change"], "Screenshots": [{"ScreenshotName": "FE-3.A.1-3.png", "ScreenshotCaption": "Telemetry showing svchost.exe seclogon event for token login ID 0xfcf5fd"}, {"ScreenshotName": "FE-3.A.1-4.png", "ScreenshotCaption": "Telemetry showing group membership of token logon ID 0xfcf5fd, which includes S-1-16-12288 (High Mandatory Level)"}], "Footnotes": [" A Configuration Change was made in order to collect Windows Event Logs for events 4627 (Group Membership Information) and 4673 (A privileged service was called)."]}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though an alert was triggered due to svchost.exe creating the process powershell.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CT-3.A.1-1.png", "ScreenshotCaption": "Alert for PowerShell process creation (does not count as a detection)"}, {"ScreenshotName": "CT-3.A.1-2.png", "ScreenshotCaption": "Relationships view of alert showing svchost.exe spawning powershell.exe tree (including encoded PowerShell). Red dots indicate malicious behavior and orange indicate suspicious behavior (based off impact value) (does not count as a detection)"}], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed svchost.exe, with the seclogon command-line argument as well as a New Credentials logon event for user Debbie, indicating token manipulation.", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "MC-3.A.1-1.png", "ScreenshotCaption": "Telemetry showing svchost.exe, with the seclogon command-line argument"}, {"ScreenshotName": "MC-3.A.1-2.png", "ScreenshotCaption": "Telemetry showing a New Credentials logon event for user Debbie"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed svchost.exe executed with the seclogon command-line argument and a subsequent elevated powershell.exe process, indicating token manipulation (tainted by parent alert on a suspicious PowerShell command-line generated for the svchost.exe invocation of powershell.exe with an encoded script).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-3.A.1-2.png", "ScreenshotCaption": "Telemetry showing svchost.exe execution with seclogon command-line argument then subsequent powershell.exe"}, {"ScreenshotName": "MS-3.C.1-2.png", "ScreenshotCaption": "Alert for 'Suspicious PowerShell command-line' showing tainted association via a process tree containing svchost.exe and elevated powershell.exe"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed svchost.exe executed with the seclogon command-line argument and a subsequent logon event with an elevated token and new logon ID, indicating token manipulation.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-3.A.1-1.png", "ScreenshotCaption": "Telemetry showing svchost.exe executed with the seclogon command-line argument"}, {"ScreenshotName": "PA-3.A.1-2.png", "ScreenshotCaption": "Telemetry showing logon event with an elevated token and new logon ID"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}]}, {"Substep": "3.B.1", "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "Techniques": [{"TechniqueId": "T1057", "TechniqueName": "Process Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the execution of a specific API call as process enumeration and suspicious activity. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine. [PA7]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-3.B.1-1.png", "ScreenshotCaption": "Enrichment of the execution of a specific API call as process enumeration and suspicious activity (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}], "Footnotes": ["The process tree showing taintedness is visible within the same UI but did not fit within the current frame."]}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}]}, {"Substep": "3.C.1", "Procedure": "Cobalt Strike: Built-in process injection capability executed to inject callback into cmd.exe", "Techniques": [{"TechniqueId": "T1055", "TechniqueName": "Process Injection", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated that was mapped to correct ATT&CK Technique (Process Injection).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-3.C.1-2.png", "ScreenshotCaption": "Telemetry showing open handles and thread injection into cmd.exe"}, {"ScreenshotName": "CB-3.C.1-3.png", "ScreenshotCaption": "Telemetry showing CreateRemoteThread API call used for thread injection into cmd.exe"}, {"ScreenshotName": "CB-3.C.1-1.png", "ScreenshotCaption": "Specific Behavior alert mapped to correct ATT&CK Technique (T1055 - Process Injection)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed \"crossproc\" events indicative of Process Injection into cmd.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-3.C.1-2.png", "ScreenshotCaption": "Telemetry showing open handles and thread injection into cmd.exe"}, {"ScreenshotName": "CB-3.C.1-3.png", "ScreenshotCaption": "Telemetry showing CreateRemoteThread API call used for thread injection into cmd.exe"}, {"ScreenshotName": "CB-3.C.1-1.png", "ScreenshotCaption": "Specific Behavior alert mapped to correct ATT&CK Technique (T1055 - Process Injection)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated showing that PowerShell created a thread into a remote process. The alert identified the correct ATT&CK Technique (Process Injection) and Tactic (Defense Evasion). The process tree view showed the alert as tainted by parent svchost.exe and powershell.exe detections.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-3.C.1-1.png", "ScreenshotCaption": "Specific Behavior Process Injection alert mapped to correct ATT&CK Technique (Process Injection) and Tactic (Defense Evasion) as well as OverWatch General Behavior alert identifying behavior as suspicious"}, {"ScreenshotName": "CS-3.C.1-2.png", "ScreenshotCaption": "Telemetry showing process tree view of Process Injection Specific Behavior alert and OverWatch General Behavior alert tainted by parent detections (orange line indicates medium severity)"}], "Footnotes": []}, {"DetectionType": "General Behavior", "DetectionNote": "OverWatch also generated a General Behavior alert identifying the injection as suspicious. The process tree view showed the alert as tainted by previous svchost.exe and powershell.exe detections.[CS1]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "CS-3.C.1-1.png", "ScreenshotCaption": "Specific Behavior Process Injection alert mapped to correct ATT&CK Technique (Process Injection) and Tactic (Defense Evasion) as well as OverWatch General Behavior alert identifying behavior as suspicious"}, {"ScreenshotName": "CS-3.C.1-2.png", "ScreenshotCaption": "Telemetry showing process tree view of Process Injection Specific Behavior alert and OverWatch General Behavior alert tainted by parent detections (orange line indicates medium severity)"}], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry associated with the alert would show thread creation in a separate view.[CS8]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-3.C.1-1.png", "ScreenshotCaption": "Specific Behavior Process Injection alert mapped to correct ATT&CK Technique (Process Injection) and Tactic (Defense Evasion) as well as OverWatch General Behavior alert identifying behavior as suspicious"}, {"ScreenshotName": "CS-3.C.1-2.png", "ScreenshotCaption": "Telemetry showing process tree view of Process Injection Specific Behavior alert and OverWatch General Behavior alert tainted by parent detections (orange line indicates medium severity)"}], "Footnotes": ["For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not specifically taken in this instance."]}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for process injection from powershell.exe into cmd.exe (Anonymous RWX). The alert is tagged with the correct ATT&CK Tactic (Defense Evasion) and Technique (Process Injection). The alert is tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-3.C.1-10.png", "ScreenshotCaption": "Specific Behavior alert for powershell.exe injecting into cmd.exe"}, {"ScreenshotName": "CR-3.C.1-100.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell injection into cmd.exe mapped to ATT&CK Tactic (Defense Evasion) and Technique (Process Injection) (tainted by a parent PowerShell alert)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for process injection into cmd.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-03-2.png", "ScreenshotCaption": "Specific Behavior alert for process injection into cmd.exe"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for PowerShell opening a handle to a system process with access rights typical for a known PowerShell injection pattern, identified as a sign of code injection.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-3.C.1-1.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell opening a handle to a system process with access rights typical for a known PowerShell injection pattern, identified as a sign of code injection"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified a process injection from PowerShell.exe to cmd.exe. [FE5][FE11]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-3.C.1-1.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report identifying a process injection from PowerShell.exe to cmd.exe (Specific Behavior)"}, {"ScreenshotName": "FE-3.C.1-2.png", "ScreenshotCaption": "Continued excerpt from the Managed Defense Report showing the artifact evidence of a process injection from PowerShell.exe to cmd.exe"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident.", " The vendor stated the process injection detection capability is a HX plugin that is only available within the Managed Defense Service, and the data is reported to  a separate cloud server which is not accessible to customers at this time."]}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated based on DLL injection for powershell.exe injecting into cmd.exe. The detection was labeled with Process Hijacking and Privilege Escalation and tainted by the parent \"Powershell process created\" alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-3.C.1-1.png", "ScreenshotCaption": "Specific Behavior alert for DLL injection detection labeled with Process Hijacking and Privilege Escalation (tainted by the parent \\\"Powershell process created\\\" alert)"}], "Footnotes": ["The vendor noted all DLL injection conditions are labeled with Privilege Escalation. The vendor also noted Privilege Escalation is one of ten \"Capabilities\" that are part of the taxonomy."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for\u00a0a process injection from PowerShell into cmd.exe based on both connecting to a named pipe. The alert was tagged with the correct ATT&CK Technique (Process Injection) and Tactics (Defense Evasion, Privilege Escalation).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-3.C.1-1.png", "ScreenshotCaption": "Specific Behavior alert \u00a0for\u00a0a process injection from PowerShell into cmd.exe based on both connecting to a named pipe, tagged with the correct ATT&CK Technique (Process Injection) and Tactics (Defense Evasion, Privilege Escalation)"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for process injection.[MS5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "MS-3.C.1-1.png", "ScreenshotCaption": "Enrichment of powershell.exe injecting into cmd.exe"}, {"ScreenshotName": "MS-3.C.1-2.png", "ScreenshotCaption": "Alert for 'Suspicious PowerShell command-line' showing tainted association via a process tree containing svchost.exe and elevated powershell.exe (subsequent powershell.exe is the injecting process)"}, {"ScreenshotName": "MS-3.C.1-3.png", "ScreenshotCaption": "Specific Behavior alert showing powershell.exe process injection"}, {"ScreenshotName": "MS-3.C.1-4.png", "ScreenshotCaption": "Telemetry showing process injection activity audited by Exploit Guard"}], "Footnotes": [" Process Injection attempt was audited by Exploit Guard. Vendor states that the Exploit Guard audit events demonstrate that execution would have been prevented if Export Address Table (EAF) was enabled in blocking mode."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched data showing powershell.exe injecting into cmd.exe (tainted by alert on a suspicious PowerShell command-line generated for the svchost.exe invocation of powershell.exe with an encoded script).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-3.C.1-1.png", "ScreenshotCaption": "Enrichment of powershell.exe injecting into cmd.exe"}, {"ScreenshotName": "MS-3.C.1-2.png", "ScreenshotCaption": "Alert for 'Suspicious PowerShell command-line' showing tainted association via a process tree containing svchost.exe and elevated powershell.exe (subsequent powershell.exe is the injecting process)"}, {"ScreenshotName": "MS-3.C.1-3.png", "ScreenshotCaption": "Specific Behavior alert showing powershell.exe process injection"}, {"ScreenshotName": "MS-3.C.1-4.png", "ScreenshotCaption": "Telemetry showing process injection activity audited by Exploit Guard"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for PowerShell injecting shellcode. The alert was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine. [PA7]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-3.C.1-1.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell injecting shellcode (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}], "Footnotes": ["The process tree showing taintedness is visible within the same UI but did not fit within the current frame."]}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe creating a remote thread into cmd.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-03-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe creating a remote thread into cmd.exe"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe allocating memory, writing to memory space, and invoking a thread into cmd.exe (tainted by association with parent alert for powershell.exe process executed by svchost.exe).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-3.C.1-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe injecting into cmd.exe (Group ID tainted this event but was not shown in this view)"}], "Footnotes": []}]}]}]}, {"Substep": "4.A.1", "Procedure": "Cobalt Strike: 'net group \"Domain Controllers\" -domain' via cmd", "Techniques": [{"TechniqueId": "T1018", "TechniqueName": "Remote System Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with a related ATT&CK technique (Account Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-4.A.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-4.A.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK technique (Account Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed cmd.exe executing net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-4.A.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-4.A.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK technique (Account Discovery)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "OverWatch also generated a General Behavior alert identifying cmd.exe executing net as suspicious.[CS1]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating net group was a reconnaissance command (General Behavior)"}, {"ScreenshotName": "CS-4.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery)"}, {"ScreenshotName": "CS-4.A.1-2.png", "ScreenshotCaption": "Additional process tree view showing net.exe enrichment"}, {"ScreenshotName": "CS-4.A.1-3.png", "ScreenshotCaption": "OverWatch General Behavior alert for net group"}], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team also sent an email indicating a General Behavior was observed because net group was one of the reconnaissance commands performed.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating net group was a reconnaissance command (General Behavior)"}, {"ScreenshotName": "CS-4.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery)"}, {"ScreenshotName": "CS-4.A.1-2.png", "ScreenshotCaption": "Additional process tree view showing net.exe enrichment"}, {"ScreenshotName": "CS-4.A.1-3.png", "ScreenshotCaption": "OverWatch General Behavior alert for net group"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability showed net.exe executing with command-line arguments and enriched the command with a related ATT&CK Technique (Account Discovery) and the correct Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating net group was a reconnaissance command (General Behavior)"}, {"ScreenshotName": "CS-4.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery)"}, {"ScreenshotName": "CS-4.A.1-2.png", "ScreenshotCaption": "Additional process tree view showing net.exe enrichment"}, {"ScreenshotName": "CS-4.A.1-3.png", "ScreenshotCaption": "OverWatch General Behavior alert for net group"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the enrichment showed net.exe executing with command-line arguments, and would be available in a separate view.[CS8]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating net group was a reconnaissance command (General Behavior)"}, {"ScreenshotName": "CS-4.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery)"}, {"ScreenshotName": "CS-4.A.1-2.png", "ScreenshotCaption": "Additional process tree view showing net.exe enrichment"}, {"ScreenshotName": "CS-4.A.1-3.png", "ScreenshotCaption": "OverWatch General Behavior alert for net group"}], "Footnotes": ["For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not specifically taken in this instance."]}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for net.exe executing as part of a suspicious execution chain related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was tainted by a parent Injected Shellcode alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-4.A.1-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing as part of a suspicious execution chain"}, {"ScreenshotName": "CR-4.A.1-10.png", "ScreenshotCaption": "Process tree showing alerted net.exe executing (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-4.A.1-101.png", "ScreenshotCaption": "Telemetry showing net.exe executing with command-line arguments"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-4.A.1-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing as part of a suspicious execution chain"}, {"ScreenshotName": "CR-4.A.1-10.png", "ScreenshotCaption": "Process tree showing alerted net.exe executing (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-4.A.1-101.png", "ScreenshotCaption": "Telemetry showing net.exe executing with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the net command with a related ATT&CK Technique (T1069 - Permission Groups Discovery) and the correct Tactic (Discovery). [EG11]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "EG-04-1.png", "ScreenshotCaption": "Telemetry from event tree showing net with command-line arguments"}, {"ScreenshotName": "EG-04-2.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net with related ATT&CK Technique (T1069 - Permission Groups Discovery) and correct Tactic (Discovery)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the process creation of net group with command-line arguments. [EG11]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-04-1.png", "ScreenshotCaption": "Telemetry from event tree showing net with command-line arguments"}, {"ScreenshotName": "EG-04-2.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net with related ATT&CK Technique (T1069 - Permission Groups Discovery) and correct Tactic (Discovery)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe indicating that it was run with commands commonly used for reconnaissance.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-4.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe indicating that it was run with commands commonly used for reconnaissance"}, {"ScreenshotName": "CC-4.A.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-4.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe indicating that it was run with commands commonly used for reconnaissance"}, {"ScreenshotName": "CC-4.A.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it indicated net group was one of the reconnaissance commands performed. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-4.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Group Command Execution alert (tagged with related ATT&CK Technique, T1069 - Permission Groups Discovery, and correct Tactic, Discovery)"}, {"ScreenshotName": "FE-2.A.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net group was a reconnaissance command (General Behavior)"}, {"ScreenshotName": "FE-4.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about net group"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with an alert for Net Group Command Execution (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1069 - Permission Groups Discovery) and the correct Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-4.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Group Command Execution alert (tagged with related ATT&CK Technique, T1069 - Permission Groups Discovery, and correct Tactic, Discovery)"}, {"ScreenshotName": "FE-2.A.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net group was a reconnaissance command (General Behavior)"}, {"ScreenshotName": "FE-4.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about net group"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability showed cmd.exe executing net.exe with command-line arguments and enriched the command with the condition Net Group Reconnaissance Command. The enrichment was tainted by the parent \\\"Powershell Execution Policy ByPass command ran\\\" alert.[CT4]", "Modifiers": ["Configuration Change", "Tainted"], "Screenshots": [{"ScreenshotName": "CT-4.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with condition Net Group Reconnaissance Command, (tainted by the parent \\\"Powershell Execution Policy ByPass command ran\\\" alert)"}], "Footnotes": [" At least one condition was added to the capability's detection after the start of the evaluation, so this detection is identified as a configuration change."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with the correct Tactic (Discovery) and Technique (Remote System Discovery) and a suspicious indicator that the net utility obtained information about domain computers and controllers.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-4.A.1-10.png", "ScreenshotCaption": "Process tree within trace detection showing cmd.exe executing net.exe (tainted by a parent alert on cmd.exe)"}, {"ScreenshotName": "MC-4.A.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with the correct Tactic (Discovery) and Technique (Remote System Discovery) and a suspicious indicator that the net utility obtained information about domain computers and controllers"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by a trace detection on cmd.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-4.A.1-10.png", "ScreenshotCaption": "Process tree within trace detection showing cmd.exe executing net.exe (tainted by a parent alert on cmd.exe)"}, {"ScreenshotName": "MC-4.A.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with the correct Tactic (Discovery) and Technique (Remote System Discovery) and a suspicious indicator that the net utility obtained information about domain computers and controllers"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence of cmd.exe executing net.exe with command-line arguments (tainted by the alert on suspicious process injection alert association with rundll32.exe).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-4.A.1-1.png", "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"}, {"ScreenshotName": "MS-4.A.1-2.png", "ScreenshotCaption": "Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific net.exe command not shown)"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched cmd.exe executing net with a related ATT&CK Technique (System Network Connections Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-4.A.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net with command-line arguments"}, {"ScreenshotName": "PA-4.A.1-2.png", "ScreenshotCaption": "Enrichment of the execution of net.exe as the execution of an enumeration command using net or net1"}, {"ScreenshotName": "PA-4.A.1-3.png", "ScreenshotCaption": "Enrichment of the execution of net.exe as the execution of an enumeration command"}, {"ScreenshotName": "PA-4.A.1-4.png", "ScreenshotCaption": "Enrichment of cmd.exe executing net with a related ATT&CK Technique (System Network Connections Discovery)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the execution of net.exe as the execution of an enumeration command.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-4.A.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net with command-line arguments"}, {"ScreenshotName": "PA-4.A.1-2.png", "ScreenshotCaption": "Enrichment of the execution of net.exe as the execution of an enumeration command using net or net1"}, {"ScreenshotName": "PA-4.A.1-3.png", "ScreenshotCaption": "Enrichment of the execution of net.exe as the execution of an enumeration command"}, {"ScreenshotName": "PA-4.A.1-4.png", "ScreenshotCaption": "Enrichment of cmd.exe executing net with a related ATT&CK Technique (System Network Connections Discovery)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the execution of net.exe as the execution of an enumeration command using net or net1.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-4.A.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net with command-line arguments"}, {"ScreenshotName": "PA-4.A.1-2.png", "ScreenshotCaption": "Enrichment of the execution of net.exe as the execution of an enumeration command using net or net1"}, {"ScreenshotName": "PA-4.A.1-3.png", "ScreenshotCaption": "Enrichment of the execution of net.exe as the execution of an enumeration command"}, {"ScreenshotName": "PA-4.A.1-4.png", "ScreenshotCaption": "Enrichment of cmd.exe executing net with a related ATT&CK Technique (System Network Connections Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-4.A.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net with command-line arguments"}, {"ScreenshotName": "PA-4.A.1-2.png", "ScreenshotCaption": "Enrichment of the execution of net.exe as the execution of an enumeration command using net or net1"}, {"ScreenshotName": "PA-4.A.1-3.png", "ScreenshotCaption": "Enrichment of the execution of net.exe as the execution of an enumeration command"}, {"ScreenshotName": "PA-4.A.1-4.png", "ScreenshotCaption": "Enrichment of cmd.exe executing net with a related ATT&CK Technique (System Network Connections Discovery)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe running net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-04-1.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by activity seen during the privilege escalation step because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-4.A.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "4.A.2", "Procedure": "Cobalt Strike: 'net group \"Domain Computers\" -domain' via cmd", "Techniques": [{"TechniqueId": "T1018", "TechniqueName": "Remote System Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with a related ATT&CK technique (Account Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-4.A.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-4.A.2-2.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK technique (Account Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed cmd.exe executing net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-4.A.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-4.A.2-2.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK technique (Account Discovery)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team also sent an email indicating a General Behavior was observed because net group was one of the reconnaissance commands performed.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating net group was a reconnaissance command (General Behavior)"}, {"ScreenshotName": "CS-4.A.2-1.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery)"}, {"ScreenshotName": "CS-4.A.2-2.png", "ScreenshotCaption": "Additional process tree view showing net.exe enrichment"}, {"ScreenshotName": "CS-4.A.2-3.png", "ScreenshotCaption": "OverWatch General Behavior alert for net group"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team identified net group as suspicious with a General Behavior alert.[CS1]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating net group was a reconnaissance command (General Behavior)"}, {"ScreenshotName": "CS-4.A.2-1.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery)"}, {"ScreenshotName": "CS-4.A.2-2.png", "ScreenshotCaption": "Additional process tree view showing net.exe enrichment"}, {"ScreenshotName": "CS-4.A.2-3.png", "ScreenshotCaption": "OverWatch General Behavior alert for net group"}], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability showed net.exe executing with command-line arguments and enriched the command with a related ATT&CK Technique (Account Discovery) and the correct Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating net group was a reconnaissance command (General Behavior)"}, {"ScreenshotName": "CS-4.A.2-1.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery)"}, {"ScreenshotName": "CS-4.A.2-2.png", "ScreenshotCaption": "Additional process tree view showing net.exe enrichment"}, {"ScreenshotName": "CS-4.A.2-3.png", "ScreenshotCaption": "OverWatch General Behavior alert for net group"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the enrichment showed net.exe with command-line arguments, and would be available in a separate view.[CS8]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating net group was a reconnaissance command (General Behavior)"}, {"ScreenshotName": "CS-4.A.2-1.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery)"}, {"ScreenshotName": "CS-4.A.2-2.png", "ScreenshotCaption": "Additional process tree view showing net.exe enrichment"}, {"ScreenshotName": "CS-4.A.2-3.png", "ScreenshotCaption": "OverWatch General Behavior alert for net group"}], "Footnotes": ["For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not specifically taken in this instance."]}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for net.exe executing as part of a suspicious execution chain related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was also tagged with the correct ATT&CK Tactic (Discovery) and Technique (Remote System Discovery). The alert was tainted by a parent Injected Shellcode alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-4.A.1-101.png", "ScreenshotCaption": "Telemetry showing net.exe executing with command-line arguments"}, {"ScreenshotName": "CR-4.A.2-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing as part of a suspicious execution chain"}, {"ScreenshotName": "CR-4.A.2-10.png", "ScreenshotCaption": "Process tree showing alerted net.exe executing (tainted by a parent Injected Shellcode alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-4.A.1-101.png", "ScreenshotCaption": "Telemetry showing net.exe executing with command-line arguments"}, {"ScreenshotName": "CR-4.A.2-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing as part of a suspicious execution chain"}, {"ScreenshotName": "CR-4.A.2-10.png", "ScreenshotCaption": "Process tree showing alerted net.exe executing (tainted by a parent Injected Shellcode alert)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the net command with a related ATT&CK Technique (T1069 - Permission Groups Discovery) and the correct Tactic (Discovery). [EG11]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "EG-04-1.png", "ScreenshotCaption": "Telemetry from event tree showing net with command-line arguments"}, {"ScreenshotName": "EG-04-2.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net group command mapped to related ATT&CK Technique (T1069 - Permission Groups Discovery) and\u00a0correct Tactic (Discovery)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the process creation of net group with command-line arguments. [EG11]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-04-1.png", "ScreenshotCaption": "Telemetry from event tree showing net with command-line arguments"}, {"ScreenshotName": "EG-04-2.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net group command mapped to related ATT&CK Technique (T1069 - Permission Groups Discovery) and\u00a0correct Tactic (Discovery)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe indicating that it was run with commands commonly used for reconnaissance.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-4.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe indicating that it was run with commands commonly used for reconnaissance"}, {"ScreenshotName": "CC-4.A.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-4.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe indicating that it was run with commands commonly used for reconnaissance"}, {"ScreenshotName": "CC-4.A.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it indicated net group was one of the reconnaissance commands performed. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-2.A.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net group was a reconnaissance command (General Behavior)"}, {"ScreenshotName": "FE-4.A.2-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Group Command Execution alert (tagged with related ATT&CK Technique, T1069 - Permission Groups Discovery, and correct Tactic, Discovery)"}, {"ScreenshotName": "FE-4.A.2-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about net group"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with an alert for Net Group Command Execution (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1069 - Permission Groups Discovery) and the correct Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-2.A.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net group was a reconnaissance command (General Behavior)"}, {"ScreenshotName": "FE-4.A.2-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Group Command Execution alert (tagged with related ATT&CK Technique, T1069 - Permission Groups Discovery, and correct Tactic, Discovery)"}, {"ScreenshotName": "FE-4.A.2-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about net group"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability showed cmd.exe executing net.exe with command-line arguments and enriched the command with the condition Net Group Reconnaissance Command. The enrichment was tainted by the parent \"Powershell Execution Policy ByPass command ran\" alert.", "Modifiers": ["Configuration Change", "Tainted"], "Screenshots": [{"ScreenshotName": "CT-4.A.2-1.png", "ScreenshotCaption": "Enrichment of net.exe with condition Net Group Reconnaissance Command, (tainted by the parent \\\"Powershell Execution Policy ByPass command ran\\\" alert)"}], "Footnotes": ["The condition contributing to Enrichment was added to the capability's detection after the start of the evaluation, so this detection is identified as a configuration change. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with the correct Tactic (Discovery) and Technique (Remote System Discovery) and a suspicious indicator that the net utility obtained information about domain computers and controllers.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-4.A.1-10.png", "ScreenshotCaption": "Process tree within trace detection showing cmd.exe executing net.exe (tainted by a parent alert on cmd.exe)"}, {"ScreenshotName": "MC-4.A.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with the correct Tactic (Discovery) and Technique (Remote System Discovery) and a suspicious indicator that the net utility obtained information about domain computers and controllers"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by a trace detection on cmd.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-4.A.1-10.png", "ScreenshotCaption": "Process tree within trace detection showing cmd.exe executing net.exe (tainted by a parent alert on cmd.exe)"}, {"ScreenshotName": "MC-4.A.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with the correct Tactic (Discovery) and Technique (Remote System Discovery) and a suspicious indicator that the net utility obtained information about domain computers and controllers"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence of cmd.exe executing net.exe with command-line arguments (tainted by the alert on suspicious process injection alert association with rundll32.exe).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-4.A.1-2.png", "ScreenshotCaption": "Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific net.exe command not shown)"}, {"ScreenshotName": "MS-4.A.2-1.png", "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the execution of net.exe as the execution of an enumeration command using net or net1.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-4.A.2-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net with command-line arguments"}, {"ScreenshotName": "PA-4.A.2-2.png", "ScreenshotCaption": "Enrichment of the execution of net.exe as the execution of an enumeration command using net or net1"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-4.A.2-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net with command-line arguments"}, {"ScreenshotName": "PA-4.A.2-2.png", "ScreenshotCaption": "Enrichment of the execution of net.exe as the execution of an enumeration command using net or net1"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe running net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-04-1.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by activity seen during the privilege escalation step because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-4.A.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)"}, {"ScreenshotName": "S1-4.A.1-3.png", "ScreenshotCaption": "Event tree showing net.exe (tainted by launch from process lineage previously identified as malicious)"}], "Footnotes": []}]}]}]}, {"Substep": "4.B.1", "Procedure": "Cobalt Strike: 'netsh advfirewall show allprofiles' via cmd", "Techniques": [{"TechniqueId": "T1016", "TechniqueName": "System Network Configuration Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched netsh.exe with a related ATT&CK technique (T1063 - Security Software Discovery) and a tag for Potential Windows Firewall Rule Recon.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-4.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing netsh.exe with command-line arguments"}, {"ScreenshotName": "CB-4.B.1-2.png", "ScreenshotCaption": "Enrichment of netsh.exe with related ATT&CK technique (T1063 - Security Software Discovery) and tag for Potential Windows Firewall Rule Recon"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed cmd.exe executing netsh.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-4.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing netsh.exe with command-line arguments"}, {"ScreenshotName": "CB-4.B.1-2.png", "ScreenshotCaption": "Enrichment of netsh.exe with related ATT&CK technique (T1063 - Security Software Discovery) and tag for Potential Windows Firewall Rule Recon"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "OverWatch generated a General Behavior alert indicating the execution of netsh by cmd.exe was suspicious.[CS1]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-4.B.1-1.png", "ScreenshotCaption": "OverWatch General Behavior alert indicating netsh execution by cmd.exe was suspicious"}, {"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating netsh was a reconnaissance command (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team also sent an email indicating a General Behavior was observed because netsh was one of the reconnaissance commands performed.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-4.B.1-1.png", "ScreenshotCaption": "OverWatch General Behavior alert indicating netsh execution by cmd.exe was suspicious"}, {"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating netsh was a reconnaissance command (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the OverWatch alert showed netsh executing with command-line arguments, and would be available in a separate view.[CS2]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-4.B.1-1.png", "ScreenshotCaption": "OverWatch General Behavior alert indicating netsh execution by cmd.exe was suspicious"}, {"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating netsh was a reconnaissance command (General Behavior)"}], "Footnotes": ["For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched netsh.exe executing with the correct ATT&CK Tactic (Discovery) and a related Technique (Security Software Discovery). The data was tainted by a parent Injected Shellcode alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-4.B.1-10.png", "ScreenshotCaption": "Enrichment of netsh.exe executing with correct ATT&CK Tactic (Discovery) and related Technique (Security Software Discovery) (tainted by a parent Injected Shellcode alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments. command-line arguments. [CR5]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-4.B.1-10.png", "ScreenshotCaption": "Enrichment of netsh.exe executing with correct ATT&CK Tactic (Discovery) and related Technique (Security Software Discovery) (tainted by a parent Injected Shellcode alert)"}], "Footnotes": [" The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the process creation of netsh with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-04-1.png", "ScreenshotCaption": "Telemetry from event tree showing netsh with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing netsh.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-4.B.1-2.png", "ScreenshotCaption": "Telemetry showing netsh.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that netsh was a reconnaissance command used to obtain network configuration and the configuration profile of the Windows Firewall. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-4.B.1-1.png", "ScreenshotCaption": "Enrichment of netsh.exe with Netsh Execution alert (tagged with related ATT&CK Technique, T1063 - Security Software Discovery, and correct Tactic, Discovery)"}, {"ScreenshotName": "FE-2.A.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating netsh was used to obtain network configuration and the configuration profile of the Windows Firewall (Specific Behavior)"}, {"ScreenshotName": "FE-4.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about netsh"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched netsh.exe with an alert for Netsh Execution (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1063 - Security Software Discovery) and the correct Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-4.B.1-1.png", "ScreenshotCaption": "Enrichment of netsh.exe with Netsh Execution alert (tagged with related ATT&CK Technique, T1063 - Security Software Discovery, and correct Tactic, Discovery)"}, {"ScreenshotName": "FE-2.A.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating netsh was used to obtain network configuration and the configuration profile of the Windows Firewall (Specific Behavior)"}, {"ScreenshotName": "FE-4.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about netsh"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing netsh.exe with command-line arguments. The telemetry was tainted by the parent \"Powershell Execution Policy ByPass command ran\" alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-4.B.1-1.png", "ScreenshotCaption": "Telemetry showing netsh.exe with command-line arguments (tainted by the parent \\\"Powershell Execution Policy ByPass command ran\\\" alert)"}], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched netsh.exe with the correct Tactic (Discovery) and Technique (System Network Configuration Discovery) and a suspicious indicator that the netsh utility manipulated firewall rules.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-4.A.1-10.png", "ScreenshotCaption": "Process tree within trace detection showing cmd.exe executing netsh.exe (tainted by a parent alert on cmd.exe)"}, {"ScreenshotName": "MC-4.A.1-2.png", "ScreenshotCaption": "Enrichment of netsh.exe with the correct Tactic (Discovery) and Technique (System Network Configuration Discovery) and a suspicious indicator that the netsh utility manipulated firewall rules"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing netsh.exe with command-line arguments. The telemetry was tainted by a trace detection on cmd.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-4.A.1-10.png", "ScreenshotCaption": "Process tree within trace detection showing cmd.exe executing netsh.exe (tainted by a parent alert on cmd.exe)"}, {"ScreenshotName": "MC-4.A.1-2.png", "ScreenshotCaption": "Enrichment of netsh.exe with the correct Tactic (Discovery) and Technique (System Network Configuration Discovery) and a suspicious indicator that the netsh utility manipulated firewall rules"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence of cmd.exe executing netsh.exe with command-line arguments (tainted by the alert on suspicious process injection alert association with rundll32.exe).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-4.B.1-1.png", "ScreenshotCaption": "Telemetry showing execution sequence for netsh.exe with command-line arguments"}, {"ScreenshotName": "MS-4.A.1-2.png", "ScreenshotCaption": "Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific netsh.exe command not shown)"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched netsh.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-4.B.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing netsh with command-line arguments"}, {"ScreenshotName": "PA-4.B.1-2.png", "ScreenshotCaption": "Enrichment of netsh.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing netsh with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-4.B.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing netsh with command-line arguments"}, {"ScreenshotName": "PA-4.B.1-2.png", "ScreenshotCaption": "Enrichment of netsh.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe running netsh.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-04-1.png", "ScreenshotCaption": "Telemetry showing netsh.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing netsh.exe with command-line arguments. The telemetry was tainted by activity seen during the privilege escalation step because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-4.A.1-2.png", "ScreenshotCaption": "Telemetry showing netsh.exe with command-line arguments (tainted by relationship to threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "4.C.1", "Procedure": "Cobalt Strike: 'netstat -ano' via cmd", "Techniques": [{"TechniqueId": "T1049", "TechniqueName": "System Network Connections Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched netstat.exe with the correct ATT&CK technique (System Network Connections Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-4.C.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing netstat.exe with command-line arguments"}, {"ScreenshotName": "CB-4.C.1-2.png", "ScreenshotCaption": "Enrichment of netstat.exe with correct ATT&CK technique (System Network Connections Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed cmd.exe executing netstat.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-4.C.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing netstat.exe with command-line arguments"}, {"ScreenshotName": "CB-4.C.1-2.png", "ScreenshotCaption": "Enrichment of netstat.exe with correct ATT&CK technique (System Network Connections Discovery)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "OverWatch generated a General Behavior alert indicating cmd.exe executing netstat with command-line arguments was suspicious.[CS1]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-4.C.1-1.png", "ScreenshotCaption": "OverWatch General Behavior alert indicating netstat execution by cmd.exe was suspicious"}, {"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating netstat was a reconnaissance command (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team also sent an email indicating a General Behavior was observed because netstat was one of the reconnaissance commands performed.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-4.C.1-1.png", "ScreenshotCaption": "OverWatch General Behavior alert indicating netstat execution by cmd.exe was suspicious"}, {"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating netstat was a reconnaissance command (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the OverWatch alert showed cmd.exe executing netstat with command-line arguments, and would be available in a separate view.[CS2]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-4.C.1-1.png", "ScreenshotCaption": "OverWatch General Behavior alert indicating netstat execution by cmd.exe was suspicious"}, {"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating netstat was a reconnaissance command (General Behavior)"}], "Footnotes": ["For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched netstat.exe executing as Reconnaissance and mapped to the correct ATT&CK Technique (System Network Connections Discovery). The data was tainted by a parent Injected Shellcode alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-4.C.1-100.png", "ScreenshotCaption": "Enrichment of netstat.exe executing labeled as Reconnaissance and mapped to the correct ATT&CK Technique (System Network Connections Discovery) (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-4.C.1-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing netstat with command-line arguments"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing netstat with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-4.C.1-100.png", "ScreenshotCaption": "Enrichment of netstat.exe executing labeled as Reconnaissance and mapped to the correct ATT&CK Technique (System Network Connections Discovery) (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-4.C.1-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing netstat with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the netstat command with the correct ATT&CK Technique (T1049 - System Network Connections Discovery) and \u00a0Tactic (Discovery). [EG11]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "EG-04-1.png", "ScreenshotCaption": "Telemetry from event tree showing netstat with command-line arguments"}, {"ScreenshotName": "EG-04-4.png", "ScreenshotCaption": "Additional UI view of telemetry (showing the netstat command in this instance)"}, {"ScreenshotName": "EG-04-2.png", "ScreenshotCaption": "Enriched event tree showing enrichment of netstat with correct ATT&CK Technique (T1049 - System Network Connections Discovery) and Tactic (Discovery)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the process creation of netstat with command-line arguments. [EG11]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-04-1.png", "ScreenshotCaption": "Telemetry from event tree showing netstat with command-line arguments"}, {"ScreenshotName": "EG-04-4.png", "ScreenshotCaption": "Additional UI view of telemetry (showing the netstat command in this instance)"}, {"ScreenshotName": "EG-04-2.png", "ScreenshotCaption": "Enriched event tree showing enrichment of netstat with correct ATT&CK Technique (T1049 - System Network Connections Discovery) and Tactic (Discovery)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched netstat.exe with a tag identifying the command as enumeration.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-4.C.1-2.png", "ScreenshotCaption": "Enrichment of netstat.exe with a tag identifying the command as enumeration"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that netstat was a reconnaissance command used to enumerate active and listening network ports. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-4.C.1-1.png", "ScreenshotCaption": "Enrichment of netstat.exe with Netstat Execution alert (tagged with the correct ATT&CK Technique, T1049 - System Network Connections Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.A.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating netstat was used to enumerate active and listening network ports (Specific Behavior)"}, {"ScreenshotName": "FE-4.C.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about netstat"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched netstat.exe with an alert for Netstat Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1049 - System Network Connections Discovery) and Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-4.C.1-1.png", "ScreenshotCaption": "Enrichment of netstat.exe with Netstat Execution alert (tagged with the correct ATT&CK Technique, T1049 - System Network Connections Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.A.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating netstat was used to enumerate active and listening network ports (Specific Behavior)"}, {"ScreenshotName": "FE-4.C.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about netstat"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing netstat.exe with command-line arguments. The telemetry was tainted by the parent \"Powershell Execution Policy ByPass command ran\" alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-4.C.1-1.png", "ScreenshotCaption": "Telemetry showing netstat.exe with command-line arguments (tainted by the parent \\\"Powershell Execution Policy ByPass command ran\\\" alert)"}], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched netstat.exe with the correct Tactic (Discovery) and Technique (System Network Connections Discovery) and a suspicious indicator that network statistics and TCP/IP connections were gathered.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-4.A.1-10.png", "ScreenshotCaption": "Process tree within trace detection showing cmd.exe executing netstat.exe (tainted by a parent alert on cmd.exe)"}, {"ScreenshotName": "MC-4.A.1-6.png", "ScreenshotCaption": "Enrichment of netstat.exe with the correct Tactic (Discovery) and Technique (System Network Connections Discovery) and a suspicious indicator that network statistics and TCP/IP connections were gathered"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing netstat.exe with command-line arguments. The telemetry was tainted by a trace detection on cmd.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-4.A.1-10.png", "ScreenshotCaption": "Process tree within trace detection showing cmd.exe executing netstat.exe (tainted by a parent alert on cmd.exe)"}, {"ScreenshotName": "MC-4.A.1-6.png", "ScreenshotCaption": "Enrichment of netstat.exe with the correct Tactic (Discovery) and Technique (System Network Connections Discovery) and a suspicious indicator that network statistics and TCP/IP connections were gathered"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence of cmd.exe executing netstat.exe with command-line arguments (tainted by the alert on suspicious process injection alert association with rundll32.exe).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-4.C.1-1.png", "ScreenshotCaption": "Telemetry showing execution sequence for netstat.exe with command-line arguments"}, {"ScreenshotName": "MS-4.A.1-2.png", "ScreenshotCaption": "Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific netstat.exe command not shown)"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched netstat.exe executing with the correct ATT&CK Technique (System Network Connections Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-4.C.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing netstat with command-line arguments"}, {"ScreenshotName": "PA-4.C.1-2.png", "ScreenshotCaption": "Enrichment of netstat.exe executing with the correct ATT&CK Technique (System Network Connections Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing netsh with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-4.C.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing netstat with command-line arguments"}, {"ScreenshotName": "PA-4.C.1-2.png", "ScreenshotCaption": "Enrichment of netstat.exe executing with the correct ATT&CK Technique (System Network Connections Discovery)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe running netstat.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-04-1.png", "ScreenshotCaption": "Telemetry showing netstat.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing netstat.exe with command-line arguments. The telemetry was tainted by activity seen during the privilege escalation step because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-4.A.1-2.png", "ScreenshotCaption": "Telemetry showing netstat.exe with command-line arguments (tainted by relationship to threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "5.A.1", "Procedure": "Cobalt Strike: Built-in Mimikatz credential dump capability executed", "Techniques": [{"TechniqueId": "T1003", "TechniqueName": "Credential Dumping", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated showing the correct ATT&CK Technique (Credential Dumping).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-5.A.1-1.png", "ScreenshotCaption": "Telemetry showing cross process events, specifically a handle to open thread into lsass.exe"}, {"ScreenshotName": "CB-5.A.1-4.png", "ScreenshotCaption": "Specific Behavior alert showing correct ATT&CK Technique (Credential Dumping)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed an open handle to a thread into lsass.exe, which is indicative of process injection for credential dumping.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-5.A.1-1.png", "ScreenshotCaption": "Telemetry showing cross process events, specifically a handle to open thread into lsass.exe"}, {"ScreenshotName": "CB-5.A.1-4.png", "ScreenshotCaption": "Specific Behavior alert showing correct ATT&CK Technique (Credential Dumping)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for Credential Dumping, which indicated \"a DLL was detected as being reflectively loaded in the callstack.\" The alert was mapped to the correct ATT&CK Technique (Credential Dumping) and Tactic (Credential Access). The process tree view showed the alert as tainted by a parent detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-5.A.1-6.png", "ScreenshotCaption": "Specific Behavior alert for Credential Dumping and OverWatch General Behavior alert (tainted by previous detection by orange line indicating medium severity )"}], "Footnotes": []}, {"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated by the OverWatch team indicating the Credential Dumping activity was suspicious. The process tree view showed the alert as tainted by a parent detection.[CS1]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "CS-5.A.1-6.png", "ScreenshotCaption": "Specific Behavior alert for Credential Dumping and OverWatch General Behavior alert (tainted by previous detection by orange line indicating medium severity )"}], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showing the lsass handle open and DLL loading would be available in a separate view.[CS8]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-5.A.1-6.png", "ScreenshotCaption": "Specific Behavior alert for Credential Dumping and OverWatch General Behavior alert (tainted by previous detection by orange line indicating medium severity )"}], "Footnotes": ["For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not specifically taken in this instance."]}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for svchost.exe loading Mimikatz and accessing lsass (an audited system resource). The alert was also tagged with the correct ATT&CK Tactic (Credential Access) and related Technique (Process Injection).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-5.A.1-11.png", "ScreenshotCaption": "Specific Behavior alert with correct ATT&CK Tactic (Credential Access) and related Technique (Process Injection) with details about svchost.exe accessing lsass"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for the correct ATT&CK Technique (Credential Dumping).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-05-1.png", "ScreenshotCaption": "Specific Behavior alert mapped to the correct ATT&CK Technique (Credential Dumping)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though a DDNA Scan alerted for svchost.exe and displayed details related to Project Injection.[CT2]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CT-5.A.1-1.png", "ScreenshotCaption": "Alert showing DDNA Scan for svchost.exe (does not count as a detection)"}, {"ScreenshotName": "CT-5.A.1-2.png", "ScreenshotCaption": "Alert showing DDNA Scan details for svchost.exe, including that it appears to inject code into another process (does not count as a detection)"}, {"ScreenshotName": "CT-5.A.1-3.png", "ScreenshotCaption": "Alert showing additional DDNA Scan details for svchost.exe, including that it appears to inject code into another process (does not count as a detection)"}], "Footnotes": [" According to the vendor, DDNA scans trigger due to machine learning scanning in-memory code and identifying that the code is malicious. DDNA output, which is delayed, shows the process capabilities (known as \"traits\"), which may give an analyst clues on what the process does."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated on credential memory access.", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "MS-5.A.1-3.png", "ScreenshotCaption": "Enrichment showing Exploit Guard audit of svchost.exe extracting credentials from lsass.exe"}, {"ScreenshotName": "MS-5.A.2-2.png", "ScreenshotCaption": "Alert for suspicious process injection showing tainted association via a process tree containing svchost.exe (inner failure message in screenshot not relevant to tested functionality)"}, {"ScreenshotName": "MS-5.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert description for sensitive credential memory read"}, {"ScreenshotName": "MS-5.A.1-1.png", "ScreenshotCaption": "Process tree for sensitive credential memory read alert"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched data showing a svchost.exe process opening lsass.exe with a description that it was accessing credentials (tainted by parent process injection event that occurred from svchost.exe). Exploit Guard audited the process open and credential extraction event.[MS6]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-5.A.1-3.png", "ScreenshotCaption": "Enrichment showing Exploit Guard audit of svchost.exe extracting credentials from lsass.exe"}, {"ScreenshotName": "MS-5.A.2-2.png", "ScreenshotCaption": "Alert for suspicious process injection showing tainted association via a process tree containing svchost.exe (inner failure message in screenshot not relevant to tested functionality)"}, {"ScreenshotName": "MS-5.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert description for sensitive credential memory read"}, {"ScreenshotName": "MS-5.A.1-1.png", "ScreenshotCaption": "Process tree for sensitive credential memory read alert"}], "Footnotes": ["Vendor stated the Exploit Guard audit events demonstrate that execution would have been prevented if Attack Surface Reduction (ASR) was enabled in blocking mode. Vendor stated that Credential Guard can also mitigate this attack if enabled."]}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for a suspicious handle being opened to lsass.exe to dump passwords. The alert was tagged with the correct ATT&CK Technique (Credential Dumping). [PA3]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-5.A.1-1.png", "ScreenshotCaption": "A Specific Behavior alert for a suspicious handle being opened to lsass.exe to dump password, tagged with the correct ATT&CK Technique (Credential Dumping)"}], "Footnotes": ["Vendor stated the capability would have prevented this behavior."]}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[SO1]", "Modifiers": [], "Screenshots": [], "Footnotes": [" Vendor states that the capability would normally block credential dumping activity like this, but the mitigation capability was disabled due to the evaluation parameters."]}]}]}]}, {"Substep": "5.A.1", "Procedure": "Cobalt Strike: Credential dump capability involved process injection into lsass", "Techniques": [{"TechniqueId": "T1055", "TechniqueName": "Process Injection", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed an open handle to a thread into lsass.exe, which is indicative of process injection.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-5.A.1-1.png", "ScreenshotCaption": "Telemetry showing cross process events, specifically a handle to open thread into lsass.exe"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched several event types with descriptions, including for a remote process opening a handle to lsass and a DLL being reflectively loaded (ReflectiveDllOpenLsass), as well as an lsass process accessed (ProcessHollowingDetected).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-5.A.1-8.png", "ScreenshotCaption": "Enrichment showing ReflectiveDllOpenLsass and ProcessHollowingDetected events"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for svchost.exe reflectively loading a malicious executable, identified as Mimikatz, then accessing lsass. The alert was also tagged with the correct ATT&CK Technique (Process Injection) and Tactics (Defense Evasion, Privilege Escalation). The powerkatz.dll was also seen loaded as a floating executable code.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-5.A.1-11.png", "ScreenshotCaption": "Specific Behavior alert with correct ATT&CK Technique (Process Injection) and Tactics (Defense Evasion, Privilege Escalation)"}, {"ScreenshotName": "CR-5.A.1-21.png", "ScreenshotCaption": "Data within alert showing loaded powerkatz.dll as floating executable code"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed privileged accesses (PROCESS_VM_READ and PROCESS_QUERY_LIMITED_INFORMATION) into lsass.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-05-1.png", "ScreenshotCaption": "Telemetry showing process accesses into lsass.exe"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated when a DDNA Scan alerted for svchost.exe. DDNA scan results showed that svchost.exe \"appeared to inject code into another process.\"", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CT-5.A.1-1.png", "ScreenshotCaption": "General Behavior alert showing DDNA Scan for svchost.exe"}, {"ScreenshotName": "CT-5.A.1-2.png", "ScreenshotCaption": "General Behavior alert details on DDNA Scan for svchost.exe, including that it appears to inject code into another process"}, {"ScreenshotName": "CT-5.A.1-3.png", "ScreenshotCaption": "General Behavior alert additional details on DDNA Scan for svchost.exe, including that it appears to inject code into another process"}], "Footnotes": [" According to the vendor, DDNA scans trigger due to machine learning scanning in-memory code and identifying that the code is malicious. DDNA output, which is delayed, shows the process capabilities (known as \"traits\"), which may give an analyst clues on what the process does."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for process injection into lsass.exe.", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "MS-5.A.1-3.png", "ScreenshotCaption": "Telemetry showing svchost.exe accessing and extracting credentials from lsass.exe"}, {"ScreenshotName": "MS-5.A.1-1.png", "ScreenshotCaption": "Alert on credential dump showing injecting svchost.exe process (process with syringe) that was used to access lsass.exe"}, {"ScreenshotName": "MS-5.A.2-2.png", "ScreenshotCaption": "Specific Behavior alert for process injection into lsass.exe (inner failure message in screenshot not relevant to tested functionality)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed svchost.exe accessing lsass.exe and dumping credentials (tainted by parent alert on sensitive credential memory read for the first credential dump). Exploit Guard audited process open and credential extraction event.[MS30]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-5.A.1-3.png", "ScreenshotCaption": "Telemetry showing svchost.exe accessing and extracting credentials from lsass.exe"}, {"ScreenshotName": "MS-5.A.1-1.png", "ScreenshotCaption": "Alert on credential dump showing injecting svchost.exe process (process with syringe) that was used to access lsass.exe"}, {"ScreenshotName": "MS-5.A.2-2.png", "ScreenshotCaption": "Specific Behavior alert for process injection into lsass.exe (inner failure message in screenshot not relevant to tested functionality)"}], "Footnotes": ["Vendor stated the Exploit Guard audit events demonstrate that execution would have been prevented if Attack Surface Reduction (ASR) was enabled in blocking mode."]}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for a suspicious handle being opened to lsass.exe. The alert was tagged with a related ATT&CK Technique (Credential Dumping). [PA3]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-5.A.1-1.png", "ScreenshotCaption": "A Specific Behavior alert for a suspicious handle being opened to lsass.exe, tagged with a related ATT&CK Technique (Credential Dumping)"}], "Footnotes": ["Vendor stated the capability would have prevented this behavior."]}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}]}, {"Substep": "5.A.2", "Procedure": "Cobalt Strike: Built-in hash dump capability executed", "Techniques": [{"TechniqueId": "T1003", "TechniqueName": "Credential Dumping", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed an open handle to a thread into lsass.exe, which is indicative of process injection for credential dumping.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-5.A.2-2.png", "ScreenshotCaption": "Telemetry showing cross process events, specifically a handle to open thread into lsass.exe"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A second Specific Behavior alert was generated for Credential Dumping, which indicated that \"a remote thread in LSASS accessed credential registry keys.\" The alert was mapped to the correct ATT&CK Technique (Credential Dumping) and Tactic (Credential Access). The process tree view showed the alert as tainted by a parent detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-5.A.2-1.png", "ScreenshotCaption": "Two Specific Behavior alerts for Credential Dumping (mapped to correct ATT&CK Technique, Credential Dumping, and Tactic, Credential Access) and General Behavior OverWatch alert"}, {"ScreenshotName": "CS-5.A.2-4.png", "ScreenshotCaption": "Process tree view of Specific Behavior alerts for Credential Dumping and OverWatch General Behavior alert (tainted by previous detection by orange line indicating medium severity )"}], "Footnotes": []}, {"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for Credential Dumping, which indicated \"a DLL was detected as being reflectively loaded in the callstack.\" The alert was mapped to the correct ATT&CK Technique (Credential Dumping) and Tactic (Credential Access). The process tree view showed the alert as tainted by a parent detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-5.A.2-1.png", "ScreenshotCaption": "Two Specific Behavior alerts for Credential Dumping (mapped to correct ATT&CK Technique, Credential Dumping, and Tactic, Credential Access) and General Behavior OverWatch alert"}, {"ScreenshotName": "CS-5.A.2-4.png", "ScreenshotCaption": "Process tree view of Specific Behavior alerts for Credential Dumping and OverWatch General Behavior alert (tainted by previous detection by orange line indicating medium severity )"}], "Footnotes": []}, {"DetectionType": "General Behavior", "DetectionNote": "OverWatch also generated a General Behavior alert indicating the Credential Dumping activity was suspicious. The process tree view showed the alert as tainted by a previous detection.[CS1]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "CS-5.A.2-1.png", "ScreenshotCaption": "Two Specific Behavior alerts for Credential Dumping (mapped to correct ATT&CK Technique, Credential Dumping, and Tactic, Credential Access) and General Behavior OverWatch alert"}, {"ScreenshotName": "CS-5.A.2-4.png", "ScreenshotCaption": "Process tree view of Specific Behavior alerts for Credential Dumping and OverWatch General Behavior alert (tainted by previous detection by orange line indicating medium severity )"}], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry for the lsass remote thread and DLL loading would be available in a separate view.[CS8]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-5.A.2-1.png", "ScreenshotCaption": "Two Specific Behavior alerts for Credential Dumping (mapped to correct ATT&CK Technique, Credential Dumping, and Tactic, Credential Access) and General Behavior OverWatch alert"}, {"ScreenshotName": "CS-5.A.2-4.png", "ScreenshotCaption": "Process tree view of Specific Behavior alerts for Credential Dumping and OverWatch General Behavior alert (tainted by previous detection by orange line indicating medium severity )"}], "Footnotes": ["For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not specifically taken in this instance."]}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed svchost.exe injecting into lsass.exe. The telemetry was tainted by the parent \u201cinjected (svchost.exe > lsass.exe)\u201d alert. The hashdumpx64.dll was also seen loaded as a floating executable code.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-5.A.2-20.png", "ScreenshotCaption": "Telemetry showing svchost.exe process injection into lsass.exe (tainted by a parent injection alert)"}, {"ScreenshotName": "CR-5.A.2-10.png", "ScreenshotCaption": "Parent alert for svchost.exe injecting into lsass.exe, labeled as Malicious Code Injection"}, {"ScreenshotName": "CR-5.A.2-11.png", "ScreenshotCaption": "Telemetry within alert showing loaded hashdumpx64.dll as floating executable code"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for the correct ATT&CK Technique (Credential Dumping).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-05-2.png", "ScreenshotCaption": "Specific Behavior alert mapped to the correct ATT&CK Technique (Credential Dumping)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched svchost.exe injecting a thread into lsass.exe with a tag identifying credential dumping.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-5.A.2-1.png", "ScreenshotCaption": "Enrichment of svchost.exe injecting a thread into lsass.exe with a tag identifying credential dumping"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a thread create within lsass.exe from svchost.exe, which could be indicative of credential dumping. The telemetry was tainted by the parent \"Powershell process created\" and \"Policy Remote Process Compromise\" alerts.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-5.A.2-2.png", "ScreenshotCaption": "Telemetry showing thread create to lsass.exe (tainted by the parent \\\"Powershell process created\\\" and \\\"Policy Remote Process Compromise\\\" alerts)"}], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched data showing a svchost.exe process opening lsass.exe with a description that it was accessing credentials (tainted by parent process injection event that occurred from svchost.exe). Exploit Guard audited the process open and credential extraction event.[MS6]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-5.A.2-1.png", "ScreenshotCaption": "Enrichment showing Exploit Guard audit of svchost.exe extracting credentials from lsass.exe"}, {"ScreenshotName": "MS-5.A.2-2.png", "ScreenshotCaption": "Alert for process injection into lsass.exe tainting this event (inner failure message in screenshot not relevant to tested functionality)"}], "Footnotes": ["Vendor stated the Exploit Guard audit events demonstrate that execution would have been prevented if Attack Surface Reduction (ASR) was enabled in blocking mode. Vendor stated that Credential Guard can also mitigate this attack if enabled."]}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for svchost dumping credentials via the Registry. The alert was tagged with the correct ATT&CK Technique (Credential Dumping).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-5.A.1-2.png", "ScreenshotCaption": "Telemetry showing a code injection into lsass.exe (tainted by a parent process injection alert on cmd.exe)"}, {"ScreenshotName": "PA-5.A.1-3.png", "ScreenshotCaption": "Specific Behavior alert for svchost dumping credentials via the Registry tagged with the correct ATT&CK Technique (Credential Dumping)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a code injection into lsass.exe. The telemetry was tainted by a parent process injection alert on cmd.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-5.A.1-2.png", "ScreenshotCaption": "Telemetry showing a code injection into lsass.exe (tainted by a parent process injection alert on cmd.exe)"}, {"ScreenshotName": "PA-5.A.1-3.png", "ScreenshotCaption": "Specific Behavior alert for svchost dumping credentials via the Registry tagged with the correct ATT&CK Technique (Credential Dumping)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[SO1]", "Modifiers": [], "Screenshots": [], "Footnotes": [" Vendor states that the capability would normally block credential dumping activity like this, but the mitigation capability was disabled due to the evaluation parameters."]}]}]}]}, {"Substep": "5.A.2", "Procedure": "Cobalt Strike: Hash dump capability involved process injection into lsass.exe", "Techniques": [{"TechniqueId": "T1055", "TechniqueName": "Process Injection", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated showing the correct ATT&CK Technique (Credential Dumping).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-5.A.2-2.png", "ScreenshotCaption": "Telemetry showing cross process events, specifically a new thread and open handle into lsass.exe"}, {"ScreenshotName": "CB-5.A.2-4.png", "ScreenshotCaption": "Specific Behavior alert showing correct ATT&CK Technique (Process Injection)"}, {"ScreenshotName": "CB-5.A.2-1.png", "ScreenshotCaption": "Alert showing correct ATT&CK Technique (Process Injection) within process tree"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a new thread and open handle into lsass.exe, which is indicative of process injection for credential dumping.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-5.A.2-2.png", "ScreenshotCaption": "Telemetry showing cross process events, specifically a new thread and open handle into lsass.exe"}, {"ScreenshotName": "CB-5.A.2-4.png", "ScreenshotCaption": "Specific Behavior alert showing correct ATT&CK Technique (Process Injection)"}, {"ScreenshotName": "CB-5.A.2-1.png", "ScreenshotCaption": "Alert showing correct ATT&CK Technique (Process Injection) within process tree"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched several event types with descriptions, including for a remote process opening a handle to lsass and a DLL being reflectively loaded (ReflectiveDllOpenLsass), malicious process hollowing (ProcessHollowingDetected), and a remote process injecting code into lsass (LsassInjectedCode).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-5.A.2-5.png", "ScreenshotCaption": "Enrichment showing ReflectiveDllOpenLsass, ProcessHollowingDetected, and LsassInjectedCode events"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for svchost.exe injection into lsass.exe. The alert was mapped with the correct ATT&CK Tactic (Defense Evasion, Privilege Escalation) and Technique (Process Injection). The hashdumpx64.dll was also seen loaded as a floating executable code.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-5.A.2-10.png", "ScreenshotCaption": "Specific Behavior alert for svchost.exe injecting into lsass.exe, labeled as Malicious Code Injection"}, {"ScreenshotName": "CR-5.A.2-20.png", "ScreenshotCaption": "Details of Specific Behavior alert for svchost.exe process injection into lsass.exe with correct ATT&CK Tactic (Defense Evasion, Privilege Escalation) and Technique (Process Injection)"}, {"ScreenshotName": "CR-5.A.2-11.png", "ScreenshotCaption": "Data within alert showing loaded hashdumpx64.dll as floating executable code"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for the correct ATT&CK Technique (Process Injection).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-05-2.png", "ScreenshotCaption": "Telemetry showing process injection into lsass.exe (tainted by parent Process Injection alert)"}, {"ScreenshotName": "EG-05-5.png", "ScreenshotCaption": "Specific Behavior alert mapped to the correct ATT&CK Technique (Process Injection)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed multiple privileged accesses (including PROCESS_CREATE_THREAD) into lsass, indicative of Process Injection (tainted by the Process Injection alert).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-05-2.png", "ScreenshotCaption": "Telemetry showing process injection into lsass.exe (tainted by parent Process Injection alert)"}, {"ScreenshotName": "EG-05-5.png", "ScreenshotCaption": "Specific Behavior alert mapped to the correct ATT&CK Technique (Process Injection)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched svchost.exe injecting a thread into lsass.exe with a tag identifying thread injection.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-5.A.2-1.png", "ScreenshotCaption": "Enrichment of svchost.exe injecting a thread into lsass.exe with a tag identifying thread injection"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for process hijacking based on a thread create within lsass.exe from svchost.exe (tainted by the parent \"Powershell process created\" and \"Policy Remote Process Compromise\" alerts.)", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-5.A.2-2.png", "ScreenshotCaption": "Specific Behavior alert showing process hijacking detection for lsass.exe thread create (tainted by the parent \\\"Powershell process created\\\" and \\\"Policy Remote Process Compromise\\\" alerts)"}, {"ScreenshotName": "CT-5.A.2-3.png", "ScreenshotCaption": "General Behavior alert showing DDNA Scan for svchost.exe"}, {"ScreenshotName": "CT-5.A.2-5.png", "ScreenshotCaption": "General Behavior alert details on DDNA Scan for svchost.exe, including that it appears to inject code into another process"}], "Footnotes": ["The vendor noted Privilege Escalation is one of ten \"Capabilities\" that are part of the taxonomy."]}, {"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated when a DDNA Scan alerted for svchost.exe. The DDNA scan results showed that svchost.exe \"appeared to inject code into another process.\"", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CT-5.A.2-2.png", "ScreenshotCaption": "Specific Behavior alert showing process hijacking detection for lsass.exe thread create (tainted by the parent \\\"Powershell process created\\\" and \\\"Policy Remote Process Compromise\\\" alerts)"}, {"ScreenshotName": "CT-5.A.2-3.png", "ScreenshotCaption": "General Behavior alert showing DDNA Scan for svchost.exe"}, {"ScreenshotName": "CT-5.A.2-5.png", "ScreenshotCaption": "General Behavior alert details on DDNA Scan for svchost.exe, including that it appears to inject code into another process"}], "Footnotes": [" According to the vendor, DDNA scans trigger due to machine learning scanning in-memory code and identifying that the code is malicious. DDNA output, which is delayed, shows the process capabilities (known as \"traits\"), which may give an analyst clues on what the process does."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for process injection into lsass.exe. The alert was rolled up under the prior lsass.exe process injection alert and the last activity seen field was updated.", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "MS-5.A.2-2.png", "ScreenshotCaption": "Specific Behavior alert for process injection into lsass.exe (inner failure message in screenshot not relevant to tested functionality)"}, {"ScreenshotName": "MS-5.A.2-1.png", "ScreenshotCaption": "Telemetry showing svchost.exe accessing and extracting credentials from lsass.exe"}, {"ScreenshotName": "MS-5.A.1-1.png", "ScreenshotCaption": "Alert on prior credential dump tainting svchost.exe process (process with syringe indicating process injection) that was used to access lsass.exe"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed svchost.exe accessing lsass.exe and dumping credentials (tainted by parent alert on sensitive credential memory read for the first credential dump). Exploit Guard audited process open and credential extraction event.[MS30]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-5.A.2-2.png", "ScreenshotCaption": "Specific Behavior alert for process injection into lsass.exe (inner failure message in screenshot not relevant to tested functionality)"}, {"ScreenshotName": "MS-5.A.2-1.png", "ScreenshotCaption": "Telemetry showing svchost.exe accessing and extracting credentials from lsass.exe"}, {"ScreenshotName": "MS-5.A.1-1.png", "ScreenshotCaption": "Alert on prior credential dump tainting svchost.exe process (process with syringe indicating process injection) that was used to access lsass.exe"}], "Footnotes": ["Vendor stated the Exploit Guard audit events demonstrate that execution would have been prevented if Attack Surface Reduction (ASR) was enabled in blocking mode."]}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a code injection into lsass.exe. The telemetry was tainted by a parent process injection alert on cmd.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-5.A.1-2.png", "ScreenshotCaption": "Telemetry showing a code injection into lsass.exe (tainted by a parent process injection alert on cmd.exe)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe injecting into svchost.exe (not counted for detection) then invoking a remote thread into lsass.exe. Powershell.exe was listed as the source of the remote thread into lsass.exe instead of svchost.exe because the alert on powershell.exe came before other events and therefore had increased precedence. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-5.A.2-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe invoking a remote thread into lsass.exe (Group ID tainted this event but was not shown in this view)"}], "Footnotes": []}]}]}]}, {"Substep": "5.B.1", "Procedure": "Cobalt Strike: Built-in token theft capability executed to change user context to George", "Techniques": [{"TechniqueId": "T1134", "TechniqueName": "Access Token Manipulation", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a change in user execution context from Debbie to George between parent and child processes, which is indicative of token manipulation.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-5.B.1-2.png", "ScreenshotCaption": "Telemetry showing parent cmd.exe process running under user context Debbie"}, {"ScreenshotName": "CB-5.B.1-3.png", "ScreenshotCaption": "Telemetry showing child cmd.exe process running under user context George"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the compromised process (21898821890) running as Debbie, then children from this process spawning first as Debbie and later as George. This could indicate theft of George's token within the context of the process.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-5.B.1-1.png", "ScreenshotCaption": "Telemetry showing children of the compromised process (PID 21898821890) first running as Debbie, then as George"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe associated with both users Debbie and George, indicating user context change via token manipulation. The telemetry was tainted by a parent alert on explorer.exe attempting to execute a file (Resume Viewer.exe) identified as malicious.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-5.B.1-10.png", "ScreenshotCaption": "Telemetry within the process tree showing cmd.exe associated with users Debbie and George (tainted by a parent alert on explorer.exe)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for Privilege Escalation based on rundll32.exe as Debbie, spawning the process cmd.exe as George, which indicated a possible stolen token. The alert was mapped to the correct ATT&CK Technique (T1134 - Access Token Manipulation) and Tactics (Privilege Escalation, Defense Evasion).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-05-6.png", "ScreenshotCaption": "Specific Behavior alert on Privilege Escalation showing a process spawning (cmd.exe) with different tokens than the parent (rundll32.exe) (mapped to the correct ATT&CK Technique, T1134 - Access Token Manipulation, and Tactics, Privilege Escalation and Defense Evasion)"}, {"ScreenshotName": "EG-05-7.png", "ScreenshotCaption": "Telemetry showing the cmd.exe that spawned as user George from rundll32.exe running as user Debbie (tainted by parent Privilege Escalation alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the users change in the parent-child processes of rundll32.exe and cmd.exe (tainted by the Privilege Escalation alert).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-05-6.png", "ScreenshotCaption": "Specific Behavior alert on Privilege Escalation showing a process spawning (cmd.exe) with different tokens than the parent (rundll32.exe) (mapped to the correct ATT&CK Technique, T1134 - Access Token Manipulation, and Tactics, Privilege Escalation and Defense Evasion)"}, {"ScreenshotName": "EG-05-7.png", "ScreenshotCaption": "Telemetry showing the cmd.exe that spawned as user George from rundll32.exe running as user Debbie (tainted by parent Privilege Escalation alert)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a cmd.exe associated with user Debbie spawn a cmd.exe associated with user George, indicating user context change via token manipulation.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-5.B.1-T1134-new.png", "ScreenshotCaption": "Telemetry showing a cmd.exe associated with user Debbie spawn a cmd.exe associated with user George, indicating user context change via token manipulation"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a process (net.exe) executed during Step 4 as user Debbie and a subsequent process (reg.exe) executed during Step 6 as user George, indicating a change in user context from a stolen token.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-4.A.1-1.png", "ScreenshotCaption": "Telemetry showing the user Debbie executing net.exe with command-line arguments during Step 4"}, {"ScreenshotName": "FE-5.B.1-1.png", "ScreenshotCaption": "Telemetry showing the user George executing reg.exe with command-line arguments during Step 6"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a change in user execution context from Debbie to George between processes, which is indicative of token manipulation.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-5.C.1-1.png", "ScreenshotCaption": "Telemetry showing a change in user execution context from Debbie to George between processes"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed svchost.exe as a high integrity process from SYSTEM and subsequent cmd.exe process running as user George (tainted by the parent alert on suspicious process injection into lsass.exe). Svchost.exe was executed with seclogon command-line argument indicating token manipulation.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-5.B.1-1.png", "ScreenshotCaption": "Telemetry showing svchost.exe invocation with seclogon flag subsequently running cmd.exe as SYSTEM"}, {"ScreenshotName": "MS-5.B.1-2.png", "ScreenshotCaption": "Telemetry showing resulting cmd.exe running as user George"}, {"ScreenshotName": "MS-5.B.1-4.png", "ScreenshotCaption": "Alert for suspicious process injection showing tainted association via a process tree containing subsequent cmd.exe processes (inner failure message in screenshot not relevant to tested functionality)"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a cmd.exe associated with user Debbie spawn a cmd.exe associated with user George, indicating user context change via token manipulation. The telemetry was tainted by a parent process injection alert on cmd.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-5.B.1-1.png", "ScreenshotCaption": "Telemetry showing a cmd.exe associated with user Debbie spawn a cmd.exe associated with user George, indicating user context change via token manipulation (tainted by a parent process injection alert on cmd.exe)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}]}, {"Substep": "6.A.1", "Procedure": "Cobalt Strike: 'reg query' via cmd to remotely enumerate a specific Registry key on Conficker (10.0.0.5)", "Techniques": [{"TechniqueId": "T1012", "TechniqueName": "Query Registry", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched reg.exe with the correct ATT&CK Technique (T1012 - Query Registry).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-6.A.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing reg.exe with command-line arguments"}, {"ScreenshotName": "CB-6.A.1-2.png", "ScreenshotCaption": "Enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing reg.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-6.A.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing reg.exe with command-line arguments"}, {"ScreenshotName": "CB-6.A.1-2.png", "ScreenshotCaption": "Enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "OverWatch generated a General Behavior alert indicating the reg query command was suspicious. The alert was tainted by the parent cmd.exe process.[CS1]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "CS-6.A.1-1.png", "ScreenshotCaption": "Telemetry showing reg with command-line arguments"}, {"ScreenshotName": "CS-6.A.1-2.png", "ScreenshotCaption": "OverWatch General Behavior alert identifying reg query as suspicious as well as reg.exe process (tainted by previous detection by orange line indicating medium severity)"}], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing reg with command-line arguments. The telemetry was tainted by the parent cmd.exe process.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-6.A.1-1.png", "ScreenshotCaption": "Telemetry showing reg with command-line arguments"}, {"ScreenshotName": "CS-6.A.1-2.png", "ScreenshotCaption": "OverWatch General Behavior alert identifying reg query as suspicious as well as reg.exe process (tainted by previous detection by orange line indicating medium severity)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed reg.exe executing with command-line arguments. The telemetry was tainted by a parent Injected Shellcode alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-6.A.1-10.png", "ScreenshotCaption": "Telemetry showing reg.exe executing with command-line arguments (tainted by a parent Injected Shellcode alert)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing reg with command-line arguments. The telemetry was tainted by a parent Process Injection alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-06-1.png", "ScreenshotCaption": "Telemetry showing reg with command-line arguments"}, {"ScreenshotName": "EG-06-4.png", "ScreenshotCaption": "Event tree view of telemetry showing reg with command-line arguments (tainted by parent Process Injection alert)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched reg.exe identifying that a sensitive Registry key was accessed which could be used for recon.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-6.A.1-1.png", "ScreenshotCaption": "Enrichment of reg.exe identifying that a sensitive Registry key was accessed which could be used for recon"}, {"ScreenshotName": "CC-6.A.1-2.png", "ScreenshotCaption": "Telemetry showing reg.exe with command-line arguments"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing reg with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-6.A.1-1.png", "ScreenshotCaption": "Enrichment of reg.exe identifying that a sensitive Registry key was accessed which could be used for recon"}, {"ScreenshotName": "CC-6.A.1-2.png", "ScreenshotCaption": "Telemetry showing reg.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified reg.exe as a reconnaissance command to enumerate a Registry key on the host Conficker to determine the configuration of its Windows Terminal Server service. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-6.A.1-1.png", "ScreenshotCaption": "Enrichment of reg.exe with Reg Execution alert (tagged with correct ATT&CK Technique, T1012 - Query Registry, and Tactic, Discovery)"}, {"ScreenshotName": "FE-6.A.1-2.png", "ScreenshotCaption": "File Write To Named Pipe  alert for write to remote named pipe from reg.exe"}, {"ScreenshotName": "FE-6.A.1-3.png", "ScreenshotCaption": "Additional details on named pipe alert"}, {"ScreenshotName": "FE-2.A.1-3.png", "ScreenshotCaption": "Excerpt from Managed Defense Report of the reg command executing a remote registry query (Specific Behavior)"}, {"ScreenshotName": "FE-6.A.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about reg query"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched reg.exe with an alert for Reg Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1012 - Query Registry) and Tactic (Discovery). An alert was also generated for a File Write To Named Pipe (Weak Signal) for reg.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-6.A.1-1.png", "ScreenshotCaption": "Enrichment of reg.exe with Reg Execution alert (tagged with correct ATT&CK Technique, T1012 - Query Registry, and Tactic, Discovery)"}, {"ScreenshotName": "FE-6.A.1-2.png", "ScreenshotCaption": "File Write To Named Pipe  alert for write to remote named pipe from reg.exe"}, {"ScreenshotName": "FE-6.A.1-3.png", "ScreenshotCaption": "Additional details on named pipe alert"}, {"ScreenshotName": "FE-2.A.1-3.png", "ScreenshotCaption": "Excerpt from Managed Defense Report of the reg command executing a remote registry query (Specific Behavior)"}, {"ScreenshotName": "FE-6.A.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about reg query"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing reg.exe with command-line arguments. Telemetry also showed that two PIPEs were created as a result of reg.exe execution. The telemetry was tainted by the parent \"Powershell process created\" alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-6.A.1-1.png", "ScreenshotCaption": "Telemetry showing reg.exe with command-line arguments (tainted by the parent \\\"Powershell process created\\\" alert)"}, {"ScreenshotName": "CT-6.A.1-2.png", "ScreenshotCaption": "Telemetry showing PIPEs created (tainted by the parent \\\"Powershell process created\\\" alert)"}], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated indicating that reg.exe command-line arguments contains signs of malicious usage such as encoded content or interacting with Registry keys.", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "MC-6.A.1-11.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing reg.exe with command-line arguments (tainted by a trace detection on cmd.exe)"}, {"ScreenshotName": "MC-6.A.1-7.png", "ScreenshotCaption": "Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (Query Registry) and a suspicious indicator that the Registry was queried via execution of the reg.exe utility"}, {"ScreenshotName": "MC-6.A.1-5.png", "ScreenshotCaption": "General Behavior alert indicating that reg.exe command-line arguments contains signs of malicious usage"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (Query Registry) and a suspicious indicator that the Registry was queried via execution of the reg.exe utility.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-6.A.1-11.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing reg.exe with command-line arguments (tainted by a trace detection on cmd.exe)"}, {"ScreenshotName": "MC-6.A.1-7.png", "ScreenshotCaption": "Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (Query Registry) and a suspicious indicator that the Registry was queried via execution of the reg.exe utility"}, {"ScreenshotName": "MC-6.A.1-5.png", "ScreenshotCaption": "General Behavior alert indicating that reg.exe command-line arguments contains signs of malicious usage"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing reg.exe with command-line arguments. The telemetry was tainted by a trace detection on cmd.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-6.A.1-11.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing reg.exe with command-line arguments (tainted by a trace detection on cmd.exe)"}, {"ScreenshotName": "MC-6.A.1-7.png", "ScreenshotCaption": "Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (Query Registry) and a suspicious indicator that the Registry was queried via execution of the reg.exe utility"}, {"ScreenshotName": "MC-6.A.1-5.png", "ScreenshotCaption": "General Behavior alert indicating that reg.exe command-line arguments contains signs of malicious usage"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence of reg.exe executing with command-line arguments. The telemetry was tainted by the relationship to prior rundll32.exe activity based on process injection alert context.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-6.A.1-1.png", "ScreenshotCaption": "Telemetry showing execution sequence for reg.exe with command-line arguments"}, {"ScreenshotName": "MS-6.A.1-2.png", "ScreenshotCaption": "Process tree view of suspicious process injection alert on lsass.exe showing tainted relationship to reg.exe (inner failure message in screenshot not relevant to tested functionality)"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched reg.exe executing with the correct ATT&CK Technique (Query Registry).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-6.A.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing reg with command-line arguments (tainted by a parent process injection alert on cmd.exe)"}, {"ScreenshotName": "PA-6.A.1-2.png", "ScreenshotCaption": "Enrichment of the execution of reg.exe as querying a remote key (tainted by a parent process injection alert on cmd.exe)"}, {"ScreenshotName": "PA-6.A.1-3.png", "ScreenshotCaption": "Enrichment of reg.exe executing with the correct ATT&CK Technique (Query Registry)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the execution of reg.exe as querying a remote key. The data was tainted by a parent process injection alert on cmd.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-6.A.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing reg with command-line arguments (tainted by a parent process injection alert on cmd.exe)"}, {"ScreenshotName": "PA-6.A.1-2.png", "ScreenshotCaption": "Enrichment of the execution of reg.exe as querying a remote key (tainted by a parent process injection alert on cmd.exe)"}, {"ScreenshotName": "PA-6.A.1-3.png", "ScreenshotCaption": "Enrichment of reg.exe executing with the correct ATT&CK Technique (Query Registry)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing reg with command-line arguments. The telemetry was tainted by a parent process injection alert on cmd.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-6.A.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing reg with command-line arguments (tainted by a parent process injection alert on cmd.exe)"}, {"ScreenshotName": "PA-6.A.1-2.png", "ScreenshotCaption": "Enrichment of the execution of reg.exe as querying a remote key (tainted by a parent process injection alert on cmd.exe)"}, {"ScreenshotName": "PA-6.A.1-3.png", "ScreenshotCaption": "Enrichment of reg.exe executing with the correct ATT&CK Technique (Query Registry)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing reg.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-06-1.png", "ScreenshotCaption": "Telemetry showing reg.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing reg with command-line arguments. The telemetry was tainted by the activity seen during the privilege escalation step because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-6.A.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing reg with command-line arguments (tainted by relationship to rundll32 parent process linked by Group ID but not shown in this view)"}], "Footnotes": []}]}]}]}, {"Substep": "6.B.1", "Procedure": "Cobalt Strike: C2 channel modified to use port 80", "Techniques": [{"TechniqueId": "T1043", "TechniqueName": "Commonly Used Port", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the network connections from rundll32.exe with the correct ATT&CK Technique (T1043 - Commonly Used Port).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-6.B.1-2.png", "ScreenshotCaption": "Telemetry showing network connection over port 80 to 192.168.0.4 (C2 server)"}, {"ScreenshotName": "CB-6.B.1-4.png", "ScreenshotCaption": "Enrichment of rundll32.exe TCP port 80 network connections with correct ATT&CK Technique (T1043 - Commonly Used Port)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed network connections over TCP port 80 to 192.168.0.4 (C2 server).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-6.B.1-2.png", "ScreenshotCaption": "Telemetry showing network connection over port 80 to 192.168.0.4 (C2 server)"}, {"ScreenshotName": "CB-6.B.1-4.png", "ScreenshotCaption": "Enrichment of rundll32.exe TCP port 80 network connections with correct ATT&CK Technique (T1043 - Commonly Used Port)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a connection over TCP port 80 to 192.168.0.4 (C2 server).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-6.C.1-1.png", "ScreenshotCaption": "Telemetry showing TCP port 80 connection to 192.168.0.4 (C2 server)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched rundll32.exe opening a connection to the C2 server over a \\\"HTTP port\\\" with the correct ATT&CK Tactic (Command and Control) and the Technique (Commonly Used Port). The data was tainted by a parent Injected Shellcode alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-6.B.1-10.png", "ScreenshotCaption": "Enrichment of rundll32.exe making a connection over the \\\"HTTP Port\\\" with the correct ATT&CK Tactic (Command and Control) and Technique (Commonly Used Port) (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-6.B.1-20.png", "ScreenshotCaption": "Telemetry showing rundll32.exe opening a connection over port 80 (tainted by a parent Injected Shellcode alert, listed as Owner process)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed rundll32.exe opening a connection over port 80. The telemetry was tainted by a parent Injected Shellcode alert listed as the owner process.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-6.B.1-10.png", "ScreenshotCaption": "Enrichment of rundll32.exe making a connection over the \\\"HTTP Port\\\" with the correct ATT&CK Tactic (Command and Control) and Technique (Commonly Used Port) (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-6.B.1-20.png", "ScreenshotCaption": "Telemetry showing rundll32.exe opening a connection over port 80 (tainted by a parent Injected Shellcode alert, listed as Owner process)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a TCP port 80 connection from rundll32.exe to 192.168.0.4 (C2 server). The telemetry was tainted by a parent Malicious File Detection alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-06-2.png", "ScreenshotCaption": "Telemetry showing a TCP port 80 connection from rundll32.exe"}, {"ScreenshotName": "EG-06-7.png", "ScreenshotCaption": "Telemetry showing port 80 traffic (tainted by the parent\u00a0Malicious File Detection alert)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed network connections over port 80 to 192.168.0.4 (C2 server) initiated from rundll32.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-6.B.1-T1043-new.png", "ScreenshotCaption": "Telemetry showing network connections over port 80 to 192.168.0.4 (C2 server)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified C2 communication over TCP port 80 to www.freegoogleadsenseinfo.com (C2 domain).\u00a0[FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-6.B.1-1.png", "ScreenshotCaption": "Telemetry showing port 80 connections to 192.168.0.4 (C2 server)"}, {"ScreenshotName": "FE-6.B.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report identifying C2 traffic communicating over TCP port 80 to www.freegoogleadsenseinfo.com (C2 domain) (General Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a connection over port 80 to 192.168.0.4 (C2 server).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-6.B.1-1.png", "ScreenshotCaption": "Telemetry showing port 80 connections to 192.168.0.4 (C2 server)"}, {"ScreenshotName": "FE-6.B.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report identifying C2 traffic communicating over TCP port 80 to www.freegoogleadsenseinfo.com (C2 domain) (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed an outbound network connection from rundll32.exe to 192.168.0.4 (C2 server) over TCP port 80. The telemetry was tainted by the parent \"Sponsor Process Established Network Connection\" alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-6.B.1-1.png", "ScreenshotCaption": "Telemetry showing outbound traffic to 192.168.0.4 (C2 server) over TCP port 80 (tainted by parent \\\"Sponsor Process Established Network Connection\\\" alert)"}], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched rundll32.exe (the process that made the network connection) with the correct ATT&CK Tactic (Command and Control) and the Technique (Commonly Used Port).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-6.B.1-2.png", "ScreenshotCaption": "Telemetry showing TCP port 80 connections to freegoogleadsenseinfo.com (C2 domain)"}, {"ScreenshotName": "MC-6.C.1-2.png", "ScreenshotCaption": "Enrichment of rundll32.exe (the process that made the network connection) with the correct ATT&CK Tactic (Command and Control) and the Technique (Commonly Used Port)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed connections over TCP port 80 to freegoogleadsenseinfo.com (C2 domain).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-6.B.1-2.png", "ScreenshotCaption": "Telemetry showing TCP port 80 connections to freegoogleadsenseinfo.com (C2 domain)"}, {"ScreenshotName": "MC-6.C.1-2.png", "ScreenshotCaption": "Enrichment of rundll32.exe (the process that made the network connection) with the correct ATT&CK Tactic (Command and Control) and the Technique (Commonly Used Port)"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence for rundll32.exe opening a connection to 192.186.0.4 (C2 server) over port 80. The telemetry was tainted by the relationship to the previous alert on unexpected behavior originating from rundll32.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-6.B.1-1.png", "ScreenshotCaption": "Telemetry showing execution sequence for rundll32.exe opening network connection"}, {"ScreenshotName": "MS-6.B.1-2.png", "ScreenshotCaption": "Incident graph from \\\"Unexpected process behavior\\\" alert (resulting from rundll32.exe) showing tainted network connection"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed port 80 command and control traffic.[PA2]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-6.B.1-1.png", "ScreenshotCaption": "Telemetry showing port 80 command and control traffic"}], "Footnotes": ["Vendor stated that more information would be available if their firewall appliance was installed and activated."]}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed connections over TCP port 80 to freegoogleadsenseinfo.com (C2 domain).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-06-2.png", "ScreenshotCaption": "Telemetry showing TCP port 80 connections to freegoogleadsenseinfo.com (C2 domain)"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a port 80 connection to 192.168.0.4 (C2 server) that was associated with the rundll32 parent process. The telemetry was tainted by the activity seen during the privilege escalation step because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-6.B.1-1.png", "ScreenshotCaption": "Telemetry showing port 80 connection to 192.168.0.4 (C2 server) (tainted by relationship to rundll32 parent process linked by Group ID but not shown in this view)"}], "Footnotes": []}]}]}]}, {"Substep": "6.B.1", "Procedure": "Cobalt Strike: C2 channel modified to use HTTP traffic to freegoogleadsenseinfo.com", "Techniques": [{"TechniqueId": "T1071", "TechniqueName": "Standard Application Layer Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed network connections over TCP port 80 as well as a modload showing winhttp.dll was loaded, which an analyst could use to determine HTTP was used.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-6.B.1-8.png", "ScreenshotCaption": "Telemetry showing modloads showing winhttp.dll loaded"}, {"ScreenshotName": "CB-6.B.1-2.png", "ScreenshotCaption": "Telemetry showing network connection over TCP port 80 to the C2 domain (could be used in conjunction with modload to determine protocol)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed a connection to 192.168.0.4 (C2 server) on port 80 (no detection showed HTTP specifically).", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched rundll32.exe opening an unusual network connection to the C2 server over the port 80 \"HTTP port.\u201d The data was tagged with the correct ATT&CK Tactic (Command and Control) and Technique (Standard Application Layer Protocol), and also showed the amount of transmitted/received bytes as well as that the winhttp.dll module was loaded (which an analyst could use to determine HTTP was used). The data was tainted by a parent Injected Shellcode alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-6.B.1-30.png", "ScreenshotCaption": "Enrichment of rundll32.exe making an unusual network connection over the \\\"HTTP Port\\\" with the correct ATT&CK Tactic (Command and Control) and the Technique (Standard Application Layer Protocol) (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-6.B.1-100.png", "ScreenshotCaption": "Enrichment of rundll32.exe showing connection over port 80 and the amount of transmitted/received bytes (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-6.B.1-101.png", "ScreenshotCaption": "Enrichment of rundll32.exe showing winhttp.dll module loaded (tainted by a parent Injected Shellcode alert)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed a connection to port 80 (no detection showed HTTP specifically).", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a trace of HTTP connections being made by rundll32.exe to freegoogleadsenseinfo.com (C2 domain).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-6.B.1-2.png", "ScreenshotCaption": "Telemetry showing rundll32 making HTTP connections"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified C2 communication over HTTP to www.freegoogleadsenseinfo.com (C2 domain). [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-6.B.1-3.png", "ScreenshotCaption": "Telemetry showing HTTP GET requests to 192.168.0.4 (C2 server)"}, {"ScreenshotName": "FE-6.B.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report identifying C2 traffic communicating over HTTP to www.freegoogleadsenseinfo.com (C2 domain) (General Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed HTTP GET requests over port 80 to 192.168.0.4 (C2 server).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-6.B.1-3.png", "ScreenshotCaption": "Telemetry showing HTTP GET requests to 192.168.0.4 (C2 server)"}, {"ScreenshotName": "FE-6.B.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report identifying C2 traffic communicating over HTTP to www.freegoogleadsenseinfo.com (C2 domain) (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed an outbound HTTP request to www.freegoogleadsenseinfo.com (C2 domain).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CT-6.B.1-2.png", "ScreenshotCaption": "Telemetry showing outbound C2 traffic over HTTP to www.freegoogleadsense.info (C2 domain)"}], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed network connections over TCP port 80 and that winhttp.dll module was loaded into the same process (PID 6276) that made the network connection, which an analyst could use to determine HTTP was used.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-6.B.1-2.png", "ScreenshotCaption": "Telemetry showing TCP port 80 connections to freegoogleadsenseinfo.com (C2 domain)"}, {"ScreenshotName": "MC-6.B.1-22.png", "ScreenshotCaption": "Telemetry showing that the winhttp.dll module was loaded into the process (PID 6276) that made the network connection"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed a connection to port 80 (no detection showed HTTP specifically).", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed port 80 command and control traffic as well as the loading of winhttp.dll, which an analyst could use to determine HTTP was used.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-6.B.1-1.png", "ScreenshotCaption": "Telemetry showing port 80 command and control traffic as well as the loading of winhttp.dll"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed a connection to TCP port 80 (no detection showed HTTP specifically).", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[SO96]", "Modifiers": [], "Screenshots": [], "Footnotes": ["Telemetry showed a connection to port 80 (no detection showed HTTP specifically)."]}]}]}]}, {"Substep": "6.B.1", "Procedure": "Cobalt Strike: C2 channel modified to split communications between both HTTP and DNS", "Techniques": [{"TechniqueId": "T1026", "TechniqueName": "Multiband Communication", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed separate network connections over port TCP port 80 and UDP port 53, which could indicate multiband communication.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-6.B.1-3.png", "ScreenshotCaption": "Telemetry showing network connection over UDP port 53"}, {"ScreenshotName": "CB-6.B.1-2.png", "ScreenshotCaption": "Telemetry showing network connection over TCP port 80"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed connections over both DNS and TCP port 80, which could indicate multiband communication. The DNS connections were tainted by a parent Exfiltration alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-6.C.1-1.png", "ScreenshotCaption": "Telemetry showing TCP port 80 connection to 192.168.0.4 (C2 server)"}, {"ScreenshotName": "CS-1.C.1-2.png", "ScreenshotCaption": "Telemetry within an alert showing abnormally large DNS requests occurred (tainted by parent Exfiltration alert)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the same rundll32.exe opening a connection over port 80 while making DNS queries to freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by a parent Injected Shellcode alert listed as the owner process.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-6.B.1-20.png", "ScreenshotCaption": "Telemetry showing the same rundll32.exe opening a connection over port 80 while making DNS queries to freegoogleadsenseinfo.com (C2 domain) (tainted by a parent Injected Shellcode alert, listed as Owner process)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed connections over DNS as well as over port 80, which could indicate multiband communication. The telemetry was tainted by a parent Malicious File Detection alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-06-6.png", "ScreenshotCaption": "Telemetry showing DNS connections"}, {"ScreenshotName": "EG-06-7.png", "ScreenshotCaption": "Telemetry showing port 80 traffic (tainted by parent\u00a0Malicious File Detection alert)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed rundll32.exe making network connections over port 80 to 192.168.0.4 (C2 server) as well as earlier identified DNS queries, which could indicate multiband communication.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-6.B.1-T1043-new.png", "ScreenshotCaption": "Telemetry showing rundll32.exe making network connections over port 80 to 192.168.0.4 (C2 server)"}, {"ScreenshotName": "CC-1.C.1-1.png", "ScreenshotCaption": "Telemetry showing rundll32.exe making DNS queries"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified C2 communication over TCP port 80 to www.freegoogleadsenseinfo.com (C2 domain) in addition to the ongoing DNS C2. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-6.B.1-2.png", "ScreenshotCaption": "Telemetry showing DNS requests (field name dnsLookupEvents/Generated) and HTTP requests (field name urlMonitorEvents/Generated)"}, {"ScreenshotName": "FE-6.B.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report identifying C2 traffic communicating over TCP port 80 to www.freegoogleadsenseinfo.com (C2 domain) in addition to the ongoing DNS C2 (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a combination of both DNS requests as well as HTTP requests, which could indicate multiband communication.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-6.B.1-2.png", "ScreenshotCaption": "Telemetry showing DNS requests (field name dnsLookupEvents/Generated) and HTTP requests (field name urlMonitorEvents/Generated)"}, {"ScreenshotName": "FE-6.B.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report identifying C2 traffic communicating over TCP port 80 to www.freegoogleadsenseinfo.com (C2 domain) in addition to the ongoing DNS C2 (Specific Behavior)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed C2 traffic was over TCP port 80 as well as earlier traffic over DNS, which could indicate multiband communication. The HTTP telemetry over TCP port 80 was tainted by the parent \"Sponsor Process Established Network Connection\" alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-1.C.1-1.png", "ScreenshotCaption": "Telemetry showing DNS queries to freegoogleadsenseinfo.com (C2 domain) from svchost.exe"}, {"ScreenshotName": "CT-6.B.1-1.png", "ScreenshotCaption": "Telemetry showing outbound traffic to 192.168.0.4 (C2 server) over TCP port 80 (tainted by the parent \\\"Sponsor Process Established Network Connection\\\" alert)"}], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed an execution sequence for rundll32.exe opening a connection to 192.168.0.4 (C2 server) over port 80, and prior activity showed DNS traffic to the same C2 IP address, which could indicate multiband communication. The port 80 telemetry was tainted by the relationship to the previous alert on unexpected behavior originating from rundll32.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-6.B.1-2.png", "ScreenshotCaption": "Incident graph from \\\"Unexpected process behavior\\\" alert (resulting from rundll32.exe) showing tainted network connection"}, {"ScreenshotName": "MS-6.B.1-1.png", "ScreenshotCaption": "Telemetry showing execution sequence for rundll32.exe opening port 80 network connection"}, {"ScreenshotName": "MS-6.B.1-3.png", "ScreenshotCaption": "Telemetry showing DNS traffic to C2 domain"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed command and control traffic for both ports 80 and 53 .", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-6.B.1-1.png", "ScreenshotCaption": "Telemetry showing ports 80 and 53 command and control traffic"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed port 80 connections to 192.168.0.4 (C2 server) and DNS requests for freegoogleadsenseinfo.com (C2 domain), which could indicate multiband communication. The telemetry was tainted by the activity seen during the privilege escalation step because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-6.B.1-1.png", "ScreenshotCaption": "Telemetry showing port 80 connection to 192.168.0.4 (C2 server)"}, {"ScreenshotName": "S1-1.C.1-1.png", "ScreenshotCaption": "Telemetry showing DNS query to C2 domain (tainted by relationship to threat story shown in Group ID)"}], "Footnotes": []}]}]}]}, {"Substep": "6.C.1", "Procedure": "Cobalt Strike: C2 channel modified to proxy RDP connection to Conficker (10.0.0.5)", "Techniques": [{"TechniqueId": "T1076", "TechniqueName": "Remote Desktop Protocol", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the rdpclip.exe events with the correct ATT&CK Technique (Remote Desktop Protocol).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-6.B.1-1.png", "ScreenshotCaption": "Telemetry showing network connection over TCP port 3389 to 10.0.0.5 (Conficker)"}, {"ScreenshotName": "CB-6.C.1-3.png", "ScreenshotCaption": "Telemetry showing rdpclip.exe running"}, {"ScreenshotName": "CB-6.C.1-1.png", "ScreenshotCaption": "Enrichment of rdpclip.exe events with correct ATT&CK Technique (Remote Desktop Protocol)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a connection to 10.0.0.5 (Conficker) over TCP port 3389 as well as rdpclip.exe executing.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-6.B.1-1.png", "ScreenshotCaption": "Telemetry showing network connection over TCP port 3389 to 10.0.0.5 (Conficker)"}, {"ScreenshotName": "CB-6.C.1-3.png", "ScreenshotCaption": "Telemetry showing rdpclip.exe running"}, {"ScreenshotName": "CB-6.C.1-1.png", "ScreenshotCaption": "Enrichment of rdpclip.exe events with correct ATT&CK Technique (Remote Desktop Protocol)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team sent an email indicating a General Behavior was observed because they identified suspicious communications over port 3389 (RDP) to other hosts.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-6.C.1-3.png", "ScreenshotCaption": "Telemetry showing logon type 10 (interactive remote login) as user George@shockwave on 10.0.0.5 (Conficker)"}, {"ScreenshotName": "CS-6.C.1-5.png", "ScreenshotCaption": "Telemetry showing a network connection to 10.0.0.5 (Conficker) over TCP port 3389"}, {"ScreenshotName": "CS-E-1.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating suspicious communications over 3389 (RDP) were observed (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a connection for logon type 10 (interactive logon) and a connection to 10.0.0.5 (Conficker) over TCP port 3389.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-6.C.1-3.png", "ScreenshotCaption": "Telemetry showing logon type 10 (interactive remote login) as user George@shockwave on 10.0.0.5 (Conficker)"}, {"ScreenshotName": "CS-6.C.1-5.png", "ScreenshotCaption": "Telemetry showing a network connection to 10.0.0.5 (Conficker) over TCP port 3389"}, {"ScreenshotName": "CS-E-1.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating suspicious communications over 3389 (RDP) were observed (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe establishing an outbound RDP connection over port 3389 to 10.0.0.5 (Conficker) with Remote Interactive Logon Type. The telemetry was tainted by a parent Injected Shellcode alert listed as the owner process Telemetry also showed rdpclip.exe executing on 10.0.0.5 (Conficker).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-6.B.1-20.png", "ScreenshotCaption": "Telemetry showing cmd.exe establishing an outbound RDP connection over port 3389 to 10.0.0.5 (Conficker) (tainted by a parent Injected Shellcode alert, listed as Owner process)"}, {"ScreenshotName": "CR-6.C.1-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe establishing an outbound RDP connection over port 3389 to 10.0.0.5 (Conficker) with Remote Interactive Logon Type"}, {"ScreenshotName": "CR-6.C.1-11.png", "ScreenshotCaption": "Telemetry showing rdpclip.exe executing on 10.0.0.5 (Conficker)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a connection over port 3389 to 10.0.0.5 (Conficker) as well as a Type 10 (interactive remote) login event by user George on Conficker. The port 3389 telemetry was tainted by a parent Process Injection alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-06-4.png", "ScreenshotCaption": "Event tree view of telemetry showing port 3389 connection to 10.0.0.5 (Conficker) (tainted by parent Process Injection alert)"}, {"ScreenshotName": "EG-06-3.png", "ScreenshotCaption": "Telemetry showing Type 10 (interactive remote) login event by user George on Conficker"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed rundll32.exe making network connections to 10.0.0.5 (Conficker) over port 3389.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-6.C.1-T1076-new.png", "ScreenshotCaption": "Telemetry showing rundll32.exe making network connections to 10.0.0.5 (Conficker) over port 3389"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the RDP connection from rundll32.exe with an alert for RDP Network Connection (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1076 - Remote Desktop Protocol) and Tactic (Lateral Movement).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-6.C.1-1.png", "ScreenshotCaption": "Enrichment of RDP connection from rundll32.exe with RDP Network Connection alert (tagged with correct ATT&CK Technique, T1076 - Remote Desktop Protocol, and Tactic, Lateral Movement)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability showed cmd.exe creating an outbound TCP port 3389 (RDP) connection from Nimda and enriched the connection with the conditions Lateral Movement and Remote Share Access. The enrichment was tainted by the parent \\\"Windows command prompt invoked\\\" alert. [CT22]", "Modifiers": ["Configuration Change", "Tainted"], "Screenshots": [{"ScreenshotName": "CT-6.C.1-1.png", "ScreenshotCaption": "Enrichment of outbound TCP port 3389 (RDP) connection with Lateral Movement and Remote Share Access (tainted by parent \\\"Windows command prompt invoked\\\" alert)"}, {"ScreenshotName": "CT-6.C.1-2.png", "ScreenshotCaption": "Telemetry showing inbound TCP port 3389 connection to 10.0.0.5 (Conficker)"}], "Footnotes": ["At least one condition contributing to Enrichment was added to the capability's detection after the start of the evaluation, so this detection is identified as a configuration change. See Configuration page for details."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry also identified an inbound connection to Conficker over TCP port 3389.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CT-6.C.1-1.png", "ScreenshotCaption": "Enrichment of outbound TCP port 3389 (RDP) connection with Lateral Movement and Remote Share Access (tainted by parent \\\"Windows command prompt invoked\\\" alert)"}, {"ScreenshotName": "CT-6.C.1-2.png", "ScreenshotCaption": "Telemetry showing inbound TCP port 3389 connection to 10.0.0.5 (Conficker)"}], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched rundll32.exe (the process that made the network connection) with the correct ATT&CK Tactic (Lateral Movement) and the Technique (Remote Desktop Protocol).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-6.C.1-1.png", "ScreenshotCaption": "Telemetry showing a connection to 10.0.0.5 (Conficker) over TCP port 3389"}, {"ScreenshotName": "MC-6.C.1-2.png", "ScreenshotCaption": "Enrichment of rundll32.exe (the process that made the network connection) with the correct ATT&CK Tactic (Lateral Movement) and the Technique (Remote Desktop Protocol)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a connection to 10.0.0.5 (Conficker) over TCP port 3389.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-6.C.1-1.png", "ScreenshotCaption": "Telemetry showing a connection to 10.0.0.5 (Conficker) over TCP port 3389"}, {"ScreenshotName": "MC-6.C.1-2.png", "ScreenshotCaption": "Enrichment of rundll32.exe (the process that made the network connection) with the correct ATT&CK Tactic (Lateral Movement) and the Technique (Remote Desktop Protocol)"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence for cmd.exe establishing an outbound RDP connection over port 3389 to 10.0.0.5 (Conficker). Logon activity over the last 30 days on Conficker shows George with a logon type 10 RemoteInteractive logon event. Telemetry also showed George logged into Conficker and displayed a movement graph of activity from user account Debbie to George.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-6.C.1-1.png", "ScreenshotCaption": "Telemetry showing execution sequence for cmd.exe connection over RDP to 10.0.0.5 (Conficker)"}, {"ScreenshotName": "MS-6.C.1-2.png", "ScreenshotCaption": "Telemetry showing execution sequence on 10.0.0.5 (Conficker) showing George logon"}, {"ScreenshotName": "MS-6.C.1-3.png", "ScreenshotCaption": "Telemetry showing user logon activity on 10.0.0.5 (Conficker) showing George with a logon type 10 RemoteInteractive logon event"}, {"ScreenshotName": "MS-6.C.1-4.png", "ScreenshotCaption": "Graph showing movement from Debbie account to George"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for an unexpected process using the RDP port. The data was tainted by a parent process injection alert on cmd.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-6.C.1-1.png", "ScreenshotCaption": "Telemetry showed cmd.exe establishing an outbound RDP connection over port 3389 to 10.0.0.5 (Conficker) (tainted by a parent process injection alert on cmd.exe)"}, {"ScreenshotName": "PA-6.C.1-2.png", "ScreenshotCaption": "General Behavior alert for an unexpected process using the RDP port (tainted by a parent process injection alert on cmd.exe)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe establishing an outbound RDP connection over port 3389 to 10.0.0.5 (Conficker). The telemetry was tainted by a parent process injection alert on cmd.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-6.C.1-1.png", "ScreenshotCaption": "Telemetry showed cmd.exe establishing an outbound RDP connection over port 3389 to 10.0.0.5 (Conficker) (tainted by a parent process injection alert on cmd.exe)"}, {"ScreenshotName": "PA-6.C.1-2.png", "ScreenshotCaption": "General Behavior alert for an unexpected process using the RDP port (tainted by a parent process injection alert on cmd.exe)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe connecting to 10.0.0.5 (Conficker) over port 3389.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-06-3.png", "ScreenshotCaption": "Telemetry showing cmd.exe connecting over port 3389 (RDP) to 10.0.0.5 (Conficker)"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a port 3389 connection. The telemetry was tainted by the activity seen during the privilege escalation step because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-6.C.1-1.png", "ScreenshotCaption": "Telemetry showing port 3389 connection (tainted by relationship to threat story shown in Group ID)"}], "Footnotes": []}]}]}]}, {"Substep": "7.A.1", "Procedure": "Added user Jesse to Conficker (10.0.0.5) through RDP connection", "Techniques": [{"TechniqueId": "T1136", "TechniqueName": "Create Account", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched lsass.exe with the tag \\\"Create Accounts using GUI\\\". [CB1]", "Modifiers": ["Configuration Change"], "Screenshots": [{"ScreenshotName": "CB-7.A.1-2.png", "ScreenshotCaption": "Telemetry showing Registry modifications for new user Jesse"}, {"ScreenshotName": "CB-7.A.1-4.png", "ScreenshotCaption": "Enrichment of lsass.exe with tag \\\"Create Accounts using GUI\\\""}], "Footnotes": [" The enrichment was added as a configuration change during the action and was not part of the original set of detections when the evaluation started."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed Registry modification events related to the creation of the user account Jesse.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-7.A.1-2.png", "ScreenshotCaption": "Telemetry showing Registry modifications for new user Jesse"}, {"ScreenshotName": "CB-7.A.1-4.png", "ScreenshotCaption": "Enrichment of lsass.exe with tag \\\"Create Accounts using GUI\\\""}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the creation of the user Jesse and the user being added to the domain admin group.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-7.A.1-1.png", "ScreenshotCaption": "Telemetry showing creation of the user Jesse with the user RID 000003E8"}, {"ScreenshotName": "CS-7.A.1-2.png", "ScreenshotCaption": "Telemetry showing user RID 000003E8 (corresponding to the user Jesse) added to the admin group (00000220), a well-known security identifier"}, {"ScreenshotName": "CS-7.A.1-3.png", "ScreenshotCaption": "Telemetry showing group membership of the user Jesse, including Remote (0000022B), Admins (00000220), and Users (00000221), which are well-known security identifiers"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed lsass.exe creating a Registry key for user Jesse, indicating that the user is new.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-7.A.1-20.png", "ScreenshotCaption": "Telemetry showing lsass.exe creating a Registry key for user Jesse"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the creation of the new user Jesse.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-7.A.1-2.png", "ScreenshotCaption": "Telemetry showing the creation of the new user Jesse"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified the creation of a local user account for Jesse on Conficker. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-7.A.1-1.png", "ScreenshotCaption": "Telemetry showing creation of user Jesse"}, {"ScreenshotName": "FE-7.A.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report showing the creation of the user Jesse (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry from Conficker showed the creation of the new user Jesse.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-7.A.1-1.png", "ScreenshotCaption": "Telemetry showing creation of user Jesse"}, {"ScreenshotName": "FE-7.A.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report showing the creation of the user Jesse (Specific Behavior)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert named \"New user account created\" was generated based on the Registry change identifying that the new user Jesse was created. A child event of the alert indicated that the account had been added to the local admins group (but did not identify the account creation specifically).", "Modifiers": ["Configuration Change"], "Screenshots": [{"ScreenshotName": "CT-7.A.1-1.png", "ScreenshotCaption": "Specific Behavior alert for \\\"New user account created\\\" and event showing account name was Jesse"}, {"ScreenshotName": "CT-7.A.1-2.png", "ScreenshotCaption": "Child event of Specific Behavior alert showing new account added to local admins group"}], "Footnotes": [" This alert was added to the capability's detection after the start of the evaluation, so the detection is identified as a configuration change. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the creation of the user Jesse.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-7.A.1-1.png", "ScreenshotCaption": "Telemetry showing creation of user account Jesse"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed data for account Jesse creation after configuration change to enable collection of event ID 4720.[MS7]", "Modifiers": ["Configuration Change"], "Screenshots": [{"ScreenshotName": "MS-7.A.1-1.png", "ScreenshotCaption": "Telemetry showing creation of user account Jesse"}], "Footnotes": [" Visibility of account creation data was verified in retesting at the end of the evaluation after vendor adjusted data collection configuration and visibility of account creation."]}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the Local Users and Groups snap-in (lusrmgr.msc) executing with the correct ATT&CK Technique (Create Account).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-7.A.1-3.png", "ScreenshotCaption": "Telemetry showing mmc.exe creating a Registry key for user Jesse"}, {"ScreenshotName": "PA-7.A.1-4.png", "ScreenshotCaption": "Enrichment of the Local Users and Groups snap-in (lusrmgr.msc) executing with the correct ATT&CK Technique (Create Account)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed mmc.exe creating a Registry key for user Jesse, indicating that the user is new.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-7.A.1-3.png", "ScreenshotCaption": "Telemetry showing mmc.exe creating a Registry key for user Jesse"}, {"ScreenshotName": "PA-7.A.1-4.png", "ScreenshotCaption": "Enrichment of the Local Users and Groups snap-in (lusrmgr.msc) executing with the correct ATT&CK Technique (Create Account)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the creation of the user Jesse which was noted from SAM Registry events.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "S1-7.A.1-1.png", "ScreenshotCaption": "Telemetry showing creation of user account Jesse"}], "Footnotes": []}]}]}]}, {"Substep": "7.A.1", "Procedure": "Microsoft Management Console (Local Users and Groups snap-in) GUI utility used to add new user through RDP connection", "Techniques": [{"TechniqueId": "T1061", "TechniqueName": "Graphical User Interface", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the GUI-based lusrmgr.msc (Local Users and Groups snap-in).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-7.A.1-3.png", "ScreenshotCaption": "Telemetry showing mmc.exe running lusrmgr.msc"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the GUI-based lusrmgr.msc (Local Users and Groups snap-in).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-6.C.1-4.png", "ScreenshotCaption": "Telemetry showing mmc.exe running lursmgr.msc"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed mmc.exe, the Microsoft Management Console, executing the GUI-based lusrmgr.msc (Local Users and Groups snap-in).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-7.A.1-30.png", "ScreenshotCaption": "Telemetry showing lusrmgr.msc running from mmc.exe"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the GUI-based lusrmgr.msc (Local Users and Groups snap-in).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-07-5.png", "ScreenshotCaption": "Telemetry showing mmc.exe running lursmgr.msc"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed mmc.exe, the Microsoft Management Console, executing the GUI-based lusrmgr.msc (Local Users and Groups snap-in).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-7.A.1-T1061-new.png", "ScreenshotCaption": "Telemetry showing mmc.exe running lursmgr.msc"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the GUI-based lusrmgr.msc (Local Users and Groups snap-in).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-7.A.1-3.png", "ScreenshotCaption": "Telemetry showing mmc.exe spawning lusrmgr.exe"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the GUI-based lusrmgr.msc (Local Users and Groups snap-in) (tainted by the parent \"LSA Registry Key modified\" alert).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-7.A.1-3.png", "ScreenshotCaption": "Telemetry showing mmc.exe process executing lusrmgr.msc (tainted by the parent \\\"LSA Registry Key modified\\\" alert)"}], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed mmc.exe, the Microsoft Management Console, executing the GUI-based lusrmgr.msc (Local Users and Groups snap-in).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-7.A.1-2.png", "ScreenshotCaption": "Telemetry showing mmc.exe running lusrmgr.msc"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the GUI-based lusrmgr.msc (Local Users and Groups snap-in).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-7.A.1-2.png", "ScreenshotCaption": "Telemetry showing mmc.exe running lusrmgr.msc"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the Local Users and Groups snap-in (lusrmgr.msc) executing with the correct ATT&CK Technique (Graphical User Interface).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-7.A.1-1.png", "ScreenshotCaption": "Telemetry showing lusrmgr.msc running from mmc.exe"}, {"ScreenshotName": "PA-7.A.1-2.png", "ScreenshotCaption": "Enrichment of the Local Users and Groups snap-in (lusrmgr.msc) executing with the correct ATT&CK Technique (Graphical User Interface)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed mmc.exe, the Microsoft Management Console, executing the lusrmgr.msc (Local Users and Groups snap-in) which displays local account information.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-7.A.1-1.png", "ScreenshotCaption": "Telemetry showing lusrmgr.msc running from mmc.exe"}, {"ScreenshotName": "PA-7.A.1-2.png", "ScreenshotCaption": "Enrichment of the Local Users and Groups snap-in (lusrmgr.msc) executing with the correct ATT&CK Technique (Graphical User Interface)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}]}, {"Substep": "7.A.1", "Procedure": "Microsoft Management Console (Local Users and Groups snap-in) GUI utility displayed user account information", "Techniques": [{"TechniqueId": "T1087", "TechniqueName": "Account Discovery", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the lusrmgr.msc (Local Users and Groups snap-in) which displays local account information.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-7.A.1-3.png", "ScreenshotCaption": "Telemetry showing mmc.exe running lusrmgr.msc"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the lusrmgr.msc (Local Users and Groups snap-in) which displays local account information.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-6.C.1-4.png", "ScreenshotCaption": "Telemetry showing mmc.exe running lursmgr.msc"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed mmc.exe, the Microsoft Management Console, executing the lusrmgr.msc (Local Users and Groups snap-in) which displays local account information.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-7.A.1-10.png", "ScreenshotCaption": "Telemetry showing lusrmgr.msc running from mmc.exe"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the lusrmgr.msc (Local Users and Groups snap-in) which displays local account information.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-07-5.png", "ScreenshotCaption": "Telemetry showing mmc.exe running lusrmgr.msc"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the lusrmgr.msc (Local Users and Groups snap-in), which displays local account information.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-7.A.1-1.png", "ScreenshotCaption": "Telemetry showing mmc.exe running lursmgr.msc"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the lusrmgr.msc (Local Users and Groups snap-in), which displays local account information.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-7.A.1-3.png", "ScreenshotCaption": "Telemetry showing mmc.exe running lusrmgr.exe"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the lusrmgr.msc (Local Users and Groups snap-in) which displays local account information. The telemetry was tainted by the parent \"LSA Registry Key modified\" alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-7.A.1-3.png", "ScreenshotCaption": "Telemetry showing mmc.exe running lusrmgr.msc (tainted by the parent \\\"LSA Registry Key modified\\\" alert)"}], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed mmc.exe, the Microsoft Management Console, executing the lusrmgr.msc (Local Users and Groups snap-in) which displays local account information.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-7.A.1-2.png", "ScreenshotCaption": "Telemetry showing lusrmgr.msc running from mmc.exe"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the lusrmgr.msc (Local Users and Groups snap-in) which displays local account information.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-7.A.1-2.png", "ScreenshotCaption": "Telemetry showing mmc.exe running lusrmgr.msc"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched mmc.exe, the Microsoft Management Console, executing the GUI-based lusrmgr.msc (Local Users and Groups snap-in) as reconnaissance via the MMC utility with local users and groups view.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-7.A.1-1.png", "ScreenshotCaption": "Telemetry showing lusrmgr.msc running from mmc.exe"}, {"ScreenshotName": "PA-7.A.1-5.png", "ScreenshotCaption": "Enrichment of mmc.exe as reconnaissance via the MMC utility with local users and groups view"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed mmc.exe, the Microsoft Management Console, executing the GUI-based lusrmgr.msc (Local Users and Groups snap-in).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-7.A.1-1.png", "ScreenshotCaption": "Telemetry showing lusrmgr.msc running from mmc.exe"}, {"ScreenshotName": "PA-7.A.1-5.png", "ScreenshotCaption": "Enrichment of mmc.exe as reconnaissance via the MMC utility with local users and groups view"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}]}, {"Substep": "7.B.1", "Procedure": "Cobalt Strike: Built-in upload capability executed to write a DLL payload (updater.dll) to disk on Nimda (10.0.1.6)", "Techniques": [{"TechniqueId": "T1105", "TechniqueName": "Remote File Copy", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed file modification events indicating updater.dll being created and written to disk.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-7.B.1-1.png", "ScreenshotCaption": "Telemetry showing updater.dll written to disk"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the file write for updater.dll into the system32 folder by user George. The telemetry was tainted by the parent \\\"unexpected process\\\" alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-7.B.1-1.png", "ScreenshotCaption": "Telemetry showing file write for updater.dll (tainted by the parent \\\"unexpected process\\\" alert)"}, {"ScreenshotName": "CS-7.B.1-2.png", "ScreenshotCaption": "Additional telemetry showing\u00a0file write for updater.dll"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the creation of updater.dll. Telemetry was tainted by a parent alert on cmd.exe (listed as the owner process) generated based on updater.dll being detected as known malware.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-7.B.1-10.png", "ScreenshotCaption": "Telemetry showing the file write of updater.dll (tainted by a parent alert on cmd.exe, listed as Owner Process)"}, {"ScreenshotName": "CR-7.B.1-11.png", "ScreenshotCaption": "Parent alert for updater.dll being detected as known malware"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the creation of updater.dll (tainted by the parent Malicious File Detection).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-07-1.png", "ScreenshotCaption": "Telemetry showing creation of updater.dll\u00a0(tainted by parent Malicious File Detection alert)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the creation of updater.dll identifying that a command prompt modified an unknown DLL.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-7.B.1-1.png", "ScreenshotCaption": "Enrichment of the creation of updater.dll identifying that a command prompt modified an unknown DLL"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched updater.dll being written by cmd.exe with an alert for CMD File Write (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1105\u00a0- Remote File Copy) and a related ATT&CK Technique (T1059 - Command-Line Interface) and Tactic (Execution).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-7.B.1-1.png", "ScreenshotCaption": "Enrichment of updater.dll file write by cmd.exe with alert for CMD File Write (tagged with correct ATT&CK Technique, T1105 \u00a0- Remote File Copy, and related ATT&CK Technique, T1059 - Command-Line Interface, and Tactic, Execution)"}, {"ScreenshotName": "FE-7.B.1-2.png", "ScreenshotCaption": "Telemetry showing updater.dll file write (tainted by parent AV signature alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the file write for updater.dll into the system32 folder. The telemetry was tainted by the parent AV signature alert for updater.dll.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "FE-7.B.1-1.png", "ScreenshotCaption": "Enrichment of updater.dll file write by cmd.exe with alert for CMD File Write (tagged with correct ATT&CK Technique, T1105 \u00a0- Remote File Copy, and related ATT&CK Technique, T1059 - Command-Line Interface, and Tactic, Execution)"}, {"ScreenshotName": "FE-7.B.1-2.png", "ScreenshotCaption": "Telemetry showing updater.dll file write (tainted by parent AV signature alert)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed creation of updater.dll. The telemetry was tainted by the parent \"Powershell process created\" alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-7.B.1-1.png", "ScreenshotCaption": "Telemetry showing creation of updater.dll (tainted by the parent \\\"Powershell process created\\\" alert)"}], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for a new dynamic library created in the Windows system (System32) folder.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-7.B.1-1.png", "ScreenshotCaption": "Specific Behavior alert for a new PE file created in the Windows system (System32) folder"}, {"ScreenshotName": "MC-7.B.1-99.png", "ScreenshotCaption": "Specific Behavior alert for a new dynamic library file created in the Windows system (System32) folder"}], "Footnotes": []}, {"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for a new PE file created in the Windows system (System32) folder.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-7.B.1-1.png", "ScreenshotCaption": "Specific Behavior alert for a new PE file created in the Windows system (System32) folder"}, {"ScreenshotName": "MC-7.B.1-99.png", "ScreenshotCaption": "Specific Behavior alert for a new dynamic library file created in the Windows system (System32) folder"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe writing updater.dll to disk.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-7.B.1-1.png", "ScreenshotCaption": "Telemetry showing file write of updater.dll"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for a script engine creating/writing a DLL in the system32 folder. The alert was tainted by a parent process injection alert on cmd.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-7.B.1-1.png", "ScreenshotCaption": "Telemetry showed the file create event for updater.dll"}, {"ScreenshotName": "PA-7.B.1-2.png", "ScreenshotCaption": "Specific Behavior alert for a script engine creating/writing a DLL in the system32 folder (tainted by a parent process injection alert on cmd.exe)"}, {"ScreenshotName": "PA-7.B.1-3.png", "ScreenshotCaption": "Specific Behavior alert for a Windows scripting engine creating an executable on disk"}], "Footnotes": []}, {"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for a Windows scripting engine creating an executable on disk.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-7.B.1-1.png", "ScreenshotCaption": "Telemetry showed the file create event for updater.dll"}, {"ScreenshotName": "PA-7.B.1-2.png", "ScreenshotCaption": "Specific Behavior alert for a script engine creating/writing a DLL in the system32 folder (tainted by a parent process injection alert on cmd.exe)"}, {"ScreenshotName": "PA-7.B.1-3.png", "ScreenshotCaption": "Specific Behavior alert for a Windows scripting engine creating an executable on disk"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the file create event for updater.dll.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-7.B.1-1.png", "ScreenshotCaption": "Telemetry showed the file create event for updater.dll"}, {"ScreenshotName": "PA-7.B.1-2.png", "ScreenshotCaption": "Specific Behavior alert for a script engine creating/writing a DLL in the system32 folder (tainted by a parent process injection alert on cmd.exe)"}, {"ScreenshotName": "PA-7.B.1-3.png", "ScreenshotCaption": "Specific Behavior alert for a Windows scripting engine creating an executable on disk"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed file write of updater.dll.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-07-1.png", "ScreenshotCaption": "Telemetry showing file write event of updater.dll"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed file write of updater.dll. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-7.B.1-1.png", "ScreenshotCaption": "Telemetry showing file write of updater.dll (tainted by relationship to threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "7.C.1", "Procedure": "Cobalt Strike: 'schtasks' via cmd to create scheduled task that executes a DLL payload (updater.dll)", "Techniques": [{"TechniqueId": "T1053", "TechniqueName": "Scheduled Task", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated mapped to the correct ATT&CK Technique (T1053 - Scheduled Task).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-7.C.1-1.png", "ScreenshotCaption": "Telemetry showing process tree containing schtasks.exe and full command a task creation"}, {"ScreenshotName": "CB-7.C.1-2.png", "ScreenshotCaption": "Specific Behavior alert mapped to correct ATT&CK Technique (T1053 - Scheduled Task)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the process tree containing schtasks.exe as well as the full command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-7.C.1-1.png", "ScreenshotCaption": "Telemetry showing process tree containing schtasks.exe and full command a task creation"}, {"ScreenshotName": "CB-7.C.1-2.png", "ScreenshotCaption": "Specific Behavior alert mapped to correct ATT&CK Technique (T1053 - Scheduled Task)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The OverWatch team also sent an email indicating a Specific Behavior was observed because a scheduled task was created for persistence.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-7.C.1-2.png", "ScreenshotCaption": "Telemetry showing creation of the scheduled task"}, {"ScreenshotName": "CS-7.C.1-3.png", "ScreenshotCaption": "General Behavior alert from OverWatch indicating scheduled task creation was suspicious (tainted by previous cmd.exe detection by orange line indicating medium severity)"}, {"ScreenshotName": "CS-E-4.png", "ScreenshotCaption": "Email excerpt from OverWatch team indicating they observed a scheduled task establishing persistence (Specific Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "General Behavior", "DetectionNote": "OverWatch generated a General Behavior alert indicating the creation of the scheduled task was suspicious. The process tree view showed the alert as tainted by a previous cmd.exe detection.[CS1]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "CS-7.C.1-2.png", "ScreenshotCaption": "Telemetry showing creation of the scheduled task"}, {"ScreenshotName": "CS-7.C.1-3.png", "ScreenshotCaption": "General Behavior alert from OverWatch indicating scheduled task creation was suspicious (tainted by previous cmd.exe detection by orange line indicating medium severity)"}, {"ScreenshotName": "CS-E-4.png", "ScreenshotCaption": "Email excerpt from OverWatch team indicating they observed a scheduled task establishing persistence (Specific Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the creation of the scheduled task.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-7.C.1-2.png", "ScreenshotCaption": "Telemetry showing creation of the scheduled task"}, {"ScreenshotName": "CS-7.C.1-3.png", "ScreenshotCaption": "General Behavior alert from OverWatch indicating scheduled task creation was suspicious (tainted by previous cmd.exe detection by orange line indicating medium severity)"}, {"ScreenshotName": "CS-E-4.png", "ScreenshotCaption": "Email excerpt from OverWatch team indicating they observed a scheduled task establishing persistence (Specific Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched schtasks.exe creating the Resume Viewer Update Checker scheduled task as reboot persistence and as SYSTEM. The data was also mapped to the correct ATT&CK Tactic (Persistence).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-7.C.1-10.png", "ScreenshotCaption": "Enrichment of schtasks.exe with the correct ATT&CK Tactic (Persistence)"}, {"ScreenshotName": "CR-7.C.1-11.png", "ScreenshotCaption": "Telemetry showing the Resume Viewer Update Checker scheduled task"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the Resume Viewer Update Checker scheduled task.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-7.C.1-10.png", "ScreenshotCaption": "Enrichment of schtasks.exe with the correct ATT&CK Tactic (Persistence)"}, {"ScreenshotName": "CR-7.C.1-11.png", "ScreenshotCaption": "Telemetry showing the Resume Viewer Update Checker scheduled task"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert for \"Persistence-Scheduled Task Creation\" was generated (tainted by parent Malicious File Detection alert). \u00a0The alert was also mapped to the correct ATT&CK Technique (T1053 - Scheduled Task) and Tactic (Persistence).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-07-2.png", "ScreenshotCaption": "Enrichment of scheduled task from persistence hunt"}, {"ScreenshotName": "EG-07-3.png", "ScreenshotCaption": "Enriched event tree showing enrichment of scheduled task with correct ATT&CK Technique (T1053 - Scheduled Task) and Tactic (Persistence) (tainted by parent Malicious File Detection, tree is initially available unenriched to show the base telemetry)"}, {"ScreenshotName": "EG-07-4.png", "ScreenshotCaption": "Specific Behavior alert for scheduled task creation mapped to correct ATT&CK Technique (T1053 - Scheduled Task) and Tactic (Persistence) (tainted by parent Malicious File Detection alert)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched data from a hunt for persistence via scheduled task, which showed the \\\"Resume Viewer Update Checker\\\" scheduled task.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-07-2.png", "ScreenshotCaption": "Enrichment of scheduled task from persistence hunt"}, {"ScreenshotName": "EG-07-3.png", "ScreenshotCaption": "Enriched event tree showing enrichment of scheduled task with correct ATT&CK Technique (T1053 - Scheduled Task) and Tactic (Persistence) (tainted by parent Malicious File Detection, tree is initially available unenriched to show the base telemetry)"}, {"ScreenshotName": "EG-07-4.png", "ScreenshotCaption": "Specific Behavior alert for scheduled task creation mapped to correct ATT&CK Technique (T1053 - Scheduled Task) and Tactic (Persistence) (tainted by parent Malicious File Detection alert)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the event tree with the correct ATT&CK Technique (T1053 - Scheduled Task) and Tactic (Persistence) (tainted by parent Malicious File Detection alert). [EG11]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-07-2.png", "ScreenshotCaption": "Enrichment of scheduled task from persistence hunt"}, {"ScreenshotName": "EG-07-3.png", "ScreenshotCaption": "Enriched event tree showing enrichment of scheduled task with correct ATT&CK Technique (T1053 - Scheduled Task) and Tactic (Persistence) (tainted by parent Malicious File Detection, tree is initially available unenriched to show the base telemetry)"}, {"ScreenshotName": "EG-07-4.png", "ScreenshotCaption": "Specific Behavior alert for scheduled task creation mapped to correct ATT&CK Technique (T1053 - Scheduled Task) and Tactic (Persistence) (tainted by parent Malicious File Detection alert)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showing creation of the scheduled task data was also visible in a event tree (tainted by parent Malicious File Detection alert). [EG11]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-07-2.png", "ScreenshotCaption": "Enrichment of scheduled task from persistence hunt"}, {"ScreenshotName": "EG-07-3.png", "ScreenshotCaption": "Enriched event tree showing enrichment of scheduled task with correct ATT&CK Technique (T1053 - Scheduled Task) and Tactic (Persistence) (tainted by parent Malicious File Detection, tree is initially available unenriched to show the base telemetry)"}, {"ScreenshotName": "EG-07-4.png", "ScreenshotCaption": "Specific Behavior alert for scheduled task creation mapped to correct ATT&CK Technique (T1053 - Scheduled Task) and Tactic (Persistence) (tainted by parent Malicious File Detection alert)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe registering the \"Resume Viewer Update Checker\" scheduled task.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-7.C.1-2.png", "ScreenshotCaption": "Telemetry showing schtasks.exe with command-line arguments scheduling a task for persistence"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that updater.dll persisted through the creation of a scheduled task. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-7.C.1-1.png", "ScreenshotCaption": "Enrichment of schtasks.exe with Scheduled Task Activity alert (tagged with correct ATT&CK Technique, T1053 - Scheduled Task, and Tactic, Execution, Persistence, Privilege Escalation)"}, {"ScreenshotName": "FE-7.C.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating updater.dll persisted through a scheduled task (Specific Behavior)"}, {"ScreenshotName": "FE-7.C.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about schtask"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched schtasks.exe with an alert for Scheduled Task Activity (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1053 - Scheduled Task) and Tactics (Execution, Persistence, and Privilege Escalation).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-7.C.1-1.png", "ScreenshotCaption": "Enrichment of schtasks.exe with Scheduled Task Activity alert (tagged with correct ATT&CK Technique, T1053 - Scheduled Task, and Tactic, Execution, Persistence, Privilege Escalation)"}, {"ScreenshotName": "FE-7.C.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating updater.dll persisted through a scheduled task (Specific Behavior)"}, {"ScreenshotName": "FE-7.C.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about schtask"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert called \"Schtasks with create command\" was generated due to a schtasks.exe process create from cmd.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CT-7.C.1-1.png", "ScreenshotCaption": "Specific Behavior alert on \\\"Schtasks with create command\\\" for schtasks.exe run from cmd.exe"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the Schtasks alert showed a process creation of schtasks.exe from cmd.exe, and would be available in a separate view.[CT9]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CT-7.C.1-1.png", "ScreenshotCaption": "Specific Behavior alert on \\\"Schtasks with create command\\\" for schtasks.exe run from cmd.exe"}], "Footnotes": ["For this alert, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not specifically taken in this instance."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for a task being created that runs an executable (via rundll32) under system rights at Windows logon. The alert was tagged with the correct ATT&CK Tactics (Execution, Persistence, Privilege Escalation) and Technique (Scheduled Task).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-7.C.1-3.png", "ScreenshotCaption": "Telemetry showed cmd.exe creating the \"Resume Viewer Update Checker\" scheduled task via schtasks.exe (tainted by a trace detection on cmd.exe)"}, {"ScreenshotName": "MC-7.C.1-1.png", "ScreenshotCaption": "Specific Behavior alert for a task being created that runs an executable (via rundll32) under system rights at Windows logon, tagged with the correct ATT&CK Tactics (Execution, Persistence, Privilege Escalation) and Technique (Scheduled Task)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe creating the \"Resume Viewer Update Checker\" scheduled task via schtasks.exe. The telemetry was tainted by a trace detection on cmd.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-7.C.1-3.png", "ScreenshotCaption": "Telemetry showed cmd.exe creating the \"Resume Viewer Update Checker\" scheduled task via schtasks.exe (tainted by a trace detection on cmd.exe)"}, {"ScreenshotName": "MC-7.C.1-1.png", "ScreenshotCaption": "Specific Behavior alert for a task being created that runs an executable (via rundll32) under system rights at Windows logon, tagged with the correct ATT&CK Tactics (Execution, Persistence, Privilege Escalation) and Technique (Scheduled Task)"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A delayed Specific Behavior alert was generated on a low-reputation DLL persisting through a scheduled task.", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "MS-7.C.1-1.png", "ScreenshotCaption": "Telemetry showing schtasks.exe with command-line arguments scheduling a task for persistence"}, {"ScreenshotName": "MS-7.C.1-2.png", "ScreenshotCaption": "Alert for low-reputation DLL persisting through rundll32.exe as a scheduled task"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe registering the \"Resume Viewer Update Checker\" scheduled task.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-7.C.1-1.png", "ScreenshotCaption": "Telemetry showing schtasks.exe with command-line arguments scheduling a task for persistence"}, {"ScreenshotName": "MS-7.C.1-2.png", "ScreenshotCaption": "Alert for low-reputation DLL persisting through rundll32.exe as a scheduled task"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for a commonly abused host process scheduling a task. The alert was tainted by a parent process injection alert on cmd.exe.[PA4]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-7.C.1-1.png", "ScreenshotCaption": "Telemetry showing schtasks.exe creating the scheduled task (tainted by a parent process injection alert on cmd.exe)"}, {"ScreenshotName": "PA-7.C.1-2.png", "ScreenshotCaption": "Specific Behavior alert for the creation of a new scheduled task (tainted by a parent process injection alert on cmd.exe)"}, {"ScreenshotName": "PA-7.C.1-3.png", "ScreenshotCaption": "Specific Behavior alert for a commonly abused host process scheduling a task (tainted by a parent process injection alert on cmd.exe)"}, {"ScreenshotName": "PA-7.C.1-4.png", "ScreenshotCaption": "Enrichment of schtasks.exe creating the Resume Viewer Update Checker scheduled task with the correct ATT&CK Technique (Scheduled Task)"}], "Footnotes": ["Vendor stated the capability would have prevented the creation of the scheduled task."]}, {"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for the creation of a new scheduled task. The alert was tainted by a parent process injection alert on cmd.exe.[PA4]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-7.C.1-1.png", "ScreenshotCaption": "Telemetry showing schtasks.exe creating the scheduled task (tainted by a parent process injection alert on cmd.exe)"}, {"ScreenshotName": "PA-7.C.1-2.png", "ScreenshotCaption": "Specific Behavior alert for the creation of a new scheduled task (tainted by a parent process injection alert on cmd.exe)"}, {"ScreenshotName": "PA-7.C.1-3.png", "ScreenshotCaption": "Specific Behavior alert for a commonly abused host process scheduling a task (tainted by a parent process injection alert on cmd.exe)"}, {"ScreenshotName": "PA-7.C.1-4.png", "ScreenshotCaption": "Enrichment of schtasks.exe creating the Resume Viewer Update Checker scheduled task with the correct ATT&CK Technique (Scheduled Task)"}], "Footnotes": ["Vendor stated the capability would have prevented the creation of the scheduled task."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched schtasks.exe creating the Resume Viewer Update Checker scheduled task with the correct ATT&CK Technique (Scheduled Task).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-7.C.1-1.png", "ScreenshotCaption": "Telemetry showing schtasks.exe creating the scheduled task (tainted by a parent process injection alert on cmd.exe)"}, {"ScreenshotName": "PA-7.C.1-2.png", "ScreenshotCaption": "Specific Behavior alert for the creation of a new scheduled task (tainted by a parent process injection alert on cmd.exe)"}, {"ScreenshotName": "PA-7.C.1-3.png", "ScreenshotCaption": "Specific Behavior alert for a commonly abused host process scheduling a task (tainted by a parent process injection alert on cmd.exe)"}, {"ScreenshotName": "PA-7.C.1-4.png", "ScreenshotCaption": "Enrichment of schtasks.exe creating the Resume Viewer Update Checker scheduled task with the correct ATT&CK Technique (Scheduled Task)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed schtasks.exe creating the Resume Viewer Update Checker scheduled task as reboot persistence and as SYSTEM. The telemetry was tainted by a parent process injection alert on cmd.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-7.C.1-1.png", "ScreenshotCaption": "Telemetry showing schtasks.exe creating the scheduled task (tainted by a parent process injection alert on cmd.exe)"}, {"ScreenshotName": "PA-7.C.1-2.png", "ScreenshotCaption": "Specific Behavior alert for the creation of a new scheduled task (tainted by a parent process injection alert on cmd.exe)"}, {"ScreenshotName": "PA-7.C.1-3.png", "ScreenshotCaption": "Specific Behavior alert for a commonly abused host process scheduling a task (tainted by a parent process injection alert on cmd.exe)"}, {"ScreenshotName": "PA-7.C.1-4.png", "ScreenshotCaption": "Enrichment of schtasks.exe creating the Resume Viewer Update Checker scheduled task with the correct ATT&CK Technique (Scheduled Task)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution of schtasks.exe as well as the full command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-07-2.png", "ScreenshotCaption": "Telemetry showing the schtask.exe and command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of schtasks.exe and associated command-line arguments. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-7.C.1-1.png", "ScreenshotCaption": "Telemetry showing schtask.exe and associated command-line arguments (tainted by relationship to threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "8.A.1", "Procedure": "Cobalt Strike: 'dir -s -b \"\\\\conficker\\wormshare\"' via cmd", "Techniques": [{"TechniqueId": "T1083", "TechniqueName": "File and Directory Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched cmd.exe with the correct ATT&CK Technique (T1083 - File and Directory Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-8.A.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing dir with command-line arguments"}, {"ScreenshotName": "CB-8.C.1-2.png", "ScreenshotCaption": "Enrichment of cmd.exe with correct ATT&CK Technique (T1083 - File and Directory Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing dir with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-8.A.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing dir with command-line arguments"}, {"ScreenshotName": "CB-8.C.1-2.png", "ScreenshotCaption": "Enrichment of cmd.exe with correct ATT&CK Technique (T1083 - File and Directory Discovery)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe running dir. The process tree view showed the cmd.exe process that ran dir as tainted by a prior detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-8.A.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe running dir with command-line arguments (search was on commands running within the past 10 minutes)"}, {"ScreenshotName": "CS-8.A.1-2.png", "ScreenshotCaption": "Process tree view showing cmd.exe that ran dir (dir not specifically shown, cmd.exe is second from top and tainted by previous detection by orange line indicating medium severity)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched cmd.exe executing dir with command-line arguments with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery). The data was tainted by a parent Injected Shellcode alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-8.A.1-10.png", "ScreenshotCaption": "Enrichment of cmd.exe executing the dir with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery) (tainted by a parent Injected Shellcode alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing dir with command-line arguments. [CR5]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-8.A.1-10.png", "ScreenshotCaption": "Enrichment of cmd.exe executing the dir with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery) (tainted by a parent Injected Shellcode alert)"}], "Footnotes": [" The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched dir with the correct ATT&CK Technique (T1083 - File and Directory Discovery) and Tactic (Discovery). The enrichment was also tainted by a parent Malicious File Detection.[EG11]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-08-1.png", "ScreenshotCaption": "Enriched event tree showing enrichment of dir with the correct ATT&CK Technique (T1083 - File and Directory Discovery) and Tactic (Discovery) (tainted by parent Malicious File Detection, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within an event tree (tainted by a parent Malicious File Detection) showed cmd.exe executing dir with command-line arguments. [EG11]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-08-1.png", "ScreenshotCaption": "Enriched event tree showing enrichment of dir with the correct ATT&CK Technique (T1083 - File and Directory Discovery) and Tactic (Discovery) (tainted by parent Malicious File Detection, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing dir) which was identified as extremely rare and suspicious.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-8.A.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing dir)"}, {"ScreenshotName": "CC-8.A.1-99.png", "ScreenshotCaption": "Enrichment of cmd.exe executing the dir command indicating that the parameter was a directory listing of a network drive associated with potential reconnaissance."}, {"ScreenshotName": "CC-8.A.1-98.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running dir) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}], "Footnotes": []}, {"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (cmd.exe running dir) has been tagged for monitoring because its parent process has a detection (rundll32.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-8.A.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing dir)"}, {"ScreenshotName": "CC-8.A.1-99.png", "ScreenshotCaption": "Enrichment of cmd.exe executing the dir command indicating that the parameter was a directory listing of a network drive associated with potential reconnaissance."}, {"ScreenshotName": "CC-8.A.1-98.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running dir) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched cmd.exe executing the dir command indicating that the parameter was a directory listing of a network drive associated with potential reconnaissance.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-8.A.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing dir)"}, {"ScreenshotName": "CC-8.A.1-99.png", "ScreenshotCaption": "Enrichment of cmd.exe executing the dir command indicating that the parameter was a directory listing of a network drive associated with potential reconnaissance."}, {"ScreenshotName": "CC-8.A.1-98.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running dir) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched cmd.exe executing dir with an alert for Dir Command (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1083 - File and Directory Discovery) and Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-8.A.1-1.png", "ScreenshotCaption": "Enrichment of cmd.exe executing dir with Dir Command alert (tagged with correct ATT&CK Technique, T1083 - File and Directory Discovery and, Tactic, Discovery)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed that svchost.exe created cmd.exe, which executed dir. The telemetry was tainted by the parent \\\"Powershell process created\\\" alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-8.A.1-1.png", "ScreenshotCaption": "Telemetry showing dir with command-line arguments (tainted by the parent \\\"Powershell process created\\\" alert)"}], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched cmd.exe executing the dir command with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-8.A.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing the dir command (tainted by a trace detection on cmd.exe)"}, {"ScreenshotName": "MC-8.A.2-5.png", "ScreenshotCaption": "Enrichment of cmd.exe executing the dir command with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing the dir command. The telemetry was tainted by a trace detection on cmd.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-8.A.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing the dir command (tainted by a trace detection on cmd.exe)"}, {"ScreenshotName": "MC-8.A.2-5.png", "ScreenshotCaption": "Enrichment of cmd.exe executing the dir command with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery)"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence for cmd.exe executing dir with command-line arguments. The telemetry was tainted by a prior alert on rundll32.exe being executed without command-line arguments.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-8.A.1-1.png", "ScreenshotCaption": "Telemetry showing execution sequence of cmd.exe executing dir with command-line arguments"}, {"ScreenshotName": "MS-8.A.1-2.png", "ScreenshotCaption": "Process tree view of rundll32.exe \\\"Unexpected behavior from process run with no command-line arguments\\\" alert that tainted dir (dir command not shown)"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "A General Behavior alert was generated for a commonly abused process (cmd.exe) spawning out of rundll32.exe. The alert was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-8.A.1-1.png", "ScreenshotCaption": "Telemetry showed cmd.exe executing dir with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-8.A.1-2.png", "ScreenshotCaption": "Enrichment of cmd executing dir with command-line arguments as the execution of the dir command on a network location (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-8.A.1-4.png", "ScreenshotCaption": "Enrichment of cmd.exe executing dir with command-line arguments with the correct ATT&CK Technique (File and Directory Discovery)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched cmd.exe executing dir with command-line arguments as the execution of the dir command on a network location. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-8.A.1-1.png", "ScreenshotCaption": "Telemetry showed cmd.exe executing dir with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-8.A.1-2.png", "ScreenshotCaption": "Enrichment of cmd executing dir with command-line arguments as the execution of the dir command on a network location (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-8.A.1-4.png", "ScreenshotCaption": "Enrichment of cmd.exe executing dir with command-line arguments with the correct ATT&CK Technique (File and Directory Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing dir with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-8.A.1-1.png", "ScreenshotCaption": "Telemetry showed cmd.exe executing dir with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-8.A.1-2.png", "ScreenshotCaption": "Enrichment of cmd executing dir with command-line arguments as the execution of the dir command on a network location (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-8.A.1-4.png", "ScreenshotCaption": "Enrichment of cmd.exe executing dir with command-line arguments with the correct ATT&CK Technique (File and Directory Discovery)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing dir with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-08-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing dir with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing dir with command-line arguments. The telemetry was tainted by the activity seen during the initial compromise step because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-8.A.1-2.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing dir with command-line arguments (tainted by relationship to threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "8.A.2", "Procedure": "Cobalt Strike: 'tree \"C:\\Users\\debbie\"' via cmd", "Techniques": [{"TechniqueId": "T1083", "TechniqueName": "File and Directory Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched tree.com with the correct ATT&CK Technique (T1083 - File and Directory Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-8.A.1-2.png", "ScreenshotCaption": "Telemetry from process tree showing tree.com with command-line arguments"}, {"ScreenshotName": "CB-8.C.1-2.png", "ScreenshotCaption": "Enrichment of tree.com with correct ATT&CK Technique (T1083 - File and Directory Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing tree.com with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-8.A.1-2.png", "ScreenshotCaption": "Telemetry from process tree showing tree.com with command-line arguments"}, {"ScreenshotName": "CB-8.C.1-2.png", "ScreenshotCaption": "Enrichment of tree.com with correct ATT&CK Technique (T1083 - File and Directory Discovery)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "OverWatch generated a General Behavior alert indicating tree.com was suspicious. The process tree view showed the alert as tainted by a previous cmd.exe detection.[CS1]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "CS-8.A.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe running tree with command-line arguments (search was on commands running within the past 10 minutes)"}, {"ScreenshotName": "CS-8.A.1-2.png", "ScreenshotCaption": "OverWatch General Behavior alert indicating tree.com was suspicious (tainted by previous detection by orange line indicating medium severity)"}, {"ScreenshotName": "CS-8.A.2-2.png", "ScreenshotCaption": "Additional details for OverWatch General Behavior alert indicating tree.com was suspicious (tainted by previous detection by orange line indicating medium severity)"}, {"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating tree was a reconnaissance command (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team also sent an email indicating a General Behavior was identified because tree was one of the reconnaissance commands performed.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-8.A.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe running tree with command-line arguments (search was on commands running within the past 10 minutes)"}, {"ScreenshotName": "CS-8.A.1-2.png", "ScreenshotCaption": "OverWatch General Behavior alert indicating tree.com was suspicious (tainted by previous detection by orange line indicating medium severity)"}, {"ScreenshotName": "CS-8.A.2-2.png", "ScreenshotCaption": "Additional details for OverWatch General Behavior alert indicating tree.com was suspicious (tainted by previous detection by orange line indicating medium severity)"}, {"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating tree was a reconnaissance command (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe running tree with command-line arguments. The process tree view also showed the cmd.exe that was the parent for tree.com as tainted by a prior detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-8.A.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe running tree with command-line arguments (search was on commands running within the past 10 minutes)"}, {"ScreenshotName": "CS-8.A.1-2.png", "ScreenshotCaption": "OverWatch General Behavior alert indicating tree.com was suspicious (tainted by previous detection by orange line indicating medium severity)"}, {"ScreenshotName": "CS-8.A.2-2.png", "ScreenshotCaption": "Additional details for OverWatch General Behavior alert indicating tree.com was suspicious (tainted by previous detection by orange line indicating medium severity)"}, {"ScreenshotName": "CS-E-3.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating tree was a reconnaissance command (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched cmd.exe executing tree with command-line arguments with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery). The data was tainted by a parent Injected Shellcode alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-8.A.1-20.png", "ScreenshotCaption": "Enrichment of cmd.exe executing the tree with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery) (tainted by a parent Injected Shellcode alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing tree with command-line arguments. [CR5]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-8.A.1-20.png", "ScreenshotCaption": "Enrichment of cmd.exe executing the tree with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery) (tainted by a parent Injected Shellcode alert)"}], "Footnotes": [" The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched tree with the correct ATT&CK Technique (T1083 - File and Directory Discovery) and Tactic (Discovery). The enrichment was also tainted by a parent Malicious File Detection).[EG11]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-08-1.png", "ScreenshotCaption": "Enriched event tree showing enrichment of tree with the correct ATT&CK Technique (T1083 - File and Directory Discovery) and Tactic (Discovery) (tainted by parent Malicious File Detection, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within an event tree (tainted by a parent Malicious File Detection) showed cmd.exe executing tree with command-line arguments.[EG11]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-08-1.png", "ScreenshotCaption": "Enriched event tree showing enrichment of tree with the correct ATT&CK Technique (T1083 - File and Directory Discovery) and Tactic (Discovery) (tainted by parent Malicious File Detection, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing tree) which was identified as extremely rare and suspicious.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-8.A.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing tree)"}, {"ScreenshotName": "CC-8.A.2-2.png", "ScreenshotCaption": "Enrichment of tree.exe with a tag identifying the command as enumeration"}, {"ScreenshotName": "CC-8.A.1-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running tree) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}], "Footnotes": []}, {"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (cmd.exe running tree) has been tagged for monitoring because its parent process has a detection (rundll32.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-8.A.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing tree)"}, {"ScreenshotName": "CC-8.A.2-2.png", "ScreenshotCaption": "Enrichment of tree.exe with a tag identifying the command as enumeration"}, {"ScreenshotName": "CC-8.A.1-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running tree) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched cmd.exe executing the tree command with a tag identifying the command as enumeration.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-8.A.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing tree)"}, {"ScreenshotName": "CC-8.A.2-2.png", "ScreenshotCaption": "Enrichment of tree.exe with a tag identifying the command as enumeration"}, {"ScreenshotName": "CC-8.A.1-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running tree) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that the attacker performed a directory listing of the contents of Debbie's user profile directory. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-8.A.1-2.png", "ScreenshotCaption": "Enrichment of cmd.exe executing tree with Tree Command Execution alert (tagged with correct ATT&CK Technique, T1083 - File and Directory Discovery and Tactic, Discovery)"}, {"ScreenshotName": "FE-7.C.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report identifying a directory listing of Debbie's profile directory (Specific Behavior)"}, {"ScreenshotName": "FE-8.A.1-4.png", "ScreenshotCaption": "Excerpt from Managed Defense Report showing additional details about tree"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched cmd.exe executing tree with an alert for Tree Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1083 - File and Directory Discovery) and Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-8.A.1-2.png", "ScreenshotCaption": "Enrichment of cmd.exe executing tree with Tree Command Execution alert (tagged with correct ATT&CK Technique, T1083 - File and Directory Discovery and Tactic, Discovery)"}, {"ScreenshotName": "FE-7.C.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report identifying a directory listing of Debbie's profile directory (Specific Behavior)"}, {"ScreenshotName": "FE-8.A.1-4.png", "ScreenshotCaption": "Excerpt from Managed Defense Report showing additional details about tree"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed that svchost.exe created cmd.exe, which executed tree with command-line arguments. The telemetry was tainted by the parent \\\"Powershell process created\\\" alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-8.A.2-1.png", "ScreenshotCaption": "Telemetry showing tree with command-line arguments (tainted by the parent \\\"Powershell process created\\\" alert)"}], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched cmd.exe executing the tree.exe with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-8.A.1-2.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing tree.exe (tainted by a trace detection on cmd.exe)"}, {"ScreenshotName": "MC-8.A.2-5.png", "ScreenshotCaption": "Enrichment of tree.exe with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing tree.exe. The telemetry was tainted by a trace detection on cmd.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-8.A.1-2.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing tree.exe (tainted by a trace detection on cmd.exe)"}, {"ScreenshotName": "MC-8.A.2-5.png", "ScreenshotCaption": "Enrichment of tree.exe with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery)"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence for cmd.exe executing tree.com with command-line arguments. The telemetry was tainted by a prior alert on rundll32.exe being executed without command-line arguments.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-8.A.2-1.png", "ScreenshotCaption": "Telemetry showing execution sequence of cmd.exe executing tree.com with command-line arguments"}, {"ScreenshotName": "MS-8.A.1-2.png", "ScreenshotCaption": "Process tree view of rundll32.exe \\\"Unexpected behavior from process run with no command-line arguments\\\" alert that tainted tree (tree command not shown)"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched cmd.exe executing tree with command-line arguments with the correct ATT&CK Technique (File and Directory Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-8.A.2-1.png", "ScreenshotCaption": "Telemetry showed cmd.exe executing tree with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-8.A.2-2.png", "ScreenshotCaption": "Enrichment of cmd.exe executing tree with command-line arguments with the correct ATT&CK Technique (File and Directory Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing tree with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-8.A.2-1.png", "ScreenshotCaption": "Telemetry showed cmd.exe executing tree with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {"ScreenshotName": "PA-8.A.2-2.png", "ScreenshotCaption": "Enrichment of cmd.exe executing tree with command-line arguments with the correct ATT&CK Technique (File and Directory Discovery)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing tree with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-08-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing tree with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing tree with command-line arguments. The telemetry was tainted by the activity seen during the initial compromise step because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-8.A.1-3.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing tree with command-line arguments (tainted by relationship to threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "8.B.1", "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "Techniques": [{"TechniqueId": "T1057", "TechniqueName": "Process Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the execution of a specific API call as process enumeration and suspicious activity. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.[PA7]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-8.B.1-1.png", "ScreenshotCaption": "Enrichment of the execution of a specific API call as process enumeration and suspicious activity (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}], "Footnotes": ["The process tree showing taintedness is visible within the same UI but did not fit within the current frame."]}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}]}, {"Substep": "8.C.1", "Procedure": "Cobalt Strike: Built-in keylogging capability executed to capture keystrokes of user Debbie", "Techniques": [{"TechniqueId": "T1056", "TechniqueName": "Input Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[CB2]", "Modifiers": [], "Screenshots": [], "Footnotes": [" The vendor indicated that CB Defense sees applicable API calls, but that product was not included in the evaluation."]}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed explorer.exe injecting from a known beacon (does not detect input capture specifically).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-8.C.1-1.png", "ScreenshotCaption": "Telemetry showing injected thread events (explorer.exe, pid=21776848613, injecting from cmd.exe, pid=21898821890) (does not count as a detection)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability was available, though an alert was generated based on a chain of injections caused by process injection of powershell.exe to cmd.exe then explorer.exe.\u00a0Data within the alert showed the\u00a0loaded keyloggerx64.dll module, and additional data showed the memory address and size of the module within explorer.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-8.C.1-10.png", "ScreenshotCaption": "Alert for Chain of Injections for powershell.exe injecting into cmd.exe (does not count as detection)"}, {"ScreenshotName": "CR-8.C.1-100.png", "ScreenshotCaption": "Alert for Chain of Injections showing powershell.exe injecting into explorer.exe (does not count as detection)"}, {"ScreenshotName": "CR-8.C.1-11.png", "ScreenshotCaption": "Alert showing loaded keyloggerx64.dll module (does not count as detection)"}, {"ScreenshotName": "CR-8.C.1-12.png", "ScreenshotCaption": "Alert showing keyloggerx64.dll module loaded into explorer.exe, including memory address and size (does not count as a detection)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though strings were pulled from a Process Injection alert, which identified functionality of code to indicate keylogging, but no proof of execution was identified.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-08-2.png", "ScreenshotCaption": "Event tree showing a Process Injection alert from which strings were pulled (does not count as a detection)"}, {"ScreenshotName": "EG-08-4.png", "ScreenshotCaption": "Strings output extracted from Process Injection alert, showing key definitions typically associated with a keylogger, but no evidence of execution (does not count as a detection)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed a remote thread being created from cmd.exe in explorer.exe. The vendor noted that if a user determined the process creation was suspicious, the user could manually kick off a DDNA scan from the Command-Line Interface (CLI) view by using the Process ID (PID).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CT-8.C.1-1.png", "ScreenshotCaption": "Telemetry showing remote thread being created into explorer.exe (does not count as a detection)"}, {"ScreenshotName": "CT-8.C.1-2.png", "ScreenshotCaption": "Command-Line Interface view for host Nimda kicking off DDNA Scan for PID 11252 (does not count as a detection)"}, {"ScreenshotName": "CT-8.C.1-3.png", "ScreenshotCaption": "DDNA JSON output from PID 11252 showing process capabilities (does not count as a detection)"}], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though an alert indicated cmd.exe obtained a handle to the memory thread and injected code into explorer.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-8.C.1-3.png", "ScreenshotCaption": "Alert that cmd.exe obtained a handle to the memory thread and injected code into explorer.exe (does not count as detection)"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A delayed Specific Behavior alert was generated on \"Possible keylogging activity\" against explorer.exe.", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "MS-8.C.1-3.png", "ScreenshotCaption": "Telemetry showing explorer.exe reading user keystrokes"}, {"ScreenshotName": "MS-8.C.1-1.png", "ScreenshotCaption": "Execution sequence showing cmd.exe injecting into explorer.exe (does not count as a detection)"}, {"ScreenshotName": "MS-8.C.1-2.png", "ScreenshotCaption": "Specific Behavior alert for \\\"Possible keylogging activity\\\" against explorer.exe"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed events indicating \"explorer.exe is reading user keystrokes.\"", "Modifiers": ["Configuration Change"], "Screenshots": [{"ScreenshotName": "MS-8.C.1-3.png", "ScreenshotCaption": "Telemetry showing explorer.exe reading user keystrokes"}, {"ScreenshotName": "MS-8.C.1-1.png", "ScreenshotCaption": "Execution sequence showing cmd.exe injecting into explorer.exe (does not count as a detection)"}, {"ScreenshotName": "MS-8.C.1-2.png", "ScreenshotCaption": "Specific Behavior alert for \\\"Possible keylogging activity\\\" against explorer.exe"}], "Footnotes": ["The vendor stated that Input Capture telemetry is captured but it was not immediately visible in the user portal. The vendor made changes to the portal during the test to enable the visibility of these events.", "Telemetry also showed cmd.exe injecting into explorer.exe to facilitate the keylogging, but this did not identify input capture specifically so was not counted as a detection."]}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the execution of a specific API call as keylogging and suspicious activity. Though it does not count as a detection, the capability also showed code and hook injections into explorer.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-8.C.1-1.png", "ScreenshotCaption": "Enrichment of the execution of a specific API call as keylogging and suspicious activity"}, {"ScreenshotName": "PA-8.C.1-2.png", "ScreenshotCaption": "Telemetry showing code injection into explorer.exe (does not count as a detection)"}, {"ScreenshotName": "PA-8.C.1-3.png", "ScreenshotCaption": "Telemetry showing hook injection from explorer.exe (does not count as a detection)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though a floating code \"IIOC\" module alerted with a elevated risk score for DLL injection. An analyst could explore the module and observe the keylogger aggressor script, but this only showed that there is a potential capability of a keylogger, not that execution occurred.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-08-2.png", "ScreenshotCaption": "Floating Code module output showing keylogger aggressor script (does not count as a detection)"}, {"ScreenshotName": "RSA-08-3.png", "ScreenshotCaption": "Floating Code module output showing keylogger key definitions (does not count as a detection)"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed GetAsyncKeyStateApi, which was indicative of keylogging. The telemetry was tainted by the activity seen during the initial compromise step because it was associated with the same story (Group ID).[SO3]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-8.C.1-2.png", "ScreenshotCaption": "Telemetry showing GetAsyncKeyStateApi (Group ID tainted the event but was not shown in this view)"}, {"ScreenshotName": "S1-8.C.1-1.png", "ScreenshotCaption": "Telemetry showing process injection into explorer.exe (does not count as a detection)"}], "Footnotes": [" Vendor stated log files indicate the powershell process was using the SSL cache folder."]}]}]}]}, {"Substep": "8.C.1", "Procedure": "Cobalt Strike: Keylogging capability included residual enumeration of application windows", "Techniques": [{"TechniqueId": "T1010", "TechniqueName": "Application Window Discovery", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}]}, {"Substep": "8.D.1", "Procedure": "Cobalt Strike: Built-in screen capture capability executed to capture screenshot of current window of user Debbie", "Techniques": [{"TechniqueId": "T1113", "TechniqueName": "Screen Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though modloads showed the thumbnail com object masquerading followed by a modload of dwmapi.dll (Microsoft Desktop Windows Manager API) and then a crossprocess (open process) to the target application, which could be indicative of screen capture behavior.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-8.D.1-1.png", "ScreenshotCaption": "Telemetry showing modloads and crossprocess events (does not count as a detection)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed explorer.exe injecting from a known beacon (does not detect screen capture specifically).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-8.D.1-2.png", "ScreenshotCaption": "Telemetry showing injected thread events (explorer.exe, pid=21776848613, injecting from cmd.exe, pid=21898821890) (does not count as a detection)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability was available, though an alert was generated based on explorer.exe being flagged for loading a Meterpreter Agent. Data within a previous process injection alert showed the\u00a0loaded screenshotx64.dll module.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-8.D.1-11.png", "ScreenshotCaption": "Alert for explorer.exe loading a Meterpreter agent (does not count as detection)"}, {"ScreenshotName": "CR-8.D.1-10.png", "ScreenshotCaption": "Alert showing loaded screenshotx64.dll module (does not count as a detection)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though strings were pulled from a Process Injection alert, which identified functionality of code to indicate screen capture, but no proof of execution was identified.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-08-5.png", "ScreenshotCaption": "Strings output extracted from Process Injection alert, showing BitBlt and CreateCompatibleBitmap that could be associated with screen capture, but no evidence of execution (does not count as a detection)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed a remote thread being created from cmd.exe into explorer.exe. The vendor also noted that if a user determined the process creation was suspicious, the user could manually kick off a DDNA scan. DDNA results on this process reported \"This module may capture screen shots,\" indicating the module has the capability to perform this.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CT-8.D.1-1.png", "ScreenshotCaption": "Telemetry showing remote thread being created into explorer.exe (does not count as a detection)"}, {"ScreenshotName": "CT-8.D.1-2.png", "ScreenshotCaption": "DDNA JSON output showing the process had the capability to capture screen shots (does not count as a detection; DDNA scan was manually initiated)"}], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched an explorer.exe process with ScreenshotTaken.[MS31]", "Modifiers": ["Configuration Change"], "Screenshots": [{"ScreenshotName": "MS-8.D.1-1.png", "ScreenshotCaption": "Enrichment of explorer.exe with ScreenshotTaken"}], "Footnotes": ["The vendor stated that screen capture telemetry is captured but it was not immediately visible in the portal. The vendor made changes to the portal during the test to enable by default the visibility of these events, so this detection is identified as a configuration change."]}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the execution of a specific API call as information gathering using screen capture and suspicious activity.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-8.D.1-1.png", "ScreenshotCaption": "Enrichment of the execution of a specific API call using screen capture and suspicious activity"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though a floating code \"IIOC\" module alerted with a elevated risk score for DLL injection. An analyst could explore the module and observe multiple components related to jpegs, which may be related to screenshots, but does not show that execution occurred.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-08-4.png", "ScreenshotCaption": "Floating Code module generated from DLL injection showing multiple jpeg components (does not count as a detection)"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}]}, {"Substep": "8.D.1", "Procedure": "Cobalt Strike: Screen capture capability involved process injection into explorer.exe", "Techniques": [{"TechniqueId": "T1055", "TechniqueName": "Process Injection", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a cross-process \"open handle\" event into explorer.exe, which could be indicative of process injection.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-8.D.1-1.png", "ScreenshotCaption": "Telemetry showing \\\"open handle\\\" crossproc on explorer.exe by the process"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed InjectedThread events for explorer.exe (pid=21776848613) injecting from cmd.exe (pid=21898821890), which is a known beacon.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-8.D.1-2.png", "ScreenshotCaption": "Telemetry showing injected thread events (explorer.exe, pid=21776848613, injecting from cmd.exe, pid=21898821890)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated based on a malicious code injection caused by process injection of explorer.exe. The alert was mapped with the correct ATT&CK Tactics (Defense Evasion, Privilege Escalation) and Technique (Process Injection) and indicated that explorer.exe was hosting injected threads and loading malicious files.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-8.D.1-21.png", "ScreenshotCaption": "Specific Behavior alert for process injection explorer.exe rolled into chain of injections"}, {"ScreenshotName": "CR-8.D.1-20.png", "ScreenshotCaption": "Specific Behavior alert for Malicious code injection to explorer.exe with correct ATT&CK Tactic (Defense Evasion, Privilege Escalation) and Technique (Process Injection)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert for process injection was generated with cmd.exe as the source. The alert was tainted by parent Malicious File Detection and process injection alerts, and was also labeled with the correct ATT&CK Technique (T1055 - Process Injection) and Tactics (Defense Evasion and Execution).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-08-3.png", "ScreenshotCaption": "Event tree showing process injection Specific Behavior alert (last alert in the view, ID 2561310) (tainted by parent Malicious File Detection and process injection alerts and labeled with the correct ATT&CK Technique, Process Injection, and Tactics, Defense Evasion and Execution)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a remote thread being created from cmd.exe into explorer.exe, which could be indicative of process injection.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CT-8.D.1-1.png", "ScreenshotCaption": "Telemetry showing remote thread being created into explorer.exe"}], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for code injection into explorer.exe. The alert was tagged with the correct ATT&CK Tactics (Defense Evasion, Privilege Escalation) and Technique (Process Injection) and was tainted by a trace detection on cmd.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-8.D.1-9.png", "ScreenshotCaption": "Specific Behavior alert for code injection into explorer.exe, tagged with the correct ATT&CK Tactics (Defense Evasion, Privilege Escalation) and Technique (Process Injection)"}, {"ScreenshotName": "MC-8.D.1-1.png", "ScreenshotCaption": "Specific Behavior alert for code injection into explorer.exe (tainted by a trace detection on cmd.exe)"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the execution sequence for cmd.exe injecting into explorer.exe with the label \\\"Inject to process.\\\"", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-8.D.1-2.png", "ScreenshotCaption": "Enrichment of execution sequence showing cmd.exe injecting into explorer.exe (labeled \\\"Inject to process\\\")"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched cmd.exe injecting into explorer.exe as code injection via CreateThread.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-8.D.1-2.png", "ScreenshotCaption": "Enrichment of cmd.exe injecting into explorer.exe as code injection via CreateThread"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though a floating code \"IIOC\" module alerted with a elevated risk score for DLL injection. There was no telemetry available for the processes that were injected to verify its relation this procedure.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-08-4.png", "ScreenshotCaption": "Floating Code module generated from DLL injection showing introspection into the module's characteristics (does not count as a detection)"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the sequence of events related to process injection from powershell.exe into explorer.exe. The capability associated the process with the highest threat to the event (powershell.exe) instead of cmd.exe (the expected source of the injection) because it had an alert associated with it previously. The telemetry was tainted by the activity seen during the initial compromise step because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-8.D.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe injecting into explorer.exe (Group ID tainted this event but was not shown in this view)"}], "Footnotes": []}]}]}]}, {"Substep": "9.A.1", "Procedure": "Cobalt Strike: 'ls' (List) via Win32 APIs to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Techniques": [{"TechniqueId": "T1083", "TechniqueName": "File and Directory Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[PA2]", "Modifiers": [], "Screenshots": [], "Footnotes": ["Vendor stated that more information would be available if their firewall appliance was installed and activated."]}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}]}, {"Substep": "9.B.1", "Procedure": "Cobalt Strike: Built-in download capability executed to a collect file (Shockwave_rackb_diagram.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Techniques": [{"TechniqueId": "T1039", "TechniqueName": "Data from Network Shared Drive", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed connection between Nimda (10.0.1.6) and the source of the file, Conficker (10.0.0.5), over port 445.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-9.B.1-20.png", "ScreenshotCaption": "Telemetry showing a port 445 connection between Nimda (10.0.1.6) and the source of the file on Conficker (10.0.0.5) (does not count as detection)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though file creation telemetry showed that the .vsdx file was created (no indication it was created from a shared drive).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-09-3.png", "ScreenshotCaption": "Telemetry showing .vsdx file creation, but no indication of network shared drive (does not count as a detection)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[MS32]", "Modifiers": [], "Screenshots": [], "Footnotes": ["The vendor stated that by default WDATP monitored activities around all the most used documents (doc, xls, ppt pdf, etc) at the time of the evaluation. Subsequently, the vendor made changes to enable the visibility of .vsdx events by default, which is now available in WDATP."]}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a file read event for the .vsdx file from the network shared drive.[PA2]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-9.B.1-1.png", "ScreenshotCaption": "Telemetry showing a file read event for the .vsdx file from the network shared drive"}], "Footnotes": ["Vendor stated that more information would be available if their firewall appliance was installed and activated."]}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed remote file access behavior for the .vsdx file from the network shared drive.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "S1-9.B.1-1.png", "ScreenshotCaption": "Telemetry showing .vsdx file access from WormShare on the network shared drive"}], "Footnotes": []}]}]}]}, {"Substep": "9.B.1", "Procedure": "Cobalt Strike: Download capability exfiltrated data through existing C2 channel", "Techniques": [{"TechniqueId": "T1041", "TechniqueName": "Exfiltration Over Command and Control Channel", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed connection between Nimda (10.0.1.6) and the source of the file, Conficker (10.0.0.5), over port 445.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-9.B.1-20.png", "ScreenshotCaption": "Telemetry showing a port 445 connection between Nimda (10.0.1.6) and the source of the file on Conficker (10.0.0.5) (does not count as detection)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though DNS requests for freegoogleadsenseinfo.com (C2 domain) were observed.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-9.B.1-1.png", "ScreenshotCaption": "DNS requests to freegoogleadsenseinfo.com (C2 domain) (does not count as a detection)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though port 53 network traffic to/from freegoogleadsenseinfo.com (C2 domain) was observed.[PA2]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-9.B.1-2.png", "ScreenshotCaption": "Port 53 network traffic to/from freegoogleadsenseinfo.com (C2 domain) (does not count as a detection)"}], "Footnotes": ["Vendor stated that more information would be available if their firewall appliance was installed and activated."]}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}]}, {"Substep": "10.A.1", "Procedure": "Batch file (autoupdate.bat) previously written to Startup folder executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (update.dat) using Rundll32", "Techniques": [{"TechniqueId": "T1060", "TechniqueName": "Registry Run Keys / Startup Folder", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed cmd.exe executing autoupdate.bat from the Startup folder.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-10.A.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing cmd.exe executing autoupdate.bat from Startup folder"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe running autoupdate.bat from the Startup folder.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-10.A.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe running autoupdate.bat from Startup folder"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed rundll32.exe executing autoupdate.bat from the Startup folder. The telemetry was tainted by a parent Injected Shellcode alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-10.A.1-100.png", "ScreenshotCaption": "Telemetry showing rundll32.exe executing autoupdate.bat from the Startup folder (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-10.A.1-10.png", "ScreenshotCaption": "Parent alert for Injected shellcode into rundll32.exe"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the process chain for rundll32.exe execution of update.dat. The telemetry was tainted by the parent alert for \\\"RunDLL32 with Suspicious DLL Location.\\\"", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-10-5.png", "ScreenshotCaption": "Telemetry showing rundll32.exe executing update.dat (tainted by parent \\\"RunDLL32 with Suspicious DLL Location\\\" alert)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for a batch file automatically being started from the Startup folder.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-10.A.1-1.png", "ScreenshotCaption": "Specific Behavior alert for a batch file automatically being started from the Startup folder."}, {"ScreenshotName": "CC-10.A.1-2.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing autoupdate.bat from the Startup folder"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing autoupdate.bat from the Startup folder.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-10.A.1-1.png", "ScreenshotCaption": "Specific Behavior alert for a batch file automatically being started from the Startup folder."}, {"ScreenshotName": "CC-10.A.1-2.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing autoupdate.bat from the Startup folder"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that autoupdate.bat persisted due to its presence in the startup directory. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-10.A.1-1.png", "ScreenshotCaption": "Enrichment of cmd.exe executing from Startup with Process Execution Startup alert (tagged with correct ATT&CK Technique, T1060 - Registry Run Keys / Startup Folder and Tactic, Persistence)"}, {"ScreenshotName": "FE-10.A.1-2.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing autoupdate.bat from Startup folder"}, {"ScreenshotName": "FE-10.A.1-3.png", "ScreenshotCaption": "Telemetry showing rundll32.exe executing update.dat (tainted by parent Rundll32 Execution alert)"}, {"ScreenshotName": "FE-10.A.1-4.png", "ScreenshotCaption": "Additional details of rundll32.exe telemetry"}, {"ScreenshotName": "FE-10.A.1-5.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating autoupdate.bat persisted due to its presence in startup (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched cmd.exe executing a file from Startup with an alert for Process Execution Startup. The alert was also tagged with the correct ATT&CK Technique (T1060 - Registry Run Keys / Startup Folder) and Tactic (Persistence).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-10.A.1-1.png", "ScreenshotCaption": "Enrichment of cmd.exe executing from Startup with Process Execution Startup alert (tagged with correct ATT&CK Technique, T1060 - Registry Run Keys / Startup Folder and Tactic, Persistence)"}, {"ScreenshotName": "FE-10.A.1-2.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing autoupdate.bat from Startup folder"}, {"ScreenshotName": "FE-10.A.1-3.png", "ScreenshotCaption": "Telemetry showing rundll32.exe executing update.dat (tainted by parent Rundll32 Execution alert)"}, {"ScreenshotName": "FE-10.A.1-4.png", "ScreenshotCaption": "Additional details of rundll32.exe telemetry"}, {"ScreenshotName": "FE-10.A.1-5.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating autoupdate.bat persisted due to its presence in startup (Specific Behavior)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing autoupdate.bat from the Startup folder.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-10.A.1-1.png", "ScreenshotCaption": "Enrichment of cmd.exe executing from Startup with Process Execution Startup alert (tagged with correct ATT&CK Technique, T1060 - Registry Run Keys / Startup Folder and Tactic, Persistence)"}, {"ScreenshotName": "FE-10.A.1-2.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing autoupdate.bat from Startup folder"}, {"ScreenshotName": "FE-10.A.1-3.png", "ScreenshotCaption": "Telemetry showing rundll32.exe executing update.dat (tainted by parent Rundll32 Execution alert)"}, {"ScreenshotName": "FE-10.A.1-4.png", "ScreenshotCaption": "Additional details of rundll32.exe telemetry"}, {"ScreenshotName": "FE-10.A.1-5.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating autoupdate.bat persisted due to its presence in startup (Specific Behavior)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed rundll32.exe executing update.dll with command-line arguments. The telemetry was tainted by the parent alert for Rundll32 Execution (Weak Signal).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "FE-10.A.1-1.png", "ScreenshotCaption": "Enrichment of cmd.exe executing from Startup with Process Execution Startup alert (tagged with correct ATT&CK Technique, T1060 - Registry Run Keys / Startup Folder and Tactic, Persistence)"}, {"ScreenshotName": "FE-10.A.1-2.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing autoupdate.bat from Startup folder"}, {"ScreenshotName": "FE-10.A.1-3.png", "ScreenshotCaption": "Telemetry showing rundll32.exe executing update.dat (tainted by parent Rundll32 Execution alert)"}, {"ScreenshotName": "FE-10.A.1-4.png", "ScreenshotCaption": "Additional details of rundll32.exe telemetry"}, {"ScreenshotName": "FE-10.A.1-5.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating autoupdate.bat persisted due to its presence in startup (Specific Behavior)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe starting rundll32.exe, which started update.dat, as well as cmd.exe executing autoupdate.bat from the Startup folder.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CT-10.A.1-2.png", "ScreenshotCaption": "Telemetry showing cmd.exe starting rundll32.exe"}, {"ScreenshotName": "CT-10.A.1-3.png", "ScreenshotCaption": "Telemetry showing explorer.exe creating cmd.exe and executing .bat from startup"}], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing autoupdate.bat from the Startup folder, then update.dat via rundll32.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-10.A.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing autoupdate.bat then update.dat via rundll32.exe"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence of cmd.exe executing autoupdate.bat from the Startup folder to start update.dat.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-10.A.1-1.png", "ScreenshotCaption": "Telemetry showing Startup folder execution sequence for autoupdate.bat on user logon"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing autoupdate.bat from the Startup folder.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-10.A.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing autoupdate.bat from the Startup folder"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing autoupdate.bat from the Startup folder.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-10-1.png", "ScreenshotCaption": "Telemetry showing the execution of autoupdate.bat from the Startup Folder"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of autoupdate.bat from the Startup folder for persistence. The telemetry was associated to a new story (Group ID) but was not marked as malicious or tainted because it is not associated with an alert.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "S1-10.A.1-2.png", "ScreenshotCaption": "Telemetry showing execution of autoupdate.bat from the Startup folder"}, {"ScreenshotName": "S1-10.A.1-3.png", "ScreenshotCaption": "Group ID query showing both autoupdate.bat and updater.dll persistence execution"}], "Footnotes": []}]}]}]}, {"Substep": "10.A.2", "Procedure": "Scheduled task executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (updater.dll) using Rundll32", "Techniques": [{"TechniqueId": "T1053", "TechniqueName": "Scheduled Task", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed rundll32.exe executing updater.dll with a parent of svchost.exe running with command-line arguments \\\"-k netsvcs -p -s Schedule\\\".", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-10.A.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing svchost.exe parent of rundll32.exe process running with \\\"-k netsvcs -p -s Schedule\\\" arguments"}, {"ScreenshotName": "CB-10.A.2-2.png", "ScreenshotCaption": "Telemetry from process tree showing updater.dll executed by rundll32.exe"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed rundll32.exe starting updater.dll. The telemetry was tainted by the parent OverWatch alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-10.A.2-2.png", "ScreenshotCaption": "Telemetry showing rundll32.exe executing updater.dll (tainted by the parent OverWatch alert)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed rundll32.exe executing update.dat with command-line arguments. The telemetry was tainted by a parent Injected Shellcode alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-10.A.2-100.png", "ScreenshotCaption": "Telemetry showing rundll32.exe executing update.dat (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-10.A.1-20.png", "ScreenshotCaption": "Parent alert for Injected shellcode into rundll32.exe"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the event tree showed rundll32.exe executing updater.dll. The telemetry was tainted by a Malicious File Detection alert for updater.dll and a Process Injection alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-10-1.png", "ScreenshotCaption": "Telemetry showing rundll32.exe executing updater.dll (tainted by Malicious File Detection alert)"}, {"ScreenshotName": "EG-10-2.png", "ScreenshotCaption": "Telemetry showing rundll32.exe executing updater.dll (tainted by Process Injection alert)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed rundll32.exe executing updater.dll.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-10.A.1-2.png", "ScreenshotCaption": "Telemetry showing rundll32 starting updater.dll, tainted by an \"abnormal rundll32 launch\" alert"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified the Resume Viewer Update Checker scheduled task executing updater.dll with rundll32.exe. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-10.A.2-1.png", "ScreenshotCaption": "Telemetry showing rundll32.exe executing updater.dll"}, {"ScreenshotName": "FE-10.A.2-2.png", "ScreenshotCaption": "Parent Rundll32 Execution alert that tainted updater.dll telemetry (tagged with related ATT&CK Technique, T1085 - Rundll32, and Tactic, Defense Evasion, Execution; does not include specific Scheduled Task information)"}, {"ScreenshotName": "FE-10.A.2-3.png", "ScreenshotCaption": "Excerpt from Managed Defense Report indicating the Resume Viewer Update Checker scheduled task executed updater.dll with rundll32.exe (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed svchost.exe executing rundll32.exe, which executed updater.dll. The telemetry was tainted by the parent Rundll32 Execution alert, which was tagged with a related ATT&CK Technique (T1085 - Rundll32) and Tactic (Defense Evasion, Execution), but did not include information on the use of a Scheduled Task specifically.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "FE-10.A.2-1.png", "ScreenshotCaption": "Telemetry showing rundll32.exe executing updater.dll"}, {"ScreenshotName": "FE-10.A.2-2.png", "ScreenshotCaption": "Parent Rundll32 Execution alert that tainted updater.dll telemetry (tagged with related ATT&CK Technique, T1085 - Rundll32, and Tactic, Defense Evasion, Execution; does not include specific Scheduled Task information)"}, {"ScreenshotName": "FE-10.A.2-3.png", "ScreenshotCaption": "Excerpt from Managed Defense Report indicating the Resume Viewer Update Checker scheduled task executed updater.dll with rundll32.exe (Specific Behavior)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed svchost.exe executing rundll32.exe, which executed updater.dll. The telemetry was tainted by the parent \\\"Sponsor process started V2\\\" alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-10.A.2-1.png", "ScreenshotCaption": "Telemetry showing svchost.exe executing rundll32.exe (tainted by parent \\\"Sponsor process started V2\\\" alert)"}], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed rundll32.exe executing updater.dll with a parent of svchost.exe running with command-line arguments \"-k netsvcs -p -s Schedule\".", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-10.A.2-1.png", "ScreenshotCaption": "Telemetry showing rundll32.exe executing updater.dll with a parent of svchost.exe running with command-line arguments \"-k netsvcs -p -s Schedule\""}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence for rundll32.exe executing updater.dll with a parent of svchost.exe running with command-line arguments \\\"-k netsvcs -p -s Schedule\\\".", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-10.A.2-1.png", "ScreenshotCaption": "Telemetry showing execution sequence for svchost.exe parent of rundll32.exe process running with \\\"-k netsvcs -p -s Schedule\\\" arguments"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence for rundll32.exe executing updater.dll with a parent of svchost.exe running with command-line arguments \"-k netsvcs -p -s Schedule\".", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-10.A.2-3.png", "ScreenshotCaption": "Telemetry showing svchost.exe running with command-line arguments \"-k netsvcs -p -s Schedule\""}, {"ScreenshotName": "PA-10.A.2-4.png", "ScreenshotCaption": "Telemetry showing rundll32.exe executing updater.dll"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed rundll32.exe executing updater.dll.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-10-2.png", "ScreenshotCaption": "Telemetry showing rundll32.exe executing updater.dll"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed rundll32.exe executing updater.dll as part of the scheduled task persistence. The telemetry was associated with the execution of autoupdate.bat for persistence because it was associated with the same story (Group ID) but is not marked as malicious or tainted because it is not associated with an alert.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "S1-10.A.1-3.png", "ScreenshotCaption": "Group ID query showing both autoupdate.bat and updater.dll persistence execution"}, {"ScreenshotName": "S1-10.A.2-2.png", "ScreenshotCaption": "Telemetry showing rundll32.exe executing updater.dll"}], "Footnotes": []}]}]}]}, {"Substep": "10.B.1", "Procedure": "RDP connection to Conficker (10.0.0.5) authenticated using previously added user Jesse", "Techniques": [{"TechniqueId": "T1078", "TechniqueName": "Valid Accounts", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched rdpclip.exe with the correct ATT&CK Technique (Remote Desktop Protocol).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-10.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing rdpclip.exe running as user Jesse"}, {"ScreenshotName": "CB-10.B.1-2.png", "ScreenshotCaption": "Enrichment of rdpclip.exe with correct ATT&CK Technique (Remote Desktop Protocol)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed rdpclip.exe execution by the user Jesse on the destination system of the RDP connection.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-10.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing rdpclip.exe running as user Jesse"}, {"ScreenshotName": "CB-10.B.1-2.png", "ScreenshotCaption": "Enrichment of rdpclip.exe with correct ATT&CK Technique (Remote Desktop Protocol)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a type 10 (interactive) UserLogon event for Jesse.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-10.B.1-1.png", "ScreenshotCaption": "Telemetry showing user logon by Jesse to Conficker"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the logon session for Jesse to Conficker (10.0.0.5) as a Remote Interactive Logon Type.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-10.B.1-10.png", "ScreenshotCaption": "Telemetry of logon session for Jesse from Nimda (10.0.1.6) to Conficker (10.0.0.5) with Remote Interactive Logon Type"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed that the userinit.exe process was running as the user Jesse, indicating Jesse logged in. The telemetry was tainted by the parent \\\"Start Folder Persistence\\\" alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-10-3.png", "ScreenshotCaption": "Telemetry showing userinit.exe running as Jesse (tainted by parent \\\"Start Folder Persistence\\\" alert)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a remote interactive logon event for the account Jesse logging on to Conficker (10.0.0.5) over port 3389.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-10.B.1-T1076-new.png", "ScreenshotCaption": "Telemetry showing a RemoteInteractive connection as Jesse over port 3389 to Conficker (10.0.0.5)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that the account Jesse was used to log in to Conficker as part of Lateral Movement.[FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-10.B.1-2.png", "ScreenshotCaption": "Telemetry showing Logon Type 10 (interactive) event for Jesse logging on to Conficker"}, {"ScreenshotName": "FE-10.B.1-3.png", "ScreenshotCaption": "Excerpt from Managed Defense Report indicating account Jesse was used to logon to Conficker as part of Lateral Movement (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a Logon Type 10 (interactive) event for the account Jesse logging on to Conficker.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-10.B.1-2.png", "ScreenshotCaption": "Telemetry showing Logon Type 10 (interactive) event for Jesse logging on to Conficker"}, {"ScreenshotName": "FE-10.B.1-3.png", "ScreenshotCaption": "Excerpt from Managed Defense Report indicating account Jesse was used to logon to Conficker as part of Lateral Movement (Specific Behavior)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed that the explorer.exe process was running as the user Jesse, indicating the account exists.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CT-10.B.1-1.png", "ScreenshotCaption": "Telemetry showing explorer.exe running as Jesse"}], "Footnotes": []}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a remote interactive logon for Jesse to Conficker (10.0.0.5).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-10.B.1-1.png", "ScreenshotCaption": "Telemetry showing a remote interactive logon for Jesse to Conficker (10.0.0.5)"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the new local user account Jesse logging into Conficker.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-10.B.1-1.png", "ScreenshotCaption": "Telemetry showing local user account Jesse first and last seen logons on Conficker"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed userinit.exe as well as explorer.exe spawn as the user Jesse.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-10.B.1-1.png", "ScreenshotCaption": "Telemetry showing userinit.exe as well as explorer.exe spawn as the user Jesse"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed \\\"unregmp2.exe /FirstLogon\\\" (associated with user logon) as well as the user name \\\"Jesse J\\\" within Machine Properties.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-10-3.png", "ScreenshotCaption": "Telemetry showing \\\"unregmp2.exe /FirstLogon\\\" (associated with user logon)"}, {"ScreenshotName": "RSA-10-4.png", "ScreenshotCaption": "Telemetry showing user name \\\"Jesse J\\\" within Machine Properties"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the Jesse account had logged into the system.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "S1-10.B.1-3.png", "ScreenshotCaption": "Telemetry showing last logged on user identified as Jesse"}], "Footnotes": []}]}]}]}, {"Substep": "10.B.1", "Procedure": "RDP connection made to Conficker (10.0.0.5) as part of execution of persistence mechanism", "Techniques": [{"TechniqueId": "T1076", "TechniqueName": "Remote Desktop Protocol", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched rdpclip.exe with the correct ATT&CK Technique (Remote Desktop Protocol).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-10.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing rdpclip.exe running as user Jesse"}, {"ScreenshotName": "CB-10.B.1-2.png", "ScreenshotCaption": "Enrichment of rdpclip.exe with correct ATT&CK Technique (Remote Desktop Protocol)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed rdpclip.exe execution by the user Jesse on the destination system of the RDP connection.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-10.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing rdpclip.exe running as user Jesse"}, {"ScreenshotName": "CB-10.B.1-2.png", "ScreenshotCaption": "Enrichment of rdpclip.exe with correct ATT&CK Technique (Remote Desktop Protocol)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team sent an email indicating a General Behavior occurred because they observed suspicious communications over 3389 (RDP) to other hosts.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-E-1.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating suspicious communications over 3389 (RDP) were observed (General Behavior)"}, {"ScreenshotName": "CS-10.B.1-1.png", "ScreenshotCaption": "Telemetry showing user logon by Jesse to Conficker with type 10 (interactive logon)"}, {"ScreenshotName": "CS-10.B.1-2.png", "ScreenshotCaption": "Telemetry showing logged-on user activity, including the use of rdpclip.exe"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the remote connection to Conficker for a user logon by Jesse with type 10 (interactive) as well as the use of rdpclip.exe by the logged-on user.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-E-1.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating suspicious communications over 3389 (RDP) were observed (General Behavior)"}, {"ScreenshotName": "CS-10.B.1-1.png", "ScreenshotCaption": "Telemetry showing user logon by Jesse to Conficker with type 10 (interactive logon)"}, {"ScreenshotName": "CS-10.B.1-2.png", "ScreenshotCaption": "Telemetry showing logged-on user activity, including the use of rdpclip.exe"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the logon session for Jesse to Conficker (10.0.0.5) as a Remote Interactive Logon Type. Telemetry also showed a connection over port 3389 to Conficker (10.0.0.5) through rundll32.exe serving as a proxy. The telemetry was tainted by a parent Injected Shellcode alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-10.B.1-10.png", "ScreenshotCaption": "Telemetry of logon session for Jesse from Nimda (10.0.1.6) to Conficker (10.0.0.5) with Remote Interactive Logon Type"}, {"ScreenshotName": "CR-10.B.1-20.png", "ScreenshotCaption": "Telemetry showing a TCP port 3389 connection to Conficker (10.0.0.5)"}, {"ScreenshotName": "CR-10.B.1-100.png", "ScreenshotCaption": "Telemetry showing rundll32.exe process used to proxy connection over port 3389 from Nimda (10.0.1.6) to Conficker (10.0.0.5) (tainted by a parent Injected Shellcode alert)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a Type 10 logon event (corresponding to interactive) for Jesse as well remote connections over port 3389 to 10.0.0.5 (Conficker).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-10-6.png", "ScreenshotCaption": "Telemetry showing Type 10 (interactive) logon for Jesse"}, {"ScreenshotName": "EG-10-7.png", "ScreenshotCaption": "Telemetry showing remote connections over port 3389 to 10.0.0.5 (Conficker)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a remote interactive logon event for the account Jesse logging on to Conficker (10.0.0.5) over port 3389.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-10.B.1-T1076-new.png", "ScreenshotCaption": "Telemetry showing a RemoteInteractive connection over port 3389 to Conficker (10.0.0.5)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified the user account Jesse logged on to Conficker via Remote Desktop Protocol. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-10.B.1-1.png", "ScreenshotCaption": "Enrichment of port 3389 connection with RDP Network Connection alert (tagged with correct ATT&CK Technique, T1076 - Remote Desktop Protocol, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-10.B.1-4.png", "ScreenshotCaption": "Telemetry showing Logon Type 10 (interactive) event for Jesse logging on to Conficker"}, {"ScreenshotName": "FE-10.B.1-3.png", "ScreenshotCaption": "Excerpt from Managed Defense Report indicating account Jesse was used to logon via Remote Desktop Protocol (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched a TCP port 3389 connection to 10.0.0.5 (Conficker) with the alert RDP Network Connection (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1076 - Remote Desktop Protocol) and Tactic (Lateral Movement).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-10.B.1-1.png", "ScreenshotCaption": "Enrichment of port 3389 connection with RDP Network Connection alert (tagged with correct ATT&CK Technique, T1076 - Remote Desktop Protocol, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-10.B.1-4.png", "ScreenshotCaption": "Telemetry showing Logon Type 10 (interactive) event for Jesse logging on to Conficker"}, {"ScreenshotName": "FE-10.B.1-3.png", "ScreenshotCaption": "Excerpt from Managed Defense Report indicating account Jesse was used to logon via Remote Desktop Protocol (Specific Behavior)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a Logon Type 10 (interactive) event for the account Jesse logging on to Conficker.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-10.B.1-1.png", "ScreenshotCaption": "Enrichment of port 3389 connection with RDP Network Connection alert (tagged with correct ATT&CK Technique, T1076 - Remote Desktop Protocol, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-10.B.1-4.png", "ScreenshotCaption": "Telemetry showing Logon Type 10 (interactive) event for Jesse logging on to Conficker"}, {"ScreenshotName": "FE-10.B.1-3.png", "ScreenshotCaption": "Excerpt from Managed Defense Report indicating account Jesse was used to logon via Remote Desktop Protocol (Specific Behavior)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched a TCP port 3389 (RDP) connection to 10.0.0.5 (Conficker) with the conditions Lateral Movement and Remote Share Access. One connection event was tainted by the parent \\\"Windows command prompt invoked\\\" alert. [CT19]", "Modifiers": ["Configuration Change", "Tainted"], "Screenshots": [{"ScreenshotName": "CT-10.B.1-2.png", "ScreenshotCaption": "Enrichment of TCP port 3389 (RDP) connection to 10.0.0.5 (Conficker) with conditions Lateral Movement and Remote Share Access (tainted by the parent \\\"Windows command prompt invoked\\\" alert)"}], "Footnotes": ["The conditions contributing to Enrichment were added to the capability's detection after the start of the evaluation, so this detection is identified as a configuration change. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the rundll32.exe that made the network connection with the correct ATT&CK Tactic (Lateral Movement) and Technique (Remote Desktop Protocol).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-10.B.1-1.png", "ScreenshotCaption": "Telemetry showing a remote interactive logon for Jesse to Conficker (10.0.0.5)"}, {"ScreenshotName": "MC-10.B.1-3.png", "ScreenshotCaption": "Telemetry showing a connection over port 3389 to Conficker (10.0.0.5) (tainted by parent alert on rundll32.exe)"}, {"ScreenshotName": "MC-10.A.1-1.png", "ScreenshotCaption": "Enrichment of the rundll32.exe that made the network connection with the correct ATT&CK Tactic (Lateral Movement) and Technique (Remote Desktop Protocol)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a remote interactive logon for Jesse to Conficker (10.0.0.5) as well as a connection to 10.0.0.5 (Conficker) over port 3389 from rundll32.exe. The telemetry was tainted by a trace detection on rundll32.exe", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-10.B.1-1.png", "ScreenshotCaption": "Telemetry showing a remote interactive logon for Jesse to Conficker (10.0.0.5)"}, {"ScreenshotName": "MC-10.B.1-3.png", "ScreenshotCaption": "Telemetry showing a connection over port 3389 to Conficker (10.0.0.5) (tainted by parent alert on rundll32.exe)"}, {"ScreenshotName": "MC-10.A.1-1.png", "ScreenshotCaption": "Enrichment of the rundll32.exe that made the network connection with the correct ATT&CK Tactic (Lateral Movement) and Technique (Remote Desktop Protocol)"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed\u00a0a successful connection to Conficker (10.0.0.5) over port 3389 from rundll32.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-10.B.1-2.png", "ScreenshotCaption": "Telemetry showing successful port 3389 connection to Conficker (10.0.0.5)"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the network connection over port 3389 with the correct ATT&CK Technique (Remote Desktop Protocol).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-10.B.1-2.png", "ScreenshotCaption": "Telemetry showed a successful incoming connection to Conficker (10.0.0.5) over port 3389"}, {"ScreenshotName": "PA-10.B.1-3.png", "ScreenshotCaption": "Enrichment of the network connection over port 3389 with the correct ATT&CK Technique (Remote Desktop Protocol)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a successful incoming connection to Conficker (10.0.0.5) over port 3389.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-10.B.1-2.png", "ScreenshotCaption": "Telemetry showed a successful incoming connection to Conficker (10.0.0.5) over port 3389"}, {"ScreenshotName": "PA-10.B.1-3.png", "ScreenshotCaption": "Enrichment of the network connection over port 3389 with the correct ATT&CK Technique (Remote Desktop Protocol)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry from Nimda showed a TCP port 3389 connection from 10.0.1.6 (Nimda) to 10.0.0.5 (Conficker). The rundll32.exe process (PID 184) that was used to load updater.dll was used to proxy the RDP connection to Conficker. The telemetry was tainted by the activity generated during the privilege escalation step because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-10.B.1-1.png", "ScreenshotCaption": "Telemetry showing connection over port 3389 to 10.0.0.5 (Conficker)"}, {"ScreenshotName": "S1-10.B.1-2.png", "ScreenshotCaption": "Threat group identified as malicious, including rundll32.exe (PID 184) proxying the port 3389 connection (port 3389 connection not specifically shown in this view, but it identifies the rundll32.exe process tainting the connection by Group ID)"}], "Footnotes": []}]}]}]}, {"Substep": "11.A.1", "Procedure": "Legitimate user Bob clicked and executed malicious VBScript (autoupdate.vbs) on 10.0.1.5 (CodeRed)", "Techniques": [{"TechniqueId": "T1064", "TechniqueName": "Scripting", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior Alert was generated indicating that powershell.exe was a suspicious child process of wscript.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-11.A.1-1.png", "ScreenshotCaption": "Enrichment of wscript.exe and powershell.exe with correct ATT&CK Techniques (T1063 - Scripting, T1086 - Powershell)"}, {"ScreenshotName": "CB-11.A.1-2.png", "ScreenshotCaption": "Telemetry showing process tree of script execution"}, {"ScreenshotName": "CB-11.A.1-3.png", "ScreenshotCaption": "Specific Behavior alerts for Powershell scripting"}], "Footnotes": []}, {"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated indicating that powershell.exe was executed with encoded command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-11.A.1-1.png", "ScreenshotCaption": "Enrichment of wscript.exe and powershell.exe with correct ATT&CK Techniques (T1063 - Scripting, T1086 - Powershell)"}, {"ScreenshotName": "CB-11.A.1-2.png", "ScreenshotCaption": "Telemetry showing process tree of script execution"}, {"ScreenshotName": "CB-11.A.1-3.png", "ScreenshotCaption": "Specific Behavior alerts for Powershell scripting"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched wscript.exe and powershell.exe with the correct ATT&CK Techniques (T1063 - Scripting, T1086 - Powershell).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-11.A.1-1.png", "ScreenshotCaption": "Enrichment of wscript.exe and powershell.exe with correct ATT&CK Techniques (T1063 - Scripting, T1086 - Powershell)"}, {"ScreenshotName": "CB-11.A.1-2.png", "ScreenshotCaption": "Telemetry showing process tree of script execution"}, {"ScreenshotName": "CB-11.A.1-3.png", "ScreenshotCaption": "Specific Behavior alerts for Powershell scripting"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry of a process tree showed powershell.exe execution, including full command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-11.A.1-1.png", "ScreenshotCaption": "Enrichment of wscript.exe and powershell.exe with correct ATT&CK Techniques (T1063 - Scripting, T1086 - Powershell)"}, {"ScreenshotName": "CB-11.A.1-2.png", "ScreenshotCaption": "Telemetry showing process tree of script execution"}, {"ScreenshotName": "CB-11.A.1-3.png", "ScreenshotCaption": "Specific Behavior alerts for Powershell scripting"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated indicating \"A PowerShell script launched that shares characteristics with known PowerShell exploit kits.\"", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-11.A.1-1.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell sharing characteristics with known exploit kits"}, {"ScreenshotName": "CS-11.A.1-2.png", "ScreenshotCaption": "General Behavior alert from OverWatch for wscript.exe executing launcher.vbs was suspicious"}, {"ScreenshotName": "CS-E-6.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating a malicious script was run (Specific Behavior)"}], "Footnotes": []}, {"DetectionType": "Specific Behavior", "DetectionNote": "The OverWatch team also sent an email indicating a Specific Behavior was observed because a malicious script invoked by wscript was run by Bob on CodeRed and launched PowerShell.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-11.A.1-1.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell sharing characteristics with known exploit kits"}, {"ScreenshotName": "CS-11.A.1-2.png", "ScreenshotCaption": "General Behavior alert from OverWatch for wscript.exe executing launcher.vbs was suspicious"}, {"ScreenshotName": "CS-E-6.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating a malicious script was run (Specific Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated from OverWatch indicating wscript.exe executing launcher.vbs was suspicious.[CS1]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-11.A.1-1.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell sharing characteristics with known exploit kits"}, {"ScreenshotName": "CS-11.A.1-2.png", "ScreenshotCaption": "General Behavior alert from OverWatch for wscript.exe executing launcher.vbs was suspicious"}, {"ScreenshotName": "CS-E-6.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating a malicious script was run (Specific Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the OverWatch alert showed wscript.exe executing launcher.vbs, and would be available in a separate view.[CS2]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-11.A.1-1.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell sharing characteristics with known exploit kits"}, {"ScreenshotName": "CS-11.A.1-2.png", "ScreenshotCaption": "General Behavior alert from OverWatch for wscript.exe executing launcher.vbs was suspicious"}, {"ScreenshotName": "CS-E-6.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating a malicious script was run (Specific Behavior)"}], "Footnotes": ["For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for powershell.exe, labeled with Command and Control as well as Malicious use of PowerShell. The alert was tagged as a Obfuscated PowerShell payload and mapped to the correct ATT&CK Tactic (Execution) and Technique (PowerShell)", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-11.A.1-14.png", "ScreenshotCaption": "Specific Behavior alert for powershell.exe, labeled with Command and Control and Malicious use of PowerShell"}, {"ScreenshotName": "CR-11.A.1-11.png", "ScreenshotCaption": "Specific Behavior alert tagged as obfuscated PowerShell payload and downloader mapped to the correct ATT&CK Tactic (Execution) and Technique (PowerShell)"}, {"ScreenshotName": "CR-11.A.1-13.png", "ScreenshotCaption": "Telemetry showing decoded PowerShell command with command-line arguments (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-11.A.1-12.png", "ScreenshotCaption": "Telemetry showing wscript.exe executing autoupdate.vbs (tainted by a parent PowerShell alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe execution, including decoded full command-line arguments, as well as wscript.exe executing autoupdate.vbs.\u00a0The telemetry was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-11.A.1-14.png", "ScreenshotCaption": "Specific Behavior alert for powershell.exe, labeled with Command and Control and Malicious use of PowerShell"}, {"ScreenshotName": "CR-11.A.1-11.png", "ScreenshotCaption": "Specific Behavior alert tagged as obfuscated PowerShell payload and downloader mapped to the correct ATT&CK Tactic (Execution) and Technique (PowerShell)"}, {"ScreenshotName": "CR-11.A.1-13.png", "ScreenshotCaption": "Telemetry showing decoded PowerShell command with command-line arguments (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-11.A.1-12.png", "ScreenshotCaption": "Telemetry showing wscript.exe executing autoupdate.vbs (tainted by a parent PowerShell alert)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for \"Windows Script Executing PowerShell\" due to wscript.exe launching powershell.exe. The alert was mapped to the correct ATT&CK Technique (T1064 - Scripting) and Tactic (Execution).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-11-1.png", "ScreenshotCaption": "Specific Behavior alert for powershell.exe also showing telemetry for script execution  (mapped to related ATT&CK Technique, T1086 - PowerShell, and correct Tactic, Execution)"}, {"ScreenshotName": "EG-11-7.png", "ScreenshotCaption": "Specific Behavior alert for wscript.exe launching powershell.exe (mapped to the correct ATT&CK Technique, T1064 - Scripting, and Tactic, Execution)"}], "Footnotes": []}, {"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated indicating that powershell.exe ran with unusual arguments due to the -enc and -noP command-line arguments. The alert was mapped to a related ATT&CK Technique (T1086 - PowerShell) and the correct Tactic (Execution).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-11-1.png", "ScreenshotCaption": "Specific Behavior alert for powershell.exe also showing telemetry for script execution  (mapped to related ATT&CK Technique, T1086 - PowerShell, and correct Tactic, Execution)"}, {"ScreenshotName": "EG-11-7.png", "ScreenshotCaption": "Specific Behavior alert for wscript.exe launching powershell.exe (mapped to the correct ATT&CK Technique, T1064 - Scripting, and Tactic, Execution)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the process events associated with wscript.exe executing the autoupdate.vbs script (tainted by parent alert).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-11-1.png", "ScreenshotCaption": "Specific Behavior alert for powershell.exe also showing telemetry for script execution  (mapped to related ATT&CK Technique, T1086 - PowerShell, and correct Tactic, Execution)"}, {"ScreenshotName": "EG-11-7.png", "ScreenshotCaption": "Specific Behavior alert for wscript.exe launching powershell.exe (mapped to the correct ATT&CK Technique, T1064 - Scripting, and Tactic, Execution)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for PowerShell executing a long, encoded command.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-11.A.1-3.png", "ScreenshotCaption": "Telemetry showing wscript.exe executing autoupdate.vbs and subsequently powershell.exe"}, {"ScreenshotName": "CC-11.A.1-1.png", "ScreenshotCaption": "Enrichment of wscript.exe executing powershell.exe with a tag indicating that wscript executed code"}, {"ScreenshotName": "CC-11.A.1-5.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell executing a long, encoded command"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched wscript.exe executing powershell.exe with a tag indicating that wscript executed code.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-11.A.1-3.png", "ScreenshotCaption": "Telemetry showing wscript.exe executing autoupdate.vbs and subsequently powershell.exe"}, {"ScreenshotName": "CC-11.A.1-1.png", "ScreenshotCaption": "Enrichment of wscript.exe executing powershell.exe with a tag indicating that wscript executed code"}, {"ScreenshotName": "CC-11.A.1-5.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell executing a long, encoded command"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed wscript.exe executing autoupdate.vbs and subsequently powershell.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-11.A.1-3.png", "ScreenshotCaption": "Telemetry showing wscript.exe executing autoupdate.vbs and subsequently powershell.exe"}, {"ScreenshotName": "CC-11.A.1-1.png", "ScreenshotCaption": "Enrichment of wscript.exe executing powershell.exe with a tag indicating that wscript executed code"}, {"ScreenshotName": "CC-11.A.1-5.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell executing a long, encoded command"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for Suspicious PowerShell Usage (Methodology) indicating powershell.exe ran with unusual arguments due to the -enc and -noP command-line arguments. The alert was mapped to a related ATT&CK Technique (T1086 - PowerShell) and the correct Tactic (Execution) and captured the encoded command.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-11.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert for Suspicious PowerShell Usage showing powershell.exe execution (tagged with related ATT&CK Technique, T1086 - PowerShell, and correct Tactic, Execution)"}, {"ScreenshotName": "FE-11.A.1-3.png", "ScreenshotCaption": "Additional details on Specific Behavior alert for Suspicious PowerShell Usage"}, {"ScreenshotName": "FE-11.A.1-1.png", "ScreenshotCaption": "Enrichment of wscript.exe with Wscript Execution alert (tagged with correct ATT&CK Technique, T064 - Scripting, and Tactic, Execution)"}, {"ScreenshotName": "FE-11.A.1-4.png", "ScreenshotCaption": "Indicator of Compromise alert for EMPIRE RAT (tagged with related ATT&CK Technique, T1086 - PowerShell)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched wscript.exe with an alert for Wscript Execution (Weak Signal). The alert was tagged with the correct ATT&CK Technique (T1064 - Scripting) and Tactic (Execution).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-11.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert for Suspicious PowerShell Usage showing powershell.exe execution (tagged with related ATT&CK Technique, T1086 - PowerShell, and correct Tactic, Execution)"}, {"ScreenshotName": "FE-11.A.1-3.png", "ScreenshotCaption": "Additional details on Specific Behavior alert for Suspicious PowerShell Usage"}, {"ScreenshotName": "FE-11.A.1-1.png", "ScreenshotCaption": "Enrichment of wscript.exe with Wscript Execution alert (tagged with correct ATT&CK Technique, T064 - Scripting, and Tactic, Execution)"}, {"ScreenshotName": "FE-11.A.1-4.png", "ScreenshotCaption": "Indicator of Compromise alert for EMPIRE RAT (tagged with related ATT&CK Technique, T1086 - PowerShell)"}], "Footnotes": []}, {"DetectionType": "Indicator of Compromise", "DetectionNote": "An Indicator of Compromise alert was generated for EMPIRE RAT (Backdoor) based on a detected string specific to the backdoor. The alert was also mapped to a related ATT&CK Technique (T1086 - PowerShell).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-11.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert for Suspicious PowerShell Usage showing powershell.exe execution (tagged with related ATT&CK Technique, T1086 - PowerShell, and correct Tactic, Execution)"}, {"ScreenshotName": "FE-11.A.1-3.png", "ScreenshotCaption": "Additional details on Specific Behavior alert for Suspicious PowerShell Usage"}, {"ScreenshotName": "FE-11.A.1-1.png", "ScreenshotCaption": "Enrichment of wscript.exe with Wscript Execution alert (tagged with correct ATT&CK Technique, T064 - Scripting, and Tactic, Execution)"}, {"ScreenshotName": "FE-11.A.1-4.png", "ScreenshotCaption": "Indicator of Compromise alert for EMPIRE RAT (tagged with related ATT&CK Technique, T1086 - PowerShell)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed wscript.exe executing autoupdate.vbs and that wscript.exe created a powershell.exe process, including the encoded command-line arguments (tainted by the parent Script File Created alert).[CT5]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-11.A.1-2.png", "ScreenshotCaption": "Telemetry showing script execution (tainted by the parent Script File Created alert)"}, {"ScreenshotName": "CT-11.A.1-3.png", "ScreenshotCaption": "Telemetry showing powershell.exe creation from wscript.exe (tainted by the parent Script File Created alert)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for decoding and running encoded scripting sources from another process (wscript.exe). The alert was tagged with correct ATT&CK Tactic (Defense Evasion, Execution) and Techniques (PowerShell).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-11.A.1-1.png", "ScreenshotCaption": "Telemetry showing wscript.exe (executing autoupdate.vbs) then spawning powershell.exe (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "MC-11.A.1-5.png", "ScreenshotCaption": "Specific Behavior alerts and enrichments for wcript.exe and powershell.exe"}], "Footnotes": []}, {"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for PowerShell commands being executed from another process (wscript.exe). The alert was tagged with correct ATT&CK Tactic (Execution) and Techniques (PowerShell).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-11.A.1-1.png", "ScreenshotCaption": "Telemetry showing wscript.exe (executing autoupdate.vbs) then spawning powershell.exe (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "MC-11.A.1-5.png", "ScreenshotCaption": "Specific Behavior alerts and enrichments for wcript.exe and powershell.exe"}], "Footnotes": []}, {"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for PowerShell execution with a very long command line. The alert was tagged with correct ATT&CK Tactics (Defense Evasion, Execution) and Techniques (Scripting, PowerShell).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-11.A.1-1.png", "ScreenshotCaption": "Telemetry showing wscript.exe (executing autoupdate.vbs) then spawning powershell.exe (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "MC-11.A.1-5.png", "ScreenshotCaption": "Specific Behavior alerts and enrichments for wcript.exe and powershell.exe"}], "Footnotes": []}, {"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for the VBScript interpreter launching a suspicious PowerShell process. The alert was tagged with the correct ATT&CK Tactics (Defense Evasion, Execution) and Techniques (Scripting, PowerShell).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-11.A.1-1.png", "ScreenshotCaption": "Telemetry showing wscript.exe (executing autoupdate.vbs) then spawning powershell.exe (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "MC-11.A.1-5.png", "ScreenshotCaption": "Specific Behavior alerts and enrichments for wcript.exe and powershell.exe"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched powershell.exe with the correct ATT&CK Tactic (Execution) and Techniques (PowerShell) and a suspicious indicator that a PowerShell command was executed.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-11.A.1-1.png", "ScreenshotCaption": "Telemetry showing wscript.exe (executing autoupdate.vbs) then spawning powershell.exe (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "MC-11.A.1-5.png", "ScreenshotCaption": "Specific Behavior alerts and enrichments for wcript.exe and powershell.exe"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched wscript.exe with the correct ATT&CK Tactics (Defense Evasion, Execution) and Techniques (Scripting, PowerShell) and a suspicious indicator that the VBScript interpreter was executed.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-11.A.1-1.png", "ScreenshotCaption": "Telemetry showing wscript.exe (executing autoupdate.vbs) then spawning powershell.exe (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "MC-11.A.1-5.png", "ScreenshotCaption": "Specific Behavior alerts and enrichments for wcript.exe and powershell.exe"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed wscript.exe (executing autoupdate.vbs) then spawning powershell.exe. The telemetry was tainted by a trace detection on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-11.A.1-1.png", "ScreenshotCaption": "Telemetry showing wscript.exe (executing autoupdate.vbs) then spawning powershell.exe (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "MC-11.A.1-5.png", "ScreenshotCaption": "Specific Behavior alerts and enrichments for wcript.exe and powershell.exe"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A delayed Specific Behavior alert was generated for suspicious PowerShell command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-11.A.1-1.png", "ScreenshotCaption": "Telemetry showing execution of autoupdate.vbs script"}, {"ScreenshotName": "MS-11.A.1-2.png", "ScreenshotCaption": "Telemetry showing execution of wscript.exe"}, {"ScreenshotName": "MS-11.A.1-3.png", "ScreenshotCaption": "Telemetry showing execution of PowerShell cmdlets from wscript.exe"}, {"ScreenshotName": "MS-11.A.1-4.png", "ScreenshotCaption": "Telemetry showing PowerShell script metadata and decoded command-line arguments"}, {"ScreenshotName": "MS-11.A.1-5.png", "ScreenshotCaption": "Specific Behavior alert for \\\"Suspicious PowerShell command-line\\\""}, {"ScreenshotName": "MS-11.A.1-6.png", "ScreenshotCaption": "Specific Behavior alert for \\\"PowerShell script with suspicious content\\\" detected through Antimalware Scan Interface extracted content"}, {"ScreenshotName": "MS-11.A.1-7.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell script with malicious cmdlets"}, {"ScreenshotName": "MS-11.A.1-8.png", "ScreenshotCaption": "Process tree of alert showing containing malicious PowerShell cmdlets related to Empire"}], "Footnotes": []}, {"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for PowerShell script with malicious cmdlets related to Empire.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-11.A.1-1.png", "ScreenshotCaption": "Telemetry showing execution of autoupdate.vbs script"}, {"ScreenshotName": "MS-11.A.1-2.png", "ScreenshotCaption": "Telemetry showing execution of wscript.exe"}, {"ScreenshotName": "MS-11.A.1-3.png", "ScreenshotCaption": "Telemetry showing execution of PowerShell cmdlets from wscript.exe"}, {"ScreenshotName": "MS-11.A.1-4.png", "ScreenshotCaption": "Telemetry showing PowerShell script metadata and decoded command-line arguments"}, {"ScreenshotName": "MS-11.A.1-5.png", "ScreenshotCaption": "Specific Behavior alert for \\\"Suspicious PowerShell command-line\\\""}, {"ScreenshotName": "MS-11.A.1-6.png", "ScreenshotCaption": "Specific Behavior alert for \\\"PowerShell script with suspicious content\\\" detected through Antimalware Scan Interface extracted content"}, {"ScreenshotName": "MS-11.A.1-7.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell script with malicious cmdlets"}, {"ScreenshotName": "MS-11.A.1-8.png", "ScreenshotCaption": "Process tree of alert showing containing malicious PowerShell cmdlets related to Empire"}], "Footnotes": []}, {"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for PowerShell script with suspicious content detected through Antimalware Scan Interface extracted content.", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "MS-11.A.1-1.png", "ScreenshotCaption": "Telemetry showing execution of autoupdate.vbs script"}, {"ScreenshotName": "MS-11.A.1-2.png", "ScreenshotCaption": "Telemetry showing execution of wscript.exe"}, {"ScreenshotName": "MS-11.A.1-3.png", "ScreenshotCaption": "Telemetry showing execution of PowerShell cmdlets from wscript.exe"}, {"ScreenshotName": "MS-11.A.1-4.png", "ScreenshotCaption": "Telemetry showing PowerShell script metadata and decoded command-line arguments"}, {"ScreenshotName": "MS-11.A.1-5.png", "ScreenshotCaption": "Specific Behavior alert for \\\"Suspicious PowerShell command-line\\\""}, {"ScreenshotName": "MS-11.A.1-6.png", "ScreenshotCaption": "Specific Behavior alert for \\\"PowerShell script with suspicious content\\\" detected through Antimalware Scan Interface extracted content"}, {"ScreenshotName": "MS-11.A.1-7.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell script with malicious cmdlets"}, {"ScreenshotName": "MS-11.A.1-8.png", "ScreenshotCaption": "Process tree of alert showing containing malicious PowerShell cmdlets related to Empire"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed explorer.exe running autoupdate.vbs through wscript.exe and subsequent execution of PowerShell script and cmdlets.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-11.A.1-1.png", "ScreenshotCaption": "Telemetry showing execution of autoupdate.vbs script"}, {"ScreenshotName": "MS-11.A.1-2.png", "ScreenshotCaption": "Telemetry showing execution of wscript.exe"}, {"ScreenshotName": "MS-11.A.1-3.png", "ScreenshotCaption": "Telemetry showing execution of PowerShell cmdlets from wscript.exe"}, {"ScreenshotName": "MS-11.A.1-4.png", "ScreenshotCaption": "Telemetry showing PowerShell script metadata and decoded command-line arguments"}, {"ScreenshotName": "MS-11.A.1-5.png", "ScreenshotCaption": "Specific Behavior alert for \\\"Suspicious PowerShell command-line\\\""}, {"ScreenshotName": "MS-11.A.1-6.png", "ScreenshotCaption": "Specific Behavior alert for \\\"PowerShell script with suspicious content\\\" detected through Antimalware Scan Interface extracted content"}, {"ScreenshotName": "MS-11.A.1-7.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell script with malicious cmdlets"}, {"ScreenshotName": "MS-11.A.1-8.png", "ScreenshotCaption": "Process tree of alert showing containing malicious PowerShell cmdlets related to Empire"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for PowerShell execution. The alert was tagged with a related Technique (PowerShell)", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-11.A.1-3.png", "ScreenshotCaption": "Specific Behavior alert for execution of the windows script engine tagged with the correct ATT&CK Technique (Scripting)"}, {"ScreenshotName": "PA-11.A.1-6.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell (execution) tagged with a related Technique (PowerShell)"}, {"ScreenshotName": "PA-11.A.1-7.png", "ScreenshotCaption": "Specific Behavior alert for suspicious PowerShell activity"}, {"ScreenshotName": "PA-11.A.1-8.png", "ScreenshotCaption": "Indicator of Compromise alerts for suspicious PowerShell strings"}, {"ScreenshotName": "PA-11.A.1-4.png", "ScreenshotCaption": "Indicator of Compromise alert identifying PowerShell Empire"}, {"ScreenshotName": "PA-11.A.1-5.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell execution with base64 encoded commands"}, {"ScreenshotName": "PA-11.A.1-1.png", "ScreenshotCaption": "Telemetry showing wscript.exe executing autoupdate.vbs (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-11.A.1-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe running with command-line arguments (tainted by a parent alert on wscript.exe)"}], "Footnotes": []}, {"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for PowerShell execution with base64 encoded commands.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-11.A.1-3.png", "ScreenshotCaption": "Specific Behavior alert for execution of the windows script engine tagged with the correct ATT&CK Technique (Scripting)"}, {"ScreenshotName": "PA-11.A.1-6.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell (execution) tagged with a related Technique (PowerShell)"}, {"ScreenshotName": "PA-11.A.1-7.png", "ScreenshotCaption": "Specific Behavior alert for suspicious PowerShell activity"}, {"ScreenshotName": "PA-11.A.1-8.png", "ScreenshotCaption": "Indicator of Compromise alerts for suspicious PowerShell strings"}, {"ScreenshotName": "PA-11.A.1-4.png", "ScreenshotCaption": "Indicator of Compromise alert identifying PowerShell Empire"}, {"ScreenshotName": "PA-11.A.1-5.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell execution with base64 encoded commands"}, {"ScreenshotName": "PA-11.A.1-1.png", "ScreenshotCaption": "Telemetry showing wscript.exe executing autoupdate.vbs (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-11.A.1-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe running with command-line arguments (tainted by a parent alert on wscript.exe)"}], "Footnotes": []}, {"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for suspicious PowerShell activity", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-11.A.1-3.png", "ScreenshotCaption": "Specific Behavior alert for execution of the windows script engine tagged with the correct ATT&CK Technique (Scripting)"}, {"ScreenshotName": "PA-11.A.1-6.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell (execution) tagged with a related Technique (PowerShell)"}, {"ScreenshotName": "PA-11.A.1-7.png", "ScreenshotCaption": "Specific Behavior alert for suspicious PowerShell activity"}, {"ScreenshotName": "PA-11.A.1-8.png", "ScreenshotCaption": "Indicator of Compromise alerts for suspicious PowerShell strings"}, {"ScreenshotName": "PA-11.A.1-4.png", "ScreenshotCaption": "Indicator of Compromise alert identifying PowerShell Empire"}, {"ScreenshotName": "PA-11.A.1-5.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell execution with base64 encoded commands"}, {"ScreenshotName": "PA-11.A.1-1.png", "ScreenshotCaption": "Telemetry showing wscript.exe executing autoupdate.vbs (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-11.A.1-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe running with command-line arguments (tainted by a parent alert on wscript.exe)"}], "Footnotes": []}, {"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for the execution of the windows script engine The alert was tagged with the correct ATT&CK Technique (Scripting).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-11.A.1-3.png", "ScreenshotCaption": "Specific Behavior alert for execution of the windows script engine tagged with the correct ATT&CK Technique (Scripting)"}, {"ScreenshotName": "PA-11.A.1-6.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell (execution) tagged with a related Technique (PowerShell)"}, {"ScreenshotName": "PA-11.A.1-7.png", "ScreenshotCaption": "Specific Behavior alert for suspicious PowerShell activity"}, {"ScreenshotName": "PA-11.A.1-8.png", "ScreenshotCaption": "Indicator of Compromise alerts for suspicious PowerShell strings"}, {"ScreenshotName": "PA-11.A.1-4.png", "ScreenshotCaption": "Indicator of Compromise alert identifying PowerShell Empire"}, {"ScreenshotName": "PA-11.A.1-5.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell execution with base64 encoded commands"}, {"ScreenshotName": "PA-11.A.1-1.png", "ScreenshotCaption": "Telemetry showing wscript.exe executing autoupdate.vbs (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-11.A.1-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe running with command-line arguments (tainted by a parent alert on wscript.exe)"}], "Footnotes": []}, {"DetectionType": "Indicator of Compromise", "DetectionNote": "An Indicator of Compromise alert was generated identifying PowerShell Empire.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-11.A.1-3.png", "ScreenshotCaption": "Specific Behavior alert for execution of the windows script engine tagged with the correct ATT&CK Technique (Scripting)"}, {"ScreenshotName": "PA-11.A.1-6.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell (execution) tagged with a related Technique (PowerShell)"}, {"ScreenshotName": "PA-11.A.1-7.png", "ScreenshotCaption": "Specific Behavior alert for suspicious PowerShell activity"}, {"ScreenshotName": "PA-11.A.1-8.png", "ScreenshotCaption": "Indicator of Compromise alerts for suspicious PowerShell strings"}, {"ScreenshotName": "PA-11.A.1-4.png", "ScreenshotCaption": "Indicator of Compromise alert identifying PowerShell Empire"}, {"ScreenshotName": "PA-11.A.1-5.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell execution with base64 encoded commands"}, {"ScreenshotName": "PA-11.A.1-1.png", "ScreenshotCaption": "Telemetry showing wscript.exe executing autoupdate.vbs (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-11.A.1-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe running with command-line arguments (tainted by a parent alert on wscript.exe)"}], "Footnotes": []}, {"DetectionType": "Indicator of Compromise", "DetectionNote": "Indicator of Compromise alerts were generated for suspicious PowerShell strings.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-11.A.1-3.png", "ScreenshotCaption": "Specific Behavior alert for execution of the windows script engine tagged with the correct ATT&CK Technique (Scripting)"}, {"ScreenshotName": "PA-11.A.1-6.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell (execution) tagged with a related Technique (PowerShell)"}, {"ScreenshotName": "PA-11.A.1-7.png", "ScreenshotCaption": "Specific Behavior alert for suspicious PowerShell activity"}, {"ScreenshotName": "PA-11.A.1-8.png", "ScreenshotCaption": "Indicator of Compromise alerts for suspicious PowerShell strings"}, {"ScreenshotName": "PA-11.A.1-4.png", "ScreenshotCaption": "Indicator of Compromise alert identifying PowerShell Empire"}, {"ScreenshotName": "PA-11.A.1-5.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell execution with base64 encoded commands"}, {"ScreenshotName": "PA-11.A.1-1.png", "ScreenshotCaption": "Telemetry showing wscript.exe executing autoupdate.vbs (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-11.A.1-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe running with command-line arguments (tainted by a parent alert on wscript.exe)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed wscript.exe executing autoupdate.vbs as well as the resulting powershell.exe execution. The telemetry was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-11.A.1-3.png", "ScreenshotCaption": "Specific Behavior alert for execution of the windows script engine tagged with the correct ATT&CK Technique (Scripting)"}, {"ScreenshotName": "PA-11.A.1-6.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell (execution) tagged with a related Technique (PowerShell)"}, {"ScreenshotName": "PA-11.A.1-7.png", "ScreenshotCaption": "Specific Behavior alert for suspicious PowerShell activity"}, {"ScreenshotName": "PA-11.A.1-8.png", "ScreenshotCaption": "Indicator of Compromise alerts for suspicious PowerShell strings"}, {"ScreenshotName": "PA-11.A.1-4.png", "ScreenshotCaption": "Indicator of Compromise alert identifying PowerShell Empire"}, {"ScreenshotName": "PA-11.A.1-5.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell execution with base64 encoded commands"}, {"ScreenshotName": "PA-11.A.1-1.png", "ScreenshotCaption": "Telemetry showing wscript.exe executing autoupdate.vbs (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-11.A.1-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe running with command-line arguments (tainted by a parent alert on wscript.exe)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed wscript.exe executing autoupdate.vbs and the subsequent PowerShell child process. [RS1]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-11-1.png", "ScreenshotCaption": "Telemetry showing the autoupdate.vbs script executed by wscript.exe"}], "Footnotes": [" Vendor says launch command-line argument truncation resulted in PowerShell not being able to be decoded."]}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for the execution of autoupdate.vbs that was listed as an active threat.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "S1-11.A.1-2.png", "ScreenshotCaption": "Telemetry showing wscript.exe and powershell.exe"}, {"ScreenshotName": "S1-11.A.1-1.png", "ScreenshotCaption": "General Behavior alert for execution of autoupdate.vbs listed as an active threat"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed wscript.exe executing autoupdate.vbs which then executed powershell.exe with an encoded PowerShell script.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "S1-11.A.1-2.png", "ScreenshotCaption": "Telemetry showing wscript.exe and powershell.exe"}, {"ScreenshotName": "S1-11.A.1-1.png", "ScreenshotCaption": "General Behavior alert for execution of autoupdate.vbs listed as an active threat"}], "Footnotes": []}]}]}]}, {"Substep": "11.B.1", "Procedure": "Empire: C2 channel established using port 443", "Techniques": [{"TechniqueId": "T1043", "TechniqueName": "Commonly Used Port", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched backgroundtaskhost.exe and powershell.exe with the correct ATT&CK Technique (T1043 - Commonly Used Port).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-11.A.1-1.png", "ScreenshotCaption": "Enrichment of backgroundtaskhost.exe and powershell.exe with correct ATT&CK Technique (T1043 - Commonly Used Port)"}, {"ScreenshotName": "CB-11.B.1-1.png", "ScreenshotCaption": "Telemetry showing network connections, including over TCP port 443"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed network connections, including over TCP port 443 to www.freegoogleadsenseinfo.com (C2 domain).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-11.A.1-1.png", "ScreenshotCaption": "Enrichment of backgroundtaskhost.exe and powershell.exe with correct ATT&CK Technique (T1043 - Commonly Used Port)"}, {"ScreenshotName": "CB-11.B.1-1.png", "ScreenshotCaption": "Telemetry showing network connections, including over TCP port 443"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe making connection to 192.168.0.5 (C2 server) over port 443. The telemetry was tainted by an alert on its parent powershell.exe process.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-11.B.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe making a network connection over port 443 (tainted by parent powershell.exe high severity alert indicated by red icon)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched powershell.exe as making a connection over a \u201dHTTP Port\u201d. The data was tagged with the correct ATT&CK Technique (Commonly Used Port) and Tactic (Command and Control) and was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-11.A.1-13.png", "ScreenshotCaption": "Telemetry showing decoded PowerShell command with command-line arguments (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-11.B.1-100.png", "ScreenshotCaption": "Enrichment of powershell.exe making a connection over a \u201dHTTP Port,\" tagged with the correct ATT&CK Technique (Commonly Used Port) and Tactic (Command and Control) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-11.B.1-11.png", "ScreenshotCaption": "Telemetry showing powershell.exe making outgoing connection to 192.168.0.5 (C2 Server) over port TCP port 443 (tainted by a parent PowerShell alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe making an outgoing connection on TCP port 443 to 192.168.0.5 (C2 Server). Telemetry also showed decoded command-line arguments to perform a HTTPS connection to freegoogleadsenseinfo.com (C2 domain) over port 443. The telemetry was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-11.A.1-13.png", "ScreenshotCaption": "Telemetry showing decoded PowerShell command with command-line arguments (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-11.B.1-100.png", "ScreenshotCaption": "Enrichment of powershell.exe making a connection over a \u201dHTTP Port,\" tagged with the correct ATT&CK Technique (Commonly Used Port) and Tactic (Command and Control) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-11.B.1-11.png", "ScreenshotCaption": "Telemetry showing powershell.exe making outgoing connection to 192.168.0.5 (C2 Server) over port TCP port 443 (tainted by a parent PowerShell alert)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert for \"PowerShell Making Network Connections\" was triggered due to powershell.exe making a connection over port 443. The alert was tainted by a parent alert and mapped to the correct ATT&CK Tactic (Command and Control).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-11-2.png", "ScreenshotCaption": "Telemetry showing decoded powershell.exe command-line arguments (tainted by parent alert)"}, {"ScreenshotName": "EG-11-3.png", "ScreenshotCaption": "Telemetry showing powershell.exe making connections over port 443 (tainted by parent alert)"}, {"ScreenshotName": "EG-11-5.png", "ScreenshotCaption": "Specific Behavior alert for \\\"PowerShell Making Network Connections\\\" (mapped to correct ATT&CK Tactic, Command and Control)"}, {"ScreenshotName": "EG-11-6.png", "ScreenshotCaption": "Event tree view of Specific Behavior alert for \\\"Command and Control PowerShell Network\\\"(tainted by parent alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showing the decoded powershell.exe command-line arguments showed a connection over port 443 to www.freegoogleadsenseinfo.com (C2 domain) (tainted by parent alert).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-11-2.png", "ScreenshotCaption": "Telemetry showing decoded powershell.exe command-line arguments (tainted by parent alert)"}, {"ScreenshotName": "EG-11-3.png", "ScreenshotCaption": "Telemetry showing powershell.exe making connections over port 443 (tainted by parent alert)"}, {"ScreenshotName": "EG-11-5.png", "ScreenshotCaption": "Specific Behavior alert for \\\"PowerShell Making Network Connections\\\" (mapped to correct ATT&CK Tactic, Command and Control)"}, {"ScreenshotName": "EG-11-6.png", "ScreenshotCaption": "Event tree view of Specific Behavior alert for \\\"Command and Control PowerShell Network\\\"(tainted by parent alert)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a network connection over port 443 to www.freegoogleadsenseinfo.com (C2 domain).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-11.A.1-4.png", "ScreenshotCaption": "Telemetry showing a network connection over TCP port 443 to www.freegoogleadsenseinfo.com (C2 domain)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified that the Empire backdoor communicated with 192.168.0.5 (C2 server) over port 443.[FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-11.B.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe communicating over TCP port 443 (tainted by parent PowerShell Network Connection alert)"}, {"ScreenshotName": "FE-11.B.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating Empire communicated over port 443 (General Behavior)"}, {"ScreenshotName": "FE-11.B.1-4.png", "ScreenshotCaption": "Additional excerpt from the Managed Defense Report indicating Empire was configured to communicate over port 443 (General Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe communicating over TCP port 443. The telemetry was tainted by the parent PowerShell Network Connection alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "FE-11.B.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe communicating over TCP port 443 (tainted by parent PowerShell Network Connection alert)"}, {"ScreenshotName": "FE-11.B.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating Empire communicated over port 443 (General Behavior)"}, {"ScreenshotName": "FE-11.B.1-4.png", "ScreenshotCaption": "Additional excerpt from the Managed Defense Report indicating Empire was configured to communicate over port 443 (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe creating an outbound connection to 192.168.0.5 (C2 server) over TCP port 443.[CT5]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CT-11.B.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe making a network connection over TCP port 443"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for PowerShell sending and receiving information through port 443. The alert was tagged with the correct ATT&CK Tactic (Command and Control) and Technique (Commonly Used Port).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-11.B.1-4.png", "ScreenshotCaption": "Telemetry showing port 443 network connections to www.freegoogleadsenseinfo.com (C2 domain) (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "MC-11.A.1-5.png", "ScreenshotCaption": "Enrichment of powershell.exe with the correct ATT&CK Tactic (Command and Control) and Technique (Commonly Used Port) and a suspicious indicator that powershell.exe accessed a known TCP port"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched powershell.exe with the correct ATT&CK Tactic (Command and Control) and Technique (Commonly Used Port) and a suspicious indicator that powershell.exe accessed a known TCP port.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-11.B.1-4.png", "ScreenshotCaption": "Telemetry showing port 443 network connections to www.freegoogleadsenseinfo.com (C2 domain) (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "MC-11.A.1-5.png", "ScreenshotCaption": "Enrichment of powershell.exe with the correct ATT&CK Tactic (Command and Control) and Technique (Commonly Used Port) and a suspicious indicator that powershell.exe accessed a known TCP port"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed port 443 network connections to www.freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by a trace detection on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-11.B.1-4.png", "ScreenshotCaption": "Telemetry showing port 443 network connections to www.freegoogleadsenseinfo.com (C2 domain) (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "MC-11.A.1-5.png", "ScreenshotCaption": "Enrichment of powershell.exe with the correct ATT&CK Tactic (Command and Control) and Technique (Commonly Used Port) and a suspicious indicator that powershell.exe accessed a known TCP port"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe checking an SSL certificate and then communicating to 192.168.0.5 (C2 server) over port 443 (tainted by relationship to alert on PowerShell script with suspicious content). Telemetry within an alert also showed decoded command-line arguments containing port 443.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-11.A.1-9.png", "ScreenshotCaption": "Telemetry showing powershell.exe communicating over TCP port 443"}, {"ScreenshotName": "MS-11.B.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server)"}, {"ScreenshotName": "MS-11.B.1-4.png", "ScreenshotCaption": "Telemetry within alert showing decoded command-line arguments containing port 443\u00a0and tainted relationship to the powershell.exe process"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "General Behavior alerts were generated for PowerShell making network connections to the internet as well as Wscript connecting to an external network. The alerts were tainted by a parent alert on wscript.exe.[PA2]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-11.B.1-1.png", "ScreenshotCaption": "Telemetry showing port 443 network connections to www.freegoogleadsenseinfo.com (C2 domain) (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-11.A.1-3.png", "ScreenshotCaption": "Enrichment of the port 443 network connection with the correct ATT&CK Technique (Commonly Used Port) (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-11.B.1-2.png", "ScreenshotCaption": "General Behavior alerts for PowerShell making network connections to the internet as well as Wscript connecting to an external network (tainted by a parent alert on wscript.exe)"}], "Footnotes": ["Vendor stated that more information would be available if their firewall appliance was installed and activated."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the port 443 network connection with the correct ATT&CK Technique (Commonly Used Port). The data was tainted by a parent alert on wscript.exe.[PA2]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-11.B.1-1.png", "ScreenshotCaption": "Telemetry showing port 443 network connections to www.freegoogleadsenseinfo.com (C2 domain) (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-11.A.1-3.png", "ScreenshotCaption": "Enrichment of the port 443 network connection with the correct ATT&CK Technique (Commonly Used Port) (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-11.B.1-2.png", "ScreenshotCaption": "General Behavior alerts for PowerShell making network connections to the internet as well as Wscript connecting to an external network (tainted by a parent alert on wscript.exe)"}], "Footnotes": ["Vendor stated that more information would be available if their firewall appliance was installed and activated."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed port 443 network connections to www.freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by a parent alert on wscript.exe.[PA2]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-11.B.1-1.png", "ScreenshotCaption": "Telemetry showing port 443 network connections to www.freegoogleadsenseinfo.com (C2 domain) (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-11.A.1-3.png", "ScreenshotCaption": "Enrichment of the port 443 network connection with the correct ATT&CK Technique (Commonly Used Port) (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-11.B.1-2.png", "ScreenshotCaption": "General Behavior alerts for PowerShell making network connections to the internet as well as Wscript connecting to an external network (tainted by a parent alert on wscript.exe)"}], "Footnotes": ["Vendor stated that more information would be available if their firewall appliance was installed and activated."]}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed an outbound network connection over port 443 and to letsencrypt.org (no protocol was identified for this traffic).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-11-2.png", "ScreenshotCaption": "Telemetry showing network connections, including over port 443 (does not count as a detection)"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed network connections to 192.168.0.5 (C2 server) over TCP port 443. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-11.B.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server) over TCP port 443 (Group ID tainted the event but was not shown in this view)"}], "Footnotes": []}]}]}]}, {"Substep": "11.B.1", "Procedure": "Empire: C2 channel established using HTTPS traffic to freegoogleadsenseinfo.com", "Techniques": [{"TechniqueId": "T1071", "TechniqueName": "Standard Application Layer Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed modload events importing dynamic libraries usually used for HTTP and SSL communication (e.g. winhttp.dll), followed by a CRL check to a CA, indicating that HTTPS was likely used.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-11.B.1-2.png", "ScreenshotCaption": "Telemetry showing modloads and certificate check"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed an outbound network connection to 192.168.0.5 (C2 server) over port 443 (no protocol was identified for this traffic).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-11.B.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe making a network connection over port 443 (does not count as a detection)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed decoded command-line arguments to perform a HTTPS connection to freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by a parent PowerShell alert. Telemetry also showed that powershell.exe had an outgoing connection on port 443, identified as HTTP type traffic.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-11.A.1-13.png", "ScreenshotCaption": "Telemetry showing decoded PowerShell command with command-line arguments (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-11.B.1-11.png", "ScreenshotCaption": "Telemetry showing powershell.exe making outgoing connection to 192.168.0.5 tagged with SERVICE_HTTP (Hypertext Transfer Protocol Over TLS/SSL (HTTPS)) (does not count as a detection)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showing the decoded powershell.exe command-line arguments showed a connection to over HTTPS to www.freegoogleadsenseinfo.com (C2 domain) (tainted by parent alert). Telemetry also showed a connection to letsencrypt.org, which could indicate use of a cert for HTTPS.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-11-2.png", "ScreenshotCaption": "Telemetry showing decoded powershell.exe command-line arguments (tainted by parent alert)"}, {"ScreenshotName": "EG-11-6.png", "ScreenshotCaption": "Telemetry showing connection to letsencrypt.org"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe making a connection over port 443 to freegoogleadsenseinfo.com (C2 domain). [CC2]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-11.B.1-T1071-new.png", "ScreenshotCaption": "Telemetry showing a network connection over TCP port 443 to www.freegoogleadsenseinfo.com (C2 domain)"}, {"ScreenshotName": "CC-11.A.1-5.png", "ScreenshotCaption": "An alert for PowerShell downloading a significant amount of data using HTTP(S) (does not count as a detection since it was based on port)"}], "Footnotes": [" There was an alert for PowerShell downloading significant amount of data using HTTP(S), though this alert was based only on the port (443)."]}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified that the Empire backdoor was configured to communicate with freegoogleadsenseinfo.com (C2 domain) over HTTPS.[FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-11.B.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating Empire was configured to communicate over HTTPS (General Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed an outbound network connection over TCP port 443 (no protocol was identified for this traffic).[CT5]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CT-11.B.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe making a network connection over TCP port 443 (does not count as a detection)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed an outbound network connection to 192.168.0.5 (C2 server) over port 443 (no protocol was identified for this traffic) and an alert than indicated that powershell.exe queried registered cryptographic provider libraries.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-11.B.1-4.png", "ScreenshotCaption": "Telemetry showing powershell.exe making a network connection over port 443 (does not count as a detection)"}, {"ScreenshotName": "MC-11.A.1-5.png", "ScreenshotCaption": "Alert indicating that powershell.exe queried registered cryptographic provider libraries (does not count as a detection)"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Indicator of Compromise", "DetectionNote": "An Indicator of Compromise alert was generated on the C2 domain.[MS12]", "Modifiers": ["Configuration Change"], "Screenshots": [{"ScreenshotName": "MS-11.B.1-3.png", "ScreenshotCaption": "Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server) over an encrypted channel"}, {"ScreenshotName": "MS-11.B.1-4.png", "ScreenshotCaption": "Telemetry within alert showing decoded command-line arguments containing HTTPS"}, {"ScreenshotName": "MS-11.B.1-2.png", "ScreenshotCaption": "Alert\u00a0for C2 domain indicator of compromise"}], "Footnotes": [" Vendor added detection for evaluation C2 domain using the standard customer-facing custom detection capabilities of the product."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe checking an SSL certificate and then communicating to 192.168.0.5 (C2 server) over an encrypted channel (tainted by relationship to alert on PowerShell script with suspicious content). Telemetry within an alert showed decoded command-line arguments to perform HTTPS connection to C2 domain.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-11.B.1-3.png", "ScreenshotCaption": "Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server) over an encrypted channel"}, {"ScreenshotName": "MS-11.B.1-4.png", "ScreenshotCaption": "Telemetry within alert showing decoded command-line arguments containing HTTPS"}, {"ScreenshotName": "MS-11.B.1-2.png", "ScreenshotCaption": "Alert\u00a0for C2 domain indicator of compromise"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[PA2]", "Modifiers": [], "Screenshots": [], "Footnotes": ["Vendor stated that more information would be available if their firewall appliance was installed and activated."]}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe making a connection over port 443 to freegoogleadsenseinfo.com (C2 domain).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-11-2.png", "ScreenshotCaption": "Telemetry showing network connections, including over port 443"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[SO20][SO3]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "S1-11.B.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server) over TCP port 443 (does not count as a detection)"}], "Footnotes": ["Telemetry showed an outbound network connection to 192.168.0.5 (C2 server) over TCP port 443 (no protocol was identified for this traffic).", " Vendor stated log files indicate the powershell process was using the SSL cache folder."]}]}]}]}, {"Substep": "11.B.1", "Procedure": "Empire: Encrypted C2 channel established using HTTPS", "Techniques": [{"TechniqueId": "T1032", "TechniqueName": "Standard Cryptographic Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed modload events importing dynamic libraries usually used for HTTP and SSL communication (e.g. winhttp.dll), followed by a CRL check to a CA, indicating that HTTPS was likely used.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-11.B.1-2.png", "ScreenshotCaption": "Telemetry showing modloads and certificate check"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed an outbound network connection to 192.168.0.5 (C2 server) over port 443 (no protocol was identified for this traffic).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-11.B.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe making a network connection over port 443 (does not count as a detection)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed that powershell.exe had an outgoing connection on port 443, identified as HTTP type traffic. Telemetry also showed decoded command-line arguments to perform a HTTPS connection to freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-11.A.1-13.png", "ScreenshotCaption": "Telemetry showing decoded PowerShell command with command-line arguments (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-11.B.1-11.png", "ScreenshotCaption": "Telemetry showing powershell.exe making outgoing connection to 192.168.0.5 tagged with SERVICE_HTTP (Hypertext Transfer Protocol Over TLS/SSL (HTTPS)) (tainted by a parent PowerShell alert)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showing the decoded powershell.exe command-line arguments showed a connection to over HTTPS to www.freegoogleadsenseinfo.com (C2 domain) (tainted by parent alert). Telemetry also showed a connection to letsencrypt.org, which could indicate use of a cert for HTTPS.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-11-2.png", "ScreenshotCaption": "Telemetry showing decoded powershell.exe command-line arguments (tainted by parent alert)"}, {"ScreenshotName": "EG-11-6.png", "ScreenshotCaption": "Telemetry showing connection to letsencrypt.org"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for PowerShell downloading a significant amount of data using HTTP(S).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-11.A.1-5.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell downloading a significant amount of data using HTTP(S)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified that the Empire backdoor was configured to communicate with freegoogleadsenseinfo.com (C2 domain) over HTTPS.[FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-11.B.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating Empire was configured to communicate over HTTPS (General Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed an outbound network connection over TCP port 443 (no protocol was identified for this traffic).[CT5]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CT-11.B.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe making a network connection over TCP port 443 (does not count as a detection)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed an outbound network connection to 192.168.0.5 (C2 server) over port 443 (no protocol was identified for this traffic) and an alert than indicated that powershell.exe queried registered cryptographic provider libraries.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-11.B.1-4.png", "ScreenshotCaption": "Telemetry showing powershell.exe making a network connection over port 443 (does not count as a detection)"}, {"ScreenshotName": "MC-11.A.1-5.png", "ScreenshotCaption": "Alert indicating that powershell.exe queried registered cryptographic provider libraries (does not count as a detection)"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe checking an SSL certificate and then communicating to 192.168.0.5 (C2 server) over an encrypted channel (tainted by relationship to alert on PowerShell script with suspicious content). Telemetry within an alert showed decoded command-line arguments to perform HTTPS connection to C2 domain.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-11.B.1-3.png", "ScreenshotCaption": "Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server) over an encrypted channel"}, {"ScreenshotName": "MS-11.B.1-4.png", "ScreenshotCaption": "Telemetry within alert showing decoded command-line arguments containing HTTPS"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[PA2]", "Modifiers": [], "Screenshots": [], "Footnotes": ["Vendor stated that more information would be available if their firewall appliance was installed and activated."]}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed an outbound network connection over port 443 and to letsencrypt.org (no protocol was identified for this traffic).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-11-2.png", "ScreenshotCaption": "Telemetry showing network connections, including over port 443 (does not count as a detection)"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[SO20][SO3]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "S1-11.B.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server) over TCP port 443 (does not count as a detection)"}], "Footnotes": ["Telemetry showed an outbound network connection to 192.168.0.5 (C2 server) over TCP port 443 (no protocol was identified for this traffic).", " Vendor stated log files indicate the powershell process was using the SSL cache folder."]}]}]}]}, {"Substep": "12.A.1", "Procedure": "Empire: 'route print' via PowerShell", "Techniques": [{"TechniqueId": "T1016", "TechniqueName": "System Network Configuration Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed powershell.exe executing route.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-12.A.1-2.png", "ScreenshotCaption": "Telemetry from process tree showing route.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team also sent an email indicating a General Behavior was observed because route print was part of the basic reconnaissance activity performed.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-12.A.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing route.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-6.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating route print was part of basic reconnaissance activity (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing route.exe with command-line arguments. The process tree view showed route.exe as tainted by a previous powershell.exe detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-12.A.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing route.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-6.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating route print was part of basic reconnaissance activity (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed route.exe executing with command-line arguments. The telemetry was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-12.A.1-1.png", "ScreenshotCaption": "Telemetry showing route.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing route.exe with command-line arguments (tainted by parent PowerShell alerts).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-12-1.png", "ScreenshotCaption": "Event tree view of telemetry showing route.exe with command-line arguments (tainted by parent PowerShell alerts)"}, {"ScreenshotName": "EG-12-2.png", "ScreenshotCaption": "Telemetry showing route.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (route) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.A.1-1.png", "ScreenshotCaption": "Enrichment of route.exe indicating that it could be used to print the routing table as part of reconnaissance"}, {"ScreenshotName": "CC-12.A.1-2.png", "ScreenshotCaption": "Telemetry showing route.exe with command-line arguments"}, {"ScreenshotName": "CC-11.B.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (route) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched route.exe indicating that it could be used to print the routing table as part of reconnaissance.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.A.1-1.png", "ScreenshotCaption": "Enrichment of route.exe indicating that it could be used to print the routing table as part of reconnaissance"}, {"ScreenshotName": "CC-12.A.1-2.png", "ScreenshotCaption": "Telemetry showing route.exe with command-line arguments"}, {"ScreenshotName": "CC-11.B.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (route) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing route.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.A.1-1.png", "ScreenshotCaption": "Enrichment of route.exe indicating that it could be used to print the routing table as part of reconnaissance"}, {"ScreenshotName": "CC-12.A.1-2.png", "ScreenshotCaption": "Telemetry showing route.exe with command-line arguments"}, {"ScreenshotName": "CC-11.B.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (route) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified route.exe as a reconnaissance command used.[FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-12.A.1-1.png", "ScreenshotCaption": "Enrichment of route.exe with Route Execution alert (tagged with correct ATT&CK Technique, T1016 - System Network Configuration Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating route.exe was a reconnaissance command used (General Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched route.exe with an alert for Route Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1016 - System Network Configuration Discovery) and Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-12.A.1-1.png", "ScreenshotCaption": "Enrichment of route.exe with Route Execution alert (tagged with correct ATT&CK Technique, T1016 - System Network Configuration Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating route.exe was a reconnaissance command used (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability showed powershell.exe executing route.exe with command-line arguments and enriched the command with the conditions Reconnaissance Tool and Route Spawned with Reconnaissance. The enrichment was tainted by the parent Script File Created alert.[CT5]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-12.A.1-1.png", "ScreenshotCaption": "Enrichment of route.exe with conditions Reconnaissance Tool and Route Spawned with Reconnaissance (tainted by the parent Script File Created alert)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched route.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) and a suspicious indicator that routing tables were viewed or manipulated.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-12.A.1-3.png", "ScreenshotCaption": "Telemetry showing route.exe with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "MC-12.A.1-2.png", "ScreenshotCaption": "Enrichment of route.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) and a suspicious indicator that routing tables were viewed or manipulated"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing route.exe. The telemetry was tainted by a trace detection on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-12.A.1-3.png", "ScreenshotCaption": "Telemetry showing route.exe with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "MC-12.A.1-2.png", "ScreenshotCaption": "Enrichment of route.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) and a suspicious indicator that routing tables were viewed or manipulated"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence for powershell.exe executing route.exe with command-line arguments. The telemetry was tainted by previous \"Suspicious sequence of exploration activities\" and suspicious PowerShell cmdlet alerts.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-12.A.1-4.png", "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"}, {"ScreenshotName": "MS-12.A.1-1.png", "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing route.exe with command-line arguments"}, {"ScreenshotName": "MS-12.E.1-4.png", "ScreenshotCaption": "Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched route.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-12.A.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing route.exe with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.A.1-2.png", "ScreenshotCaption": "Enrichment of route.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing route.exe with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-12.A.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing route.exe with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.A.1-2.png", "ScreenshotCaption": "Enrichment of route.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing route.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-12-1.png", "ScreenshotCaption": "Telemetry showing route.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing route.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-12.A.1-3.png", "ScreenshotCaption": "Telemetry showing route.exe with command-line arguments (tainted Group ID not shown but was the search parameter)"}, {"ScreenshotName": "S1-12.A.1-1.png", "ScreenshotCaption": "Threat story showing partial tree of activity from the initial compromise alert"}, {"ScreenshotName": "S1-12.A.1-2.png", "ScreenshotCaption": "Continued threat story showing initial compromise alert and powershell.exe\u00a0tainting route.exe"}], "Footnotes": []}]}]}]}, {"Substep": "12.A.2", "Procedure": "Empire: 'ipconfig -all' via PowerShell", "Techniques": [{"TechniqueId": "T1016", "TechniqueName": "System Network Configuration Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched ipconfig.exe with the correct ATT&CK Technique (T1049 - System Network Configuration Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-12.A.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing ipconfig.exe with command-line arguments"}, {"ScreenshotName": "CB-12.A.1-1.png", "ScreenshotCaption": "Enrichment of ipconfig.exe with correct ATT&CK Technique (T1049 - System Network Configuration Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed powershell.exe executing ipconfig.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-12.A.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing ipconfig.exe with command-line arguments"}, {"ScreenshotName": "CB-12.A.1-1.png", "ScreenshotCaption": "Enrichment of ipconfig.exe with correct ATT&CK Technique (T1049 - System Network Configuration Discovery)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team also sent an email indicating a General Behavior was observed because ipconfig was part of the basic reconnaissance activity performed.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-12.A.1-2.png", "ScreenshotCaption": "Telemetry from process tree showing ipconfig.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-6.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating ipconfig was part of basic reconnaissance activity (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing ipconfig.exe with command-line arguments. The process tree view showed ipconfig.exe as tainted by a previous powershell.exe detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-12.A.1-2.png", "ScreenshotCaption": "Telemetry from process tree showing ipconfig.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-6.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating ipconfig was part of basic reconnaissance activity (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched ipconfig.exe executing with command-line arguments with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery). The data was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-12.A.2-1.png", "ScreenshotCaption": "Enrichment of ipconfig.exe executing with correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) (tainted by a parent PowerShell alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed ipconfig.exe executing with command-line arguments. [CR5]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-12.A.2-1.png", "ScreenshotCaption": "Enrichment of ipconfig.exe executing with correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) (tainted by a parent PowerShell alert)"}], "Footnotes": [" The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing ipconfig.exe with command-line arguments (tainted by parent PowerShell alerts).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-12-1.png", "ScreenshotCaption": "Event tree view of telemetry showing ipconfig.exe with command-line arguments (tainted by parent PowerShell alerts)"}, {"ScreenshotName": "EG-12-2.png", "ScreenshotCaption": "Telemetry showing ipconfig.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (ipconfig) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.A.2-4.png", "ScreenshotCaption": "Enrichment of powershell.exe executing ipconfig.exe with a tag identifying the command as enumeration"}, {"ScreenshotName": "CC-12.A.2-3.png", "ScreenshotCaption": "Telemetry showing ipconfig.exe with command line arguments"}, {"ScreenshotName": "CC-11.B.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (ipconfig) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability identified powershell.exe executing ipconfig.exe with a tag identifying the command as enumeration.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.A.2-4.png", "ScreenshotCaption": "Enrichment of powershell.exe executing ipconfig.exe with a tag identifying the command as enumeration"}, {"ScreenshotName": "CC-12.A.2-3.png", "ScreenshotCaption": "Telemetry showing ipconfig.exe with command line arguments"}, {"ScreenshotName": "CC-11.B.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (ipconfig) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed ipconfig.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.A.2-4.png", "ScreenshotCaption": "Enrichment of powershell.exe executing ipconfig.exe with a tag identifying the command as enumeration"}, {"ScreenshotName": "CC-12.A.2-3.png", "ScreenshotCaption": "Telemetry showing ipconfig.exe with command line arguments"}, {"ScreenshotName": "CC-11.B.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (ipconfig) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified ipconfig.exe as a reconnaissance command used. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-12.A.2-1.png", "ScreenshotCaption": "Enrichment of ipconfig.exe with Ipconfig Execution alert (tagged with correct ATT&CK Technique, T1016 - System Network Configuration Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating ipconfig.exe was a reconnaissance command used (General Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched ipconfig.exe with an alert for Ipconfig Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1016 - System Network Configuration Discovery) and Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-12.A.2-1.png", "ScreenshotCaption": "Enrichment of ipconfig.exe with Ipconfig Execution alert (tagged with correct ATT&CK Technique, T1016 - System Network Configuration Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating ipconfig.exe was a reconnaissance command used (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability showed powershell.exe executing ipconfig.exe with command-line arguments and enriched the command with the condition Ipconfig All Reconnaissance Command. The enrichment was tainted by the parent Script File Created alert.[CT6]", "Modifiers": ["Configuration Change", "Tainted"], "Screenshots": [{"ScreenshotName": "CT-12.A.2-1.png", "ScreenshotCaption": "Enrichment of ipconfig.exe with condition Ipconfig All Reconnaissance Command (tainted by parent Script File Created alert)"}], "Footnotes": ["The condition contributing to Enrichment was added to the capability's detection after the start of the evaluation, so the detection is identified as a configuration change. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched ipconfig.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-12.A.1-3.png", "ScreenshotCaption": "Telemetry showing ipconfig.exe with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "MC-12.A.1-2.png", "ScreenshotCaption": "Enrichment of ipconfig.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing ipconfig.exe. The telemetry was tainted by a trace detection on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-12.A.1-3.png", "ScreenshotCaption": "Telemetry showing ipconfig.exe with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "MC-12.A.1-2.png", "ScreenshotCaption": "Enrichment of ipconfig.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery)"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence for powershell.exe executing ipconfig.exe with command-line arguments. The telemetry was tainted by previous \"Suspicious sequence of exploration activities\" and suspicious PowerShell cmdlet alerts.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-12.A.1-4.png", "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"}, {"ScreenshotName": "MS-12.E.1-4.png", "ScreenshotCaption": "Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process"}, {"ScreenshotName": "MS-12.A.1-2.png", "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing ipconfig.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched ipconfig.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-12.A.2-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing ipconfig.exe with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.A.2-2.png", "ScreenshotCaption": "Enrichment of ipconfig.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing ipconfig.exe with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-12.A.2-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing ipconfig.exe with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.A.2-2.png", "ScreenshotCaption": "Enrichment of ipconfig.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing ipconfig.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-12-1.png", "ScreenshotCaption": "Telemetry showing ipconfig.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing ipconfig.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-12.A.1-3.png", "ScreenshotCaption": "Telemetry showing ipconfig.exe with command-line arguments (tainted Group ID not shown but was the search parameter)"}, {"ScreenshotName": "S1-12.A.1-1.png", "ScreenshotCaption": "Threat story showing initial compromise alert and powershell.exe\u00a0tainting ipconfig.exe"}], "Footnotes": []}]}]}]}, {"Substep": "12.B.1", "Procedure": "Empire: 'whoami -all -fo list' via PowerShell", "Techniques": [{"TechniqueId": "T1033", "TechniqueName": "System Owner/User Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched whoami.exe with the correct ATT&CK Technique (T1033 - System Owner/User Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-12.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing whoami.exe with command-line arguments"}, {"ScreenshotName": "CB-12.B.1-2.png", "ScreenshotCaption": "Enrichment of whoami.exe with correct ATT&CK Technique (T1033 - System Owner/User Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed powershell.exe executing whoami.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-12.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing whoami.exe with command-line arguments"}, {"ScreenshotName": "CB-12.B.1-2.png", "ScreenshotCaption": "Enrichment of whoami.exe with correct ATT&CK Technique (T1033 - System Owner/User Discovery)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "OverWatch generated a General Behavior alert indicating whoami.exe with command-line arguments was suspicious. The process tree view showed whoami.exe as tainted by a previous powershell.exe detection.[CS1]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "CS-12.B.1-1.png", "ScreenshotCaption": "OverWatch General Behavior alert and telemetry indicating whoami.exe with command-line arguments was suspicious (tainted from previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-6.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating whoami was part of basic reconnaissance activity (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team also sent an email indicating a General Behavior was observed because whoami was part of the basic reconnaissance activity performed.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-12.B.1-1.png", "ScreenshotCaption": "OverWatch General Behavior alert and telemetry indicating whoami.exe with command-line arguments was suspicious (tainted from previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-6.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating whoami was part of basic reconnaissance activity (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the OverWatch alert showed powershell.exe executing whoami.exe with command-line arguments, and would be available in a separate view.[CS2]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-12.B.1-1.png", "ScreenshotCaption": "OverWatch General Behavior alert and telemetry indicating whoami.exe with command-line arguments was suspicious (tainted from previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-6.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating whoami was part of basic reconnaissance activity (General Behavior)"}], "Footnotes": ["For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched whoami.exe executing as Reconnaissance and the correct ATT&CK Tactic (Discovery) and Technique (System Owner/User Discovery). The data was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-12.B.1-1.png", "ScreenshotCaption": "Enrichment of whoami.exe executing as Reconnaissance and the correct ATT&CK Tactic (Discovery) and Technique (System Owner/User Discovery) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-12.B.1-2.png", "ScreenshotCaption": "Enrichment of whoami.exe executing with labels for Reconnaissance and Accounts discovery"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed whoami.exe executing with command-line arguments. [CR5]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-12.B.1-1.png", "ScreenshotCaption": "Enrichment of whoami.exe executing as Reconnaissance and the correct ATT&CK Tactic (Discovery) and Technique (System Owner/User Discovery) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-12.B.1-2.png", "ScreenshotCaption": "Enrichment of whoami.exe executing with labels for Reconnaissance and Accounts discovery"}], "Footnotes": [" The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched whoami.exe with the correct ATT&CK Technique (T1033 - System Owner/User Discovery) and Tactic (Discovery). The enrichment was tainted by parent PowerShell alerts. [EG11]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-12-2.png", "ScreenshotCaption": "Telemetry showing whoami.exe with command-line arguments"}, {"ScreenshotName": "EG-12-1.png", "ScreenshotCaption": "Enriched event tree showing enrichment of whoami.exe with correct ATT&CK Technique (T1033 - System Owner/User Discovery) and Tactic (Discovery) (tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing whoami.exe with command-line arguments (tainted by parent PowerShell alerts). [EG11]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-12-2.png", "ScreenshotCaption": "Telemetry showing whoami.exe with command-line arguments"}, {"ScreenshotName": "EG-12-1.png", "ScreenshotCaption": "Enriched event tree showing enrichment of whoami.exe with correct ATT&CK Technique (T1033 - System Owner/User Discovery) and Tactic (Discovery) (tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (whoami) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.A.1-1.png", "ScreenshotCaption": "Enrichment of powershell.exe executing whoami.exe indicating a sign of reconnaissance before privilege escalation"}, {"ScreenshotName": "CC-12.B.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing whoami.exe with command-line arguments"}, {"ScreenshotName": "CC-11.B.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (whoami) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched powershell.exe executing whoami.exe indicating a sign of reconnaissance before privilege escalation.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.A.1-1.png", "ScreenshotCaption": "Enrichment of powershell.exe executing whoami.exe indicating a sign of reconnaissance before privilege escalation"}, {"ScreenshotName": "CC-12.B.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing whoami.exe with command-line arguments"}, {"ScreenshotName": "CC-11.B.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (whoami) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing whoami.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.A.1-1.png", "ScreenshotCaption": "Enrichment of powershell.exe executing whoami.exe indicating a sign of reconnaissance before privilege escalation"}, {"ScreenshotName": "CC-12.B.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing whoami.exe with command-line arguments"}, {"ScreenshotName": "CC-11.B.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (whoami) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified whoami.exe as a reconnaissance command used. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-12.B.1-1.png", "ScreenshotCaption": "Enrichment of whoami.exe with Whoami Execution (tagged with correct ATT&CK Technique, T1033 - System Owner/User Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating whoami.exe was a reconnaissance command used (General Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched whoami.exe with an alert for Whoami Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1033 - System Owner/User Discovery) and Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-12.B.1-1.png", "ScreenshotCaption": "Enrichment of whoami.exe with Whoami Execution (tagged with correct ATT&CK Technique, T1033 - System Owner/User Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating whoami.exe was a reconnaissance command used (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability showed powershell.exe executing whoami.exe with command-line arguments and enriched the command with the condition Whoami Reconnaissance Command. The enrichment was tainted by the parent Script File Created alert.[CT15]", "Modifiers": ["Configuration Change", "Tainted"], "Screenshots": [{"ScreenshotName": "CT-12.B.1-1.png", "ScreenshotCaption": "Enrichment of whoami.exe with condition Whoami Reconnaissance Command (tainted by parent Script File Created alert)"}], "Footnotes": ["The condition contributing to enrichment may have been added to the capability's detection after the start of the evaluation, so the detection is identified as a configuration change. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched whomai.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Owner / User Discovery) and a suspicious indicator that the name of the logged user was discovered.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-12.A.1-3.png", "ScreenshotCaption": "Telemetry showing whoami.exe with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "MC-12.A.1-2.png", "ScreenshotCaption": "Enrichment of whoami.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Owner / User Discovery) and a suspicious indicator that the name of the logged user was discovered"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing whoami.exe. The telemetry was tainted by a trace detection on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-12.A.1-3.png", "ScreenshotCaption": "Telemetry showing whoami.exe with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "MC-12.A.1-2.png", "ScreenshotCaption": "Enrichment of whoami.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Owner / User Discovery) and a suspicious indicator that the name of the logged user was discovered"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence for powershell.exe executing whoami.exe with command-line arguments. The telemetry was tainted by previous \\\"Suspicious sequence of exploration activities\\\" and suspicious PowerShell cmdlet alerts.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-12.A.1-4.png", "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"}, {"ScreenshotName": "MS-12.E.1-4.png", "ScreenshotCaption": "Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process"}, {"ScreenshotName": "MS-12.B.1-1.png", "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing whoami.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing whoami.exe with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-12.B.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing whoami.exe with command-line arguments (tainted by a parent alert on wscript.exe)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing whoami.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-12-1.png", "ScreenshotCaption": "Telemetry showing whoami.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing whoami.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-12.A.1-3.png", "ScreenshotCaption": "Telemetry showing whoami.exe with command-line arguments (tainted Group ID not shown but was the search parameter)"}, {"ScreenshotName": "S1-12.A.1-2.png", "ScreenshotCaption": "Continued threat story showing initial compromise alert and powershell.exe\u00a0tainting whoami.exe"}], "Footnotes": []}]}]}]}, {"Substep": "12.C.1", "Procedure": "Empire: 'qprocess *' via PowerShell", "Techniques": [{"TechniqueId": "T1057", "TechniqueName": "Process Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched qprocess.exe with the correct ATT&CK Technique (Process Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-12.C.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing qprocess.exe with command-line arguments"}, {"ScreenshotName": "CB-12.C.1-2.png", "ScreenshotCaption": "Enrichment of qprocess.exe with correct ATT&CK Technique (Process Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed powershell.exe executing qprocess.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-12.C.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing qprocess.exe with command-line arguments"}, {"ScreenshotName": "CB-12.C.1-2.png", "ScreenshotCaption": "Enrichment of qprocess.exe with correct ATT&CK Technique (Process Discovery)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "OverWatch generated a General Behavior alert indicating qprocess.exe with command-line arguments was suspicious. The process tree view showed qprocess.exe as tainted by a previous powershell.exe detection.[CS1]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "CS-12.C.1-1.png", "ScreenshotCaption": "OverWatch General Behavior alert and telemetry indicating qprocess.exe with command-line arguments was suspicious (tainted from previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-6.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating qprocess was part of basic reconnaissance activity (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team also sent an email indicating a General Behavior was observed because qprocess was part of the basic reconnaissance activity performed performed.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-12.C.1-1.png", "ScreenshotCaption": "OverWatch General Behavior alert and telemetry indicating qprocess.exe with command-line arguments was suspicious (tainted from previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-6.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating qprocess was part of basic reconnaissance activity (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the OverWatch alert showed execution of qprocess.exe with command-line arguments, and would be available in a separate view.[CS2]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-12.C.1-1.png", "ScreenshotCaption": "OverWatch General Behavior alert and telemetry indicating qprocess.exe with command-line arguments was suspicious (tainted from previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-6.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating qprocess was part of basic reconnaissance activity (General Behavior)"}], "Footnotes": ["For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched qprocess.exe executing as Reconnaissance and Local process discovery as well as the correct ATT&CK Technique (Process Discovery) and Tactic (Discovery). The data was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-12.C.1-1.png", "ScreenshotCaption": "Enrichment of qprocess.exe executing with correct ATT&CK Technique (Process Discovery) and Tactic (Discovery) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-12.B.1-2.png", "ScreenshotCaption": "Enrichment of qprocess.exe executing with labels for Reconnaissance and Local process discovery"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed qprocess.exe executing with command-line arguments. [CR5]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-12.C.1-1.png", "ScreenshotCaption": "Enrichment of qprocess.exe executing with correct ATT&CK Technique (Process Discovery) and Tactic (Discovery) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-12.B.1-2.png", "ScreenshotCaption": "Enrichment of qprocess.exe executing with labels for Reconnaissance and Local process discovery"}], "Footnotes": [" The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing qprocess.exe with command-line arguments (tainted by parent PowerShell alerts).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-12-1.png", "ScreenshotCaption": "Event tree view of telemetry showing qprocess.exe with command-line arguments (tainted by parent PowerShell alerts)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (qprocess) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.A.1-1.png", "ScreenshotCaption": "Enrichment of qprocess.exe as listing running processes and possibly a sign of reconnaissance"}, {"ScreenshotName": "CC-12.C.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing qprocess.exe with command-line arguments"}, {"ScreenshotName": "CC-12.A.1-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (qprocess) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched qprocess.exe as listing running processes and possibly a sign of reconnaissance.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.A.1-1.png", "ScreenshotCaption": "Enrichment of qprocess.exe as listing running processes and possibly a sign of reconnaissance"}, {"ScreenshotName": "CC-12.C.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing qprocess.exe with command-line arguments"}, {"ScreenshotName": "CC-12.A.1-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (qprocess) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershelll.exe executing qprocess.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.A.1-1.png", "ScreenshotCaption": "Enrichment of qprocess.exe as listing running processes and possibly a sign of reconnaissance"}, {"ScreenshotName": "CC-12.C.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing qprocess.exe with command-line arguments"}, {"ScreenshotName": "CC-12.A.1-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (qprocess) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified qprocess.exe as a reconnaissance command used.[FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-12.C.1-1.png", "ScreenshotCaption": "Enrichment of qprocess.exe with Qprocess Execution alert (tagged with correct ATT&CK Technique, T1057 - Process Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating qprocess.exe was a reconnaissance command used (General Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched qprocess.exe with an alert for Qprocess Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1057 - Process Discovery) and Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-12.C.1-1.png", "ScreenshotCaption": "Enrichment of qprocess.exe with Qprocess Execution alert (tagged with correct ATT&CK Technique, T1057 - Process Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating qprocess.exe was a reconnaissance command used (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing qprocess.exe with command-line arguments. The telemetry was tainted by the parent Script File Created alert.[CT5]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-12.C.1-1.png", "ScreenshotCaption": "Telemetry showing qprocess.exe with command-line arguments (tainted by parent Script File Created alert)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched qprocess.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (Process Discovery) and a suspicious indicator that QPROCESS was used to check active processes.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-12.A.1-3.png", "ScreenshotCaption": "Telemetry showing qprocess.exe with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "MC-12.A.1-2.png", "ScreenshotCaption": "Enrichment of qprocess.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (Process Discovery) and a suspicious indicator that QPROCESS was used to check active processes"}, {"ScreenshotName": "MC-12.A.1-99.png", "ScreenshotCaption": "Enrichment of qprocess.exe with the correct ATT&CK Tactic (Discovery) and a suspicious indicator that software running on a system was queried"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched qprocess.exe with the correct ATT&CK Tactic (Discovery) and a suspicious indicator that software running on a system was queried.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-12.A.1-3.png", "ScreenshotCaption": "Telemetry showing qprocess.exe with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "MC-12.A.1-2.png", "ScreenshotCaption": "Enrichment of qprocess.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (Process Discovery) and a suspicious indicator that QPROCESS was used to check active processes"}, {"ScreenshotName": "MC-12.A.1-99.png", "ScreenshotCaption": "Enrichment of qprocess.exe with the correct ATT&CK Tactic (Discovery) and a suspicious indicator that software running on a system was queried"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing qprocess.exe. The telemetry was tainted by a trace detection on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-12.A.1-3.png", "ScreenshotCaption": "Telemetry showing qprocess.exe with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "MC-12.A.1-2.png", "ScreenshotCaption": "Enrichment of qprocess.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (Process Discovery) and a suspicious indicator that QPROCESS was used to check active processes"}, {"ScreenshotName": "MC-12.A.1-99.png", "ScreenshotCaption": "Enrichment of qprocess.exe with the correct ATT&CK Tactic (Discovery) and a suspicious indicator that software running on a system was queried"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence for powershell.exe executing qprocess.exe with command-line arguments. The telemetry was tainted by previous \\\"Suspicious sequence of exploration activities\\\" and suspicious PowerShell cmdlet alerts.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-12.A.1-4.png", "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"}, {"ScreenshotName": "MS-12.E.1-4.png", "ScreenshotCaption": "Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process"}, {"ScreenshotName": "MS-12.C.1-1.png", "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing qprocess.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched qprocess.exe executing with a related ATT&CK Technique (System Service Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-12.C.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing qprocess.exe with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.C.1-2.png", "ScreenshotCaption": "Enrichment of execution of qprocess.exe as the enumeration of running processes via the command line (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.C.1-3.png", "ScreenshotCaption": "Enrichment of qprocess.exe executing with a related ATT&CK Technique (System Service Discovery)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the execution of qprocess.exe as the enumeration of running processes via the command line. The data was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-12.C.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing qprocess.exe with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.C.1-2.png", "ScreenshotCaption": "Enrichment of execution of qprocess.exe as the enumeration of running processes via the command line (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.C.1-3.png", "ScreenshotCaption": "Enrichment of qprocess.exe executing with a related ATT&CK Technique (System Service Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing qprocess.exe with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-12.C.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing qprocess.exe with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.C.1-2.png", "ScreenshotCaption": "Enrichment of execution of qprocess.exe as the enumeration of running processes via the command line (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.C.1-3.png", "ScreenshotCaption": "Enrichment of qprocess.exe executing with a related ATT&CK Technique (System Service Discovery)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing qprocess.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-12-1.png", "ScreenshotCaption": "Telemetry showing qprocess.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing qprocess.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-12.A.1-3.png", "ScreenshotCaption": "Telemetry showing qprocess.exe with command-line arguments (tainted Group ID not shown but was the search parameter)"}, {"ScreenshotName": "S1-12.A.1-1.png", "ScreenshotCaption": "Threat story showing initial compromise alert and powershell.exe\u00a0tainting qprocess.exe"}], "Footnotes": []}]}]}]}, {"Substep": "12.D.1", "Procedure": "Empire: 'net start' via PowerShell", "Techniques": [{"TechniqueId": "T1007", "TechniqueName": "System Service Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed powershell.exe executing net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-12.A.D.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team sent an email indicating a General Behavior was observed because net start was part of the basic reconnaissance activity performed performed.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-12.D.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-6.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating net start was part of basic reconnaissance activity (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments. The process tree view showed net.exe and net1.exe as tainted by a previous powershell.exe detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-12.D.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-6.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating net start was part of basic reconnaissance activity (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was also tagged with the correct ATT&CK Tactic (Discovery) and Technique (System Services Discovery). The alert was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-12.D.1-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (System Services Discovery) and Technique (Discovery)"}, {"ScreenshotName": "CR-12.D.1-1.png", "ScreenshotCaption": "Process tree showing alerted net.exe with correct ATT&CK Technique (System Service Discovery) (tainted by a parent PowerShell alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed net.exe executing with command-line arguments. [CR3]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-12.D.1-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (System Services Discovery) and Technique (Discovery)"}, {"ScreenshotName": "CR-12.D.1-1.png", "ScreenshotCaption": "Process tree showing alerted net.exe with correct ATT&CK Technique (System Service Discovery) (tainted by a parent PowerShell alert)"}], "Footnotes": [" For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with the correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery).\u00a0The enrichment was tainted by parent PowerShell alerts. [EG11]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-12-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "EG-12-1.png", "ScreenshotCaption": "Enriched event tree showing enrichment of  net.exe with correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery)\u00a0(tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments (tainted by parent PowerShell alerts). [EG11]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-12-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "EG-12-1.png", "ScreenshotCaption": "Enriched event tree showing enrichment of  net.exe with correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery)\u00a0(tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.D.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}, {"ScreenshotName": "CC-11.B.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.D.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}, {"ScreenshotName": "CC-11.B.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified net.exe as a reconnaissance command used. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-12.D.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Start Command Execution alert (tagged with correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with an alert for Net Start Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-12.D.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Start Command Execution alert (tagged with correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by the parent Script File Created alert.[CT5]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-12.D.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by parent Script File Created alert)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for net or sc command executed through PowerShell. The alert was tagged with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-12.A.1-3.png", "ScreenshotCaption": "Telemetry showing qprocess.exe with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "MC-12.A.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Windows services were manipulated via sc.exe/net.exe"}, {"ScreenshotName": "MC-12.A.1-99.png", "ScreenshotCaption": "General Behavior alert was generated for net or sc command executed through PowerShell, tagged with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Windows services were manipulated via sc.exe/net.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-12.A.1-3.png", "ScreenshotCaption": "Telemetry showing qprocess.exe with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "MC-12.A.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Windows services were manipulated via sc.exe/net.exe"}, {"ScreenshotName": "MC-12.A.1-99.png", "ScreenshotCaption": "General Behavior alert was generated for net or sc command executed through PowerShell, tagged with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net.exe. The telemetry was tainted by a trace detection on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-12.A.1-3.png", "ScreenshotCaption": "Telemetry showing qprocess.exe with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "MC-12.A.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Windows services were manipulated via sc.exe/net.exe"}, {"ScreenshotName": "MC-12.A.1-99.png", "ScreenshotCaption": "General Behavior alert was generated for net or sc command executed through PowerShell, tagged with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery)"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A delayed General Behavior alert was generated for \"Suspicious sequence of exploration activities\".", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "MS-12.D.1-1.png", "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing net.exe with command-line arguments"}, {"ScreenshotName": "MS-12.E.1-4.png", "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process"}, {"ScreenshotName": "MS-12.A.1-3.png", "ScreenshotCaption": "General Behavior alert description for \\\"Suspicious sequence of discovery activities\\\""}, {"ScreenshotName": "MS-12.D.1-2.png", "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of discovery activities\\\" alert context with net.exe command-line arguments"}], "Footnotes": ["Alert is based on the correlation of a chain of related behaviors across multiple steps."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence for powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by a previous suspicious PowerShell cmdlet alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-12.D.1-1.png", "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing net.exe with command-line arguments"}, {"ScreenshotName": "MS-12.E.1-4.png", "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process"}, {"ScreenshotName": "MS-12.A.1-3.png", "ScreenshotCaption": "General Behavior alert description for \\\"Suspicious sequence of discovery activities\\\""}, {"ScreenshotName": "MS-12.D.1-2.png", "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of discovery activities\\\" alert context with net.exe command-line arguments"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for net.exe executing as an enumeration command called by a commonly abused causality group owner (CGO, wscipt.exe). The data was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-12.D.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.D.1-2.png", "ScreenshotCaption": "Enrichment of net.exe executing as the execution of an enumeration command (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.D.1-3.png", "ScreenshotCaption": "General Behavior alert for net.exe executing as a enumeration command called by a commonly abused causality group owner (CGO, wscript.exe) (tainted by a parent alert on wscript.exe)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe executing as the execution of an enumeration command. The data was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-12.D.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.D.1-2.png", "ScreenshotCaption": "Enrichment of net.exe executing as the execution of an enumeration command (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.D.1-3.png", "ScreenshotCaption": "General Behavior alert for net.exe executing as a enumeration command called by a commonly abused causality group owner (CGO, wscript.exe) (tainted by a parent alert on wscript.exe)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-12.D.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.D.1-2.png", "ScreenshotCaption": "Enrichment of net.exe executing as the execution of an enumeration command (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.D.1-3.png", "ScreenshotCaption": "General Behavior alert for net.exe executing as a enumeration command called by a commonly abused causality group owner (CGO, wscript.exe) (tainted by a parent alert on wscript.exe)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-12-1.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-12.A.1-3.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted Group ID not shown but was the search parameter)"}, {"ScreenshotName": "S1-12.A.1-1.png", "ScreenshotCaption": "Threat story showing initial compromise alert and powershell.exe\u00a0tainting net.exe"}], "Footnotes": []}]}]}]}, {"Substep": "12.E.1", "Procedure": "Empire: Built-in WinEnum module executed to programmatically execute a series of enumeration techniques", "Techniques": [{"TechniqueId": "T1064", "TechniqueName": "Scripting", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed process execution of powershell.exe. The powershell.exe process loaded several non-default dynamically loaded libraries that may indicate the functionality may be used by the PowerShell script.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-12.E.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe execution"}, {"ScreenshotName": "CB-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing dynamically loaded libraries (modloads) that may indicate PowerShell functionality"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The OverWatch team also sent an email indicating they identified a Specific Behavior for an unidentified PowerShell script running.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-12.E.1-1.png", "ScreenshotCaption": "Telemetry showing the temp write of the ps1 script"}, {"ScreenshotName": "CS-12.E.1-4.png", "ScreenshotCaption": "OverWatch Specific Behavior alert indicating the PowerShell script was malicious"}, {"ScreenshotName": "CS-12.E.1-3.png", "ScreenshotCaption": "Email excerpt from OverWatch team indicating they observed an unidentified PowerShell script running (Specific Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Specific Behavior", "DetectionNote": "The OverWatch team generated a Specific Behavior alert indicating the PowerShell script was malicious.[CS1]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-12.E.1-1.png", "ScreenshotCaption": "Telemetry showing the temp write of the ps1 script"}, {"ScreenshotName": "CS-12.E.1-4.png", "ScreenshotCaption": "OverWatch Specific Behavior alert indicating the PowerShell script was malicious"}, {"ScreenshotName": "CS-12.E.1-3.png", "ScreenshotCaption": "Email excerpt from OverWatch team indicating they observed an unidentified PowerShell script running (Specific Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the PowerShell script (.ps1) being written to the temp folder.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-12.E.1-1.png", "ScreenshotCaption": "Telemetry showing the temp write of the ps1 script"}, {"ScreenshotName": "CS-12.E.1-4.png", "ScreenshotCaption": "OverWatch Specific Behavior alert indicating the PowerShell script was malicious"}, {"ScreenshotName": "CS-12.E.1-3.png", "ScreenshotCaption": "Email excerpt from OverWatch team indicating they observed an unidentified PowerShell script running (Specific Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for a malicious command, which was identified as the Invoke-WinEnum function. The alert also identified the PowerShell commands as suspicious and were tagged with the correct ATT&CK Technique (PowerShell) and Tactic (Execution). The alert was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-12.E.1-100.png", "ScreenshotCaption": "Specific Behavior alert for Malicious use of PowerShell (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-12.E.1-1.png", "ScreenshotCaption": "Specific Behavior alert for a PowerShell Malicious command, identified as the Invoke-WinEnum function"}, {"ScreenshotName": "CR-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the temp write of the psm1 script module (tainted by a parent PowerShell alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the PowerShell Script module (.psm1) being written to the temp folder. The telemetry was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-12.E.1-100.png", "ScreenshotCaption": "Specific Behavior alert for Malicious use of PowerShell (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-12.E.1-1.png", "ScreenshotCaption": "Specific Behavior alert for a PowerShell Malicious command, identified as the Invoke-WinEnum function"}, {"ScreenshotName": "CR-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the temp write of the psm1 script module (tainted by a parent PowerShell alert)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for \"PowerShell with Unusual Arguments\" that coincided with the execution of WinEnum (tainted by parent PowerShell alerts). The alert also identified a related ATT&CK Technique (T1086 - PowerShell) and Tactic (Execution). From the alert, the Interactive Shell was used to analyze the PowerShell script and the function Invoke-WinEnum was observed.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-12-3.png", "ScreenshotCaption": "Specific Behavior alert for \\\"PowerShell with Unusual Arguments\\\" (tagged with correct ATT&CK Technique, T1086 - PowerShell, and Tactic, Execution; tainted by parent PowerShell alerts)"}, {"ScreenshotName": "EG-12-E-01.png", "ScreenshotCaption": "Telemetry pulled by Interactive Shell showing the contents of the WinEnum script (does not count as a detection)"}, {"ScreenshotName": "EG-12-7.png", "ScreenshotCaption": "Telemetry showing powershell.exe execution (ID 2397532) (tainted by parent PowerShell alerts)"}], "Footnotes": ["Interactive Shell was not by itself considered telemetry, but the analyst can retrieve additional Windows Logs to enhance baseline Endgame functionality. "]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the creation of the PowerShell Process (tainted by parent PowerShell alerts).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-12-3.png", "ScreenshotCaption": "Specific Behavior alert for \\\"PowerShell with Unusual Arguments\\\" (tagged with correct ATT&CK Technique, T1086 - PowerShell, and Tactic, Execution; tainted by parent PowerShell alerts)"}, {"ScreenshotName": "EG-12-E-01.png", "ScreenshotCaption": "Telemetry pulled by Interactive Shell showing the contents of the WinEnum script (does not count as a detection)"}, {"ScreenshotName": "EG-12-7.png", "ScreenshotCaption": "Telemetry showing powershell.exe execution (ID 2397532) (tainted by parent PowerShell alerts)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that a PowerShell command was run from the Empire process. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-12.E.1-1.png", "ScreenshotCaption": "Enrichment of powershell.exe with PowerShell Execution alert (tagged with related ATT&CK Technique T1086 - PowerShell)"}, {"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating a PowerShell command was run from Empire (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched powershell.exe with an alert for PowerShell Execution (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1086 - PowerShell).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-12.E.1-1.png", "ScreenshotCaption": "Enrichment of powershell.exe with PowerShell Execution alert (tagged with related ATT&CK Technique T1086 - PowerShell)"}, {"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating a PowerShell command was run from Empire (Specific Behavior)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe connecting to the domain controller 10.0.0.4 (Creeper), which coincided with the execution of WinEnum.[CT5]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CT-12.E.1.2-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe execution and connection to the domain controller 10.0.0.4 (Creeper)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the PowerShell script (.ps1) being written to the temp folder, indicating the execution of a PowerShell script.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-12.E.1-4.png", "ScreenshotCaption": "Telemetry showing the PowerShell script (.ps1) being written to the temp folder"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for \"A malicious PowerShell Cmdlet was invoked on the machine.\"", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-12.E.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe execution sequence resulting from WinEnum"}, {"ScreenshotName": "MS-12.A.1-4.png", "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"}, {"ScreenshotName": "MS-12.E.1-2.png", "ScreenshotCaption": "Additional telemetry showing powershell.exe execution sequence resulting from WinEnum"}, {"ScreenshotName": "MS-12.E.1-5.png", "ScreenshotCaption": "Specific Behavior alert for \\\"A malicious PowerShell Cmdlet was invoked on the machine\\\""}, {"ScreenshotName": "MS-12.E.1-4.png", "ScreenshotCaption": "Process tree under alert \\\"A malicious PowerShell Cmdlet was invoked on the machine\\\" showing Invoke-Empire and Invoke-WinEnum"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence from PowerShell with several activities from the WinEnum cmdlet. The telemetry was tainted by the previous \\\"Suspicious sequence of exploration activities\\\" alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-12.E.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe execution sequence resulting from WinEnum"}, {"ScreenshotName": "MS-12.A.1-4.png", "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"}, {"ScreenshotName": "MS-12.E.1-2.png", "ScreenshotCaption": "Additional telemetry showing powershell.exe execution sequence resulting from WinEnum"}, {"ScreenshotName": "MS-12.E.1-5.png", "ScreenshotCaption": "Specific Behavior alert for \\\"A malicious PowerShell Cmdlet was invoked on the machine\\\""}, {"ScreenshotName": "MS-12.E.1-4.png", "ScreenshotCaption": "Process tree under alert \\\"A malicious PowerShell Cmdlet was invoked on the machine\\\" showing Invoke-Empire and Invoke-WinEnum"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for PowerShell execution with base64 encoded commands. The alert was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-12.E.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing with command-line arguments as well as PowerShell module (.psm) and script (.ps1) files being written to disk (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.E.1-2.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell execution with base64 encoded commands (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.E.1-3.png", "ScreenshotCaption": "Indicator of Compromise alert identifying suspicious PowerShell strings as Empire WinEnum"}], "Footnotes": []}, {"DetectionType": "Indicator of Compromise", "DetectionNote": "An Indicator of Compromise alert was generated identifying suspicious PowerShell strings as Empire WinEnum.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-12.E.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing with command-line arguments as well as PowerShell module (.psm) and script (.ps1) files being written to disk (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.E.1-2.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell execution with base64 encoded commands (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.E.1-3.png", "ScreenshotCaption": "Indicator of Compromise alert identifying suspicious PowerShell strings as Empire WinEnum"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing with command-line arguments as well as PowerShell module (.psm) and script (.ps1) files being written to disk. The telemetry was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-12.E.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing with command-line arguments as well as PowerShell module (.psm) and script (.ps1) files being written to disk (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.E.1-2.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell execution with base64 encoded commands (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.E.1-3.png", "ScreenshotCaption": "Indicator of Compromise alert identifying suspicious PowerShell strings as Empire WinEnum"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed PowerShell running and a PowerShell script being written to disk that coincided with the execution of WinEnum.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-12-3.png", "ScreenshotCaption": "Telemetry showing a PowerShell script written to disk"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of a PowerShell script with follow-on enumeration activity that coincided with the execution of the WinEnum module. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-12.E.1-1.png", "ScreenshotCaption": "Telemetry showing encoded PowerShell script (tainted Group ID not shown but was the search parameter)"}], "Footnotes": []}]}]}]}, {"Substep": "12.E.1.1", "Procedure": "Empire: WinEnum module included enumeration of user information", "Techniques": [{"TechniqueId": "T1033", "TechniqueName": "System Owner/User Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though the Interactive Shell was used to analyze the PowerShell execution and WinEnum Get-UserInfo was observed.[EG13]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-12-E-02.png", "ScreenshotCaption": "Interactive Shell events showing the WinEnum script and the Get-UserInfo function (does not count as a detection due to manual process of pulling events)"}], "Footnotes": ["Interactive Shell was not by itself considered telemetry, but the analyst can retrieve additional Windows Logs to enhance baseline Endgame functionality. "]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of user information.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[CT5]", "Modifiers": [], "Screenshots": [], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Indicator of Compromise", "DetectionNote": "An Indicator of Compromise alert was generated identifying suspicious PowerShell strings as Empire UserInfo.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-12.E.1.1-1.png", "ScreenshotCaption": "Indicator of Compromise alert identifying suspicious PowerShell strings as Empire UserInfo"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}]}, {"Substep": "12.E.1.2", "Procedure": "Empire: WinEnum module included enumeration of AD group memberships", "Techniques": [{"TechniqueId": "T1069", "TechniqueName": "Permission Groups Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though the Interactive Shell was used to analyze the PowerShell execution and WinEnum AD Group Memberships was observed.[EG13]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-12-E-03.png", "ScreenshotCaption": "Interactive Shell events showing the WinEnum script and the AD Group Memberships function (does not count as a detection due to manual process of pulling events)"}], "Footnotes": ["Interactive Shell was not by itself considered telemetry, but the analyst can retrieve additional Windows Logs to enhance baseline Endgame functionality. "]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of AD group memberships.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed loading of an assembly associated with accessing Active Directory security principals.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-12.E.1.2-1.png", "ScreenshotCaption": "Telemetry showing loading of System.DirectoryServices.AccountManagement assembly (does not count as a detection)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed powershell.exe connecting to the domain controller. This could indicate AD group information was being obtained, but this was not directly detected. The vendor indicated the capability sees the start of a PowerShell connection, but would not see additional commands after that start.[CT5]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CT-12.E.1.2-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe execution and connection to the domain controller 10.0.0.4 (Creeper) (does not count as a detection)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}]}, {"Substep": "12.E.1.3", "Procedure": "Empire: WinEnum module included enumeration of password policy information", "Techniques": [{"TechniqueId": "T1201", "TechniqueName": "Password Policy Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though the Interactive Shell was used to analyze the PowerShell execution and WinEnum Password Last changed was observed.[EG13]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-12-E-03.png", "ScreenshotCaption": "Interactive Shell events showing the WinEnum script and the Password Last Changed function (does not count as a detection due to manual process of pulling events)"}], "Footnotes": ["Interactive Shell was not by itself considered telemetry, but the analyst can retrieve additional Windows Logs to enhance baseline Endgame functionality. "]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of password policy information.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[CT5]", "Modifiers": [], "Screenshots": [], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}]}, {"Substep": "12.E.1.4.1", "Procedure": "Empire: WinEnum module included enumeration of recently opened files", "Techniques": [{"TechniqueId": "T1083", "TechniqueName": "File and Directory Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though the Interactive Shell was used to analyze the PowerShell execution and WinEnum Last 5 files opened was observed.[EG13]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-12-E-03.png", "ScreenshotCaption": "Interactive Shell events showing the WinEnum script and the Last 5 files opened function (does not count as a detection due to manual process of pulling events)"}], "Footnotes": ["Interactive Shell was not by itself considered telemetry, but the analyst can retrieve additional Windows Logs to enhance baseline Endgame functionality. "]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of recently opened files.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[CT5]", "Modifiers": [], "Screenshots": [], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched powershell.exe executing with command-line arguments as suspicious and the correct ATT&CK Technique (File and Directory Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-12.E.1.4-1.png", "ScreenshotCaption": "Enrichment of powershell.exe executing with command-line arguments as suspicious and the correct ATT&CK Technique (File and Directory Discovery)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}]}, {"Substep": "12.E.1.4.2", "Procedure": "Empire: WinEnum module included enumeration of interesting files", "Techniques": [{"TechniqueId": "T1083", "TechniqueName": "File and Directory Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though the Interactive Shell was used to analyze the PowerShell execution and WinEnum Interesting Files was observed.[EG13]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-12-E-04.png", "ScreenshotCaption": "Interactive Shell events showing the WinEnum script and the Interesting Files function (does not count as a detection due to manual process of pulling events)"}], "Footnotes": ["Interactive Shell was not by itself considered telemetry, but the analyst can retrieve additional Windows Logs to enhance baseline Endgame functionality. "]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of interesting files.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[CT5]", "Modifiers": [], "Screenshots": [], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched powershell.exe executing with command-line arguments as suspicious and the correct ATT&CK Technique (File and Directory Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-12.E.1.4-1.png", "ScreenshotCaption": "Enrichment of powershell.exe executing with command-line arguments as suspicious and the correct ATT&CK Technique (File and Directory Discovery)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}]}, {"Substep": "12.E.1.5", "Procedure": "Empire: WinEnum module included enumeration of clipboard contents", "Techniques": [{"TechniqueId": "T1115", "TechniqueName": "Clipboard Data", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed execution of an encoded PowerShell command and OverWatch alerted on it as suspicious. The PowerShell decoded to Windows.Clipboard(...) outside of the capability, which indicated clipboard interaction, but this was not counted as a detection because it was external to the capability.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing encoded PowerShell, which decodes to show Windows.Clipboard details (does not count as a detection)"}, {"ScreenshotName": "CS-12.E.1.5-3.png", "ScreenshotCaption": "Decoding (outside the capability) of encoded PowerShell command to show Windows.Clipboard details (does not count as a detection)"}, {"ScreenshotName": "CS-12.E.1.5-1.png", "ScreenshotCaption": "OverWatch alert indicating encoded PowerShell was suspicious (does not count as a detection)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the decoded powershell.exe function to gather clipboard data. The telemetry was tainted by a parent PowerShell alert..", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-12.E.1.5-1.png", "ScreenshotCaption": "Telemetry of the PowerShell function to gather clipboard data (tainted by a parent PowerShell alert)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the creation of a PowerShell sub-process and decoded the command within the capability to show\u00a0Windows.Clipboard (tainted by parent PowerShell alerts). Though it does not count as part of the detection, the Interactive Shell could also be used to analyze the PowerShell execution and WinEnum Clipboard Contents was observed.[EG13]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-12-4.png", "ScreenshotCaption": "Telemetry showing decoded PowerShell displaying Windows.Clipboard as part of WinEnum. The PowerShell process was tainted by parent PowerShell alerts."}, {"ScreenshotName": "EG-12-E-05.png", "ScreenshotCaption": "Interactive Shell events showing the WinEnum script and Clipboard Contents function (does not count as part of detection due to manual process of pulling events)"}], "Footnotes": ["Interactive Shell was not by itself considered telemetry, but the analyst can retrieve additional Windows Logs to enhance baseline Endgame functionality. "]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Indicator of Compromise", "DetectionNote": "An Indicator of Compromise alert was generated for PowerShell Empire accessing the clipboard.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}, {"ScreenshotName": "CC-12.E.1-4.png", "ScreenshotCaption": "Indicator of Compromise alert for PowerShell Empire accessing the clipboard."}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of clipboard contents.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}, {"ScreenshotName": "CC-12.E.1-4.png", "ScreenshotCaption": "Indicator of Compromise alert for PowerShell Empire accessing the clipboard."}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Indicator of Compromise", "DetectionNote": "The Managed Defense Report indicated an Indicator of Compromise detection occurred because it identified that the attacker executed the Windows Clipboard capability in Empire. The capability separately showed a PowerShell Execution (Weak Signal) alert containing the encoded PowerShell command. This command could be decoded, but this was not counted as a separate detection because it was external to the capability. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker executed the Windows Clipboard capability of Empire (Indicator of Compromise)"}, {"ScreenshotName": "FE-12.E.1.5-1.png", "ScreenshotCaption": "PowerShell Execution alert containing encoded PowerShell command (does not count as a detection)"}, {"ScreenshotName": "FE-12.E.1.5-2.png", "ScreenshotCaption": "Decoding (outside the capability) of encoded PowerShell command to show Windows.Clipboard details (does not count as a detection)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[CT5]", "Modifiers": [], "Screenshots": [], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed execution of an encoded PowerShell command. The PowerShell decoded to Windows.Clipboard(...) outside of the capability, which indicated clipboard interaction, but this was not counted as a detection because it was external to the capability.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-12.E.1.1-5.png", "ScreenshotCaption": "Telemetry showing execution of an encoded PowerShell command (does not count as a detection)"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched powershell.exe executing with command-line arguments with the correct ATT&CK Technique (Clipboard Data).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-12.E.1.5-1.png", "ScreenshotCaption": "Enrichment of powershell.exe executing with command-line arguments with the correct ATT&CK Technique (Clipboard Data)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[SO95]", "Modifiers": [], "Screenshots": [], "Footnotes": ["PowerShell telemetry showed execution of an encoded command and the script was decoded to Windows.Clipboard(...) outside of the capability, but this was not counted as a detection because it was external to the capability."]}]}]}]}, {"Substep": "12.E.1.6.1", "Procedure": "Empire: WinEnum module included enumeration of system information", "Techniques": [{"TechniqueId": "T1082", "TechniqueName": "System Information Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry from decoded PowerShell (within the capability) showed the Get-Sysinfo function.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-12.E.1.6.1-1.png", "ScreenshotCaption": "Telemetry showing the Get-Sysinfo function"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though the Interactive Shell was used to analyze the PowerShell execution and WinEnum Get-SysInfo was observed.[EG13]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-12-E-05.png", "ScreenshotCaption": "Interactive Shell events showing the WinEnum script and the Get-SysInfo function (does not count as a detection due to manual process of pulling events)"}], "Footnotes": ["Interactive Shell was not by itself considered telemetry, but the analyst can retrieve additional Windows Logs to enhance baseline Endgame functionality. "]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of system information.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[CT5]", "Modifiers": [], "Screenshots": [], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed invocation of the PowerShell cmdlet Get-SysInfo.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-12.E.1-2.png", "ScreenshotCaption": "Telemetry of execution sequence showing Get-SysInfo invocation"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Indicator of Compromise", "DetectionNote": "An Indicator of Compromise alert was generated identifying suspicious PowerShell strings as Empire SysImfo.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-12.E.1.6-1.png", "ScreenshotCaption": "Indicator of Compromise alert identifying suspicious PowerShell strings as Empire SysInfo"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing WMI queries that indicated operating system information was queried. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing WMI queries (tainted Group ID not shown but was the search parameter)"}, {"ScreenshotName": "S1-12.E.1-3.png", "ScreenshotCaption": "Additional telemetry showing powershell.exe WMI queries for operating system information"}], "Footnotes": []}]}]}]}, {"Substep": "12.E.1.6.2", "Procedure": "Empire: WinEnum module included enumeration of Windows update information", "Techniques": [{"TechniqueId": "T1082", "TechniqueName": "System Information Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though the Interactive Shell was used to analyze the PowerShell execution and WinEnum Windows Last Updated was observed.[EG13]", "Modifiers": [], "Screenshots": [], "Footnotes": ["Interactive Shell was not by itself considered telemetry, but the analyst can retrieve additional Windows Logs to enhance baseline Endgame functionality. "]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of Windows update information.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[CT5]", "Modifiers": [], "Screenshots": [], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed invocation of the PowerShell cmdlet Get-HotFix.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-12.E.1-2.png", "ScreenshotCaption": "Telemetry of execution sequence showing Get-HotFix invocation"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}]}, {"Substep": "12.E.1.7", "Procedure": "Empire: WinEnum module included enumeration of system information via a Registry query", "Techniques": [{"TechniqueId": "T1012", "TechniqueName": "Query Registry", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry from decoded PowerShell (within the capability) showed the Get-Sysinfo function.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-12.E.1.6.1-1.png", "ScreenshotCaption": "Telemetry showing the Get-Sysinfo function"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though the Interactive Shell was used to analyze the PowerShell execution and WinEnum Get-SysInfo was observed.[EG13]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-12-E-05.png", "ScreenshotCaption": "Interactive Shell events showing the WinEnum script and the Get-SysInfo function (does not count as a detection due to manual process of pulling events)"}], "Footnotes": ["Interactive Shell was not by itself considered telemetry, but the analyst can retrieve additional Windows Logs to enhance baseline Endgame functionality. "]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of system information via a Registry query.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[CT5]", "Modifiers": [], "Screenshots": [], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the enumeration of system information via a Registry query as suspicious. The data was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-12.E.1.6-1.png", "ScreenshotCaption": "Indicator of Compromise alert identifying suspicious PowerShell strings as Empire SysInfo"}, {"ScreenshotName": "PA-12.E.1.7-1.png", "ScreenshotCaption": "Enrichment of the enumeration of system information via a Registry query as suspicious (tainted by a parent alert on wscript.exe)"}], "Footnotes": []}, {"DetectionType": "Indicator of Compromise", "DetectionNote": "An Indicator of Compromise alert was generated identifying suspicious PowerShell strings as Empire SysImfo.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-12.E.1.6-1.png", "ScreenshotCaption": "Indicator of Compromise alert identifying suspicious PowerShell strings as Empire SysInfo"}, {"ScreenshotName": "PA-12.E.1.7-1.png", "ScreenshotCaption": "Enrichment of the enumeration of system information via a Registry query as suspicious (tainted by a parent alert on wscript.exe)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}]}, {"Substep": "12.E.1.8", "Procedure": "Empire: WinEnum module included enumeration of services", "Techniques": [{"TechniqueId": "T1007", "TechniqueName": "System Service Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though the Interactive Shell was used to analyze the PowerShell execution and WinEnum Services was observed.[EG13]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-12-E-06.png", "ScreenshotCaption": "Interactive Shell events showing the WinEnum script and the Services function (does not count as a detection due to manual process of pulling events)"}], "Footnotes": ["Interactive Shell was not by itself considered telemetry, but the analyst can retrieve additional Windows Logs to enhance baseline Endgame functionality. "]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of services.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[CT5]", "Modifiers": [], "Screenshots": [], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed invocation of the PowerShell cmdlet Get-Service.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-12.E.1-2.png", "ScreenshotCaption": "Telemetry of execution sequence showing Get-Service invocation"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched powershell.exe executing with command-line arguments with the correct ATT&CK Technique (System Service Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-12.E.1.8-1.png", "ScreenshotCaption": "Enrichment of powershell.exe executing with command-line arguments with the correct ATT&CK Technique (System Service Discovery)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}]}, {"Substep": "12.E.1.9.1", "Procedure": "Empire: WinEnum module included enumeration of available shares", "Techniques": [{"TechniqueId": "T1135", "TechniqueName": "Network Share Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though the Interactive Shell was used to analyze the PowerShell execution and WinEnum Available Shares was observed.[EG13]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-12-E-06.png", "ScreenshotCaption": "Interactive Shell events showing the WinEnum script and the Available Shares function (does not count as a detection due to manual process of pulling events)"}], "Footnotes": ["Interactive Shell was not by itself considered telemetry, but the analyst can retrieve additional Windows Logs to enhance baseline Endgame functionality. "]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of available shares.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[CT5]", "Modifiers": [], "Screenshots": [], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched powershell.exe executing with command-line arguments with the correct ATT&CK Technique (Network Share Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-12.E.1.9-1.png", "ScreenshotCaption": "Enrichment of powershell.exe executing with command-line arguments with the correct ATT&CK Technique (Network Share Discovery)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}]}, {"Substep": "12.E.1.9.2", "Procedure": "Empire: WinEnum module included enumeration of mapped network drives", "Techniques": [{"TechniqueId": "T1135", "TechniqueName": "Network Share Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though the Interactive Shell was used to analyze the PowerShell execution and WinEnum Mapped Network Drives was observed.[EG13]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-12-E-07.png", "ScreenshotCaption": "Interactive Shell events showing the WinEnum script and the Mapped Network Drives function (does not count as a detection due to manual process of pulling events)"}], "Footnotes": ["Interactive Shell was not by itself considered telemetry, but the analyst can retrieve additional Windows Logs to enhance baseline Endgame functionality. "]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of mapped network drives.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[CT5]", "Modifiers": [], "Screenshots": [], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched powershell.exe executing with command-line arguments with the correct ATT&CK Technique (Network Share Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-12.E.1.9-1.png", "ScreenshotCaption": "Enrichment of powershell.exe executing with command-line arguments with the correct ATT&CK Technique (Network Share Discovery)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing WMI queries that indicated logical disk information was queried. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing WMI queries (tainted Group ID not shown but was the search parameter)"}, {"ScreenshotName": "S1-12.E.1-3.png", "ScreenshotCaption": "Additional telemetry showing powershell.exe WMI queries for logical disk information"}], "Footnotes": []}]}]}]}, {"Substep": "12.E.1.10.1", "Procedure": "Empire: WinEnum module included enumeration of AV solutions", "Techniques": [{"TechniqueId": "T1063", "TechniqueName": "Security Software Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though the Interactive Shell was used to analyze the PowerShell execution and WinEnum AV Solution was observed.[EG13]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-12-E-08.png", "ScreenshotCaption": "Interactive Shell events showing the WinEnum script and the AV Solution function (does not count as a detection due to manual process of pulling events)"}], "Footnotes": ["Interactive Shell was not by itself considered telemetry, but the analyst can retrieve additional Windows Logs to enhance baseline Endgame functionality. "]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of AV solutions.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[CT5]", "Modifiers": [], "Screenshots": [], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed an event log for the WMI query of the system AV products.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-12.E.1.10-2.png", "ScreenshotCaption": "Telemetry showing an event log for the WMI query of the system AV products"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched powershell.exe activity with the action \\\"attempted to find other installed security software.\\\" The enrichment was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-12.E.1-2.png", "ScreenshotCaption": "Enrichment of powershell.exe with action \\\"attempted to find other installed security software\\\" (tainted Group ID not shown but was the search parameter)"}, {"ScreenshotName": "S1-12.E.1-3.png", "ScreenshotCaption": "Telemetry showing powershell.exe WMI queries for antivirus product information (tainted by relationship to threat story)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing WMI queries that indicated antivirus product information was queried. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-12.E.1-2.png", "ScreenshotCaption": "Enrichment of powershell.exe with action \\\"attempted to find other installed security software\\\" (tainted Group ID not shown but was the search parameter)"}, {"ScreenshotName": "S1-12.E.1-3.png", "ScreenshotCaption": "Telemetry showing powershell.exe WMI queries for antivirus product information (tainted by relationship to threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "12.E.1.10.2", "Procedure": "Empire: WinEnum module included enumeration of firewall rules", "Techniques": [{"TechniqueId": "T1063", "TechniqueName": "Security Software Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though the Interactive Shell was used to analyze the PowerShell execution and WinEnum Firewall Rules was observed.[EG13]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-12-E-09.png", "ScreenshotCaption": "Interactive Shell events showing the WinEnum script and the Firewall Rules function (does not count as a detection due to manual process of pulling events)"}], "Footnotes": ["Interactive Shell was not by itself considered telemetry, but the analyst can retrieve additional Windows Logs to enhance baseline Endgame functionality. "]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of firewall rules.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[CT5]", "Modifiers": [], "Screenshots": [], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched powershell.exe executing with command-line arguments with the correct ATT&CK Technique (Security Software Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-12.E.1.10-1.png", "ScreenshotCaption": "Enrichment of powershell.exe executing with command-line arguments with the correct ATT&CK Technique (Security Software Discovery)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}]}, {"Substep": "12.E.1.11", "Procedure": "Empire: WinEnum module included enumeration of network adapters", "Techniques": [{"TechniqueId": "T1016", "TechniqueName": "System Network Configuration Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though the Interactive Shell was used to analyze the PowerShell execution and WinEnum Get-NetInfo-Network Adapters was observed.[EG13]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-12-E-10.png", "ScreenshotCaption": "Interactive Shell events showing the WinEnum script and the Network Adapters function (does not count as a detection due to manual process of pulling events)"}], "Footnotes": ["Interactive Shell was not by itself considered telemetry, but the analyst can retrieve additional Windows Logs to enhance baseline Endgame functionality. "]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched powershell.exe making a WMI query with a tag identifying the command as WMI enumerating adapters.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}, {"ScreenshotName": "CC-12.E.1-3.png", "ScreenshotCaption": "Enrichment of powershell.exe making a WMI query with a tag identifying the command as WMI enumerating adapters"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of network adapters.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}, {"ScreenshotName": "CC-12.E.1-3.png", "ScreenshotCaption": "Enrichment of powershell.exe making a WMI query with a tag identifying the command as WMI enumerating adapters"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[CT5]", "Modifiers": [], "Screenshots": [], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed invocation of the PowerShell cmdlet Get-NetInfo.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-12.E.1-2.png", "ScreenshotCaption": "Telemetry of execution sequence showing Get-NetInfo invocation"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Indicator of Compromise", "DetectionNote": "An Indicator of Compromise alert was generated identifying suspicious PowerShell strings as Empire NetInfo.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-12.E.1.11-1.png", "ScreenshotCaption": "Indicator of Compromise alert identifying suspicious PowerShell strings as Empire NetInfo"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing WMI queries that indicated network adapter and configuration information was queried. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing WMI queries (tainted Group ID not shown but was the search parameter)"}, {"ScreenshotName": "S1-12.E.1-3.png", "ScreenshotCaption": "Additional telemetry showing powershell.exe WMI queries for network adapter and configuration information"}], "Footnotes": []}]}]}]}, {"Substep": "12.E.1.12", "Procedure": "Empire: WinEnum module included enumeration of established network connections", "Techniques": [{"TechniqueId": "T1049", "TechniqueName": "System Network Connections Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched netstat.exe with the correct ATT&CK Technique (System Network Connections Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-12.E.1.12-2.png", "ScreenshotCaption": "Telemetry from process tree showing netstat.exe with command-line arguments"}, {"ScreenshotName": "CB-12.E.1.12-1.png", "ScreenshotCaption": "Enrichment of netstat.exe with correct ATT&CK Technique (System Network Connections Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed netstat.exe executing with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-12.E.1.12-2.png", "ScreenshotCaption": "Telemetry from process tree showing netstat.exe with command-line arguments"}, {"ScreenshotName": "CB-12.E.1.12-1.png", "ScreenshotCaption": "Enrichment of netstat.exe with correct ATT&CK Technique (System Network Connections Discovery)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing netstat.exe with command-line arguments. The process tree view showed netstat.exe as tainted by a previous powershell.exe detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-12.E.12-2.png", "ScreenshotCaption": "Telemetry from process tree showing netstat.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched netstat.exe executing as Reconnaissance and the correct ATT&CK Technique (System Network Connections Discovery). The data was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-12.E.1.12-1.png", "ScreenshotCaption": "Enriched alert for netstat.exe labeled with Reconnaissance and the correct ATT&CK Technique (System Network Connections Discovery)\u00a0(tainted by a parent PowerShell alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed netstat.exe executing with command-line arguments. [CR5]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-12.E.1.12-1.png", "ScreenshotCaption": "Enriched alert for netstat.exe labeled with Reconnaissance and the correct ATT&CK Technique (System Network Connections Discovery)\u00a0(tainted by a parent PowerShell alert)"}], "Footnotes": [" The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched netstat.exe with the correct ATT&CK Technique (T1049 - System Network Connections Discovery) and Tactic (Discovery).\u00a0The enrichment was tainted by parent PowerShell alerts. [EG11]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-12-3.png", "ScreenshotCaption": "Event tree showing telemetry of netstat subprocess associated with WinEnum (tainted by parent PowerShell alerts)"}, {"ScreenshotName": "EG-12-E-10.png", "ScreenshotCaption": "Interactive Shell events showing the WinEnum script and the Netstat Established Connections and Processes function (does not count as a detection due to manual process of pulling events)"}, {"ScreenshotName": "EG-12-7.png", "ScreenshotCaption": "Enriched event tree showing enrichment of netstat.exe with correct ATT&CK Technique (T1049 - System Network Connections Discovery) and Tactic (Discovery)\u00a0(tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}, {"DetectionType": "Telemetry", "DetectionNote": "An event tree from the suspicious PowerShell process showed a netstat subprocess that was created by WinEnum (tainted by parent PowerShell alerts). Though it does not count as part of the detection, the Interactive Shell could also be used to analyze the PowerShell execution and WinEnum Get-NetInfo-Network Adapters was observed.[EG13][EG11]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-12-3.png", "ScreenshotCaption": "Event tree showing telemetry of netstat subprocess associated with WinEnum (tainted by parent PowerShell alerts)"}, {"ScreenshotName": "EG-12-E-10.png", "ScreenshotCaption": "Interactive Shell events showing the WinEnum script and the Netstat Established Connections and Processes function (does not count as a detection due to manual process of pulling events)"}, {"ScreenshotName": "EG-12-7.png", "ScreenshotCaption": "Enriched event tree showing enrichment of netstat.exe with correct ATT&CK Technique (T1049 - System Network Connections Discovery) and Tactic (Discovery)\u00a0(tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": ["Interactive Shell was not by itself considered telemetry, but the analyst can retrieve additional Windows Logs to enhance baseline Endgame functionality. ", " Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of established network connections.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified netstat.exe as a reconnaissance command used. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-12.E.1.12-1.png", "ScreenshotCaption": "Enrichment of netstat.exe with Netstat Execution alert (tagged with correct ATT&CK Technique, T1049 - System Network Connections Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating netstat.exe was a reconnaissance command used (General Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched netstat.exe with an alert for Netstat Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1049 - System Network Connection Discovery) and Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-12.E.1.12-1.png", "ScreenshotCaption": "Enrichment of netstat.exe with Netstat Execution alert (tagged with correct ATT&CK Technique, T1049 - System Network Connections Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating netstat.exe was a reconnaissance command used (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[CT5]", "Modifiers": [], "Screenshots": [], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing netstat.exe. The telemetry was tainted by a trace detection on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-12.F.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing netstat.exe (tainted by a parent alert on wscript.exe)"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A delayed General Behavior alert was generated for \"Suspicious sequence of exploration activities\".", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "MS-12.E.1-2.png", "ScreenshotCaption": "Telemetry of execution sequence showing Get-NetInfo invocation"}, {"ScreenshotName": "MS-12.E.1-4.png", "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process"}, {"ScreenshotName": "MS-12.E.1-1.png", "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing netstat.exe with command-line arguments"}, {"ScreenshotName": "MS-12.E.1-3.png", "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing netstat.exe with command-line arguments"}], "Footnotes": ["Alert is based on the correlation of a chain of related behaviors across multiple steps."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed invocation of the PowerShell cmdlet Get-NetInfo and subsequent execution of netstat.exe with command-line arguments from powershell.exe. The telemetry was tainted by a prior suspicious PowerShell cmdlet alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-12.E.1-2.png", "ScreenshotCaption": "Telemetry of execution sequence showing Get-NetInfo invocation"}, {"ScreenshotName": "MS-12.E.1-4.png", "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process"}, {"ScreenshotName": "MS-12.E.1-1.png", "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing netstat.exe with command-line arguments"}, {"ScreenshotName": "MS-12.E.1-3.png", "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing netstat.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched powershell.exe executing with command-line arguments with the correct ATT&CK Technique (System Network Connections Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-12.E.1.12-1.png", "ScreenshotCaption": "Enrichment of powershell.exe executing with command-line arguments with the correct ATT&CK Technique (System Network Connections Discovery)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing netstat.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-12-3.png", "ScreenshotCaption": "Telemetry showing netstat.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing netstat.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-12.E.1-1.png", "ScreenshotCaption": "Telemetry showing netstat.exe with command-line arguments (tainted Group ID not shown but was the search parameter)"}], "Footnotes": []}]}]}]}, {"Substep": "12.F.1", "Procedure": "Empire: 'net group \"Domain Admins\" -domain' via PowerShell", "Techniques": [{"TechniqueId": "T1069", "TechniqueName": "Permission Groups Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with the correct ATT&CK Technique (T1069 - Permission Groups Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-12.F.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-12.F.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with correct ATT&CK Technique (T1069 - Permission Groups Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed powershell.exe executing net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-12.F.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-12.F.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with correct ATT&CK Technique (T1069 - Permission Groups Discovery)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team sent an email indicating a General Behavior was observed because net group was part of additional malicious discovery performed.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-12.F.1-3.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-12.F.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery) (tainted from previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-8.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating net group was part of additional malicious discovery activity (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with a related ATT&CK Technique (Account Discovery) and the correct Tactic (Discovery). The process tree view showed net.exe as tainted by a previous powershell.exe detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-12.F.1-3.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-12.F.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery) (tainted from previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-8.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating net group was part of additional malicious discovery activity (General Behavior)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments. The process tree view showed net.exe as tainted by a previous powershell.exe detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-12.F.1-3.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-12.F.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery) (tainted from previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-8.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating net group was part of additional malicious discovery activity (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was also tagged with the correct ATT&CK Tactic (Discovery) and Technique (Permission Groups Discovery). The alert was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-12.F.1-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)"}, {"ScreenshotName": "CR-12.F.1-1.png", "ScreenshotCaption": "Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed net.exe executing with command-line arguments. [CR3]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-12.F.1-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)"}, {"ScreenshotName": "CR-12.F.1-1.png", "ScreenshotCaption": "Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}], "Footnotes": [" For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "An alert for Enumeration of Administrator Account provided enrichment to the net group command (tainted by parent PowerShell alerts). The alert was also tagged with the correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-12-7.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery) (tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry)"}, {"ScreenshotName": "EG-12-5.png", "ScreenshotCaption": "Enrichment on net group by Enumeration of Administrator Accounts alert (mapped to correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic (Discovery)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with the correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery). The enrichment was tainted by parent PowerShell alerts. [EG11]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-12-7.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery) (tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry)"}, {"ScreenshotName": "EG-12-5.png", "ScreenshotCaption": "Enrichment on net group by Enumeration of Administrator Accounts alert (mapped to correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic (Discovery)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed net.exe executing with command-line arguments (tainted by parent PowerShell alerts). [EG11]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-12-7.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery) (tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry)"}, {"ScreenshotName": "EG-12-5.png", "ScreenshotCaption": "Enrichment on net group by Enumeration of Administrator Accounts alert (mapped to correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic (Discovery)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (net.exe) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.F.1-T1069-new.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}, {"ScreenshotName": "CC-12.F.1-3.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.F.1-T1069-new.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}, {"ScreenshotName": "CC-12.F.1-3.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified net.exe as a reconnaissance command used. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)"}, {"ScreenshotName": "FE-12.F.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with an alert for Net Group Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)"}, {"ScreenshotName": "FE-12.F.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability showed powershell.exe executing net.exe with command-line arguments and enriched the command with the\u00a0conditions Net Domain Admins Reconnaissance Command and Net Group Reconnaissance Command. The enrichment was tainted by the parent Script File Created alert.[CT16]", "Modifiers": ["Configuration Change", "Tainted"], "Screenshots": [{"ScreenshotName": "CT-12.F.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with conditions Net Domain Admins Reconnaissance Command and Net Group Reconnaissance Command (tainted by the parent Script File Created alert)"}], "Footnotes": ["The condition contributing to Enrichment was added to the capability's detection after the start of the evaluation, so the detection is identified as a configuration change. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with the correct ATT&CK Tactic (Discovery) and Technique (Permissions Group Discovery) and a suspicious indicator that the net utility was used to obtain information of domain admins.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-12.F.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "MC-12.F.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (Permissions Group Discovery) and a suspicious indicator that the net utility was used to obtain information of domain admins"}, {"ScreenshotName": "MC-12.F.1-99.png", "ScreenshotCaption": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (Permissions Group Discovery) and a suspicious indicator that the net utility was used to obtain information of user groups"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with the correct ATT&CK Tactic (Discovery) and Technique (Permissions Group Discovery) and a suspicious indicator that the net utility was used to obtain information of user groups.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-12.F.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "MC-12.F.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (Permissions Group Discovery) and a suspicious indicator that the net utility was used to obtain information of domain admins"}, {"ScreenshotName": "MC-12.F.1-99.png", "ScreenshotCaption": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (Permissions Group Discovery) and a suspicious indicator that the net utility was used to obtain information of user groups"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net.exe. The telemetry was tainted by a trace detection on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-12.F.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "MC-12.F.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (Permissions Group Discovery) and a suspicious indicator that the net utility was used to obtain information of domain admins"}, {"ScreenshotName": "MC-12.F.1-99.png", "ScreenshotCaption": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (Permissions Group Discovery) and a suspicious indicator that the net utility was used to obtain information of user groups"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A delayed General Behavior alert was generated for \"Suspicious sequence of exploration activities\".", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "MS-12.F.1-1.png", "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"}, {"ScreenshotName": "MS-12.E.1-4.png", "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"}, {"ScreenshotName": "MS-12.F.1-2.png", "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"}], "Footnotes": ["Alert is based on the correlation of a chain of related behaviors across multiple steps."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence for powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by a prior suspicious PowerShell cmdlet alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-12.F.1-1.png", "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"}, {"ScreenshotName": "MS-12.E.1-4.png", "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"}, {"ScreenshotName": "MS-12.F.1-2.png", "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe executing with command-line arguments with the correct ATT&CK Technique (Permission Groups Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-12.F.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.F.1-2.png", "ScreenshotCaption": "Enrichment of the execution of net.exe and net1.exe as the possible enumeration of administrator groups (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.F.1-3.png", "ScreenshotCaption": "Enrichment of the execution of net.exe and net1.exe as an enumeration command (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.F.1-4.png", "ScreenshotCaption": "Enrichment of net.exe executing with command-line arguments with the correct ATT&CK Technique (Permission Groups Discovery)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the execution of net.exe and net1.exe as an enumeration command. The data was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-12.F.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.F.1-2.png", "ScreenshotCaption": "Enrichment of the execution of net.exe and net1.exe as the possible enumeration of administrator groups (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.F.1-3.png", "ScreenshotCaption": "Enrichment of the execution of net.exe and net1.exe as an enumeration command (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.F.1-4.png", "ScreenshotCaption": "Enrichment of net.exe executing with command-line arguments with the correct ATT&CK Technique (Permission Groups Discovery)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the execution of net.exe and net1.exe as the possible enumeration of administrator groups. The data was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-12.F.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.F.1-2.png", "ScreenshotCaption": "Enrichment of the execution of net.exe and net1.exe as the possible enumeration of administrator groups (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.F.1-3.png", "ScreenshotCaption": "Enrichment of the execution of net.exe and net1.exe as an enumeration command (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.F.1-4.png", "ScreenshotCaption": "Enrichment of net.exe executing with command-line arguments with the correct ATT&CK Technique (Permission Groups Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-12.F.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.F.1-2.png", "ScreenshotCaption": "Enrichment of the execution of net.exe and net1.exe as the possible enumeration of administrator groups (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.F.1-3.png", "ScreenshotCaption": "Enrichment of the execution of net.exe and net1.exe as an enumeration command (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.F.1-4.png", "ScreenshotCaption": "Enrichment of net.exe executing with command-line arguments with the correct ATT&CK Technique (Permission Groups Discovery)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-12-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-12.F.1-3.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted Group ID not shown but was the search parameter)"}], "Footnotes": []}]}]}]}, {"Substep": "12.F.2", "Procedure": "Empire: 'net\u00ef\u00bf\u00bdlocalgroup\u00ef\u00bf\u00bdadministrators' via PowerShell", "Techniques": [{"TechniqueId": "T1069", "TechniqueName": "Permission Groups Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with the correct ATT&CK Technique (T1069 - Permission Groups Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-12.F.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with correct ATT&CK Technique (T1069 - Permission Groups Discovery)"}, {"ScreenshotName": "CB-12.F.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed powershell.exe executing net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-12.F.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with correct ATT&CK Technique (T1069 - Permission Groups Discovery)"}, {"ScreenshotName": "CB-12.F.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team sent an email indicating a General Behavior was observed because net localgroup was part of additional malicious discovery performed.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-12.F.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-8.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating net localgroup was part of additional malicious discovery activity (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments. The process tree view showed net.exe as tainted by a previous powershell.exe detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-12.F.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-8.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating net localgroup was part of additional malicious discovery activity (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was also tagged with the correct ATT&CK Tactic (Discovery) and Technique (Permission Groups Discovery). The alert was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-12.F.2-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)"}, {"ScreenshotName": "CR-12.F.2-1.png", "ScreenshotCaption": "Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed net.exe executing with command-line arguments. [CR3]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-12.F.2-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)"}, {"ScreenshotName": "CR-12.F.2-1.png", "ScreenshotCaption": "Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}], "Footnotes": [" For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "An alert for Enumeration of Administrator Account provided enrichment to the net group command (tainted by parent PowerShell alerts).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-12-7.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery) (tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry). The tree also shows Enumeration of Administrator Accounts alert."}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with the correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery). The enrichment was tainted by parent PowerShell alerts. [EG11]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-12-7.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery) (tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry). The tree also shows Enumeration of Administrator Accounts alert."}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed net.exe executing with command-line arguments (tainted by parent PowerShell alerts). [EG11]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-12-7.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery) (tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry). The tree also shows Enumeration of Administrator Accounts alert."}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (net1.exe) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.F.1-3.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}, {"ScreenshotName": "CC-12.F.2-T1069-new.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.F.1-3.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}, {"ScreenshotName": "CC-12.F.2-T1069-new.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified net.exe as a reconnaissance command used. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)"}, {"ScreenshotName": "FE-12.F.2-1.png", "ScreenshotCaption": "Enrichment of net.exe with command-line arguments (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with an alert for Net Group Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)"}, {"ScreenshotName": "FE-12.F.2-1.png", "ScreenshotCaption": "Enrichment of net.exe with command-line arguments (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability showed powershell.exe executing net.exe with command-line arguments and enriched the command with the\u00a0conditions Net Group Reconnaissance Command and Net LocalGroup Reconnaissance Command. The enrichment was tainted by the parent Script File Created alert.[CT16]", "Modifiers": ["Configuration Change", "Tainted"], "Screenshots": [{"ScreenshotName": "CT-12.F.2-1.png", "ScreenshotCaption": "Enrichment of net.exe with conditions Net Group Reconnaissance Command and Net LocalGroup Reconnaissance Command (tainted by the parent Script File Created alert)"}], "Footnotes": ["The condition contributing to Enrichment was added to the capability's detection after the start of the evaluation, so the detection is identified as a configuration change. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with the correct ATT&CK Tactic (Discovery) and Technique (Permissions Group Discovery) and a suspicious indicator that the net utility was used to obtain information of user groups.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-12.F.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "MC-12.F.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (Permissions Group Discovery) and a suspicious indicator that the net utility was used to obtain information of user groups"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net.exe. The telemetry was tainted by a trace detection on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-12.F.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "MC-12.F.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (Permissions Group Discovery) and a suspicious indicator that the net utility was used to obtain information of user groups"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A delayed General Behavior alert was generated for \"Suspicious sequence of exploration activities\".", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "MS-12.E.1-4.png", "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"}, {"ScreenshotName": "MS-12.F.2-1.png", "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"}, {"ScreenshotName": "MS-12.F.2-2.png", "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"}], "Footnotes": ["Alert is based on the correlation of a chain of related behaviors across multiple steps."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence for powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by a prior suspicious PowerShell cmdlet alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-12.E.1-4.png", "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"}, {"ScreenshotName": "MS-12.F.2-1.png", "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"}, {"ScreenshotName": "MS-12.F.2-2.png", "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe executing with command-line arguments with the correct ATT&CK Technique (Permission Groups Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-12.F.2-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.F.2-2.png", "ScreenshotCaption": "Enrichment of the execution of net.exe and net1.exe as the possible enumeration of administrator groups (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.F.2-3.png", "ScreenshotCaption": "Enrichment of net.exe executing with command-line arguments with the correct ATT&CK Technique (Permission Groups Discovery)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the execution of net.exe and net1.exe as the possible enumeration of administrator groups. The data was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-12.F.2-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.F.2-2.png", "ScreenshotCaption": "Enrichment of the execution of net.exe and net1.exe as the possible enumeration of administrator groups (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.F.2-3.png", "ScreenshotCaption": "Enrichment of net.exe executing with command-line arguments with the correct ATT&CK Technique (Permission Groups Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-12.F.2-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.F.2-2.png", "ScreenshotCaption": "Enrichment of the execution of net.exe and net1.exe as the possible enumeration of administrator groups (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.F.2-3.png", "ScreenshotCaption": "Enrichment of net.exe executing with command-line arguments with the correct ATT&CK Technique (Permission Groups Discovery)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-12-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-12.F.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "12.G.1", "Procedure": "Empire: 'net user' via PowerShell", "Techniques": [{"TechniqueId": "T1087", "TechniqueName": "Account Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with a related ATT&CK Technique (T1069 - Permission Groups Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-12.G.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-12.F.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK Technique (T1069 - Permission Groups Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed powershell.exe executing net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-12.G.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-12.F.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK Technique (T1069 - Permission Groups Discovery)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team sent an email indicating a General Behavior was observed because net user was part of additional malicious discovery performed.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-12.G.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-8.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating net user was part of additional malicious discovery activity (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments. The process tree view showed net.exe as tainted by a previous powershell.exe detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-12.G.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-8.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating net user was part of additional malicious discovery activity (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was also tagged with the correct ATT&CK Tactic (Discovery) and Technique (Account Discovery). The alert was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-12.G.1-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Account Discovery) and Technique (Discovery)"}, {"ScreenshotName": "CR-12.G.1-1.png", "ScreenshotCaption": "Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed net.exe executing with command-line arguments. [CR3]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-12.G.1-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Account Discovery) and Technique (Discovery)"}, {"ScreenshotName": "CR-12.G.1-1.png", "ScreenshotCaption": "Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}], "Footnotes": [" For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the event with the correct ATT&CK Technique (T1087 - Account Discovery) and Tactic (Discovery). The enrichment was tainted by parent PowerShell alerts. [EG11]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-12-6.png", "ScreenshotCaption": "Telemetry from event tree showing net.exe with command-line arguments (tainted by parent PowerShell alert)"}, {"ScreenshotName": "EG-12-7.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1087 - Account Discovery) and Tactic (Discovery) (tainted by parent PowerShell alerts)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed net.exe executing with command-line arguments (tainted by parent PowerShell alerts). [EG11]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-12-6.png", "ScreenshotCaption": "Telemetry from event tree showing net.exe with command-line arguments (tainted by parent PowerShell alert)"}, {"ScreenshotName": "EG-12-7.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1087 - Account Discovery) and Tactic (Discovery) (tainted by parent PowerShell alerts)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (net.exe) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.F.1-3.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}, {"ScreenshotName": "CC-12.G.1-T1087-new.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.F.1-3.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}, {"ScreenshotName": "CC-12.G.1-T1087-new.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified net.exe as a reconnaissance command used to capture information about local users.[FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-12.G.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net User Command Execution alert (tagged with correct ATT&CK Technique, T1087 - Account Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used to capture information about local users (General Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with an alert for Net User Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1087 - Account Discovery) and Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-12.G.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net User Command Execution alert (tagged with correct ATT&CK Technique, T1087 - Account Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used to capture information about local users (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability showed powershell.exe executing net.exe with command-line arguments and enriched the command with the\u00a0condition Net User Reconnaissance Command. The enrichment was tainted by the parent Script File Created alert.[CT5]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-12.G.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with condition Net User Reconnaissance Command (tainted by the parent Script File Created alert)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (System Owner/User Discovery) and a suspicious indicator that the net utility was used to obtain information of user groups.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-12.F.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "MC-12.F.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (System Owner/User Discovery) and a suspicious indicator that the net utility was used to obtain information of user groups"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net.exe. The telemetry was tainted by a trace detection on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-12.F.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "MC-12.F.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (System Owner/User Discovery) and a suspicious indicator that the net utility was used to obtain information of user groups"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A delayed General Behavior alert was generated for \"Suspicious sequence of exploration activities\".", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "MS-12.E.1-4.png", "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"}, {"ScreenshotName": "MS-12.G.1-1.png", "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"}, {"ScreenshotName": "MS-12.G.1-2.png", "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"}], "Footnotes": ["Alert is based on the correlation of a chain of related behaviors across multiple steps."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence for powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by a prior suspicious PowerShell cmdlet alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-12.E.1-4.png", "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"}, {"ScreenshotName": "MS-12.G.1-1.png", "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"}, {"ScreenshotName": "MS-12.G.1-2.png", "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe executing with command-line arguments with the correct ATT&CK Technique (Account Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-12.G.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.G.1-2.png", "ScreenshotCaption": "Enrichment of net.exe executing with command-line arguments with the correct ATT&CK Technique (Account Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-12.G.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.G.1-2.png", "ScreenshotCaption": "Enrichment of net.exe executing with command-line arguments with the correct ATT&CK Technique (Account Discovery)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-12-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-12.F.1-3.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted Group ID not shown but was the search parameter)"}, {"ScreenshotName": "S1-12.F.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)"}, {"ScreenshotName": "S1-12.F.1-2.png", "ScreenshotCaption": "Continued threat story showing related processes"}], "Footnotes": []}]}]}]}, {"Substep": "12.G.2", "Procedure": "Empire: 'net user -domain' via PowerShell", "Techniques": [{"TechniqueId": "T1087", "TechniqueName": "Account Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with a related ATT&CK Technique (T1069 - Permission Groups Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-12.F.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK Technique (T1069 - Permission Groups Discovery)"}, {"ScreenshotName": "CB-12.G.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed powershell.exe executing net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-12.F.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK Technique (T1069 - Permission Groups Discovery)"}, {"ScreenshotName": "CB-12.G.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team sent an email indicating a General Behavior was observed because net user was part of additional malicious discovery performed.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-E-8.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating net user was part of additional malicious discovery activity (General Behavior)"}, {"ScreenshotName": "CS-12.G.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments. The process tree view showed net.exe as tainted by a previous powershell.exe detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-E-8.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating net user was part of additional malicious discovery activity (General Behavior)"}, {"ScreenshotName": "CS-12.G.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was also tagged with the correct ATT&CK Tactic (Discovery) and Technique (Account Discovery). The alert was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-12.G.1-1.png", "ScreenshotCaption": "Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-12.G.2-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Account Discovery) and Technique (Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed net.exe executing with command-line arguments. [CR3]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-12.G.1-1.png", "ScreenshotCaption": "Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-12.G.2-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Account Discovery) and Technique (Discovery)"}], "Footnotes": [" For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the event with the correct ATT&CK Technique (T1087 - Account Discovery) and Tactic (Discovery). The enrichment was tainted by parent PowerShell alerts.[EG11]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-12-7.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1087 - Account Discovery) and Tactic (Discovery) (tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed net.exe executing with command-line arguments (tainted by parent PowerShell alerts). [EG11]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-12-7.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1087 - Account Discovery) and Tactic (Discovery) (tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (net.exe) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.F.1-3.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}, {"ScreenshotName": "CC-12.G.2-T1087-new.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.F.1-3.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}, {"ScreenshotName": "CC-12.G.2-T1087-new.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified net.exe as a reconnaissance command used.[FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)"}, {"ScreenshotName": "FE-12.G.2-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net User Command Execution alert (tagged with correct ATT&CK Technique, T1087 - Account Discovery, and Tactic, Discovery)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with an alert for Net User Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1087 - Account Discovery) and Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)"}, {"ScreenshotName": "FE-12.G.2-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net User Command Execution alert (tagged with correct ATT&CK Technique, T1087 - Account Discovery, and Tactic, Discovery)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability showed powershell.exe executing net.exe with command-line arguments and enriched the command with the\u00a0condition Net User Reconnaissance Command. The enrichment was tainted by the parent Script File Created alert.[CT5]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-12.G.2-1.png", "ScreenshotCaption": "Enrichment of net.exe with condition Net User Reconnaissance Command (tainted by the parent Script File Created alert)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with the correct ATT&CK Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-12.F.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "MC-12.F.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery)."}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net.exe. The telemetry was tainted by a trace detection on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-12.F.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "MC-12.F.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery)."}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A delayed Specific Behavior alert called \"Reconnaissance using directory services queries\" was generated for domain user enumeration.", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "MS-12.E.1-4.png", "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"}, {"ScreenshotName": "MS-12.G.2-1.png", "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"}, {"ScreenshotName": "MS-12.G.2-3.png", "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"}, {"ScreenshotName": "MS-12.G.2-2.png", "ScreenshotCaption": "Specific Behavior alert showing domain user enumeration from Bob on CodeRed against Domain Controller on Creeper"}], "Footnotes": ["The vendor noted this was an Azure Advanced Threat Protection alert."]}, {"DetectionType": "General Behavior", "DetectionNote": "A delayed General Behavior alert was generated for \"Suspicious sequence of exploration activities\".", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "MS-12.E.1-4.png", "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"}, {"ScreenshotName": "MS-12.G.2-1.png", "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"}, {"ScreenshotName": "MS-12.G.2-3.png", "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"}, {"ScreenshotName": "MS-12.G.2-2.png", "ScreenshotCaption": "Specific Behavior alert showing domain user enumeration from Bob on CodeRed against Domain Controller on Creeper"}], "Footnotes": ["Alert is based on the correlation of a chain of related behaviors across multiple steps."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution sequence for powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by a prior suspicious PowerShell cmdlet alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-12.E.1-4.png", "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"}, {"ScreenshotName": "MS-12.G.2-1.png", "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"}, {"ScreenshotName": "MS-12.G.2-3.png", "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"}, {"ScreenshotName": "MS-12.G.2-2.png", "ScreenshotCaption": "Specific Behavior alert showing domain user enumeration from Bob on CodeRed against Domain Controller on Creeper"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe executing with command-line arguments with the correct ATT&CK Technique (Account Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-12.G.2-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.G.2-2.png", "ScreenshotCaption": "Enrichment of net.exe executing with command-line arguments with the correct ATT&CK Technique (Account Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-12.G.2-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-12.G.2-2.png", "ScreenshotCaption": "Enrichment of net.exe executing with command-line arguments with the correct ATT&CK Technique (Account Discovery)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-12-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-12.F.1-3.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted Group ID not shown but was the search parameter)"}, {"ScreenshotName": "S1-12.F.1-1.png", "ScreenshotCaption": "Threat story showing initial compromise alert and powershell.exe\u00a0tainting net.exe"}, {"ScreenshotName": "S1-12.F.1-2.png", "ScreenshotCaption": "Continued threat story showing initial compromise alert and powershell.exe\u00a0tainting net.exe"}], "Footnotes": []}]}]}]}, {"Substep": "13.A.1", "Procedure": "Empire: 'net group \"Domain Computers\" -domain' via PowerShell", "Techniques": [{"TechniqueId": "T1018", "TechniqueName": "Remote System Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with a related ATT&CK Technique (Account Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-13.A.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with net.exe and command-line arguments"}, {"ScreenshotName": "CB-13.A.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a process tree containing net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-13.A.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with net.exe and command-line arguments"}, {"ScreenshotName": "CB-13.A.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team sent an email indicating a General Behavior was observed because net group was part of additional malicious discovery performed.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-E-8.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating net group was part of additional malicious discovery activity (General Behavior)"}, {"ScreenshotName": "CS-13.A.1-2.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-13.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery) (tainted by previous powershell.exe detection by red line indicating high severity)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with a related ATT&CK Technique (Account Discovery) and the correct Tactic (Discovery). The process tree view showed the enrichment was tainted by a previous powershell.exe detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-E-8.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating net group was part of additional malicious discovery activity (General Behavior)"}, {"ScreenshotName": "CS-13.A.1-2.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-13.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery) (tainted by previous powershell.exe detection by red line indicating high severity)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed net.exe executing with command-line arguments. The process tree view showed net.exe as tainted by a previous powershell.exe detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-E-8.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating net group was part of additional malicious discovery activity (General Behavior)"}, {"ScreenshotName": "CS-13.A.1-2.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-13.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery) (tainted by previous powershell.exe detection by red line indicating high severity)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was also tagged with the correct ATT&CK Tactic (Discovery) and Technique (Remote System Discovery). The alert was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-13.A.1-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Remote System Discovery) and Technique (Discovery)"}, {"ScreenshotName": "CR-13.A.1-10.png", "ScreenshotCaption": "Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed net.exe executing with command-line arguments. [CR3]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-13.A.1-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Remote System Discovery) and Technique (Discovery)"}, {"ScreenshotName": "CR-13.A.1-10.png", "ScreenshotCaption": "Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}], "Footnotes": [" For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with a related ATT&CK Technique (T1069 - Permission Groups Discovery) and the correct Tactic (Discovery). The enrichment was tainted by a parent alert. [EG11]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-13-2.png", "ScreenshotCaption": "Telemetry from event tree showing with net.exe with command-line arguments (tainted by parent alert)"}, {"ScreenshotName": "EG-13-3.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1069 - Permission Groups Discovery) and correct Tactic (Discovery) (tainted by parent alert)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed net.exe executing with command-line arguments (tainted by parent alert). [EG11]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-13-2.png", "ScreenshotCaption": "Telemetry from event tree showing with net.exe with command-line arguments (tainted by parent alert)"}, {"ScreenshotName": "EG-13-3.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1069 - Permission Groups Discovery) and correct Tactic (Discovery) (tainted by parent alert)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.F.1-3.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}, {"ScreenshotName": "CC-13.A.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.F.1-3.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}, {"ScreenshotName": "CC-13.A.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified net.exe as a reconnaissance command used. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)"}, {"ScreenshotName": "FE-13.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1018 -Remote System Discovery, and Tactic, Discovery)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with an alert for Net Group Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1018 - Remote System Discovery) and Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)"}, {"ScreenshotName": "FE-13.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1018 -Remote System Discovery, and Tactic, Discovery)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability showed powershell.exe executing net.exe with command-line arguments and enriched the command with the\u00a0condition Net User Reconnaissance Command. The enrichment was tainted by the parent Script File Created alert.[CT17]", "Modifiers": ["Configuration Change", "Tainted"], "Screenshots": [{"ScreenshotName": "CT-13.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with condition Net Group Reconnaissance Command (tainted by the parent Script File Created alert)"}], "Footnotes": ["The condition contributing to Enrichment was added to the capability's detection after the start of the evaluation, so the detection is identified as a configuration change. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with the correct ATT&CK Tactic (Discovery) and Technique (Remote System Discovery) and a suspicious indicator that the net utility obtained information of domain computers and controllers.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-13.A.1-1.png", "ScreenshotCaption": "Telemetry showed powershell.exe executing net.exe (tainted by parent alert on wscript.exe)"}, {"ScreenshotName": "MC-13.A.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (Remote System Discovery) and a suspicious indicator that the net utility obtained information of domain computers and controllers"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net.exe. The telemetry was tainted by a trace detection on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-13.A.1-1.png", "ScreenshotCaption": "Telemetry showed powershell.exe executing net.exe (tainted by parent alert on wscript.exe)"}, {"ScreenshotName": "MC-13.A.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (Remote System Discovery) and a suspicious indicator that the net utility obtained information of domain computers and controllers"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A delayed General Behavior alert was generated for \"Suspicious sequence of exploration activities\".", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "MS-13.A.1-1.png", "ScreenshotCaption": "Telemetry showing execution of net.exe with command-line arguments"}, {"ScreenshotName": "MS-13.A.1-3.png", "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"}, {"ScreenshotName": "MS-13.A.1-2.png", "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"}], "Footnotes": ["Alert is based on the correlation of a chain of related behaviors across multiple steps."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of net.exe with command-line arguments (tainted by parent PowerShell malicious cmdlet alert).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-13.A.1-1.png", "ScreenshotCaption": "Telemetry showing execution of net.exe with command-line arguments"}, {"ScreenshotName": "MS-13.A.1-3.png", "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"}, {"ScreenshotName": "MS-13.A.1-2.png", "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the execution of net.exe and net1.exe as an enumeration command. The data was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-13.A.1-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-13.A.1-1.png", "ScreenshotCaption": "Enrichment of the execution of net.exe and net1.exe as an enumeration command (tainted by a parent alert on wscript.exe)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-13.A.1-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-13.A.1-1.png", "ScreenshotCaption": "Enrichment of the execution of net.exe and net1.exe as an enumeration command (tainted by a parent alert on wscript.exe)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-13-1.png", "ScreenshotCaption": "Telemetry showing execution of net.exe and command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of net.exe with command-line arguments. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-13.A.1-1.png", "ScreenshotCaption": "Telemetry showing execution of net.exe and command-line arguments (tainted Group ID not shown but was the search parameter)"}], "Footnotes": []}]}]}]}, {"Substep": "13.B.1", "Procedure": "Empire: 'net use' via PowerShell", "Techniques": [{"TechniqueId": "T1049", "TechniqueName": "System Network Connections Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with a related ATT&CK Technique (Account Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-13.A.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "The vendor demonstrated to MITRE that the capability can provide telemetry of net.exe, but no screenshot was captured for this procedure.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-13.A.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team sent an email indicating a General Behavior was observed because net use was part of additional malicious discovery performed.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-13.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-8.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating net use was part of additional malicious discovery activity (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed net.exe executing with command-line arguments. The process tree view showed net.exe as tainted by a previous powershell.exe detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-13.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-8.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating net use was part of additional malicious discovery activity (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was also tagged with the correct ATT&CK Tactic (Discovery) and Technique (System Network Connections Discovery). The alert was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-13.B.1-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (System Network Connections Discovery) and Technique (Discovery)"}, {"ScreenshotName": "CR-13.B.1-10.png", "ScreenshotCaption": "Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed net.exe executing with command-line arguments. [CR3]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-13.B.1-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (System Network Connections Discovery) and Technique (Discovery)"}, {"ScreenshotName": "CR-13.B.1-10.png", "ScreenshotCaption": "Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}], "Footnotes": [" For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was triggered for enumerating Windows network admin shares as part of Discovery (tainted by parent alert).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-13-1.png", "ScreenshotCaption": "Specific Behavior alert for Discovery via network file share enumeration (tainted by parent alert)"}, {"ScreenshotName": "EG-13-3.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1049 - System Network Connections Discovery), related ATT&CK Technique (Remote System Discovery), and correct Tactic (Discovery) (tainted by parent alert, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with the correct ATT&CK Technique (T1049 - System Network Connections Discovery), a related ATT&CK Technique (Remote System Discovery), and the correct Tactic (Discovery). The enrichment was tainted by a parent alert. [EG11]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-13-1.png", "ScreenshotCaption": "Specific Behavior alert for Discovery via network file share enumeration (tainted by parent alert)"}, {"ScreenshotName": "EG-13-3.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1049 - System Network Connections Discovery), related ATT&CK Technique (Remote System Discovery), and correct Tactic (Discovery) (tainted by parent alert, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of net.exe with command-line arguments (tainted by parent alert). [EG11]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-13-1.png", "ScreenshotCaption": "Specific Behavior alert for Discovery via network file share enumeration (tainted by parent alert)"}, {"ScreenshotName": "EG-13-3.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1049 - System Network Connections Discovery), related ATT&CK Technique (Remote System Discovery), and correct Tactic (Discovery) (tainted by parent alert, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.F.1-3.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}, {"ScreenshotName": "CC-13.A.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.F.1-3.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}, {"ScreenshotName": "CC-13.A.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified net.exe as a reconnaissance command used. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)"}, {"ScreenshotName": "FE-13.B.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1049 -System Network Connections Discovery, and Tactic, Discovery)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with an alert for Net Use Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1049 - System Network Connections Discovery) and Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)"}, {"ScreenshotName": "FE-13.B.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1049 -System Network Connections Discovery, and Tactic, Discovery)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of net.exe with command-line arguments (tainted by the parent Script File Created alert).[CT5]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-13.B.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by the parent Script File Created alert)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net.exe. The telemetry was tainted by a trace detection on wscript.exe", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-13.A.1-1.png", "ScreenshotCaption": "Telemetry showed powershell.exe executing net.exe (tainted by parent alert on wscript.exe)"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A delayed General Behavior alert was generated for \"Suspicious sequence of exploration activities\".", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "MS-13.A.1-3.png", "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"}, {"ScreenshotName": "MS-13.B.1-1.png", "ScreenshotCaption": "Telemetry showing execution of net.exe with command-line arguments"}, {"ScreenshotName": "MS-13.B.1-2.png", "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"}], "Footnotes": ["Alert is based on the correlation of a chain of related behaviors across multiple steps."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of net.exe with command-line arguments (tainted by parent PowerShell malicious cmdlet alert).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-13.A.1-3.png", "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"}, {"ScreenshotName": "MS-13.B.1-1.png", "ScreenshotCaption": "Telemetry showing execution of net.exe with command-line arguments"}, {"ScreenshotName": "MS-13.B.1-2.png", "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-13.B.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-13-1.png", "ScreenshotCaption": "Telemetry showing execution of net.exe and command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of net.exe with command-line arguments. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-13.A.1-1.png", "ScreenshotCaption": "Telemetry showing execution of net.exe and command-line arguments (tainted Group ID not shown but was the search parameter)"}], "Footnotes": []}]}]}]}, {"Substep": "13.B.2", "Procedure": "Empire: 'netstat -ano' via PowerShell", "Techniques": [{"TechniqueId": "T1049", "TechniqueName": "System Network Connections Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe data with the correct ATT&CK Technique (T1049 - System Network Connections Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-13.B.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with netstat.exe and command-line arguments"}, {"ScreenshotName": "CB-13.A.1-2.png", "ScreenshotCaption": "Enrichment of netstat.exe with correct ATT&CK Technique (T1049 - System Network Connections Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a process tree containing netstat.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-13.B.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with netstat.exe and command-line arguments"}, {"ScreenshotName": "CB-13.A.1-2.png", "ScreenshotCaption": "Enrichment of netstat.exe with correct ATT&CK Technique (T1049 - System Network Connections Discovery)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team sent an email indicating a General Behavior was observed because netstat was part of additional malicious discovery performed.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-13.B.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing netstat.exe with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-8.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating netstat was part of additional malicious discovery activity (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed netstat.exe executing with command-line arguments. The process tree view showed netstat.exe as tainted by a previous powershell.exe detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-13.B.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing netstat.exe with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-8.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating netstat was part of additional malicious discovery activity (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched netstat.exe executing as Reconnaissance and the correct ATT&CK Technique (System Network Connections Discovery). The data was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-13.B.2-10.png", "ScreenshotCaption": "Enrichment showing netstat.exe executing as Reconnaissance and the correct ATT&CK Technique (System Network Connections Discovery) (tainted by a parent PowerShell alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed netstat.exe executing with command-line arguments. [CR5]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-13.B.2-10.png", "ScreenshotCaption": "Enrichment showing netstat.exe executing as Reconnaissance and the correct ATT&CK Technique (System Network Connections Discovery) (tainted by a parent PowerShell alert)"}], "Footnotes": [" The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched netstat.exe data with the correct ATT&CK Technique (T1049 - System Network Connections Discovery) and Tactic (Discovery) (tainted by parent alert). [EG11]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-13-3.png", "ScreenshotCaption": "Enriched event tree showing enrichment of netstat.exe with correct ATT&CK Technique (T1049 - System Network Connections Discovery) and Tactic (Discovery) (tainted by parent alert, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of netstat.exe with command-line arguments (tainted by parent alert). [EG11]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-13-3.png", "ScreenshotCaption": "Enriched event tree showing enrichment of netstat.exe with correct ATT&CK Technique (T1049 - System Network Connections Discovery) and Tactic (Discovery) (tainted by parent alert, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (netstat) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.G.1-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing netstat.exe with command-line arguments"}, {"ScreenshotName": "CC-13.A.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (netstat) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing netstat.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.G.1-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing netstat.exe with command-line arguments"}, {"ScreenshotName": "CC-13.A.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (netstat) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified netstat.exe as a reconnaissance command used. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating netstat.exe was a reconnaissance command used (General Behavior)"}, {"ScreenshotName": "FE-13.B.2-1.png", "ScreenshotCaption": "Enrichment of netstat.exe with Netstat Execution alert (tagged with correct ATT&CK Technique, T1049 - System Network Connections Discovery, and Tactic, Discovery)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched netstat.exe with an alert for Netstat Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1049 - System Network Connections Discovery) and Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating netstat.exe was a reconnaissance command used (General Behavior)"}, {"ScreenshotName": "FE-13.B.2-1.png", "ScreenshotCaption": "Enrichment of netstat.exe with Netstat Execution alert (tagged with correct ATT&CK Technique, T1049 - System Network Connections Discovery, and Tactic, Discovery)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of netstat.exe with command-line arguments (tainted by the parent Script File Created alert).[CT5]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-13.B.2-1.png", "ScreenshotCaption": "Telemetry showing netstat.exe with command-line arguments (tainted by the parent Script File Created alert)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched netstat.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Connections Discovery) and a suspicious indicator that the network protocol statistics were gathered.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-13.A.1-1.png", "ScreenshotCaption": "Telemetry showed powershell.exe executing netstat.exe (tainted by parent alert on wscript.exe)"}, {"ScreenshotName": "MC-13.A.1-2.png", "ScreenshotCaption": "Enrichment of nestat.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Connections Discovery) and a suspicious indicator that the network protocol statistics were gathered"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing netstat.exe. The telemetry was tainted by a trace detection on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-13.A.1-1.png", "ScreenshotCaption": "Telemetry showed powershell.exe executing netstat.exe (tainted by parent alert on wscript.exe)"}, {"ScreenshotName": "MC-13.A.1-2.png", "ScreenshotCaption": "Enrichment of nestat.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Connections Discovery) and a suspicious indicator that the network protocol statistics were gathered"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A delayed General Behavior alert was generated for \"Suspicious sequence of exploration activities\".", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "MS-13.B.2-1.png", "ScreenshotCaption": "Telemetry showing execution of netstat.exe (tainted by parent PowerShell malicious cmdlet alert)"}, {"ScreenshotName": "MS-13.A.1-3.png", "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific netstat.exe instance not shown)"}, {"ScreenshotName": "MS-13.B.2-2.png", "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing netstat.exe with command-line arguments"}], "Footnotes": ["Alert is based on the correlation of a chain of related behaviors across multiple steps."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of netstat.exe (tainted by parent PowerShell malicious cmdlet alert).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-13.B.2-1.png", "ScreenshotCaption": "Telemetry showing execution of netstat.exe (tainted by parent PowerShell malicious cmdlet alert)"}, {"ScreenshotName": "MS-13.A.1-3.png", "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific netstat.exe instance not shown)"}, {"ScreenshotName": "MS-13.B.2-2.png", "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing netstat.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing netstat with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-13.B.2-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing netstat with command-line arguments (tainted by a parent alert on wscript.exe)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure due to event suppression (previously detected).", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of netstat.exe with command-line arguments. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-13.A.1-1.png", "ScreenshotCaption": "Telemetry showing execution of netstat.exe and command-line arguments (tainted Group ID not shown but was the search parameter)"}], "Footnotes": []}]}]}]}, {"Substep": "13.C.1", "Procedure": "Empire:\u00ef\u00bf\u00bd'reg query' via PowerShell to enumerate a specific Registry key", "Techniques": [{"TechniqueId": "T1012", "TechniqueName": "Query Registry", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched reg.exe data with the correct ATT&CK Technique (Query Registry).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-13.C.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with reg.exe and command-line arguments"}, {"ScreenshotName": "CB-13.C.1-2.png", "ScreenshotCaption": "Enrichment of reg.exe event with correct ATT&CK Technique (Query Registry)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a process tree containing reg.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-13.C.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with reg.exe and command-line arguments"}, {"ScreenshotName": "CB-13.C.1-2.png", "ScreenshotCaption": "Enrichment of reg.exe event with correct ATT&CK Technique (Query Registry)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "OverWatch generated a General Behavior alert identifying reg.exe execution as suspicious. The alert was tainted by a parent powershell.exe detection.[CS1]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "CS-13.C.1-4.png", "ScreenshotCaption": "Telemetry from process tree showing reg.exe with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-13.C.1-2.png", "ScreenshotCaption": "OverWatch General Behavior alert indicating reg query was suspicious (tainted by previous powershell.exe detection by orange line indicating medium severity)"}, {"ScreenshotName": "CS-13.C.1-3.png", "ScreenshotCaption": "OverWatch General Behavior alert indicating reg query was suspicious"}, {"ScreenshotName": "CS-E-8.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating reg query was part of additional malicious discovery activity (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team also sent an email indicating a General Behavior was observed because reg query was part of additional malicious discovery performed.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-13.C.1-4.png", "ScreenshotCaption": "Telemetry from process tree showing reg.exe with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-13.C.1-2.png", "ScreenshotCaption": "OverWatch General Behavior alert indicating reg query was suspicious (tainted by previous powershell.exe detection by orange line indicating medium severity)"}, {"ScreenshotName": "CS-13.C.1-3.png", "ScreenshotCaption": "OverWatch General Behavior alert indicating reg query was suspicious"}, {"ScreenshotName": "CS-E-8.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating reg query was part of additional malicious discovery activity (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed reg.exe executing with command-line arguments. The process tree view showed reg.exe as tainted by a previous powershell.exe detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-13.C.1-4.png", "ScreenshotCaption": "Telemetry from process tree showing reg.exe with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-13.C.1-2.png", "ScreenshotCaption": "OverWatch General Behavior alert indicating reg query was suspicious (tainted by previous powershell.exe detection by orange line indicating medium severity)"}, {"ScreenshotName": "CS-13.C.1-3.png", "ScreenshotCaption": "OverWatch General Behavior alert indicating reg query was suspicious"}, {"ScreenshotName": "CS-E-8.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating reg query was part of additional malicious discovery activity (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed reg.exe executing with command-line arguments. The telemetry was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-13.C.1-10.png", "ScreenshotCaption": "Telemetry showing reg.exe with command-line arguments (tainted by a parent PowerShell alert)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched reg.exe with the correct ATT&CK Technique (T1012 - Query Registry) and Tactic (Discovery) (tainted by parent alert). [EG11]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-13-3.png", "ScreenshotCaption": "Enriched event tree showing enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry) and Tactic (Discovery) (tainted by parent alert, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of reg.exe with command-line arguments (tainted by parent alert). [EG11]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-13-3.png", "ScreenshotCaption": "Enriched event tree showing enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry) and Tactic (Discovery) (tainted by parent alert, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched reg.exe indicating that a sensitive registry key was accessed for potential reconnaissance.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.G.1-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing reg.exe with command-line arguments"}, {"ScreenshotName": "CC-13.A.1-1.png", "ScreenshotCaption": "Enrichment of reg.exe indicating that a sensitive registry key was accessed for potential reconnaissance"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing reg.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-12.G.1-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing reg.exe with command-line arguments"}, {"ScreenshotName": "CC-13.A.1-1.png", "ScreenshotCaption": "Enrichment of reg.exe indicating that a sensitive registry key was accessed for potential reconnaissance"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified reg.exe as a reconnaissance command used. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-13.C.1-1.png", "ScreenshotCaption": "Enrichment of reg.exe with Reg Execution alert (tagged with ATT&CK Technique T1018 - Query Registry, and Tactic, Discovery)"}, {"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating reg.exe was a reconnaissance command used (General Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched reg.exe with an alert for Reg Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1012 - Query Registry) and Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-13.C.1-1.png", "ScreenshotCaption": "Enrichment of reg.exe with Reg Execution alert (tagged with ATT&CK Technique T1018 - Query Registry, and Tactic, Discovery)"}, {"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating reg.exe was a reconnaissance command used (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of reg.exe with command-line arguments (tainted by the parent Script File Created alert).[CT5]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-13.C.1-1.png", "ScreenshotCaption": "Telemetry showing reg.exe with command-line arguments (tainted by the parent Script File Created alert)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (Query Registry) and a suspicious indicator that reg.exe utility queried the Registry.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-13.A.1-1.png", "ScreenshotCaption": "Telemetry showed powershell.exe executing reg.exe (tainted by parent alert on wscript.exe)"}, {"ScreenshotName": "MC-13.A.1-2.png", "ScreenshotCaption": "Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (Query Registry) and a suspicious indicator that reg.exe utility queried the Registry"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing reg.exe. The telemetry was tainted by a trace detection on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-13.A.1-1.png", "ScreenshotCaption": "Telemetry showed powershell.exe executing reg.exe (tainted by parent alert on wscript.exe)"}, {"ScreenshotName": "MC-13.A.1-2.png", "ScreenshotCaption": "Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (Query Registry) and a suspicious indicator that reg.exe utility queried the Registry"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of reg.exe with command-line arguments (tainted by suspicious sequence of exploration activities alert).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-13.C.1-1.png", "ScreenshotCaption": "Telemetry showing execution of reg.exe and command-line arguments"}, {"ScreenshotName": "MS-13.C.1-2.png", "ScreenshotCaption": "Process tree view of suspicious sequence of exploration activities alert showing tainted relationship to reg.exe"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched reg.exe executing with command-line arguments with the correct ATT&CK Technique (Query Registry).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-13.B.3-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing reg with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-13.B.3-2.png", "ScreenshotCaption": "Enrichment of reg.exe executing with command-line arguments with the correct ATT&CK Technique (Query Registry)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing reg with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-13.B.3-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing reg with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-13.B.3-2.png", "ScreenshotCaption": "Enrichment of reg.exe executing with command-line arguments with the correct ATT&CK Technique (Query Registry)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of reg.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-13-1.png", "ScreenshotCaption": "Telemetry showing execution of reg.exe and command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of reg.exe with command-line arguments. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-13.A.1-1.png", "ScreenshotCaption": "Telemetry showing execution of reg.exe and command-line arguments (tainted Group ID not shown but was the search parameter)"}], "Footnotes": []}]}]}]}, {"Substep": "14.A.1", "Procedure": "Empire: Built-in UAC bypass token duplication module executed to launch new callback with elevated process integrity level", "Techniques": [{"TechniqueId": "T1088", "TechniqueName": "Bypass User Account Control", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The OverWatch team also sent an email indicating a Specific Behavior was observed because a base64 obfuscated PowerShell command was used to invoke UAC bypass.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-14.A.1-9.png", "ScreenshotCaption": "Telemetry showing integrity level change through query for powershell.exe processes of high integrity (12288/0x3000) that were created by medium integrity processes (8192/0x2000)"}, {"ScreenshotName": "CS-14.A.1-4.png", "ScreenshotCaption": "Telemetry showing the Invoke-BypassUACTokenManipulation function"}, {"ScreenshotName": "CS-E-8.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating obfuscated PowerShell invoked UAC bypass (Specific Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed an integrity level change through a query for powershell.exe processes of high integrity (12288/0x3000) that were created by medium integrity processes (8192/0x2000), which is indicative of bypassing UAC. Telemetry also showed the Invoke-BypassUACTokenManipulation function in the script.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-14.A.1-9.png", "ScreenshotCaption": "Telemetry showing integrity level change through query for powershell.exe processes of high integrity (12288/0x3000) that were created by medium integrity processes (8192/0x2000)"}, {"ScreenshotName": "CS-14.A.1-4.png", "ScreenshotCaption": "Telemetry showing the Invoke-BypassUACTokenManipulation function"}, {"ScreenshotName": "CS-E-8.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating obfuscated PowerShell invoked UAC bypass (Specific Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed an integrity level change from medium to high for powershell.exe, which is indicative of\u00a0bypass UAC. The telemetry was tainted by a parent Malicious use of PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-14.A.1-11.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing with medium process integrity (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-14.A.1-12.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing with high process integrity (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-14.A.1-13.png", "ScreenshotCaption": "Parent alert generated for malicious use of PowerShell"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a mismatch between the logon id (authentication id) of parent (powershell.exe - 312288) and child (powershell.exe - 10184789) processes indicating that a different token was used. Though no screenshot for this data is available, this information can be used to trace back to the logon event for that logon id to display the process integrity level indicative of the elevated token used for bypass UAC.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-14-2.png", "ScreenshotCaption": "Telemetry showing authentication (logon) ID mismatch between parent and child processes"}, {"ScreenshotName": "EG-14-4.png", "ScreenshotCaption": "Telemetry showing svhost.exe seclogon event for token login id 0x9b6855 (10184789), used by the spawned powershell.exe"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for a possible PowerShell privilege escalation based on the elevation of a child process from a non-elevated parent.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-14.A.1-1.png", "ScreenshotCaption": "General Behavior alert for a possible PowerShell privilege escalation based on the elevation of a child process from a non-elevated parent"}, {"ScreenshotName": "CC-14.A.1-T1088-new.png", "ScreenshotCaption": "Telemetry showing an elevated PowerShell being spawned under the context of user Bob from an unelevated parent process"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed an elevated PowerShell spawned under the context of user Bob from an unelevated parent process.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-14.A.1-1.png", "ScreenshotCaption": "General Behavior alert for a possible PowerShell privilege escalation based on the elevation of a child process from a non-elevated parent"}, {"ScreenshotName": "CC-14.A.1-T1088-new.png", "ScreenshotCaption": "Telemetry showing an elevated PowerShell being spawned under the context of user Bob from an unelevated parent process"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of powershell.exe as a high integrity process as SYSTEM with a token login ID previously associated with user Bob, which indicates UAC bypassing. [FE6]", "Modifiers": ["Configuration Change"], "Screenshots": [{"ScreenshotName": "FE-14.A.1-7.png", "ScreenshotCaption": "Telemetry showing execution of powershell.exe running as SYSTEM with token login ID 0x10530b3"}, {"ScreenshotName": "FE-14.A.1-8.png", "ScreenshotCaption": "Telemetry showing group membership of token logon ID 0x10530b3 associated with user Bob, which includes S-1-16-12288 (High Mandatory Level)"}], "Footnotes": [" A Configuration Change was made in order to collect Windows Event Logs for events 4627 (Group Membership Information) and 4673 (A privileged service was called)."]}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though an alert called \"PowerShell executed encoded commands\" triggered due to svchost.exe creating powershell.exe with the -enc command-line argument.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CT-14.A.1-1.png", "ScreenshotCaption": "Alert for encoded PowerShell (does not count as a detection)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for a possible UAC bypass. The alert was tagged with the correct ATT&CK Technique (Bypass User Account Control) and Tactics (Defense Evasion, Privilege Escalation).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-14.A.1-2.png", "ScreenshotCaption": "Telemetry showing an integrity level change for powershell.exe"}, {"ScreenshotName": "MC-14.A.1-1.png", "ScreenshotCaption": "Specific Behavior alert for a possible UAC bypass."}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed an integrity level change from medium (2) to high (3) for powershell.exe, which is indicative of bypass UAC.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-14.A.1-2.png", "ScreenshotCaption": "Telemetry showing an integrity level change for powershell.exe"}, {"ScreenshotName": "MC-14.A.1-1.png", "ScreenshotCaption": "Specific Behavior alert for a possible UAC bypass."}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of powershell.exe executing \"Invoke-BypassUACTokenManipulation\" Empire cmdlet under the context of user Bob with medium integrity level, execution of svchost.exe with seclogon flag to use impersonation service with new high integrity powershell.exe process as SYSTEM, and subsequent context adjustment of powershell.exe to user Bob (tainted by the parent alert for suspicious sequence of exploration activities).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-14.A.1-1.png", "ScreenshotCaption": "Telemetry showing medium integrity powershell.exe process executing Invoke-BypassUACTokenManipulation as user Bob"}, {"ScreenshotName": "MS-14.A.1-2.png", "ScreenshotCaption": "Telemetry showing high integrity powershell.exe process as SYSTEM"}, {"ScreenshotName": "MS-14.A.1-3.png", "ScreenshotCaption": "Telemetry showing high integrity powershell.exe process as Bob"}, {"ScreenshotName": "MS-14.A.1-5.png", "ScreenshotCaption": "Parent alert for \\\"Suspicious sequence of exploration activities\\\" showing powershell.exe process tainting this event"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Indicator of Compromise", "DetectionNote": "An Indicator of Compromise alert was generated identifying a PowerShell Empire script performing the bypass UAC attack.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-14.A.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe running as medium integrity level (8192)"}, {"ScreenshotName": "PA-14.A.1-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe running as high integrity level (12288)"}, {"ScreenshotName": "PA-14.A.1-3.png", "ScreenshotCaption": "Indicator of Compromise alert identifying a PowerShell Empire script performing the bypass UAC attack."}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a process integrity level change from parent powershell.exe (medium / 8192) to child powershell.exe (high / 12288).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-14.A.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe running as medium integrity level (8192)"}, {"ScreenshotName": "PA-14.A.1-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe running as high integrity level (12288)"}, {"ScreenshotName": "PA-14.A.1-3.png", "ScreenshotCaption": "Indicator of Compromise alert identifying a PowerShell Empire script performing the bypass UAC attack."}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed process integrity levels changing from medium to high (tainted by parent alert).[SO4]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-14.A.1-1.png", "ScreenshotCaption": "Telemetry showing process integrity level change from medium to high (tainted by relationship to threat story but Group ID not shown in this view)"}], "Footnotes": ["Integrity level numbers are based upon how the capability tracks integrity levels and not how Windows tracks them causing a difference in values."]}]}]}]}, {"Substep": "14.A.1", "Procedure": "Empire: UAC bypass module downloaded and wrote a new Empire stager (wdbypass) to disk", "Techniques": [{"TechniqueId": "T1105", "TechniqueName": "Remote File Copy", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "The vendor demonstrated to MITRE that the capability can provide telemetry of network connections and file modifications indicating a Remote File Copy, but no screenshot was captured for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The OverWatch team sent an email indicating a Specific Behavior was observed because PowerShell retrieved the file wdbypass from www.freegoogleadsenseinfo.com (C2 domain) over port 8080.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-E-11.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating PowerShell retrieved the file wdbypass (Specific Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated based on the downloading and execution of wdbypass, identified as Fileless malware, from freegoogleadsenseinfo.com (C2 domain) over port 8080. The alert also showed decoded PowerShell commands extracted from the command-line arguments showing a connection over port 8080 with a HTTP request to download the wdbypass payload. The alert was tainted by a parent PowerShell alert", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-14.A.1-40.png", "ScreenshotCaption": "Specific Behavior alert showing decoded PowerShell with download request of wdbypass over HTTP port 8080"}, {"ScreenshotName": "CR-14.A.1-10.png", "ScreenshotCaption": "Specific Behavior alert for Download & execute of the wdbypass file"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showing decoded PowerShell telemetry extracted from the command-line arguments showed a connection over port 8080 with a HTTP request to download wdbypass payload.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-14-1.png", "ScreenshotCaption": "Telemetry showing decoded PowerShell with download request of wdbypass over port 8080"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for PowerShell downloading a significant amount of data using HTTP(S).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-14.A.1-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass"}, {"ScreenshotName": "CC-14.A.1-1.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell downloading a significant amount of data using HTTP(S)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-14.A.1-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass"}, {"ScreenshotName": "CC-14.A.1-1.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell downloading a significant amount of data using HTTP(S)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched a HTTP GET request for wdbypass with an alert for PowerShell URL Request (Weak Signal). The alert also was also tagged with the correct ATT&CK Technique (T1105 - Remote File Copy) and Tactic (Command and Control).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-14.A.1-4.png", "ScreenshotCaption": "Enrichment of HTTP GET request for wdbypass with PowerShell URL Request alert (tagged with correct ATT&CK Technique, T1105 - Remote File Copy, and Tactic, Command and Control)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass (tainted by the parent \"Powershell executed encoded commands\" alert).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-14.A.1-2.png", "ScreenshotCaption": "Telemetry showing port 8080 HTTP GET request to C2 domain for file wdbypass (tainted by the parent \\\"Powershell executed encoded commands\\\" alert)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed an encoded PowerShell command that could be decoded outside the capability to show the IEX command used to download the file (wdbypass) over HTTP port 8080.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-14.A.1-1.png", "ScreenshotCaption": "Telemetry showing encoded PowerShell command that could be decoded outside the capability (does not count as a detection)"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed network connection to 192.168.0.5 (C2 server) over port 8080 as well as decoded PowerShell making a connection over port 8080 with a HTTP request to download wdbypass payload. (tainted by alert on suspicious PowerShell command-line arguments).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-14.A.1-3.png", "ScreenshotCaption": "Telemetry showing network connection to 192.168.0.5 (C2 server) over port 8080"}, {"ScreenshotName": "MS-14.A.1-4.png", "ScreenshotCaption": "Telemetry showing decoded PowerShell script with download HTTP request of wdbypass over port 8080 and tainted relationship to alert on suspicious PowerShell command-line arguments"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed an encoded PowerShell command that could be decoded outside the capability to show the IEX command used to download the file (wdbypass) over HTTP port 8080.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-14.A.1-5.png", "ScreenshotCaption": "Telemetry showing decoded PowerShell showing download request over HTTP (does not count as a detection due to decoding outside of capability)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed an encoded PowerShell command that could be decoded outside the capability to show the IEX command used to download the file (wdbypass) over HTTP port 8080.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-14-1.png", "ScreenshotCaption": "Telemetry showing decoded PowerShell showing download request over HTTP (does not count as a detection due to decoding outside of capability)"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}]}, {"Substep": "14.A.1", "Procedure": "Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over HTTP", "Techniques": [{"TechniqueId": "T1071", "TechniqueName": "Standard Application Layer Protocol", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed an encoded PowerShell command that could be decoded outside the capability to show the IEX command used to download the file (wdbypass) over HTTP port 8080.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-14.A.1-6.png", "ScreenshotCaption": "Telemetry showing encoded PowerShell command that decodes to show HTTP traffic (does not count as a detection)"}, {"ScreenshotName": "CS-14.A.1-7.png", "ScreenshotCaption": "Decoded PowerShell (outside of capability) showing download request over HTTP (does not count as a detection)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for powershell.exe executed as a PowerShell downloader. The alert was tagged with the correct ATT&CK Tactic (Command and Control) and the Technique (Standard Application Layer Protocol). Data also showed decoded PowerShell commands extracted from the command-line arguments showing a connection over port 8080 with a HTTP request to download the wdbypass payload. The alert was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-14.A.1-40.png", "ScreenshotCaption": "Specific Behavior alert showing decoded PowerShell with download request of wdbypass over HTTP port 8080"}, {"ScreenshotName": "CR-14.A.1-30.png", "ScreenshotCaption": "Specific Behavior alert for powershell.exe mapped to the correct ATT&CK Tactic (Command and Control) and Technique (Standard Application Layer Protocol) (tainted by a parent PowerShell alert)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showing decoded PowerShell telemetry extracted from the command-line arguments showed a connection over port 8080 with a HTTP request to download wdbypass payload.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-14-1.png", "ScreenshotCaption": "Telemetry showing decoded PowerShell with download request of wdbypass over port 8080"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-14.A.1-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched a HTTP GET request with an alert for PowerShell URL Request (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1071 - Standard Application Layer Protocol) and Tactic (Command and Control).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-14.A.1-4.png", "ScreenshotCaption": "Enrichment of HTTP GET request with PowerShell URL Request alert (tagged with correct ATT&CK Technique, T1071 - Standard Application Layer Protocol, and Tactic, Command and Control)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass (tainted by the parent \"Powershell executed encoded commands\" alert).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-14.A.1-2.png", "ScreenshotCaption": "Telemetry showing port 8080  HTTP GET request to C2 domain for file wdbypass (tainted by the parent \\\"Powershell executed encoded commands\\\" alert)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed an encoded PowerShell command that could be decoded outside the capability to show the IEX command used to download the file (wdbypass) over HTTP port 8080.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-14.A.1-1.png", "ScreenshotCaption": "Telemetry showing encoded PowerShell command that could be decoded outside the capability (does not count as a detection)"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a decoded PowerShell script invoked that created a web request to the C2 server with related data showing the connection was made (tainted by alert on suspicious PowerShell command-line arguments).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-14.A.1-4.png", "ScreenshotCaption": "Telemetry showing decoded PowerShell script with download HTTP request of wdbypass over port 8080 and tainted relationship to alert on suspicious PowerShell command-line arguments"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed an encoded PowerShell command that could be decoded outside the capability to show the IEX command used to download the file (wdbypass) over HTTP port 8080.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-14.A.1-5.png", "ScreenshotCaption": "Telemetry showing decoded PowerShell showing download request over HTTP (does not count as a detection due to decoding outside of capability)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed an encoded PowerShell command that could be decoded outside the capability to show the IEX command used to download the file (wdbypass) over HTTP port 8080.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-14-1.png", "ScreenshotCaption": "Telemetry showing decoded PowerShell showing download request over HTTP (does not count as a detection due to decoding outside of capability)"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}]}, {"Substep": "14.A.1", "Procedure": "Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over port 8080", "Techniques": [{"TechniqueId": "T1043", "TechniqueName": "Commonly Used Port", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed network connection to 192.168.0.5 (C2 server) over TCP port 8080.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-14.A.1-3.png", "ScreenshotCaption": "Telemetry showing network connection to 192.168.0.5 (C2 server) over TCP port 8080"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a network connection event to 192.168.0.5 (C2 server) on TCP port 8080 that was associated with the encoded PowerShell IEX command.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-14.A.1-5.png", "ScreenshotCaption": "Telemetry showing IEX connection over to 192.168.0.5 (C2 server) on TCP port 8080"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for powershell.exe executed as a PowerShell downloader. The alert was tagged with the correct ATT&CK Tactic (Command and Control) and the Technique (Commonly Used Port). Data also showed decoded PowerShell commands extracted from the command-line arguments showing a connection over port 8080 with a HTTP request to download the wdbypass payload. The alert was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-14.A.1-30.png", "ScreenshotCaption": "Specific Behavior alert for powershell.exe mapped to the correct ATT&CK Tactic (Command and Control) and Technique (Commonly Used Port) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-14.A.1-40.png", "ScreenshotCaption": "Specific Behavior alert showing decoded PowerShell with download request of wdbypass over HTTP port 8080"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe making a network connection over port 8080. [CR3]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-14.A.1-30.png", "ScreenshotCaption": "Specific Behavior alert for powershell.exe mapped to the correct ATT&CK Tactic (Command and Control) and Technique (Commonly Used Port) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-14.A.1-40.png", "ScreenshotCaption": "Specific Behavior alert showing decoded PowerShell with download request of wdbypass over HTTP port 8080"}], "Footnotes": [" For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert for Command and Control was triggered because of PowerShell making a connection over TCP port 8080.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-14-3.png", "ScreenshotCaption": "General Behavior alert for Command and Control associated with network traffic from PowerShell over TCP port 8080"}, {"ScreenshotName": "EG-14-1.png", "ScreenshotCaption": "Telemetry showing decoded PowerShell with download request of wdbypass over port 8080"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showing decoded PowerShell telemetry extracted from the command-line arguments showed a connection over port 8080 with a HTTP request to download wdbypass payload.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-14-3.png", "ScreenshotCaption": "General Behavior alert for Command and Control associated with network traffic from PowerShell over TCP port 8080"}, {"ScreenshotName": "EG-14-1.png", "ScreenshotCaption": "Telemetry showing decoded PowerShell with download request of wdbypass over port 8080"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-14.A.1-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified that the Empire instance communicated with freegoogleadsenseinfo.com (C2 domain) over port 8080.[FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-14.A.1-4.png", "ScreenshotCaption": "Telemetry showing TCP port 8080 connection to freegoogleadsenseinfo.com (C2 domain) (tainted by parent PowerShell URL Request alert)"}, {"ScreenshotName": "FE-14.A.1-9.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating Empire communicated over port 8080 (General Behavior)"}, {"ScreenshotName": "FE-11.B.1-4.png", "ScreenshotCaption": "Additional excerpt from the Managed Defense Report indicating Empire was configured to communicate over port 8080 (General Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a connection to freegoogleadsenseinfo.com (C2 domain) over TCP port 8080. The telemetry was tainted by the parent PowerShell URL Request (Weak Signal) alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "FE-14.A.1-4.png", "ScreenshotCaption": "Telemetry showing TCP port 8080 connection to freegoogleadsenseinfo.com (C2 domain) (tainted by parent PowerShell URL Request alert)"}, {"ScreenshotName": "FE-14.A.1-9.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating Empire communicated over port 8080 (General Behavior)"}, {"ScreenshotName": "FE-11.B.1-4.png", "ScreenshotCaption": "Additional excerpt from the Managed Defense Report indicating Empire was configured to communicate over port 8080 (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass (tainted by the parent \"Powershell executed encoded commands\" alert).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-14.A.1-2.png", "ScreenshotCaption": "Telemetry showing port 8080 HTTP GET request to C2 domain for file wdbypass (tainted by the parent \\\"Powershell executed encoded commands\\\" alert)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a network connection to 192.168.0.5 (C2 server) over TCP port 8080.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-14.A.1-4.png", "ScreenshotCaption": "Telemetry showing a network connection to 192.168.0.5 (C2 server) over TCP port 8080"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a connection to 192.168.0.5 (C2 server) on port 8080 was made (tainted by alert on suspicious PowerShell command-line arguments).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-14.A.1-3.png", "ScreenshotCaption": "Telemetry showing network connection to 192.168.0.5 (C2 server) over port 8080"}, {"ScreenshotName": "MS-14.A.1-4.png", "ScreenshotCaption": "Telemetry showing decoded PowerShell script with download HTTP request of wdbypass over port 8080 and tainted relationship to alert on suspicious PowerShell command-line arguments"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed an outgoing network connection to www.freegoogleadsenseinfo.com (C2 domain) over port 8080.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-14.A.1-4.png", "ScreenshotCaption": "Telemetry showing an outgoing network connection to www.freegoogleadsenseinfo.com (C2 domain) over port 8080"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed network connection to 192.168.0.5 (C2 server) over port 8080. Though it does not count as a detection, telemetry also showed an encoded PowerShell command that could be decoded outside the capability to show the IEX command used to download the file (wdbypass) over HTTP port 8080.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-14-2.png", "ScreenshotCaption": "Telemetry showing network connection to 192.168.0.5 (C2 server) over port 8080"}, {"ScreenshotName": "RSA-14-1.png", "ScreenshotCaption": "Telemetry of decoded PowerShell showing download request over HTTP (does not count as a detection due to decoding outside of capability)"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed network connections over port 8080. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-14.A.1-2.png", "ScreenshotCaption": "Telemetry showing network connections over port 8080 in the filter (tainted by relationship to threat story but Group ID not shown in this view)"}], "Footnotes": []}]}]}]}, {"Substep": "15.A.1", "Procedure": "Empire: Built-in keylogging module executed to capture keystrokes of user Bob", "Techniques": [{"TechniqueId": "T1056", "TechniqueName": "Input Capture", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the events with a tag titled \\\"PowerShell Input Capture -keylogger\\\" based on known modloads that could be potentially abused to provide keylogger functionality.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-15.A.1-1.png", "ScreenshotCaption": "Telemetry showing modloads associated with keylogger"}, {"ScreenshotName": "CB-15.A.1-3.png", "ScreenshotCaption": "Enrichment of data with tag \\\"PowerShell Input Capture -keylogger\\\""}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed modloads associated with the execution of a keylogger.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-15.A.1-1.png", "ScreenshotCaption": "Telemetry showing modloads associated with keylogger"}, {"ScreenshotName": "CB-15.A.1-3.png", "ScreenshotCaption": "Enrichment of data with tag \\\"PowerShell Input Capture -keylogger\\\""}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team sent an email indicating a Specific Behavior was identified because they observed the adversary logging keystrokes based on the GetKeystrokes PowerShell function.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-15.A.1-2.png", "ScreenshotCaption": "Telemetry showing decoded PowerShell script containing the function Get-Keystrokes"}, {"ScreenshotName": "CS-E-8.png", "ScreenshotCaption": "Excerpt from email sent by OverWatch team indicating keylogging activity occurred (Specific Behavior)"}, {"ScreenshotName": "CS-E-12.png", "ScreenshotCaption": "Excerpt from email sent by OverWatch team indicating IT_tasks.txt was retrieved as a file of interest (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the decoded PowerShell script, which displayed the function Get-Keystrokes.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-15.A.1-2.png", "ScreenshotCaption": "Telemetry showing decoded PowerShell script containing the function Get-Keystrokes"}, {"ScreenshotName": "CS-E-8.png", "ScreenshotCaption": "Excerpt from email sent by OverWatch team indicating keylogging activity occurred (Specific Behavior)"}, {"ScreenshotName": "CS-E-12.png", "ScreenshotCaption": "Excerpt from email sent by OverWatch team indicating IT_tasks.txt was retrieved as a file of interest (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Indicator of Compromise", "DetectionNote": "An Indicator of Compromise alert was generated based on the execution of a malicious command in PowerShell named Get-Keystrokes.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-15.A.1-20.png", "ScreenshotCaption": "Indicator of Compromise alert for Malicious Command Get-Keystrokes"}, {"ScreenshotName": "CR-15.A.1-100.png", "ScreenshotCaption": "Telemetry showing modloads associated with a keylogger"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed modloads associated with the execution of a keylogger.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-15.A.1-20.png", "ScreenshotCaption": "Indicator of Compromise alert for Malicious Command Get-Keystrokes"}, {"ScreenshotName": "CR-15.A.1-100.png", "ScreenshotCaption": "Telemetry showing modloads associated with a keylogger"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though the capability pulled PowerShell Script Block logs from the host to show the execution of Get-KeyStrokes.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-15-1.png", "ScreenshotCaption": "Telemetry showing PowerShell Script Block logging with execution of Get-KeyStrokes (does not count as a detection)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched powershell.exe with a tag indicating .NET keylogging.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-15.A.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing the GetAsyncKeyState method"}, {"ScreenshotName": "CC-15.B.1-3.png", "ScreenshotCaption": "Enrichment of powershell.exe with a tag indicating .NET keylogging"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing the GetAsyncKeyState method, indicating keylogging.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-15.A.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing the GetAsyncKeyState method"}, {"ScreenshotName": "CC-15.B.1-3.png", "ScreenshotCaption": "Enrichment of powershell.exe with a tag indicating .NET keylogging"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though the capability detected PowerShell activity during the time of the keylogging.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-15.A.1-1.png", "ScreenshotCaption": "PowerShell activity during the time of the keylogging (does not count as detection)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[CT30]", "Modifiers": [], "Screenshots": [], "Footnotes": ["The vendor noted the capability can create a new condition that would track all actions on a certain file of interest. Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A delayed Specific Behavior alert was generated on keylogging activity in powershell.exe.", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "MS-15.A.1-2.png", "ScreenshotCaption": "Telemetry showing keylogger events"}, {"ScreenshotName": "MS-15.A.1-1.png", "ScreenshotCaption": "Telemetry showing execution of Get-Keystrokes cmdlet"}, {"ScreenshotName": "MS-15.A.1-5.png", "ScreenshotCaption": "Parent alert showing process tree view showing tainted relationship (specific instance of this technique not shown in the alert)"}, {"ScreenshotName": "MS-15.A.1-3.png", "ScreenshotCaption": "Specific Behavior alert for keylogging activity from powershell.exe"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe making API calls consistent with keylogger behavior. Telemetry also showed execution of Get-Keystrokes Empire PowerShell cmdlet (tainted by alert on PowerShell script with suspicious content).[MS15]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-15.A.1-2.png", "ScreenshotCaption": "Telemetry showing keylogger events"}, {"ScreenshotName": "MS-15.A.1-1.png", "ScreenshotCaption": "Telemetry showing execution of Get-Keystrokes cmdlet"}, {"ScreenshotName": "MS-15.A.1-5.png", "ScreenshotCaption": "Parent alert showing process tree view showing tainted relationship (specific instance of this technique not shown in the alert)"}, {"ScreenshotName": "MS-15.A.1-3.png", "ScreenshotCaption": "Specific Behavior alert for keylogging activity from powershell.exe"}], "Footnotes": [" Vendor stated that Input Capture telemetry is captured but it was not immediately visible in the portal. Vendor made changes to the portal during the test to enable by default the visibility of these events."]}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the execution of a specific API call as keylogging and suspicious activity.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-15.A.1-1.png", "ScreenshotCaption": "Enrichment of the execution of a specific API call as keylogging and suspicious activity"}, {"ScreenshotName": "PA-15.A.1-2.png", "ScreenshotCaption": "Indicator of Compromise alert identifying a PowerShell Empire script logging keys pressed, time, and the active window"}], "Footnotes": []}, {"DetectionType": "Indicator of Compromise", "DetectionNote": "An Indicator of Compromise alert was generated identifying a PowerShell Empire script logging keys pressed, time, and the active window.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-15.A.1-1.png", "ScreenshotCaption": "Enrichment of the execution of a specific API call as keylogging and suspicious activity"}, {"ScreenshotName": "PA-15.A.1-2.png", "ScreenshotCaption": "Indicator of Compromise alert identifying a PowerShell Empire script logging keys pressed, time, and the active window"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched data collected as keylogging behavior that was not visible through the standard interface during the evaluation. [SO5]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-15.A.1-1.png", "ScreenshotCaption": "Enrichment of use of GetAsyncKeyStateApi tagged as a keylogger (tainted by relationship to threat story but Group ID not shown in this view)"}], "Footnotes": [" The capability associated the keylogging event to the parent Group ID even though it is not visible in the data provided."]}]}]}]}, {"Substep": "15.A.1", "Procedure": "Empire: Built-in keylogging module included residual enumeration of application windows", "Techniques": [{"TechniqueId": "T1010", "TechniqueName": "Application Window Discovery", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the decoded PowerShell script, which displayed the API call GetForegroundWindow to enumerate the active window.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-15.A.1-2.png", "ScreenshotCaption": "Telemetry showing decoded PowerShell script containing the API call GetForegroundWindow"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing the GetForegroundWindow method.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-15.A.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing the GetForegroundWindow method"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[CT5]", "Modifiers": [], "Screenshots": [], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Indicator of Compromise", "DetectionNote": "An Indicator of Compromise alert was generated identifying a PowerShell Empire script logging keys pressed, time, and the active window.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-15.A.1-2.png", "ScreenshotCaption": "Indicator of Compromise alert identifying a PowerShell Empire script logging keys pressed, time, and the active window"}, {"ScreenshotName": "PA-15.A.1-3.png", "ScreenshotCaption": "Telemetry showing decoded PowerShell script containing the API call GetForegroundWindow"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the decoded PowerShell script, which includes the API call GetForegroundWindow to enumerate the active window.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-15.A.1-2.png", "ScreenshotCaption": "Indicator of Compromise alert identifying a PowerShell Empire script logging keys pressed, time, and the active window"}, {"ScreenshotName": "PA-15.A.1-3.png", "ScreenshotCaption": "Telemetry showing decoded PowerShell script containing the API call GetForegroundWindow"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}]}, {"Substep": "15.B.1", "Procedure": "Empire: 'get-content' via PowerShell to collect sensitive file (it_tasks.txt) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Techniques": [{"TechniqueId": "T1081", "TechniqueName": "Credentials in Files", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The OverWatch team sent an email indicating a General Behavior was observed because IT_tasks.txt was retrieved from a network share as a file of interest.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-E-12.png", "ScreenshotCaption": "Excerpt from email sent by OverWatch team indicating IT_tasks.txt was retrieved as a file of interest (General Behavior)"}, {"ScreenshotName": "CS-15.B.1-2.png", "ScreenshotCaption": "Telemetry showing file read event for IT_tasks.txt"}, {"ScreenshotName": "CS-15.B.1-1.png", "ScreenshotCaption": "Telemetry showing FsPostOpen event for IT_tasks.txt"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a file read event for IT_tasks.txt by powershell.exe as well as a FsPostOpen event indicating IT_tasks.txt was opened.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-E-12.png", "ScreenshotCaption": "Excerpt from email sent by OverWatch team indicating IT_tasks.txt was retrieved as a file of interest (General Behavior)"}, {"ScreenshotName": "CS-15.B.1-2.png", "ScreenshotCaption": "Telemetry showing file read event for IT_tasks.txt"}, {"ScreenshotName": "CS-15.B.1-1.png", "ScreenshotCaption": "Telemetry showing FsPostOpen event for IT_tasks.txt"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure. [EG1]", "Modifiers": [], "Screenshots": [], "Footnotes": [" Had malicious access to it_tasks been detected, response actions allow file retrieval which could have identified credentials in files."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing the Get-Content cmdlet on IT_tasks.txt.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-15.A.1-4.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing the Get-Content cmdlet on IT_tasks.txt"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[CT5]", "Modifiers": [], "Screenshots": [], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though telemetry was available that showed execution of Get-Content PowerShell cmdlet. Data does not show what file the cmdlet was executed on.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-15.B.1-1.png", "ScreenshotCaption": "Telemetry showing \"Get-Content\" cmdlet (does not count as a detection)"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a file read event for IT_tasks.txt.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-15.B.1-1.png", "ScreenshotCaption": "Telemetry showing a file read event for IT_tasks.txt"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}]}, {"Substep": "16.A.1", "Procedure": "Empire: 'net use' via PowerShell to brute force password spraying authentication attempts to Morris (10.0.1.4) and Nimda (10.0.1.6) targeting credentials of users\u00ef\u00bf\u00bdKmitnick, Bob, and Frieda", "Techniques": [{"TechniqueId": "T1110", "TechniqueName": "Brute Force", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched individual net.exe events with tagging titled \\\"Credential Access using Admin Shares - Failed Attempts\\\". [CB8]", "Modifiers": ["Configuration Change"], "Screenshots": [{"ScreenshotName": "CB-16.A.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with four different net.exe logon attempts"}, {"ScreenshotName": "CB-16.B.1-2.png", "ScreenshotCaption": "Enrichment of the individual net.exe logon attempts with tag \\\"Credential Access using Admin Shares - Failed Attempts\\\""}], "Footnotes": ["The capability was modified after the start of the evaluation enabling enrichment to appear, so the detection is identified as a configuration change."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a process tree containing repeated logon attempts via net.exe and command-line arguments indicative of password spraying.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-16.A.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with four different net.exe logon attempts"}, {"ScreenshotName": "CB-16.B.1-2.png", "ScreenshotCaption": "Enrichment of the individual net.exe logon attempts with tag \\\"Credential Access using Admin Shares - Failed Attempts\\\""}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "OverWatch generated General Behavior alerts indicating the net use commands were suspicious. The alerts were tainted by a parent powershell.exe detection.[CS1]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "CS-16.A.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempts"}, {"ScreenshotName": "CS-16.A.1-3.png", "ScreenshotCaption": "Telemetry showing details for the logon attempt into the 10.0.1.4 (Morris) showing UserLogonFlags_decimal is equal to 6 (attempt for local admin) and UserLogonFailed (no distinction between authentication failure and authorization failure)"}, {"ScreenshotName": "CS-16.A.1-4.png", "ScreenshotCaption": "Telemetry showing details for the logon attempt into the 10.0.1.6 (Nimda) showing UserLogonFlags_decimal is equal to 6 (attempt for local admin) and UserLogonFailed (no distinction between authentication failure and authorization failure)"}, {"ScreenshotName": "CS-16.A.1-2.png", "ScreenshotCaption": "Process tree view of OverWatch General Behavior alerts indicating net.exe commands were suspicious (net.exe command details not specifically shown, tainted by previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-10.png", "ScreenshotCaption": "Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team also sent an email indicating a General Behavior was observed because the user Bob attempted to move laterally using several accounts.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-16.A.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempts"}, {"ScreenshotName": "CS-16.A.1-3.png", "ScreenshotCaption": "Telemetry showing details for the logon attempt into the 10.0.1.4 (Morris) showing UserLogonFlags_decimal is equal to 6 (attempt for local admin) and UserLogonFailed (no distinction between authentication failure and authorization failure)"}, {"ScreenshotName": "CS-16.A.1-4.png", "ScreenshotCaption": "Telemetry showing details for the logon attempt into the 10.0.1.6 (Nimda) showing UserLogonFlags_decimal is equal to 6 (attempt for local admin) and UserLogonFailed (no distinction between authentication failure and authorization failure)"}, {"ScreenshotName": "CS-16.A.1-2.png", "ScreenshotCaption": "Process tree view of OverWatch General Behavior alerts indicating net.exe commands were suspicious (net.exe command details not specifically shown, tainted by previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-10.png", "ScreenshotCaption": "Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed repeated logon attempts via net.exe with command-line arguments indicative of password spraying, including details that the logons were for local admin (type 6) and that they failed.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-16.A.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempts"}, {"ScreenshotName": "CS-16.A.1-3.png", "ScreenshotCaption": "Telemetry showing details for the logon attempt into the 10.0.1.4 (Morris) showing UserLogonFlags_decimal is equal to 6 (attempt for local admin) and UserLogonFailed (no distinction between authentication failure and authorization failure)"}, {"ScreenshotName": "CS-16.A.1-4.png", "ScreenshotCaption": "Telemetry showing details for the logon attempt into the 10.0.1.6 (Nimda) showing UserLogonFlags_decimal is equal to 6 (attempt for local admin) and UserLogonFailed (no distinction between authentication failure and authorization failure)"}, {"ScreenshotName": "CS-16.A.1-2.png", "ScreenshotCaption": "Process tree view of OverWatch General Behavior alerts indicating net.exe commands were suspicious (net.exe command details not specifically shown, tainted by previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-10.png", "ScreenshotCaption": "Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe execution with a related ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) in addition to labeling net.exe as having a High Internal Outgoing Embryonic Connection Rate (meaning 25% of the internal network connections did not receive a response). The data was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-16.A.1-10.png", "ScreenshotCaption": "Enrichment of net.exe execution with related ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.A.1-2.png", "ScreenshotCaption": "Enrichment of net.exe execution showing logon attempts for the user Frieda with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.A.1-3.png", "ScreenshotCaption": "Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.A.1-20.png", "ScreenshotCaption": "Enrichment of net.exe execution showing logon attempts for the user Bob with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed net.exe executing with command-line arguments. [CR5]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-16.A.1-10.png", "ScreenshotCaption": "Enrichment of net.exe execution with related ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.A.1-2.png", "ScreenshotCaption": "Enrichment of net.exe execution showing logon attempts for the user Frieda with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.A.1-3.png", "ScreenshotCaption": "Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.A.1-20.png", "ScreenshotCaption": "Enrichment of net.exe execution showing logon attempts for the user Bob with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}], "Footnotes": [" The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched each individual net.exe logon attempt with a tag titled Lateral Movement via \\\"Mounting Hidden Shares\\\" (tainted by parent PowerShell alert).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-16-1.png", "ScreenshotCaption": "Enrichment of each net.exe connection attempt (tainted by parent PowerShell alert)"}, {"ScreenshotName": "EG-16-2.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe connection events with a related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert). [EG11]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-16-1.png", "ScreenshotCaption": "Enrichment of each net.exe connection attempt (tainted by parent PowerShell alert)"}, {"ScreenshotName": "EG-16-2.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed repeated logon attempts via net.exe and command-line arguments indicative of password spraying (tainted by parent PowerShell alert). [EG11]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-16-1.png", "ScreenshotCaption": "Enrichment of each net.exe connection attempt (tainted by parent PowerShell alert)"}, {"ScreenshotName": "EG-16-2.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched multiple occurrences of net.exe usage as indicative of brute forcing a remote system as well as the correct ATT&CK Technique ID (Brute Force). [CC3]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-16.A.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempts"}], "Footnotes": ["Screenshot is not available due to sensitivity of rule logic."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed repeated logon attempts via net.exe with command-line arguments indicative of password spraying.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-16.A.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempts"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified that the attacker attempted to access systems using four accounts.[FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-16.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Frieda; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-16.A.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Bob; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-16.A.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Kmitnick; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-16.A.1-4.png", "ScreenshotCaption": "Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Kmitnick; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-16.A.1-5.png", "ScreenshotCaption": "Telemetry showing failed logon attempt for Kmitnick"}, {"ScreenshotName": "FE-16.A.1-6.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker attempted to access systems using four accounts (General Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched repeated logon attempts via net.exe with an alert for Net Use Command Execution (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1077 - Windows Admin Share) and Tactic (Lateral Movement). \u00a0The four events were included under the same alert and each of the passwords were redacted by the capability. [FE10]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-16.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Frieda; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-16.A.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Bob; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-16.A.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Kmitnick; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-16.A.1-4.png", "ScreenshotCaption": "Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Kmitnick; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-16.A.1-5.png", "ScreenshotCaption": "Telemetry showing failed logon attempt for Kmitnick"}, {"ScreenshotName": "FE-16.A.1-6.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker attempted to access systems using four accounts (General Behavior)"}], "Footnotes": [" The vendor indicated the un-redacted passwords could be observed in triage/acquistion data."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the logon failure from Kmitnick by searching for Windows Security Log Event ID 4625. [FE3]", "Modifiers": ["Configuration Change"], "Screenshots": [{"ScreenshotName": "FE-16.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Frieda; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-16.A.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Bob; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-16.A.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Kmitnick; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-16.A.1-4.png", "ScreenshotCaption": "Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Kmitnick; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-16.A.1-5.png", "ScreenshotCaption": "Telemetry showing failed logon attempt for Kmitnick"}, {"ScreenshotName": "FE-16.A.1-6.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker attempted to access systems using four accounts (General Behavior)"}], "Footnotes": [" A configuration change was made to allow for the capture of Windows Security Event ID 4625."]}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched each individual net.exe logon attempt with the condition \u00a0\\\"Net User Reconnaissance Command\\\". The enrichment was tainted by the parent \\\"Powershell executed remote commands\\\" alert.[CT5]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-16.A.1-1.png", "ScreenshotCaption": "Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) with user Kmitnick (enriched with condition \\\"Net User Reconnaissance Command\\\", tainted by the parent \\\"Powershell executed encoded commands\\\" alert)"}, {"ScreenshotName": "CT-16.A.1-2.png", "ScreenshotCaption": "Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Kmitnick (enriched with condition \\\"Net User Reconnaissance Command\\\", tainted by the parent \\\"Powershell executed encoded commands\\\" alert)"}, {"ScreenshotName": "CT-16.A.1-3.png", "ScreenshotCaption": "Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Bob (enriched with condition \\\"Net User Reconnaissance Command\\\", tainted by the parent \\\"Powershell executed encoded commands\\\" alert)"}, {"ScreenshotName": "CT-16.A.1-4.png", "ScreenshotCaption": "Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Frieda (enriched with condition \\\"Net User Reconnaissance Command\\\", tainted by the parent \\\"Powershell executed encoded commands\\\" alert)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for powershell.exe performing a potential brute force password hack via the net utility.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-16.A.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing repeated logon attempts via net.exe (tainted by a parent alert on powershell.exe)"}, {"ScreenshotName": "MC-16.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert for powershell.exe performing a potential brute force password hack via the net utility"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing repeated logon attempts via net.exe. The telemetry was tainted by a trace detection on powershell.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-16.A.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing repeated logon attempts via net.exe (tainted by a parent alert on powershell.exe)"}, {"ScreenshotName": "MC-16.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert for powershell.exe performing a potential brute force password hack via the net utility"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A delayed Specific Behavior alert was generated based on brute force attempt by accessing remote SMB shares with different accounts.[MS16]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "MS-16.A.1-6.png", "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"}, {"ScreenshotName": "MS-16.A.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"}, {"ScreenshotName": "MS-16.A.1-3.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"}, {"ScreenshotName": "MS-16.A.1-4.png", "ScreenshotCaption": "Execution sequence showing net.exe logon failure to Morris due to WebDAV fallback authentication attempt over port 80 to the C2 server"}, {"ScreenshotName": "MS-16.A.1-1.png", "ScreenshotCaption": "Specific Behavior alert for brute force attempt to remote SMB shares"}, {"ScreenshotName": "MS-16.A.1-5.png", "ScreenshotCaption": "System access history from CodeRed to Nimda and Morris"}], "Footnotes": ["The alert spans multiple login attempts."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed repeated logon attempts via net.exe with command-line arguments indicative of password spraying (tainted by parent alert on PowerShell script with suspicious content). Telemetry also showed failed authorization attempts due to bad passwords as indicated by a fallback request over WebDAV to port 80 on the C2 server, but did not indicate the two failed access attempts on Morris and Conficker that were due to the accounts having insufficient access on the systems.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-16.A.1-6.png", "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"}, {"ScreenshotName": "MS-16.A.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"}, {"ScreenshotName": "MS-16.A.1-3.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"}, {"ScreenshotName": "MS-16.A.1-4.png", "ScreenshotCaption": "Execution sequence showing net.exe logon failure to Morris due to WebDAV fallback authentication attempt over port 80 to the C2 server"}, {"ScreenshotName": "MS-16.A.1-1.png", "ScreenshotCaption": "Specific Behavior alert for brute force attempt to remote SMB shares"}, {"ScreenshotName": "MS-16.A.1-5.png", "ScreenshotCaption": "System access history from CodeRed to Nimda and Morris"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for sensitive administrative shares mapping with unexpected parent.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-16.A.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) as local Kmitnick (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.A.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) as domain user Frieda (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.A.1-3.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) as domain user Bob (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.A.1-4.png", "ScreenshotCaption": "General Behavior alert for a sensitive administrative shares mapping with unexpected parent"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed repeated logon attempts via net.exe and command-line arguments indicative of password spraying. The telemetry was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-16.A.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) as local Kmitnick (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.A.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) as domain user Frieda (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.A.1-3.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) as domain user Bob (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.A.1-4.png", "ScreenshotCaption": "General Behavior alert for a sensitive administrative shares mapping with unexpected parent"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed repeated logon attempts via net.exe and command-line arguments indicative of password spraying.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-16-1.png", "ScreenshotCaption": "Telemetry showing logon attempts via net.exe and command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed repeated logon attempts via net.exe and command-line arguments indicative of password spraying. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID). The log files showed an exit code of 0x2 which indicates a logon failure, but does not differentiate between bad credentials and access denied to resource.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-16.A.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempts and corresponding exit codes"}, {"ScreenshotName": "S1-16.A.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempts (tainted by relationship to threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "16.A.1", "Procedure": "Empire: Brute force password spraying attempts targeted Windows admin shares on Morris (10.0.1.4) and Nimda (10.0.1.6)", "Techniques": [{"TechniqueId": "T1077", "TechniqueName": "Windows Admin Shares", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "Specific Behavior alerts titled \"Windows Admin Shares - Lateral Movement\" were generated for credential accesses specifically targeting admin shares.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-16.A.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with four different net.exe logon attempts targeting ADMIN$"}, {"ScreenshotName": "CB-16.A.1-3.png", "ScreenshotCaption": "Specific Behavior alerts for of the 4 different net.exe logon attempts"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a process tree containing repeated logon attempts via net.exe targeting ADMIN$.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-16.A.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with four different net.exe logon attempts targeting ADMIN$"}, {"ScreenshotName": "CB-16.A.1-3.png", "ScreenshotCaption": "Specific Behavior alerts for of the 4 different net.exe logon attempts"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "OverWatch generated General Behavior alerts indicating the net use commands attempting logon to ADMIN$ shares were suspicious. The alerts were tainted by a parent powershell.exe detection.[CS1]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "CS-16.A.1-2.png", "ScreenshotCaption": "Process tree view of OverWatch General Behavior alerts indicating net.exe commands were suspicious (net.exe command details not specifically shown, tainted by previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-16.A.1-1.png", "ScreenshotCaption": "Telemetry showing net use logon attempts to ADMIN$ shares"}, {"ScreenshotName": "CS-E-10.png", "ScreenshotCaption": "Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally to access network resources (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team also sent an email indicating a General Behavior was observed because the user Bob attempted to move laterally to access resources on the network.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-16.A.1-2.png", "ScreenshotCaption": "Process tree view of OverWatch General Behavior alerts indicating net.exe commands were suspicious (net.exe command details not specifically shown, tainted by previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-16.A.1-1.png", "ScreenshotCaption": "Telemetry showing net use logon attempts to ADMIN$ shares"}, {"ScreenshotName": "CS-E-10.png", "ScreenshotCaption": "Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally to access network resources (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed repeated logon attempts via net.exe with command-line arguments targeting ADMIN$ shares on the machines 10.0.1.4 (Morris) and 10.0.1.6 (Nimda).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-16.A.1-2.png", "ScreenshotCaption": "Process tree view of OverWatch General Behavior alerts indicating net.exe commands were suspicious (net.exe command details not specifically shown, tainted by previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-16.A.1-1.png", "ScreenshotCaption": "Telemetry showing net use logon attempts to ADMIN$ shares"}, {"ScreenshotName": "CS-E-10.png", "ScreenshotCaption": "Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally to access network resources (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for net.exe attempting to mount an administrative share. The alert was tagged with the correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) in addition to labeling net.exe as having a High Internal Outgoing Embryonic Connection Rate (meaning 25% of the internal network connections did not receive a response). The alert was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-16.A.1-10.png", "ScreenshotCaption": "Enrichment of net.exe execution with related ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.A.1-2.png", "ScreenshotCaption": "Enrichment of net.exe execution showing logon attempts for the user Frieda with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.A.1-3.png", "ScreenshotCaption": "Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.A.1-20.png", "ScreenshotCaption": "Enrichment of net.exe execution showing logon attempts for the user Bob with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed net.exe executing with command-line arguments.[CR3]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-16.A.1-10.png", "ScreenshotCaption": "Enrichment of net.exe execution with related ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.A.1-2.png", "ScreenshotCaption": "Enrichment of net.exe execution showing logon attempts for the user Frieda with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.A.1-3.png", "ScreenshotCaption": "Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.A.1-20.png", "ScreenshotCaption": "Enrichment of net.exe execution showing logon attempts for the user Bob with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}], "Footnotes": [" For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was triggered for each individual net.exe connection with a tag titled Lateral Movement via \"Mounting Hidden Shares\" (tainted by parent PowerShell alert).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-16-1.png", "ScreenshotCaption": "Specific Behavior alert for Mounting Hidden Shares, associated with each net.exe connection attempt (tainted by parent PowerShell alert)"}, {"ScreenshotName": "EG-16-2.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe connection events with the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert). [EG11]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-16-1.png", "ScreenshotCaption": "Specific Behavior alert for Mounting Hidden Shares, associated with each net.exe connection attempt (tainted by parent PowerShell alert)"}, {"ScreenshotName": "EG-16-2.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed repeated logon attempts targeting ADMIN$ via net.exe and command-line arguments. [EG11]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-16-1.png", "ScreenshotCaption": "Specific Behavior alert for Mounting Hidden Shares, associated with each net.exe connection attempt (tainted by parent PowerShell alert)"}, {"ScreenshotName": "EG-16-2.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "Specific Behavior alerts were generated for net.exe connecting to a remote administrative share.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-16.A.1-2.png", "ScreenshotCaption": "Telemetry showing net use logon attempts to ADMIN$ shares"}, {"ScreenshotName": "CC-16.A.1-1.png", "ScreenshotCaption": "Specific Behavior alerts for net.exe connecting to a remote administrative share"}, {"ScreenshotName": "CC-16.A.1-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}, {"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-16.A.1-2.png", "ScreenshotCaption": "Telemetry showing net use logon attempts to ADMIN$ shares"}, {"ScreenshotName": "CC-16.A.1-1.png", "ScreenshotCaption": "Specific Behavior alerts for net.exe connecting to a remote administrative share"}, {"ScreenshotName": "CC-16.A.1-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed repeated logon attempts targeting ADMIN$ via net.exe and command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-16.A.1-2.png", "ScreenshotCaption": "Telemetry showing net use logon attempts to ADMIN$ shares"}, {"ScreenshotName": "CC-16.A.1-1.png", "ScreenshotCaption": "Specific Behavior alerts for net.exe connecting to a remote administrative share"}, {"ScreenshotName": "CC-16.A.1-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with an alert for Net Use Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement). The four events were included under the same alert.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-16.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Use Command Execution alert (tagged with correct ATT&CK Technique T1077 - Windows Admin Shares, and Tactic, Lateral Movement) for user Frieda"}, {"ScreenshotName": "FE-16.A.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with Net Use Command Execution alert (tagged with correct ATT&CK Technique T1077 - Windows Admin Shares, and Tactic, Lateral Movement) for user Bob"}, {"ScreenshotName": "FE-16.A.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with Net Use Command Execution alert (tagged with correct ATT&CK Technique T1077 - Windows Admin Shares, and Tactic, Lateral Movement) for user Kmitnick"}, {"ScreenshotName": "FE-16.A.1-4.png", "ScreenshotCaption": "Enrichment of net.exe with Net Use Command Execution alert (tagged with correct ATT&CK Technique T1077 - Windows Admin Shares, and Tactic, Lateral Movement) for user Kmitnick"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched individual net.exe logon attempts targeting ADMIN$ with the condition \\\"Net User Reconnaissance Command\\\". The enrichment was tainted by the parent \\\"Powershell executed remote commands\\\" alert.[CT5]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-16.A.1-1.png", "ScreenshotCaption": "Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) with user Kmitnick (enriched with condition \\\"Net User Reconnaissance Command\\\", tainted by the parent \\\"Powershell executed encoded commands\\\" alert)"}, {"ScreenshotName": "CT-16.A.1-2.png", "ScreenshotCaption": "Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Kmitnick (enriched with condition \\\"Net User Reconnaissance Command\\\", tainted by the parent \\\"Powershell executed encoded commands\\\" alert)"}, {"ScreenshotName": "CT-16.A.1-3.png", "ScreenshotCaption": "Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Bob (enriched with condition \\\"Net User Reconnaissance Command\\\", tainted by the parent \\\"Powershell executed encoded commands\\\" alert)"}, {"ScreenshotName": "CT-16.A.1-4.png", "ScreenshotCaption": "Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Frieda (enriched with condition \\\"Net User Reconnaissance Command\\\", tainted by the parent \\\"Powershell executed encoded commands\\\" alert)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing repeated logon attempts targeting ADMIN$ via net.exe. The telemetry was tainted by a trace detection on powershell.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-16.A.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing repeated logon attempts targeting ADMIN$ via net.exe (tainted by a parent alert on powershell.exe)"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A delayed Specific Behavior alert was generated based on brute force attempt by accessing remote SMB shares with different accounts.[MS16]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "MS-16.A.1-6.png", "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"}, {"ScreenshotName": "MS-16.A.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"}, {"ScreenshotName": "MS-16.A.1-3.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"}, {"ScreenshotName": "MS-16.A.1-4.png", "ScreenshotCaption": "Execution sequence showing net.exe logon failure to Morris due to WebDAV fallback authentication attempt over port 80 to the C2 server"}, {"ScreenshotName": "MS-16.A.1-1.png", "ScreenshotCaption": "Specific Behavior alert for brute force attempt to remote SMB shares"}], "Footnotes": ["The alert spans multiple login attempts."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed repeated logon attempts to ADMIN$ via net.exe with command-line arguments (tainted by parent alert on PowerShell script with suspicious content). Telemetry also showed failed authorization attempts due to bad passwords as indicated by a fallback request over WebDAV to port 80 on the C2 server, but did not indicate the two failed access attempts on Morris and Conficker that were due to the accounts having insufficient access on the systems.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-16.A.1-6.png", "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"}, {"ScreenshotName": "MS-16.A.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"}, {"ScreenshotName": "MS-16.A.1-3.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"}, {"ScreenshotName": "MS-16.A.1-4.png", "ScreenshotCaption": "Execution sequence showing net.exe logon failure to Morris due to WebDAV fallback authentication attempt over port 80 to the C2 server"}, {"ScreenshotName": "MS-16.A.1-1.png", "ScreenshotCaption": "Specific Behavior alert for brute force attempt to remote SMB shares"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for a net.exe logon attempt to ADMIN$. The alert was tagged with the correct ATT&CK Technique (Windows Admin Shares).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-16.A.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) as domain user Frieda (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.A.1-3.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) as domain user Bob (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.A.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) as local user Kmitnick (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.A.1-5.png", "ScreenshotCaption": "Specific Behavior alert for a net.exe logon attempt to ADMIN$ tagged with the correct ATT&CK Technique (Windows Admin Shares)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed repeated logon attempts via net.exe and command-line arguments indicative of password spraying. The telemetry was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-16.A.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) as domain user Frieda (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.A.1-3.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) as domain user Bob (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.A.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) as local user Kmitnick (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.A.1-5.png", "ScreenshotCaption": "Specific Behavior alert for a net.exe logon attempt to ADMIN$ tagged with the correct ATT&CK Technique (Windows Admin Shares)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed repeated logon attempts targeting ADMIN$ via net.exe and command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-16-1.png", "ScreenshotCaption": "Telemetry showing logon attempts targeting ADMIN$ via net.exe and command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed repeated logon attempts targeting ADMIN$ via net.exe and command-line arguments. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID). The log files showed an exit code of 0x2 which indicates a logon failure, but does not differentiate between bad credentials and access denied to resource.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-16.A.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempts targeting ADMIN$ (tainted by relationship to threat story)"}, {"ScreenshotName": "S1-16.A.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempts targeting ADMIN$ and corresponding exit codes"}], "Footnotes": []}]}]}]}, {"Substep": "16.B.1", "Procedure": "Empire: 'net use' via PowerShell to successfully authenticate to Conficker (10.0.0.5) using credentials of user Kmitnick", "Techniques": [{"TechniqueId": "T1078", "TechniqueName": "Valid Accounts", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a process tree containing a successful logon via net.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-16.B.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with five different net.exe logon attempts, including a success"}, {"ScreenshotName": "CB-16.B.1-2.png", "ScreenshotCaption": "Telemetry showing successful logon via net.exe"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "OverWatch generated a General Behavior alert indicating the successful net use connection was suspicious. The alert was tainted by a parent powershell.exe detection.[CS1]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "CS-16.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing successful net.exe connection using valid credentials of Kmitnick (tainted by previous powershell.exe detection by red line indicating high severity. The vendor noted the process tree view and severities change as detections occur.)"}, {"ScreenshotName": "CS-16.B.1-2.png", "ScreenshotCaption": "OverWatch General Behavior alert indicating successful net use connection by Kmitnick was suspicious (would be tainted by previous powershell.exe detection by orange line indicating medium severity in process tree view that is not shown)"}], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a logon attempt via net.exe with command-line arguments to connect using the valid credentials of user Kmitnick (following multiple failed net use attempts). The telemetry was tainted by a parent powershell.exe detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-16.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing successful net.exe connection using valid credentials of Kmitnick (tainted by previous powershell.exe detection by red line indicating high severity. The vendor noted the process tree view and severities change as detections occur.)"}, {"ScreenshotName": "CS-16.B.1-2.png", "ScreenshotCaption": "OverWatch General Behavior alert indicating successful net use connection by Kmitnick was suspicious (would be tainted by previous powershell.exe detection by orange line indicating medium severity in process tree view that is not shown)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched a logon attempt via net.exe, using the valid credentials of user Kmitnick, with a related ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) in addition to labeling net.exe as having a High Internal Outgoing Embryonic Connection Rate (meaning 25% of the internal network connections did not receive a response). The data was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-16.B.1-20.png", "ScreenshotCaption": "Enrichment of a logon attempt via net.exe using the valid credentials of user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed net.exe executing with command-line arguments. [CR5]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-16.B.1-20.png", "ScreenshotCaption": "Enrichment of a logon attempt via net.exe using the valid credentials of user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}], "Footnotes": [" The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe connection events with a related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert). [EG11]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-16-3.png", "ScreenshotCaption": "Enrichment of successful net.exe connection (tainted by parent PowerShell alert)"}, {"ScreenshotName": "EG-16-7.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the net.exe connection using valid credentials for Kmitnick with a tag titled Lateral Movement via \\\"Mounting Hidden Shares\\\" (tainted by parent PowerShell alert).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-16-3.png", "ScreenshotCaption": "Enrichment of successful net.exe connection (tainted by parent PowerShell alert)"}, {"ScreenshotName": "EG-16-7.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a logon attempt via net.exe and command-line arguments using valid credentials for user Kmitnick (tainted by parent PowerShell alert). [EG11]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-16-3.png", "ScreenshotCaption": "Enrichment of successful net.exe connection (tainted by parent PowerShell alert)"}, {"ScreenshotName": "EG-16-7.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a logon attempt via net.exe with command-line arguments to connect using the valid credentials of user Kmitnick. Telemetry also showed a logon event for user Kmitnick on Conficker (10.0.0.5).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-16.C.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempt"}, {"ScreenshotName": "CC-16.C.1-2.png", "ScreenshotCaption": "Telemetry showing a logon event for user Kmitnick on Conficker (10.0.0.5)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched a logon attempt via net.exe using valid credentials for user Kmitnick with an alert for Net Use Command Execution (Weak Signal). The password for Kmitnick was redacted within the capability. [FE10]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-16.B.1-1.png", "ScreenshotCaption": "Enrichment of net.exe logon attempt by Kmitnick with Net Use Command Execution alert"}, {"ScreenshotName": "FE-16.B.1-2.png", "ScreenshotCaption": "Telemetry showing successful logon of user Kmitnick"}], "Footnotes": [" The vendor indicated the un-redacted passwords could be observed in triage/acquistion data."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the successful logon for the user Kmitnick.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-16.B.1-1.png", "ScreenshotCaption": "Enrichment of net.exe logon attempt by Kmitnick with Net Use Command Execution alert"}, {"ScreenshotName": "FE-16.B.1-2.png", "ScreenshotCaption": "Telemetry showing successful logon of user Kmitnick"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a logon attempt via net.exe with command-line arguments to connect using the valid credentials of user Kmitnick. The telemetry was tainted by the parent \"Powershell executed remote commands\" alert. Telemetry also showed explorer.exe (as the user Bob) write a PIPE on Conficker, which could indicate to an analyst that the share had been successfully mounted.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-16.B.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with the account Kmitnick (tainted by the parent \\\"Powershell executed remote commands\\\" alert)"}, {"ScreenshotName": "CT-16.B.1-2.png", "ScreenshotCaption": "Telemetry showing explorer.exe writing \\\\\\\\conficker\\\\PIPE\\\\srvsvc (tainted by the parent \\\"FileExts Registry Key modified\\\" alert)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a logon attempt via net.exe with command-line arguments to login using the valid credentials of user Kmitnick. The telemetry was tainted by a trace detection on powershell.exe. Telemetry also showed a login event on Conficker (10.0.0.5) for user Kmitnick.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-16.A.1-3.png", "ScreenshotCaption": "Telemetry showing a logon attempt via net.exe (tainted by a parent alert on powershell.exe)"}, {"ScreenshotName": "MC-16.A.1-4.png", "ScreenshotCaption": "Telemetry showing a login event on Conficker (10.0.0.5) for user Kmitnick"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a logon attempt via net.exe with command-line arguments to connect using the valid credentials of user Kmitnick (tainted by parent alert on PowerShell script with suspicious content). Telemetry showed Kmitnick login event on 10.0.0.5 (Conficker) and that 10.0.1.5 (CodeRed) accessed resources on 10.0.0.5 (Conficker).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-16.B.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"}, {"ScreenshotName": "MS-16.A.1-6.png", "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"}, {"ScreenshotName": "MS-16.B.1-2.png", "ScreenshotCaption": "Telemetry showing user Kmitnick login activity on 10.0.0.5 (Conficker)"}, {"ScreenshotName": "MS-16.B.1-3.png", "ScreenshotCaption": "Telemetry showing 10.0.1.5 (CodeRed) system accessed resources on 10.0.0.5 (Conficker)"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched an lsass.exe event with the correct ATT&CK Technique (Valid Accounts).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-16.B.1-1.png", "ScreenshotCaption": "Telemetry showing a net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) using valid credentials for user Kmitnick (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.B.1-2.png", "ScreenshotCaption": "Telemetry showing an event for the logon credentials being validated by the DC (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.B.1-3.png", "ScreenshotCaption": "Enrichment of an lsass.exe event with the correct ATT&CK Technique (Valid Accounts)."}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) using valid credentials for user Kmitnick followed by an event for the credentials being validated by the DC. The telemetry was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-16.B.1-1.png", "ScreenshotCaption": "Telemetry showing a net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) using valid credentials for user Kmitnick (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.B.1-2.png", "ScreenshotCaption": "Telemetry showing an event for the logon credentials being validated by the DC (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.B.1-3.png", "ScreenshotCaption": "Enrichment of an lsass.exe event with the correct ATT&CK Technique (Valid Accounts)."}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a logon attempt via net.exe and command-line arguments using valid credentials of user Kmitnick.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-16-2.png", "ScreenshotCaption": "Telemetry showing logon attempts via net.exe using valid credentials of user Kmitnick"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a logon attempt using valid credentials of user Kmitnick via net.exe and command-line arguments (tainted by relationship to threat story). The log files showed an exit code of 0x2 which indicates a logon failure, but does not differentiate between bad credentials and access denied to resource.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-16.B.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempts, the last of which using valid credentials for user Kmitnick (tainted by relationship to threat story)"}, {"ScreenshotName": "S1-16.A.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempts and corresponding exit codes"}], "Footnotes": []}]}]}]}, {"Substep": "16.B.1", "Procedure": "Empire: Successful authentication targeted Windows admin share on Conficker (10.0.0.5)\u00ef\u00bf\u00bd", "Techniques": [{"TechniqueId": "T1077", "TechniqueName": "Windows Admin Shares", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "Specific Behavior alerts were generated mapped to the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) for successful logons.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-16.B.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with five different net.exe logon attempts targeting ADMIN$"}, {"ScreenshotName": "CB-16.B.1-2.png", "ScreenshotCaption": "Specific Behavior alerts for a successful logon mapped to the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a process tree containing repeated logon attempts via net.exe targeting ADMIN$, eventually resulting in a successful logon.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-16.B.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with five different net.exe logon attempts targeting ADMIN$"}, {"ScreenshotName": "CB-16.B.1-2.png", "ScreenshotCaption": "Specific Behavior alerts for a successful logon mapped to the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "OverWatch generated a General Behavior alert indicating the successful net use connection to ADMIN$ was suspicious. The alert was tainted by a parent powershell.exe detection.[CS1]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "CS-E-10.png", "ScreenshotCaption": "Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally to access network resources (General Behavior)"}, {"ScreenshotName": "CS-16.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing successful net use connection to ADMIN$ (tainted by previous powershell.exe detection by red line indicating high severity. The vendor noted the process tree view and severities change as detections occur.)"}, {"ScreenshotName": "CS-16.B.1-2.png", "ScreenshotCaption": "OverWatch General Behavior alert indicating successful net use connection to ADMIN$ was suspicious (would be tainted by previous powershell.exe detection by orange line indicating medium severity in process tree view that is not shown)"}], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team also sent an email indicating a General Behavior was observed because the user Bob attempted to move laterally to access resources on the network.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-E-10.png", "ScreenshotCaption": "Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally to access network resources (General Behavior)"}, {"ScreenshotName": "CS-16.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing successful net use connection to ADMIN$ (tainted by previous powershell.exe detection by red line indicating high severity. The vendor noted the process tree view and severities change as detections occur.)"}, {"ScreenshotName": "CS-16.B.1-2.png", "ScreenshotCaption": "OverWatch General Behavior alert indicating successful net use connection to ADMIN$ was suspicious (would be tainted by previous powershell.exe detection by orange line indicating medium severity in process tree view that is not shown)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a logon attempt via net.exe with command-line arguments to connect to ADMIN$ on 10.0.0.5 (Conficker) as the user Kmitnick (following multiple failed net use attempts). The telemetry was tainted by a previous powershell.exe detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-E-10.png", "ScreenshotCaption": "Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally to access network resources (General Behavior)"}, {"ScreenshotName": "CS-16.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing successful net use connection to ADMIN$ (tainted by previous powershell.exe detection by red line indicating high severity. The vendor noted the process tree view and severities change as detections occur.)"}, {"ScreenshotName": "CS-16.B.1-2.png", "ScreenshotCaption": "OverWatch General Behavior alert indicating successful net use connection to ADMIN$ was suspicious (would be tainted by previous powershell.exe detection by orange line indicating medium severity in process tree view that is not shown)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for net.exe attempting to mount an administrative share. The alert was tagged with the correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) in addition to labeling net.exe as having a High Internal Outgoing Embryonic Connection Rate (meaning 25% of the internal network connections did not receive a response). The alert was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-16.B.1-20.png", "ScreenshotCaption": "Specific Behavior alert of net.exe execution with correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) (tainted by a parent PowerShell alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed net.exe executing with command-line arguments.[CR3]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-16.B.1-20.png", "ScreenshotCaption": "Specific Behavior alert of net.exe execution with correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) (tainted by a parent PowerShell alert)"}], "Footnotes": [" For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was triggered for each individual net.exe connection with a tag titled Lateral Movement via \"Mounting Hidden Shares\" (tainted by parent PowerShell alert).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-16-3.png", "ScreenshotCaption": "Specific Behavior alert for Mounting Hidden Shares for the successful net.exe connection attempt (tainted by parent PowerShell alert)"}, {"ScreenshotName": "EG-16-7.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe connection events with the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert). [EG11]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-16-3.png", "ScreenshotCaption": "Specific Behavior alert for Mounting Hidden Shares for the successful net.exe connection attempt (tainted by parent PowerShell alert)"}, {"ScreenshotName": "EG-16-7.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed logon attempt targeting ADMIN$ via net.exe and command-line arguments. [EG11]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-16-3.png", "ScreenshotCaption": "Specific Behavior alert for Mounting Hidden Shares for the successful net.exe connection attempt (tainted by parent PowerShell alert)"}, {"ScreenshotName": "EG-16-7.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "Specific Behavior alerts were generated for net.exe connecting to a remote administrative share.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-16.C.1-1.png", "ScreenshotCaption": "Telemetry showing a net use logon attempt to ADMIN$ shares"}, {"ScreenshotName": "CC-16.B.1-2.png", "ScreenshotCaption": "Specific Behavior alerts for net.exe connecting to a remote administrative share"}, {"ScreenshotName": "CC-16.B.1-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}, {"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-16.C.1-1.png", "ScreenshotCaption": "Telemetry showing a net use logon attempt to ADMIN$ shares"}, {"ScreenshotName": "CC-16.B.1-2.png", "ScreenshotCaption": "Specific Behavior alerts for net.exe connecting to a remote administrative share"}, {"ScreenshotName": "CC-16.B.1-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed repeated logon attempts targeting ADMIN$ via net.exe and command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-16.C.1-1.png", "ScreenshotCaption": "Telemetry showing a net use logon attempt to ADMIN$ shares"}, {"ScreenshotName": "CC-16.B.1-2.png", "ScreenshotCaption": "Specific Behavior alerts for net.exe connecting to a remote administrative share"}, {"ScreenshotName": "CC-16.B.1-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that the attacker accessed Conficker by mounting the ADMIN$ share. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-16.B.1-1.png", "ScreenshotCaption": "Enrichment of net.exe logon attempt to ADMIN$ with Net Use Command Execution alert (tagged with the correct ATT&CK Technique, 1077 - Windows Admin Shares, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-16.B.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker accessed Conficker by mounting the ADMIN$ share (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched a logon attempt via net.exe with an alert for Net Use Command Execution (Weak Signal). The alert details showed net.exe with command-line arguments targeting ADMIN$ using valid credentials for user Kmitnick. The alert was also tagged with the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-16.B.1-1.png", "ScreenshotCaption": "Enrichment of net.exe logon attempt to ADMIN$ with Net Use Command Execution alert (tagged with the correct ATT&CK Technique, 1077 - Windows Admin Shares, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-16.B.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker accessed Conficker by mounting the ADMIN$ share (Specific Behavior)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a logon attempt via net.exe with command-line arguments targeting ADMIN$ using valid credentials for user Kmitnick. Telemetry also showed explorer.exe (as the user Bob) write a PIPE on Conficker, which could indicate to an analyst that the share had been successfully mounted (tainted by the parent FileExts Registry Key modified alert).[CT5]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-16.B.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with the account Kmitnick (tainted by the parent \\\"Powershell executed remote commands\\\" alert)"}, {"ScreenshotName": "CT-16.B.1-2.png", "ScreenshotCaption": "Telemetry showing explorer.exe writing \\\\\\\\conficker\\\\PIPE\\\\srvsvc (tainted by the parent \\\"FileExts Registry Key modified\\\" alert)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for the net utility executed to authenticate to a remote admin share with valid accounts. The alert was tagged with the correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-16.A.1-3.png", "ScreenshotCaption": "Telemetry showing a logon attempt via net.exe (tainted by a parent alert on powershell.exe)"}, {"ScreenshotName": "MC-16.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert for the net utility executed to authenticate to a remote admin share with valid accounts, tagged with the correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a logon attempt via net.exe to ADMIN$ with command-line arguments to login using the valid credentials of user Kmitnick. The telemetry was tainted by a trace detection on powershell.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-16.A.1-3.png", "ScreenshotCaption": "Telemetry showing a logon attempt via net.exe (tainted by a parent alert on powershell.exe)"}, {"ScreenshotName": "MC-16.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert for the net utility executed to authenticate to a remote admin share with valid accounts, tagged with the correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares)"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A delayed Specific Behavior alert was generated based on brute force attempt by accessing remote SMB shares with different accounts.[MS17]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "MS-16.B.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"}, {"ScreenshotName": "MS-16.A.1-6.png", "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"}, {"ScreenshotName": "MS-16.A.1-1.png", "ScreenshotCaption": "Specific Behavior alert for brute force attempt to remote SMB shares"}], "Footnotes": ["The alert spans multiple login attempts."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a logon attempt via net.exe with command-line arguments targeting ADMIN$ using valid credentials for user Kmitnick (tainted by parent alert on PowerShell script with suspicious content).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-16.B.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"}, {"ScreenshotName": "MS-16.A.1-6.png", "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"}, {"ScreenshotName": "MS-16.A.1-1.png", "ScreenshotCaption": "Specific Behavior alert for brute force attempt to remote SMB shares"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) as local Kmitnick. The telemetry was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-16.B.1-1.png", "ScreenshotCaption": "Telemetry showing a net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) as local user Kmitnick (tainted by a parent alert on wscript.exe)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a logon attempt via net.exe and command-line arguments targeting ADMIN$ via net.exe and command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-16-2.png", "ScreenshotCaption": "Telemetry showing logon attempt targeting ADMIN$ via net.exe and command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a logon attempt via net.exe and command-line arguments targeting ADMIN$ via net.exe and command-line arguments. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID). The log files showed an exit code of 0x2 which indicates a logon failure, but does not differentiate between bad credentials and access denied to resource.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-16.A.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempts and corresponding exit codes"}, {"ScreenshotName": "S1-16.B.1-1.png", "ScreenshotCaption": "Telemetry showing a net.exe logon attempt targeting ADMIN$ (tainted by relationship to threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "16.B.1", "Procedure": "Empire: Successful authentication to Conficker (10.0.0.5) using credentials of user Kmitnick as a result of the brute force password spraying", "Techniques": [{"TechniqueId": "T1110", "TechniqueName": "Brute Force", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched individual net.exe events with tagging titled \\\"Credential Access using Admin Shares - Failed Attempts\\\" for failures as well as a related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) for successful logons. [CB8]", "Modifiers": ["Configuration Change"], "Screenshots": [{"ScreenshotName": "CB-16.B.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with five different net.exe logon attempts, including a success"}, {"ScreenshotName": "CB-16.B.1-2.png", "ScreenshotCaption": "Enrichment of the individual net.exe logon attempts, successful logons mapped to related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement)"}], "Footnotes": ["The capability was modified after the start of the evaluation enabling enrichment to appear, so the detection is identified as a configuration change."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a process tree containing repeated logon attempts via net.exe and command-line arguments indicative of password spraying, eventually resulting in a successful logon.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-16.B.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with five different net.exe logon attempts, including a success"}, {"ScreenshotName": "CB-16.B.1-2.png", "ScreenshotCaption": "Enrichment of the individual net.exe logon attempts, successful logons mapped to related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "OverWatch generated a General Behavior alert indicating the successful net use connection was suspicious. The alert was tainted by a parent powershell.exe detection.[CS1]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "CS-16.B.1-2.png", "ScreenshotCaption": "OverWatch General Behavior alert indicating successful net use connection by Kmitnick was suspicious (would be tainted by previous powershell.exe detection by orange line indicating medium severity in process tree view that is not shown)"}, {"ScreenshotName": "CS-E-10.png", "ScreenshotCaption": "Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally (General Behavior)"}, {"ScreenshotName": "CS-16.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing successful net.exe connection by Kmitnick (tainted by previous powershell.exe detection by red line indicating high severity. The vendor noted the process tree view and severities change as detections occur.)"}], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team also sent an email indicating a General Behavior was observed because the user Bob attempted to move laterally using several accounts.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-16.B.1-2.png", "ScreenshotCaption": "OverWatch General Behavior alert indicating successful net use connection by Kmitnick was suspicious (would be tainted by previous powershell.exe detection by orange line indicating medium severity in process tree view that is not shown)"}, {"ScreenshotName": "CS-E-10.png", "ScreenshotCaption": "Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally (General Behavior)"}, {"ScreenshotName": "CS-16.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing successful net.exe connection by Kmitnick (tainted by previous powershell.exe detection by red line indicating high severity. The vendor noted the process tree view and severities change as detections occur.)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed net.exe executing with command-line arguments to connect as the user Kmitnick (following multiple failed net use attempts). The telemetry was tainted by a parent powershell.exe detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-16.B.1-2.png", "ScreenshotCaption": "OverWatch General Behavior alert indicating successful net use connection by Kmitnick was suspicious (would be tainted by previous powershell.exe detection by orange line indicating medium severity in process tree view that is not shown)"}, {"ScreenshotName": "CS-E-10.png", "ScreenshotCaption": "Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally (General Behavior)"}, {"ScreenshotName": "CS-16.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing successful net.exe connection by Kmitnick (tainted by previous powershell.exe detection by red line indicating high severity. The vendor noted the process tree view and severities change as detections occur.)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe execution with a related ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) in addition to labeling net.exe as having a High Internal Outgoing Embryonic Connection Rate (meaning 25% of the internal network connections did not receive a response). The data was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-16.B.1-20.png", "ScreenshotCaption": "Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed net.exe executing with command-line arguments. [CR5]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-16.B.1-20.png", "ScreenshotCaption": "Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}], "Footnotes": [" The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched each individual net.exe connection with a tag titled Lateral Movement via \\\"Mounting Hidden Shares\\\" (tainted by parent PowerShell alert).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-16-7.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)"}, {"ScreenshotName": "EG-16-3.png", "ScreenshotCaption": "Enrichment of successful net.exe connection with \\\"Mounting Hidden Share\\\" and Lateral Movement tags (tainted by parent PowerShell alert)"}, {"ScreenshotName": "EG-16-4.png", "ScreenshotCaption": "Telemetry showing event tree with all 5 net commands associated with brute force failures and eventual success (tainted by parent PowerShell alert)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe connection events with a related ATT&CK Technique (T1077 - Windows Admin Shares) and \u00a0Tactics (Execution, Lateral Movement). [EG11]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-16-7.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)"}, {"ScreenshotName": "EG-16-3.png", "ScreenshotCaption": "Enrichment of successful net.exe connection with \\\"Mounting Hidden Share\\\" and Lateral Movement tags (tainted by parent PowerShell alert)"}, {"ScreenshotName": "EG-16-4.png", "ScreenshotCaption": "Telemetry showing event tree with all 5 net commands associated with brute force failures and eventual success (tainted by parent PowerShell alert)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed repeated logon attempts via net.exe and command-line arguments indicative of password spraying, eventually resulting in a successful logon (tainted by parent PowerShell alert). [EG11]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-16-7.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)"}, {"ScreenshotName": "EG-16-3.png", "ScreenshotCaption": "Enrichment of successful net.exe connection with \\\"Mounting Hidden Share\\\" and Lateral Movement tags (tainted by parent PowerShell alert)"}, {"ScreenshotName": "EG-16-4.png", "ScreenshotCaption": "Telemetry showing event tree with all 5 net commands associated with brute force failures and eventual success (tainted by parent PowerShell alert)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched multiple occurrences of net.exe usage as indicative of brute forcing a remote system as well as the correct ATT&CK Technique ID (Brute Force). [CC3]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-16.C.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempt"}], "Footnotes": ["Screenshot is not available due to sensitivity of rule logic."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a logon attempt via net.exe with command-line arguments to connect using the valid credentials of user Kmitnick.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-16.C.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempt"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe with an alert for Net Use Command Execution (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-16.B.1-2.png", "ScreenshotCaption": "Telemetry showing successful logon of user Kmitnick"}, {"ScreenshotName": "FE-16.B.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Use Command Execution alert (tagged with related ATT&CK Technique T1077 - Windows Admin Shares, and Tactic, Lateral Movement)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the successful logon for the user Kmitnick.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-16.B.1-2.png", "ScreenshotCaption": "Telemetry showing successful logon of user Kmitnick"}, {"ScreenshotName": "FE-16.B.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Use Command Execution alert (tagged with related ATT&CK Technique T1077 - Windows Admin Shares, and Tactic, Lateral Movement)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched a net.exe logon attempt targeting ADMIN$ with the condition \\\"Net User Reconnaissance Command\\\". The enrichment was tainted by the parent \\\"Powershell executed remote commands\\\" alert.[CT5]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-16.B.1-2.png", "ScreenshotCaption": "Telemetry showing explorer.exe writing \\\\\\\\conficker\\\\PIPE\\\\srvsvc (tainted by the parent \\\"FileExts Registry Key modified\\\" alert)"}, {"ScreenshotName": "CT-16.B.1-1.png", "ScreenshotCaption": "Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with the account Kmitnick (enriched with condition \\\"Net User Reconnaissance Command\\\", tainted by the parent \\\"Powershell executed remote commands\\\" alert)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry also showed explorer.exe (as the user Bob) write a PIPE on Conficker, which could indicate to an analyst that the share had been successfully mounted (tainted by the parent FileExts Registry Key modified alert).[CT5]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-16.B.1-2.png", "ScreenshotCaption": "Telemetry showing explorer.exe writing \\\\\\\\conficker\\\\PIPE\\\\srvsvc (tainted by the parent \\\"FileExts Registry Key modified\\\" alert)"}, {"ScreenshotName": "CT-16.B.1-1.png", "ScreenshotCaption": "Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with the account Kmitnick (enriched with condition \\\"Net User Reconnaissance Command\\\", tainted by the parent \\\"Powershell executed remote commands\\\" alert)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for powershell.exe performing a potential brute force password hack via the net utility.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-16.A.1-3.png", "ScreenshotCaption": "Telemetry showing a logon attempt via net.exe (tainted by a parent alert on powershell.exe)"}, {"ScreenshotName": "MC-16.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert for powershell.exe performing a potential brute force password hack via the net utility"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a logon attempt via net.exe with command-line arguments to login using the valid credentials of user Kmitnick. The telemetry was tainted by a trace detection on powershell.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-16.A.1-3.png", "ScreenshotCaption": "Telemetry showing a logon attempt via net.exe (tainted by a parent alert on powershell.exe)"}, {"ScreenshotName": "MC-16.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert for powershell.exe performing a potential brute force password hack via the net utility"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated based on brute force attempt by accessing remote SMB shares with different accounts.[MS17]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "MS-16.B.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"}, {"ScreenshotName": "MS-16.A.1-6.png", "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"}, {"ScreenshotName": "MS-16.A.1-1.png", "ScreenshotCaption": "Specific Behavior alert for brute force attempt to remote SMB shares"}], "Footnotes": ["The alert spans multiple login attempts."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed repeated logon attempts via net.exe with command-line arguments indicative of password spraying, eventually resulting in a successful logon (tainted by parent alert on PowerShell script with suspicious content).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-16.B.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"}, {"ScreenshotName": "MS-16.A.1-6.png", "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"}, {"ScreenshotName": "MS-16.A.1-1.png", "ScreenshotCaption": "Specific Behavior alert for brute force attempt to remote SMB shares"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) as local user Kmitnick followed by an event for the credentials being validated by the DC. The telemetry was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-16.B.1-2.png", "ScreenshotCaption": "Telemetry showing an event for the logon credentials being validated by the DC (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.B.1-1.png", "ScreenshotCaption": "Telemetry showing a net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) as local Kmitnick (tainted by a parent alert on wscript.exe)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed repeated logon attempts via net.exe and command-line arguments indicative of password spraying, eventually resulting in a successful logon.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-16-2.png", "ScreenshotCaption": "Telemetry showing logon attempts via net.exe and command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed repeated logon attempts via net.exe and command-line arguments indicative of password spraying, eventually resulting in a successful logon. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID). The log files showed an exit code of 0x2 which indicates a logon failure, but does not differentiate between bad credentials and access denied to resource.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-16.A.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempts and corresponding exit codes"}, {"ScreenshotName": "S1-16.B.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempts (tainted by relationship to threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "16.C.1", "Procedure": "Empire: 'net use -delete' via PowerShell", "Techniques": [{"TechniqueId": "T1126", "TechniqueName": "Network Share Connection Removal", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated indicating that a connected network share was removed.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-16.C.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with net.exe and command-line arguments"}, {"ScreenshotName": "CB-16.B.1-2.png", "ScreenshotCaption": "Specific Behavior alerts for removing connected network share"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a process tree containing net.exe and command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-16.C.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with net.exe and command-line arguments"}, {"ScreenshotName": "CB-16.B.1-2.png", "ScreenshotCaption": "Specific Behavior alerts for removing connected network share"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team sent an email indicating a General Behavior was observed because the user Bob removed an artifact for the ADMIN$ share.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-16.C.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe executing with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-10.png", "ScreenshotCaption": "Excerpt from email sent by OverWatch team indicating they observed ADMIN$ artifact removed (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed net.exe executing with command-line arguments. The telemetry was tainted by a previous powershell.exe detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-16.C.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe executing with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-10.png", "ScreenshotCaption": "Excerpt from email sent by OverWatch team indicating they observed ADMIN$ artifact removed (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-16.C.1-10.png", "ScreenshotCaption": "General Behavior alert for net.exe conducting suspicious activity (tainted by a parent PowerShell alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed net.exe executing with command-line arguments.[CR3]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-16.C.1-10.png", "ScreenshotCaption": "General Behavior alert for net.exe conducting suspicious activity (tainted by a parent PowerShell alert)"}], "Footnotes": [" For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a event tree containing net.exe and command-line arguments (tainted by parent PowerShell alert).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-16-5.png", "ScreenshotCaption": "Telemetry showing event tree containing net.exe and command-line argument (tainted by parent PowerShell alert)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-16.C.1-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}, {"ScreenshotName": "CC-16.C.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-16.C.1-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}, {"ScreenshotName": "CC-16.C.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that the attacker unmounted the share from CodeRed. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-16.C.1-1.png", "ScreenshotCaption": "Telemetry showed net.exe executing with command-line arguments."}, {"ScreenshotName": "FE-16.B.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker unmounted the share from CodeRed (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed net.exe executing with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-16.C.1-1.png", "ScreenshotCaption": "Telemetry showed net.exe executing with command-line arguments."}, {"ScreenshotName": "FE-16.B.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker unmounted the share from CodeRed (Specific Behavior)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed net.exe executing with command-line arguments (tainted by the parent \"Powershell executed remote commands\" alert).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-16.C.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe and command-line arguments (tainted by the parent \\\"Powershell executed remote commands\\\" alert)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for the net utility removing a shared connection via PowerShell. The alert was tagged with the correct ATT&CK Tactic (Defense Evasion) and Technique (Network Share Connection Removal).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-16.A.1-3.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on powershell.exe)"}, {"ScreenshotName": "MC-16.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert for the net utility removing a shared connection via PowerShell, tagged to the correct ATT&CK Tactic (Defense Evasion) and Technique (Network Share Connection Removal)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net.exe. The telemetry was tainted by a trace detection on powershell.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-16.A.1-3.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on powershell.exe)"}, {"ScreenshotName": "MC-16.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert for the net utility removing a shared connection via PowerShell, tagged to the correct ATT&CK Tactic (Defense Evasion) and Technique (Network Share Connection Removal)"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed net.exe with command-line arguments (tainted by parent alert on PowerShell script with suspicious content).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-16.A.1-6.png", "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"}, {"ScreenshotName": "MS-16.C.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by parent alert on PowerShell script with suspicious content)"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe executing with command-line arguments with the correct ATT&CK Technique (Network Share Connection Removal).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-16.C.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.C.1-2.png", "ScreenshotCaption": "Enrichment of net.exe executing with command-line arguments with the correct ATT&CK Technique (Network Share Connection Removal)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-16.C.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.C.1-2.png", "ScreenshotCaption": "Enrichment of net.exe executing with command-line arguments with the correct ATT&CK Technique (Network Share Connection Removal)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed net.exe execution and command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-16-3.png", "ScreenshotCaption": "Telemetry showing net.exe execution and command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of net.exe and command-line arguments. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-16.C.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe and command-line arguments (tainted by relationship to threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "16.D.1", "Procedure": "Empire: Successful authentication targeted Windows admin shares on Conficker (10.0.0.5)", "Techniques": [{"TechniqueId": "T1077", "TechniqueName": "Windows Admin Shares", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "Specific Behavior alerts were generated mapped to the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) for successful logons.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with successful net.exe logon targeting C$"}, {"ScreenshotName": "CB-16.D.1-2.png", "ScreenshotCaption": "Specific Behavior alerts for a successful logon mapped to the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a process tree containing a logon attempt via net.exe and command-line arguments \u00a0targeting C$ using valid account credentials.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with successful net.exe logon targeting C$"}, {"ScreenshotName": "CB-16.D.1-2.png", "ScreenshotCaption": "Specific Behavior alerts for a successful logon mapped to the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team sent an email indicating a General Behavior was observed because the user Bob attempted to move laterally to access resources on the network.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-E-10.png", "ScreenshotCaption": "Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally to access network resources (General Behavior)"}, {"ScreenshotName": "CS-16.D.1-2.png", "ScreenshotCaption": "Telemetry showing process tree containing successful net use connection to C$ (tainted by previous powershell.exe detection by red line indicating high severity)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a logon attempt via net.exe with command-line arguments to the C$ share on 10.0.0.4 (Creeper) as the user Kmitnick. The telemetry was tainted by a previous powershell.exe detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-E-10.png", "ScreenshotCaption": "Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally to access network resources (General Behavior)"}, {"ScreenshotName": "CS-16.D.1-2.png", "ScreenshotCaption": "Telemetry showing process tree containing successful net use connection to C$ (tainted by previous powershell.exe detection by red line indicating high severity)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for net.exe attempting to mount an administrative share. The alert was tagged with the correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares). The alert was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-16.D.1-100.png", "ScreenshotCaption": "Specific Behavior alert of net.exe execution with correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.D.1-10.png", "ScreenshotCaption": "Process tree showing alert net.exe execution (tainted by a parent PowerShell alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed net.exe executing with command-line arguments.[CR3]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-16.D.1-100.png", "ScreenshotCaption": "Specific Behavior alert of net.exe execution with correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.D.1-10.png", "ScreenshotCaption": "Process tree showing alert net.exe execution (tainted by a parent PowerShell alert)"}], "Footnotes": [" For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was triggered for each individual net.exe connection with a tag titled Lateral Movement via \"Mounting Hidden Shares\" (tainted by parent PowerShell alert). The alert was also tagged with \u00a0the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) .", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-16-7.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)"}, {"ScreenshotName": "EG-16-6.png", "ScreenshotCaption": "Specific Behavior alert for Mounting Hidden Shares for the successful net.exe connection attempt tagged with  correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe connection events with the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert). [EG11]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-16-7.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)"}, {"ScreenshotName": "EG-16-6.png", "ScreenshotCaption": "Specific Behavior alert for Mounting Hidden Shares for the successful net.exe connection attempt tagged with  correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed logon attempt targeting C$ via net.exe and command-line arguments. [EG11]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-16-7.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)"}, {"ScreenshotName": "EG-16-6.png", "ScreenshotCaption": "Specific Behavior alert for Mounting Hidden Shares for the successful net.exe connection attempt tagged with  correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-16.C.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-16.C.1-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a logon attempt via net.exe with command-line arguments targeting C$ on 10.0.0.4 (Creeper) using valid credentials for user Kmitnick.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-16.C.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-16.C.1-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that the attacker mounted the C$ drive on creeper with the kmitnick account. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-16.D.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker mounting the C$ on creeper with the kmitnick account (Specific Behavior)"}, {"ScreenshotName": "FE-16.D.1-1.png", "ScreenshotCaption": "Enrichment of net1.exe with Net Use Command Execution alert (tagged with correct ATT&CK Technique, T1077 - Windows Admin Shares, and Tactic, Lateral Movement)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net1.exe with an alert for Net Use Command Execution (Weak Signal). The alert also was tagged with the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-16.D.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker mounting the C$ on creeper with the kmitnick account (Specific Behavior)"}, {"ScreenshotName": "FE-16.D.1-1.png", "ScreenshotCaption": "Enrichment of net1.exe with Net Use Command Execution alert (tagged with correct ATT&CK Technique, T1077 - Windows Admin Shares, and Tactic, Lateral Movement)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a logon attempt via net.exe with command-line arguments targeting C$ on 10.0.0.4 (Creeper) using valid credentials for user Kmitnick. [CT5]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempt to C$ on 10.0.0.4 (Creeper) with valid credentials for the account Kmitnick (tainted by the parent \\\"Powershell executed remote commands\\\" alert)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for the net utility executed to authenticate to a remote admin share with valid accounts. The alert was tagged with the correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-16.D.1-9.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on powershell.exe)"}, {"ScreenshotName": "MC-16.D.1-5.png", "ScreenshotCaption": "Specific Behavior alert for the net utility removing a shared connection via PowerShell, mapped to the correct ATT&CK Tactic (Defense Evasion) and Technique (Network Share Connection Removal)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net.exe. The telemetry was tainted by a trace detection on powershell.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-16.D.1-9.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on powershell.exe)"}, {"ScreenshotName": "MC-16.D.1-5.png", "ScreenshotCaption": "Specific Behavior alert for the net utility removing a shared connection via PowerShell, mapped to the correct ATT&CK Tactic (Defense Evasion) and Technique (Network Share Connection Removal)"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a logon attempt via net.exe with command-line arguments targeting C$ using valid credentials for user Kmitnick (tainted by parent alert on PowerShell script with suspicious content).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-16.A.1-6.png", "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"}, {"ScreenshotName": "MS-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempt to C$ on 10.0.0.4 (Creeper) with valid credentials for the account Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a net.exe logon attempt to C$ on 10.0.0.4 (Creeper) using valid credentials for user Kmitnick. The telemetry was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing a net.exe logon attempt to C$ on 10.0.0.4 (Creeper) using valid credentials for user Kmitnick (tainted by a parent alert on wscript.exe)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a logon attempt via net.exe and command-line arguments targeting C$ via net.exe and command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-16-4.png", "ScreenshotCaption": "Telemetry showing logon attempt targeting C$ via net.exe and command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a logon attempt via net.exe and command-line arguments targeting C$ via net.exe and command-line arguments. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing a net.exe logon attempt targeting C$ (tainted by relationship to threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "16.D.1", "Procedure": "Empire: 'net use' via PowerShell to successfully authenticate to Creeper (10.0.0.4) using credentials of user Kmitnick", "Techniques": [{"TechniqueId": "T1078", "TechniqueName": "Valid Accounts", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a process tree containing a logon attempt via net.exe and command-line arguments using valid account credentials.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with logon using valid account credentials"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a logon attempt via net.exe with command-line arguments to the C$ share on Creeper as the user Kmitnick. The process tree view showed net.exe as tainted by a previous powershell.exe detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-16.D.1-2.png", "ScreenshotCaption": "Telemetry showing successful net use connection by Kmitnick in the process tree view (tainted by previous powershell.exe detection by red line indicating high severity)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-16.D.1-10.png", "ScreenshotCaption": "General Behavior alert for net.exe conducting suspicious activity (tainted by a parent PowerShell alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed net.exe executing with command-line arguments.[CR3]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-16.D.1-10.png", "ScreenshotCaption": "General Behavior alert for net.exe conducting suspicious activity (tainted by a parent PowerShell alert)"}], "Footnotes": [" For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched net.exe connection events with a related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert). [EG11]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-16-7.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)"}, {"ScreenshotName": "EG-16-6.png", "ScreenshotCaption": "Enrichment of successful net.exe connection (tainted by parent PowerShell alert)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the net.exe connection (using valid credentials for Kmitnick) with a tag titled Lateral Movement via \\\"Mounting Hidden Shares\\\" (tainted by parent PowerShell alert).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-16-7.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)"}, {"ScreenshotName": "EG-16-6.png", "ScreenshotCaption": "Enrichment of successful net.exe connection (tainted by parent PowerShell alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a logon attempt via net.exe and command-line arguments using valid credentials for user Kmitnick (tainted by parent PowerShell alert). [EG11]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-16-7.png", "ScreenshotCaption": "Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)"}, {"ScreenshotName": "EG-16-6.png", "ScreenshotCaption": "Enrichment of successful net.exe connection (tainted by parent PowerShell alert)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the net.exe connection using valid credentials of Kmitnick with an alert for possible lateral movement.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-16.C.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-16.C.1-2.png", "ScreenshotCaption": "Telemetry showing a logon event for user Kmitnick on Creeper (10.0.0.4)"}, {"ScreenshotName": "CC-16.D.1-T1078-new.png", "ScreenshotCaption": "The capability enriching the net.exe connection using valid credentials of Kmitnick with an alert for possible lateral movement"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a logon attempt via net.exe with command-line arguments targeting C$ on 10.0.0.4 (Creeper) using valid credentials for user Kmitnick. Telemetry also showed a logon event for user Kmitnick on Creeper (10.0.0.4).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-16.C.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-16.C.1-2.png", "ScreenshotCaption": "Telemetry showing a logon event for user Kmitnick on Creeper (10.0.0.4)"}, {"ScreenshotName": "CC-16.D.1-T1078-new.png", "ScreenshotCaption": "The capability enriching the net.exe connection using valid credentials of Kmitnick with an alert for possible lateral movement"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that the attacker mounted the C$ drive on creeper with the kmitnick account. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-16.D.1-1.png", "ScreenshotCaption": "Enrichment of net1.exe logon attempt by Kmitnick with Net Use Command Execution alert"}, {"ScreenshotName": "FE-16.D.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker mounting the C$ on creeper with the kmitnick account (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched a logon attempt via net1.exe using valid credentials for user Kmitnick with an alert for Net Use Command Execution (Weak Signal). The password for the user Kmitnick was redacted by the capability.[FE10]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-16.D.1-1.png", "ScreenshotCaption": "Enrichment of net1.exe logon attempt by Kmitnick with Net Use Command Execution alert"}, {"ScreenshotName": "FE-16.D.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker mounting the C$ on creeper with the kmitnick account (Specific Behavior)"}], "Footnotes": [" The vendor indicated the un-redacted passwords could be observed in triage/acquistion data."]}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a logon attempt via net.exe with command-line arguments targeting C$ on 10.0.0.4 (Creeper) using valid credentials for user Kmitnick. [CT5]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempt to C$ on 10.0.0.4 (Creeper) with valid credentials for the account Kmitnick (tainted by the parent \\\"Powershell executed remote commands\\\" alert)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing net.exe. The telemetry was tainted by a trace detection on powershell.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-16.D.1-9.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on powershell.exe)"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a logon attempt via net.exe with command-line arguments targeting C$ on 10.0.0.4 (Creeper) using valid credentials for user Kmitnick (tainted by parent alert on PowerShell script with suspicious content). Telemetry also showed that the logon event for Kmitnick on Creeper was successful.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-16.A.1-6.png", "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"}, {"ScreenshotName": "MS-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempt to C$ on 10.0.0.4 (Creeper) with valid credentials for the account Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"}, {"ScreenshotName": "MS-16.D.1-2.png", "ScreenshotCaption": "Telemetry from query showing successful Kmitnick logon event for Creeper"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a net.exe logon attempt to C$ on 10.0.0.4 (Creeper) using valid credentials for user Kmitnick followed by a event for a successful login. The telemetry was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing a net.exe logon attempt to C$ on 10.0.0.4 (Creeper) using valid credentials for user Kmitnick (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.D.1-2.png", "ScreenshotCaption": "Telemetry showing a event for a successful login by user Kmitnick (tainted by a parent alert on wscript.exe)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a process tree containing a logon attempt via net.exe and command-line arguments using valid credentials of user Kmitnick.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-16-4.png", "ScreenshotCaption": "Telemetry showing logon attempts via net.exe using valid credentials of user Kmitnick"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a logon attempt via net.exe and command-line arguments using valid credentials of user Kmitnick. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing a net.exe logon attempt using valid credentials for user Kmitnick (tainted by relationship to threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "16.E.1", "Procedure": "Empire: Built-in upload module executed to write malicious VBScript (autoupdate.vbs) to disk on CodeRed (10.0.1.5)", "Techniques": [{"TechniqueId": "T1105", "TechniqueName": "Remote File Copy", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed filemods showing the creation and writing to autoupdate.vbs.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-16.E.1-1.png", "ScreenshotCaption": "Telemetry showing creation and write to autoupdate.vbs"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team sent an email indicating a General Behavior was observed because a .vbs was written to the filesystem, which was likely used to carry out additional actions.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-16.E.1-1.png", "ScreenshotCaption": "Telemetry showing File Write and New Script Write for autoupdate.vbs within powershell.exe (tainted by previous detection by orange line indicating medium severity)"}, {"ScreenshotName": "CS-E-10.png", "ScreenshotCaption": "Excerpt from email sent by OverWatch team indicating they observed autoupdate.vbs written (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed File Write and New Script Write events for autoupdate.vbs under powershell.exe. The telemetry was tainted by a previous detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-16.E.1-1.png", "ScreenshotCaption": "Telemetry showing File Write and New Script Write for autoupdate.vbs within powershell.exe (tainted by previous detection by orange line indicating medium severity)"}, {"ScreenshotName": "CS-E-10.png", "ScreenshotCaption": "Excerpt from email sent by OverWatch team indicating they observed autoupdate.vbs written (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the file write of autoupdate.vbs. The telemetry was tainted by a parent PowerShell alert listed as the owner process.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-16.E.1-10.png", "ScreenshotCaption": "Telemetry showing file write of autoupdate.vbs (tainted by a parent PowerShell alert, listed as Owner process)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed creation of autoupdate.vbs (tainted by parent PowerShell alert).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-16-8.png", "ScreenshotCaption": "Telemetry showing creation of autoupdate.vbs (tainted by parent PowerShell alert)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the file creation of autoupdate.vbs.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-16.D.1-6.png", "ScreenshotCaption": "Telemetry showing the creation of autoupdate.vbs"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched powershell.exe writing autoupdate.vbs with an alert for PowerShell File Write (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1105 - Remote File Copy) and Tactics (Command and Control, Lateral Movement).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-16.E.1-1.png", "ScreenshotCaption": "Enrichment of powershell.exe writing autoupdate.vbs with PowerShell File Write alert (tagged with correct ATT&CK Technique, T1105 - Remote File Copy) and Tactics, Command and Control and Lateral Movement)"}, {"ScreenshotName": "FE-16.E.1-2.png", "ScreenshotCaption": "Additional details on enrichment of powershell.exe writing autoupdate.vbs with PowerShell File Write alert"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe creating autoupdate.vbs (tainted by parent Powershell executed remote commands alerts) .[CT5]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-16.E.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe creating autoupdate.vbs (tainted by parent \\\"Powershell executed remote commands\\\" alerts)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched powershell.exe with the correct ATT&CK Tactic (Command and Control) and Technique (Remote File Copy) and a suspicious indicator that a file was copied to a remote computer via PowerShell.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-16.E.1-2.png", "ScreenshotCaption": "Telemetry showing the creation of autoupdate.vbs"}, {"ScreenshotName": "MC-16.E.1-1.png", "ScreenshotCaption": "Enrichment of powershell.exe with the correct ATT&CK Tactic (Command and Control) and Technique (Remote File Copy) and a suspicious indicator that a file was copied to a remote computer via PowerShell"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the creation of autoupdate.vbs on Code Red (10.0.1.5).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-16.E.1-2.png", "ScreenshotCaption": "Telemetry showing the creation of autoupdate.vbs"}, {"ScreenshotName": "MC-16.E.1-1.png", "ScreenshotCaption": "Enrichment of powershell.exe with the correct ATT&CK Tactic (Command and Control) and Technique (Remote File Copy) and a suspicious indicator that a file was copied to a remote computer via PowerShell"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe creating autoupdate.vbs (tainted by parent alert on PowerShell script with suspicious content).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-16.E.1-1.png", "ScreenshotCaption": "Telemetry showing autoupdate.vbs creation (tainted by parent alert on PowerShell script with suspicious content)"}, {"ScreenshotName": "MS-16.D.1-4.png", "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed file create and write events for autoupdate.vbs.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-16.E.1-1.png", "ScreenshotCaption": "Telemetry showing file create and write events for autoupdate.vbs"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed file write of autoupdate.vbs.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-16-5.png", "ScreenshotCaption": "Telemetry showing file write of autoupdate.vbs"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed creation and file write events for autoupdate.vbs. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-16.E.1-1.png", "ScreenshotCaption": "Telemetry showing file event for autoupdate.vbs (tainted by relationship to threat story but Group ID not shown in this view)"}, {"ScreenshotName": "S1-16.E.1-2.png", "ScreenshotCaption": "Telemetry showing creation and writes to autoupdate.vbs"}], "Footnotes": []}]}]}]}, {"Substep": "16.F.1", "Procedure": "Empire: Built-in runas module executed to launch malicious VBScript (autoupdate.vbs) as user Kmitnick\u00ef\u00bf\u00bd", "Techniques": [{"TechniqueId": "T1059", "TechniqueName": "Command-Line Interface", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched cmd.exe event data with the correct ATT&CK Technique (T1059 - Command-Line Interface).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-16.F.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with cmd.exe and initial powershell.exe running as user Bob"}, {"ScreenshotName": "CB-16.F.1-2.png", "ScreenshotCaption": "Telemetry showing process tree with cmd.exe and final powershell.exe running as user Kmitnick"}, {"ScreenshotName": "CB-16.F.1-3.png", "ScreenshotCaption": "Enrichment of cmd.exe event with correct ATT&CK Technique (T1059 - Command-Line Interface)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a process tree with cmd.exe execution and associated user context change.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-16.F.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with cmd.exe and initial powershell.exe running as user Bob"}, {"ScreenshotName": "CB-16.F.1-2.png", "ScreenshotCaption": "Telemetry showing process tree with cmd.exe and final powershell.exe running as user Kmitnick"}, {"ScreenshotName": "CB-16.F.1-3.png", "ScreenshotCaption": "Enrichment of cmd.exe event with correct ATT&CK Technique (T1059 - Command-Line Interface)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a new cmd.exe process running wscript.exe as user Kmitnick, which then launched powershell.exe. The command line arguments for cmd.exe showed that autoupdate.vbs was run. The telemetry was tainted by a previous detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-16.F.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe launching autoupdate.vbs as user Kmitnick (tainted by previous detection by red line indicating high severity)"}, {"ScreenshotName": "CS-16.F.1-2.png", "ScreenshotCaption": "Telemetry showing wscript.exe launching autoupdate.vbs as user Kmitnick (tainted by previous detection by red line indicating high severity)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing autoupdate.vbs though wscript.exe. The telemetry was tainted by a parent PowerShell alert based on a malicious Invoke-RunAs command.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-16.F.1-11.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing autoupdate.vbs though wscript.exe (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.F.1-13.png", "ScreenshotCaption": "Parent alert on Malicious PowerShell Command (Invoke-RunAs)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched events related to cmd.exe launching PowerShell via wscript.exe running autoupdate.vbs (tainted by parent PowerShell alert).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-16-9.png", "ScreenshotCaption": "Enrichment showing cmd launching PowerShell via wscript.exe running autoupdate.vbs (tainted by parent PowerShell alert)"}, {"ScreenshotName": "EG-16-11.png", "ScreenshotCaption": "Telemetry showing cmd.exe executed as user Kmitnick (tainted by parent PowerShell alert)"}, {"ScreenshotName": "EG-16-10.png", "ScreenshotCaption": "Enriched event tree showing enrichment of autoupdate.vbs execution with related ATT&CK Technique (T1064 - Scripting) and Tactic (Execution) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the execution of autoupdate.vbs with a related ATT&CK Technique (T1064 - Scripting) and Tactic (Execution). (tainted by parent PowerShell alert). [EG11]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-16-9.png", "ScreenshotCaption": "Enrichment showing cmd launching PowerShell via wscript.exe running autoupdate.vbs (tainted by parent PowerShell alert)"}, {"ScreenshotName": "EG-16-11.png", "ScreenshotCaption": "Telemetry showing cmd.exe executed as user Kmitnick (tainted by parent PowerShell alert)"}, {"ScreenshotName": "EG-16-10.png", "ScreenshotCaption": "Enriched event tree showing enrichment of autoupdate.vbs execution with related ATT&CK Technique (T1064 - Scripting) and Tactic (Execution) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe execution and associated user context change (tainted by parent PowerShell alert). [EG11]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-16-9.png", "ScreenshotCaption": "Enrichment showing cmd launching PowerShell via wscript.exe running autoupdate.vbs (tainted by parent PowerShell alert)"}, {"ScreenshotName": "EG-16-11.png", "ScreenshotCaption": "Telemetry showing cmd.exe executed as user Kmitnick (tainted by parent PowerShell alert)"}, {"ScreenshotName": "EG-16-10.png", "ScreenshotCaption": "Enriched event tree showing enrichment of autoupdate.vbs execution with related ATT&CK Technique (T1064 - Scripting) and Tactic (Execution) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (cmd.exe) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-16.F.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing autoupdate.vbs through wscript.exe, and the associated user context change between user Bob and user Kmitnick"}, {"ScreenshotName": "CC-20.A.1-4.png", "ScreenshotCaption": "General Behavior alert was generated showing that a spawned process (cmd.exe) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing autoupdate.vbs through wscript.exe, and the associated user context change between user Bob and user Kmitnick.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-16.F.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing autoupdate.vbs through wscript.exe, and the associated user context change between user Bob and user Kmitnick"}, {"ScreenshotName": "CC-20.A.1-4.png", "ScreenshotCaption": "General Behavior alert was generated showing that a spawned process (cmd.exe) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched cmd.exe spawning wscript.exe with an alert for Wscript Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1059 - Command-Line Interface) and Tactic (Execution). Alert details showed that the context of the user was changed to Kmitnick.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-16.F.1-1.png", "ScreenshotCaption": "Enrichment of cmd.exe spawning wscript.exe with Wscript Execution alert (tagged with correct ATT&CK Technique, T1059 - Command-Line Interface, and Tactic, Execution)"}, {"ScreenshotName": "FE-16.F.1-2.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing autoupdate.vbs"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing autoupdate.vbs with a parent process of powershell.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-16.F.1-1.png", "ScreenshotCaption": "Enrichment of cmd.exe spawning wscript.exe with Wscript Execution alert (tagged with correct ATT&CK Technique, T1059 - Command-Line Interface, and Tactic, Execution)"}, {"ScreenshotName": "FE-16.F.1-2.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing autoupdate.vbs"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed svchost.exe creating cmd.exe, which ran autoupdate.vbs as user Kmitnick (tainted by the parent \\\"Powershell executed remote commands\\\" alert).[CT5]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-16.F.1-1.png", "ScreenshotCaption": "Telemetry showing svchost.exe creating cmd.exe and executing autoupdate.vbs as user Kmitnick"}, {"ScreenshotName": "CT-16.F.1-2.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing autoupdate.vbs as user Kmitnick (tainted by the parent \\\"Powershell executed remote commands\\\" alert)"}, {"ScreenshotName": "CT-16.F.1-3.png", "ScreenshotCaption": "Telemetry showing wscript.exe execute autoupate.vbs and resulting powershell.exe (tainted by the parent \\\"Powershell executed remote commands\\\" alert)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched wscript.exe executing autoupdate.vbs with the correct ATT&CK Tactic (Execution) and Technique (Command Line Interface).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-16.F.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing autoupdate.vbs as user Kmitnick"}, {"ScreenshotName": "MC-16.F.1-2.png", "ScreenshotCaption": "Enrichment of wscript.exe executing autoupdate.vbs with the correct ATT&CK Tactic (Execution) and Technique (Command Line Interface)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing autoupdate.vbs as user Kmitnick.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-16.F.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing autoupdate.vbs as user Kmitnick"}, {"ScreenshotName": "MC-16.F.1-2.png", "ScreenshotCaption": "Enrichment of wscript.exe executing autoupdate.vbs with the correct ATT&CK Tactic (Execution) and Technique (Command Line Interface)"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing autoupdate.vbs via wscript.exe as user Kmitnick. The execution generated three new PowerShell related alerts for the initial execution sequence of Empire that tainted this event, but were not counted as separate detections for this technique.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-16.F.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing autoupdate.vbs as user Kmitnick (tainted by parent PowerShell alerts)"}, {"ScreenshotName": "MS-16.D.1-3.png", "ScreenshotCaption": "Parent alert for PowerShell with suspicious command-line tainting powershell.exe (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"}, {"ScreenshotName": "MS-16.D.1-4.png", "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"}, {"ScreenshotName": "MS-16.D.1-5.png", "ScreenshotCaption": "Parent alert for malicious PowerShell cmdlet tainting powershell.exe (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched wscript.exe executing autoupdate.vbs with a related ATT&CK Technique (Scripting).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-16.F.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing autoupdate.vbs (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.F.1-2.png", "ScreenshotCaption": "Enrichment of wscript.exe executing autoupdate.vbs with a related ATT&CK Technique (Scripting)."}, {"ScreenshotName": "PA-16.F.1-3.png", "ScreenshotCaption": "Indicator of Compromise Alert identifying PowerShell Empire using the Runas functionality"}], "Footnotes": []}, {"DetectionType": "Indicator of Compromise", "DetectionNote": "An Indicator of Compromise Alert was generated identify PowerShell Empire using the Runas functionality.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-16.F.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing autoupdate.vbs (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.F.1-2.png", "ScreenshotCaption": "Enrichment of wscript.exe executing autoupdate.vbs with a related ATT&CK Technique (Scripting)."}, {"ScreenshotName": "PA-16.F.1-3.png", "ScreenshotCaption": "Indicator of Compromise Alert identifying PowerShell Empire using the Runas functionality"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing autoupdate.vbs. The telemetry was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-16.F.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing autoupdate.vbs (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.F.1-2.png", "ScreenshotCaption": "Enrichment of wscript.exe executing autoupdate.vbs with a related ATT&CK Technique (Scripting)."}, {"ScreenshotName": "PA-16.F.1-3.png", "ScreenshotCaption": "Indicator of Compromise Alert identifying PowerShell Empire using the Runas functionality"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing autoupdate.vbs via wscript.exe as user Kmitnick", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-16-6.png", "ScreenshotCaption": "Telemetry showing cmd.exe and executing autoupdate.vbs as user Kmitnick"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe execution of autoupdate.vbs. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-16.F.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe launching autoupdate.vbs (tainted by relationship to threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "16.G.1", "Procedure": "Empire: Built-in move capability executed to write malicious VBScript (update.vbs) to disk on Creeper (10.0.0.4)", "Techniques": [{"TechniqueId": "T1105", "TechniqueName": "Remote File Copy", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed filemods showing the creation and writing to update.vbs on remote host 10.0.0.4 (Creeper).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-16.G.1-1.png", "ScreenshotCaption": "Telemetry showing remote creation and write to update.vbs"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed update.vbs written to the C$ remote share on host 10.0.0.4 (Creeper).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-16.G.1-1.png", "ScreenshotCaption": "Telemetry showing update.vbs with event_name NewScriptWritten indicating a write to C$"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed file events for the write of update.vbs to Creeper (10.0.0.4).\u00a0The telemetry was tainted by a parent PowerShell alert listed as the owner process.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-16.G.1-10.png", "ScreenshotCaption": "Telemetry of file events for write of update.vbs to Creeper (10.0.0.4) (tainted by a parent PowerShell alert, listed as Owner process)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry for file creation events was available, and would show the creation of update.vbs. No screenshot for the event was made available, though other file creation events, as well as the subsequent execution of update.vbs was identified.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the file creation of update.vbs.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-16.D.1-6.png", "ScreenshotCaption": "Telemetry showing the creation of update.vbs"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified the autoupdate.vbs script being written to Creeper. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-16.G.1-1.png", "ScreenshotCaption": "Enrichment of powershell.exe writing update.vbs with File Write to Network Share alert"}, {"ScreenshotName": "FE-16.G.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report of the write of the autoupdate.vbs script (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched powershell.exe writing update.vbs with an alert for File Write to Network Share (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1105 - Remote File Copy) and Tactic (Lateral Movement).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-16.G.1-1.png", "ScreenshotCaption": "Enrichment of powershell.exe writing update.vbs with File Write to Network Share alert"}, {"ScreenshotName": "FE-16.G.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report of the write of the autoupdate.vbs script (Specific Behavior)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the update.vbs creation event with the condition \\\"File created on hidden share (C$)\\\". The enrichment was tainted by parent \\\"Powershell executed remote commands\\\" alerts.[CT15]", "Modifiers": ["Configuration Change", "Tainted"], "Screenshots": [{"ScreenshotName": "CT-16.G.1-1.png", "ScreenshotCaption": "Enrichment of powershell.exe creating update.vbs (tainted by parent \\\"Powershell executed remote commands\\\" alerts)"}], "Footnotes": ["The condition contributing to enrichment may have been added to the capability's detection after the start of the evaluation, so the detection is identified as a configuration change. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched powershell.exe with the correct ATT&CK Tactic (Command and Control) and Technique (Remote File Copy) and a suspicious indicator that a file was copied to a remote computer via PowerShell.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-16.G.1-2.png", "ScreenshotCaption": "Telemetry showing the creation of update.vbs"}, {"ScreenshotName": "MC-16.G.1-1.png", "ScreenshotCaption": "Enrichment of powershell.exe with the correct ATT&CK Tactic (Command and Control) and Technique (Remote File Copy) and a suspicious indicator that a file was copied to a remote computer via PowerShell"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the creation of update.vbs on Creeper (10.0.0.4).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-16.G.1-2.png", "ScreenshotCaption": "Telemetry showing the creation of update.vbs"}, {"ScreenshotName": "MC-16.G.1-1.png", "ScreenshotCaption": "Enrichment of powershell.exe with the correct ATT&CK Tactic (Command and Control) and Technique (Remote File Copy) and a suspicious indicator that a file was copied to a remote computer via PowerShell"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed creation of update.vbs on 10.0.0.4 (Creeper) and the remote file copy action from 10.0.1.5 (CodeRed) (the remote file copy event on CodeRed was tainted by parent PowerShell alerts).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-16.D.1-4.png", "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"}, {"ScreenshotName": "MS-16.G.1-1.png", "ScreenshotCaption": "Telemetry showing file creation of update.vbs on 10.0.0.4 (Creeper)"}, {"ScreenshotName": "MS-16.G.1-2.png", "ScreenshotCaption": "Telemetry showing for remote creation of update.vbs on 10.0.0.4 (Creeper) from 10.0.1.5 (CodeRed)"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for a script being modified/moved to a remote location. The alert was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-16.G.1-1.png", "ScreenshotCaption": "Telemetry showed file create and write events for update.vbs"}, {"ScreenshotName": "PA-16.G.1-2.png", "ScreenshotCaption": "Specific Behavior alert for a script being modified/moved to a remote location (tainted by a parent alert on wscript.exe)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed file create and write events for update.vbs.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-16.G.1-1.png", "ScreenshotCaption": "Telemetry showed file create and write events for update.vbs"}, {"ScreenshotName": "PA-16.G.1-2.png", "ScreenshotCaption": "Specific Behavior alert for a script being modified/moved to a remote location (tainted by a parent alert on wscript.exe)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed creation of update.vbs on 10.0.0.4 (Creeper). The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-16.G.1-2.png", "ScreenshotCaption": "Telemetry showing create file event of update.vbs on 10.0.0.4 (Creeper) (tainted by relationship to threat story but Group ID not shown in this view)"}], "Footnotes": []}]}]}]}, {"Substep": "16.H.1", "Procedure": "Empire: 'sc query' via PowerShell to remotely enumerate services on Creeper (10.0.0.4)", "Techniques": [{"TechniqueId": "T1007", "TechniqueName": "System Service Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the sc.exe execution with the correct ATT&CK Technique (System Service Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-16.H.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing sc.exe execution for the service query"}, {"ScreenshotName": "CB-16.H.1-2.png", "ScreenshotCaption": "Telemetry showing module loads from execution of sc.exe to remotely query services on Creeper (10.0.0.4)"}, {"ScreenshotName": "CB-16.H.1-3.png", "ScreenshotCaption": "Enrichment of sc.exe executing to query services with correct ATT&CK Technique (System Service Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed execution of sc.exe with command-line arguments to remotely query services on Creeper. Telemetry also showed module loads and a network connection to Creeper (10.0.0.4).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-16.H.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing sc.exe execution for the service query"}, {"ScreenshotName": "CB-16.H.1-2.png", "ScreenshotCaption": "Telemetry showing module loads from execution of sc.exe to remotely query services on Creeper (10.0.0.4)"}, {"ScreenshotName": "CB-16.H.1-3.png", "ScreenshotCaption": "Enrichment of sc.exe executing to query services with correct ATT&CK Technique (System Service Discovery)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The OverWatch team sent an email indicating a Specific Behavior was observed because the user Bob was querying for a particular service on Creeper.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-16.H.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing sc.exe execution to query services on Creeper (tainted from previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-11.png", "ScreenshotCaption": "Email excerpt sent by OverWatch team indicating they observed Bob querying for a service on Creeper (Specific Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of sc.exe to query services on Creeper. The process tree view showed sc.exe as tainted by a previous powershell.exe detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-16.H.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing sc.exe execution to query services on Creeper (tainted from previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-11.png", "ScreenshotCaption": "Email excerpt sent by OverWatch team indicating they observed Bob querying for a service on Creeper (Specific Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed sc.exe execution with command-line arguments. The telemetry was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-16.H.1-10.png", "ScreenshotCaption": "Telemetry of sc.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched sc.exe with the correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery). The enrichment was tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts. [EG11]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-16-12.png", "ScreenshotCaption": "Telemetry showing sc.exe execution to query services on Creeper"}, {"ScreenshotName": "EG-16-14.png", "ScreenshotCaption": "Enrichment of sc.exe execution to query services on Creeper with correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery)  (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed sc.exe execution to query services on Creeper. The telemetry was tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts. [EG11]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-16-12.png", "ScreenshotCaption": "Telemetry showing sc.exe execution to query services on Creeper"}, {"ScreenshotName": "EG-16-14.png", "ScreenshotCaption": "Enrichment of sc.exe execution to query services on Creeper with correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery)  (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing sc.exe with command-line arguments"}, {"ScreenshotName": "CC-16.H.1-2.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing sc.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing sc.exe with command-line arguments"}, {"ScreenshotName": "CC-16.H.1-2.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched sc.exe with an alert for SC Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery). [FE7]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-16.L.1-1.png", "ScreenshotCaption": "Enrichment of sc.exe with an alert for SC Execution (Weak Signal) (tagged with the correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-16.H.1-1.png", "ScreenshotCaption": "Additional details on enrichment of sc.exe with SC Execution alert"}], "Footnotes": [" All five of the sc.exe events are rolled under the same SC Execution alert."]}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability showed powershell.exe executing sc.exe to remotely query services on Creeper and enriched sc.exe with enriched with the condition SC Query Reconnaissance Command. The enrichment was tainted by the parent \\\"Powershell executed remote commands\\\" alert.[CT8]", "Modifiers": ["Configuration Change", "Tainted"], "Screenshots": [{"ScreenshotName": "CT-16.H.1-1.png", "ScreenshotCaption": "Enrichment showing powershell.exe executing sc.exe to query services on Creeper (enriched with condition SC Query Reconnaissance Command, tainted by the parent \\\"Powershell executed remote commands\\\" alert)"}], "Footnotes": ["The capability was modified after the start of the evaluation to allow the condition contributing to Enrichment to appear, so the detection is identified as a configuration change. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched sc.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that a Windows service was manipulated via sc.exe/net.exe tool.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-16.J.1-4.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing sc.exe (tainted by a trace detection on cmd.exe)"}, {"ScreenshotName": "MC-16.J.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Windows service was manipulated via sc.exe/net.exe tool"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing sc.exe. The telemetry was tainted by a trace detection on cmd.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-16.J.1-4.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing sc.exe (tainted by a trace detection on cmd.exe)"}, {"ScreenshotName": "MC-16.J.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Windows service was manipulated via sc.exe/net.exe tool"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry from CodeRed showed sc.exe command remotely querying services on Creeper (tainted by parent alert on PowerShell script with suspicious content).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-16.H.1-1.png", "ScreenshotCaption": "Telemetry from CodeRed showing execution sequence of sc.exe service query to Creeper"}, {"ScreenshotName": "MS-16.D.1-4.png", "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for the sc utility be used to perform actions of remote services. The alert was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-16.H.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing sc with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.H.1-2.png", "ScreenshotCaption": "General Behavior alert for the sc utility be used to perform actions of remote services (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.H.1-3.png", "ScreenshotCaption": "Enrichment of sc.exe executing with command-line arguments with the correct ATT&CK Technique (System Service Discovery)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched sc.exe executing with command-line arguments with the correct ATT&CK Technique (System Service Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-16.H.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing sc with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.H.1-2.png", "ScreenshotCaption": "General Behavior alert for the sc utility be used to perform actions of remote services (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.H.1-3.png", "ScreenshotCaption": "Enrichment of sc.exe executing with command-line arguments with the correct ATT&CK Technique (System Service Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing sc with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-16.H.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing sc with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.H.1-2.png", "ScreenshotCaption": "General Behavior alert for the sc utility be used to perform actions of remote services (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.H.1-3.png", "ScreenshotCaption": "Enrichment of sc.exe executing with command-line arguments with the correct ATT&CK Technique (System Service Discovery)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of sc.exe to query services on 10.0.0.4 (Creeper).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-16-7.png", "ScreenshotCaption": "Telemetry showing execution of sc.exe to query services on 10.0.0.4 (Creeper)"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of sc.exe to query services on Creeper. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-16.H.1-1.png", "ScreenshotCaption": "Telemetry showing execution of sc.exe to query services on Creeper (tainted by relationship to threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "16.I.1", "Procedure": "Empire: 'sc create' via PowerShell to remotely create a service on Creeper (10.0.0.4)", "Techniques": [{"TechniqueId": "T1050", "TechniqueName": "New Service", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for sc.exe execution to create the AdobeUpdater service with the correct ATT&CK Technique (New Service).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-16.I.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing sc.exe execution creating the AdobeUpdater service"}, {"ScreenshotName": "CB-16.H.1-3.png", "ScreenshotCaption": "Specific Behavior alert on sc.exe executing to create the AdobeUpdater service mapped to ATT&CK"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed execution of sc.exe with command-line arguments to create a new AdobeUpdater service containing a binPath pointed to cmd.exe with arguments to execute update.vbs.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-16.I.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing sc.exe execution creating the AdobeUpdater service"}, {"ScreenshotName": "CB-16.H.1-3.png", "ScreenshotCaption": "Specific Behavior alert on sc.exe executing to create the AdobeUpdater service mapped to ATT&CK"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team sent an email indicating they observed a General Behavior because newly created file (AdobeUpdater service in registry) established persistence on the host.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-16.H.1-4.png", "ScreenshotCaption": "Telemetry showing AdobeUpdater service details with binPath pointed to cmd.exe with arguments and service description"}, {"ScreenshotName": "CS-16.H.1-2.png", "ScreenshotCaption": "Telemetry from process tree showing sc.exe execution to create the AdobeUpdater service (tainted from previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-11.png", "ScreenshotCaption": "Email excerpt sent by OverWatch team indicating they observed a newly created file (AdobeUpdater service in registry) to establish persistence (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed sc.exe executing with command-line arguments for a new service called AdobeUpdater with binPath pointed to cmd.exe with arguments to execute update.vbs and service description \\\"Synchronize with Adobe for security updates.\\\" The process tree view showed sc.exe as tainted by a previous powershell.exe detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-16.H.1-4.png", "ScreenshotCaption": "Telemetry showing AdobeUpdater service details with binPath pointed to cmd.exe with arguments and service description"}, {"ScreenshotName": "CS-16.H.1-2.png", "ScreenshotCaption": "Telemetry from process tree showing sc.exe execution to create the AdobeUpdater service (tainted from previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-11.png", "ScreenshotCaption": "Email excerpt sent by OverWatch team indicating they observed a newly created file (AdobeUpdater service in registry) to establish persistence (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for the unconventional creation of a new service with the correct ATT&CK Technique (New Service) and Tactic (Persistence, Privilege Escalation). The alert was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-16.I.1-13.png", "ScreenshotCaption": "Specific Behavior alert for unconventional new service with correct ATT&CK Technique (New Service) and Tactics (Persistence, Privilege Escalation) (tainted by a parent PowerShell alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed sc.exe executing with command-line arguments.[CR3]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-16.I.1-13.png", "ScreenshotCaption": "Specific Behavior alert for unconventional new service with correct ATT&CK Technique (New Service) and Tactics (Persistence, Privilege Escalation) (tainted by a parent PowerShell alert)"}], "Footnotes": [" For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated on the AdobeUpdater service named \"Persistence-New Service\". The alert was also tagged with the correct ATT&CK Technique (T1050 - New Service) and Tactic (Persistence).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-16-14.png", "ScreenshotCaption": "Enriched event tree showing enrichment of sc.exe execution with correct ATT&CK Technique (T1050 - New Service) and Tactic (Persistence) (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts, tree is initially available unenriched to show the base telemetry)"}, {"ScreenshotName": "EG-16-13.png", "ScreenshotCaption": "Specific Behavior alert for new service AdobeUpdater creation on Creeper tagged with correct ATT&CK Technique (T1050 - New Service) and Tactic (Persistence)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched sc.exe with the correct ATT&CK Technique (T1050 - New Service) and Tactic (Persistence). The enrichment was tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts. [EG11]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-16-14.png", "ScreenshotCaption": "Enriched event tree showing enrichment of sc.exe execution with correct ATT&CK Technique (T1050 - New Service) and Tactic (Persistence) (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts, tree is initially available unenriched to show the base telemetry)"}, {"ScreenshotName": "EG-16-13.png", "ScreenshotCaption": "Specific Behavior alert for new service AdobeUpdater creation on Creeper tagged with correct ATT&CK Technique (T1050 - New Service) and Tactic (Persistence)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed sc.exe execution to create the AdobeUpdater service and set the binPath to run cmd.exe with an argument to execute update.vbs. The telemetry was tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts. [EG11]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-16-14.png", "ScreenshotCaption": "Enriched event tree showing enrichment of sc.exe execution with correct ATT&CK Technique (T1050 - New Service) and Tactic (Persistence) (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts, tree is initially available unenriched to show the base telemetry)"}, {"ScreenshotName": "EG-16-13.png", "ScreenshotCaption": "Specific Behavior alert for new service AdobeUpdater creation on Creeper tagged with correct ATT&CK Technique (T1050 - New Service) and Tactic (Persistence)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for sc.exe used with parameters typical for lateral movement.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing sc.exe with command-line arguments"}, {"ScreenshotName": "CC-16.I.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}, {"ScreenshotName": "CC-16.D.1-2.png", "ScreenshotCaption": "Specific Behavior alert for sc.exe used with parameters typical for lateral movement"}], "Footnotes": []}, {"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing sc.exe with command-line arguments"}, {"ScreenshotName": "CC-16.I.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}, {"ScreenshotName": "CC-16.D.1-2.png", "ScreenshotCaption": "Specific Behavior alert for sc.exe used with parameters typical for lateral movement"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed sc.exe execution with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing sc.exe with command-line arguments"}, {"ScreenshotName": "CC-16.I.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}, {"ScreenshotName": "CC-16.D.1-2.png", "ScreenshotCaption": "Specific Behavior alert for sc.exe used with parameters typical for lateral movement"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it observed the sc.exe command creating a new service called adobeupdater on Creeper from CodeRed. [FE5][FE7]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-16.I.1-1.png", "ScreenshotCaption": "Additional details on enrichment of sc.exe with SC Execution alert"}, {"ScreenshotName": "FE-16.L.1-1.png", "ScreenshotCaption": "Enrichment of sc.exe with an alert for SC Execution (Weak Signal) (tagged with correct ATT&CK Technique, T1050 - New Service, and Tactic, Discovery)"}, {"ScreenshotName": "FE-16.I.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating sc.exe was used to create a new service (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident.", " All five of the sc.exe events are rolled under the same SC Execution alert."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched sc.exe with an alert for SC Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1050 - New Service) and Tactic (Persistence).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-16.I.1-1.png", "ScreenshotCaption": "Additional details on enrichment of sc.exe with SC Execution alert"}, {"ScreenshotName": "FE-16.L.1-1.png", "ScreenshotCaption": "Enrichment of sc.exe with an alert for SC Execution (Weak Signal) (tagged with correct ATT&CK Technique, T1050 - New Service, and Tactic, Discovery)"}, {"ScreenshotName": "FE-16.I.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating sc.exe was used to create a new service (Specific Behavior)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "An alert called \"Windows Service Registry Key modified\" and a Specific Behavior alert called \"New Windows service created\" were generated due to the AdobeUpdater service being created in the Registry.", "Modifiers": ["Configuration Change"], "Screenshots": [{"ScreenshotName": "CT-16.I.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing sc.exe to create the AdobeUpdater service on Creeper and set its description (tainted by the parent \\\"Powershell executed remote commands\\\" alert)"}, {"ScreenshotName": "CT-16.I.1-2.png", "ScreenshotCaption": "Specific Behavior alert for \\\"\\\"New Windows service created\\\"\\\" and additional alert for \\\"Windows Service Registry Key modified\\\""}], "Footnotes": ["The capability may have been modified after the start of the evaluation to create these alerts, so the detection is identified as a configuration change. See Configuration page for details."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing sc.exe to create a new service named AdobeUpdater with binPath pointed to cmd.exe with arguments to run update.vbs and suspicious service description. The telemetry was tainted by the parent \\\"Powershell executed remote commands alert\\\".[CT5]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-16.I.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing sc.exe to create the AdobeUpdater service on Creeper and set its description (tainted by the parent \\\"Powershell executed remote commands\\\" alert)"}, {"ScreenshotName": "CT-16.I.1-2.png", "ScreenshotCaption": "Specific Behavior alert for \\\"\\\"New Windows service created\\\"\\\" and additional alert for \\\"Windows Service Registry Key modified\\\""}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched sc.exe with a relevant ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that a Windows service was manipulated via sc.exe/net.exe tool.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-16.J.1-4.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing sc.exe (tainted by a trace detection on cmd.exe)"}, {"ScreenshotName": "MC-16.I.1-1.png", "ScreenshotCaption": "Telemetry showing that a new service was added"}, {"ScreenshotName": "MC-16.J.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with a relevant ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Windows service was manipulated via sc.exe/net.exe tool"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed that a new service was added. Telemetry also showed powershell.exe executing sc.exe. The telemetry was tainted by a trace detection on cmd.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-16.J.1-4.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing sc.exe (tainted by a trace detection on cmd.exe)"}, {"ScreenshotName": "MC-16.I.1-1.png", "ScreenshotCaption": "Telemetry showing that a new service was added"}, {"ScreenshotName": "MC-16.J.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with a relevant ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Windows service was manipulated via sc.exe/net.exe tool"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for the suspicious service registration of AdobeUpdater.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-16.D.1-4.png", "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"}, {"ScreenshotName": "MS-16.I.1-1.png", "ScreenshotCaption": "Telemetry from CodeRed showing execution sequence of sc.exe AdobeUpdater remote service creation"}, {"ScreenshotName": "MS-16.I.1-2.png", "ScreenshotCaption": "Telemetry showing AdobeUpdater service registry information that was changed on Creeper"}, {"ScreenshotName": "MS-16.I.1-3.png", "ScreenshotCaption": "Specific Behavior alert on suspicious service registration on Creeper"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry from CodeRed showed sc.exe execution to remotely create the AdobeUpdater service with a binPath set to run cmd.exe with an argument to execute update.vbs on Creeper (tainted by parent alert on PowerShell script with suspicious content). Telemetry from Creeper shows the registry keys that were changed to add the new service", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-16.D.1-4.png", "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"}, {"ScreenshotName": "MS-16.I.1-1.png", "ScreenshotCaption": "Telemetry from CodeRed showing execution sequence of sc.exe AdobeUpdater remote service creation"}, {"ScreenshotName": "MS-16.I.1-2.png", "ScreenshotCaption": "Telemetry showing AdobeUpdater service registry information that was changed on Creeper"}, {"ScreenshotName": "MS-16.I.1-3.png", "ScreenshotCaption": "Specific Behavior alert on suspicious service registration on Creeper"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for a new service created via the command line. The alert was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-16.I.1-1.png", "ScreenshotCaption": "Telemetry showing execution of sc.exe to create a new AdobeUpdater service (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.I.1-2.png", "ScreenshotCaption": "Telemetry showing the creation of Registry keys associated with the AdobeUpdater service"}, {"ScreenshotName": "PA-16.I.1-3.png", "ScreenshotCaption": "Specific Behavior alert for a new service created via the command line (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.I.1-4.png", "ScreenshotCaption": "Enrichment of sc.exe executing with the correct ATT&CK Technique (New Service)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched sc.exe executing with the correct ATT&CK Technique (New Service).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-16.I.1-1.png", "ScreenshotCaption": "Telemetry showing execution of sc.exe to create a new AdobeUpdater service (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.I.1-2.png", "ScreenshotCaption": "Telemetry showing the creation of Registry keys associated with the AdobeUpdater service"}, {"ScreenshotName": "PA-16.I.1-3.png", "ScreenshotCaption": "Specific Behavior alert for a new service created via the command line (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.I.1-4.png", "ScreenshotCaption": "Enrichment of sc.exe executing with the correct ATT&CK Technique (New Service)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of sc.exe with command-line arguments to create a new AdobeUpdater service containing a binPath pointed to cmd.exe with arguments to execute update.vbs. Telemetry also showed the creation of Registry keys associated with this new service. The telemetry was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-16.I.1-1.png", "ScreenshotCaption": "Telemetry showing execution of sc.exe to create a new AdobeUpdater service (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.I.1-2.png", "ScreenshotCaption": "Telemetry showing the creation of Registry keys associated with the AdobeUpdater service"}, {"ScreenshotName": "PA-16.I.1-3.png", "ScreenshotCaption": "Specific Behavior alert for a new service created via the command line (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.I.1-4.png", "ScreenshotCaption": "Enrichment of sc.exe executing with the correct ATT&CK Technique (New Service)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of sc.exe to create a new service called AdobeUpdater with a binPath set to run cmd.exe and execute update.vbs.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-16-7.png", "ScreenshotCaption": "Telemetry showing execution of sc.exe to create the AdobeUpdater service"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of sc.exe to create the AdobeUpdater service on Creeper with a binPath pointing to cmd.exe to execute update.vbs. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-16.I.1-1.png", "ScreenshotCaption": "Telemetry showing execution of sc.exe to create the AdobeUpdater service (tainted by prior threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "16.I.1", "Procedure": "Empire: 'sc description' via PowerShell to remotely disguise a service on Creeper (10.0.0.4)", "Techniques": [{"TechniqueId": "T1036", "TechniqueName": "Masquerading", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process trees showed execution of sc.exe with command-line arguments to create the AdobeUpdater service with binPath pointed to cmd.exe with arguments to execute update.vbs and a suspicious service description, which indicates masquerading.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-16.I.1-2.png", "ScreenshotCaption": "Telemetry from process tree showing sc.exe execution setting the AdobeUpdater service description"}, {"ScreenshotName": "CB-16.I.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing sc.exe execution creating the AdobeUpdater service"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed sc.exe executing with command-line arguments for a new service called AdobeUpdater with binPath pointed to cmd.exe with arguments to execute update.vbs and service description \\\"Synchronize with Adobe for security updates.\\\". An analyst could use this information to determine it is not a legitimate service. The process tree view showed sc.exe as tainted by a previous powershell.exe detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-16.H.1-3.png", "ScreenshotCaption": "Telemetry from process tree showing sc.exe execution with the AdobeUpdater service description (tainted from previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-16.H.1-4.png", "ScreenshotCaption": "Telemetry showing AdobeUpdater service details with binPath pointed to cmd.exe with arguments and service description"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed sc.exe executing with command-line arguments to set the service description. An analyst could use this information to determine it is not a legitimate service. The telemetry was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-16.I.1-21.png", "ScreenshotCaption": "Telemetry showing sc.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed sc.exe executions to create the AdobeUpdater service and set the binPath to run cmd.exe with an argument to execute update.vbs as well as set the description of the service. An analyst could use this information to determine masquerading occurred. The telemetry was tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-16-14.png", "ScreenshotCaption": "Telemetry of sc.exe executions to create and set the description of a new service on Creeper (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing sc.exe with command-line arguments"}, {"ScreenshotName": "CC-16.I.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process trees showed execution of sc.exe with command-line arguments to create the AdobeUpdater service with binPath pointed to cmd.exe with arguments to execute update.vbs and a suspicious service description, which could indicate masquerading.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing sc.exe with command-line arguments"}, {"ScreenshotName": "CC-16.I.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the sc.exe command with an alert for SC Execution (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1007 - System Service Discovery) and the correct Tactic (Discovery).  [FE7]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-16.L.1-1.png", "ScreenshotCaption": "Enrichment of sc.exe with an alert for SC Execution (Weak Signal) (tagged with related correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-16.I.1-1.png", "ScreenshotCaption": "Additional details on enrichment of sc.exe with SC Execution alert"}], "Footnotes": [" All five of the sc.exe events are rolled under the same SC Execution alert."]}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing sc.exe to create a new service named AdobeUpdater with binPath pointed to cmd.exe with arguments to run update.vbs and suspicious service description, which could assist an analyst in determining this was not a legitimate Adobe product. The telemetry was tainted by the parent \\\"Powershell executed remote commands alert\\\".[CT5]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-16.I.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing sc.exe to create the AdobeUpdater service on Creeper and set its description (tainted by the parent \\\"Powershell executed remote commands\\\" alert)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing sc.exe with command-line arguments, to create and configure the AdobeUpdater service, that an analyst could use to determine the service is masquerading. The telemetry was tainted by a trace detection on cmd.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-16.J.1-4.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing sc.exe (tainted by a trace detection on cmd.exe)"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry from CodeRed showed sc.exe service creation command for the AdobeUpdater service with a binPath set to run update.vbs with cmd.exe on startup on Creeper (tainted by parent alert on PowerShell script with suspicious content).\u00a0Telemetry also showed the sc.exe command to set the service description, but a screenshot was not available. An analyst can use this information to determine AdobeUpdater is masquerading.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-16.D.1-4.png", "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"}, {"ScreenshotName": "MS-16.I.1-1.png", "ScreenshotCaption": "Telemetry showing execution sequence of sc.exe AdobeUpdater remote service creation"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of sc.exe with command-line arguments to set the service description. An analyst could use this information to determine it is not a legitimate service. The telemetry was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-16.I.1-5.png", "ScreenshotCaption": "Telemetry showed execution of sc.exe with command-line arguments (tainted by a parent alert on wscript.exe)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of sc.exe to create a new service called AdobeUpdater with a binPath set to run cmd.exe and execute update.vbs as well as set the service description. An analyst can use this information to determine the service is masquerading.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-16-7.png", "ScreenshotCaption": "Telemetry showing execution of sc.exe to create the AdobeUpdater service and set its description"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed executions of sc.exe to create the AdobeUpdater service on Creeper with a binPath pointing to cmd.exe to execute update.vbs as well as a setting the service description. An analyst can use this information to determine AdobeUpdater is masquerading. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-16.I.1-1.png", "ScreenshotCaption": "Telemetry showing execution of sc.exe to create the AdobeUpdater service and set the description (partially shown one line above; both tainted by prior threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "16.J.1", "Procedure": "Empire: 'sc qc' via PowerShell to remotely enumerate a specific service on Creeper (10.0.0.4)", "Techniques": [{"TechniqueId": "T1007", "TechniqueName": "System Service Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched sc.exe execution with the correct ATT&CK Technique (System Service Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-16.J.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing sc.exe execution to query the AdobeUpdater service on Creeper"}, {"ScreenshotName": "CB-16.H.1-3.png", "ScreenshotCaption": "Enrichment of sc.exe executing query services with correct ATT&CK Technique (System Service Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed execution of sc.exe with command-line arguments to query the AdobeUpdater service on Creeper.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-16.J.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing sc.exe execution to query the AdobeUpdater service on Creeper"}, {"ScreenshotName": "CB-16.H.1-3.png", "ScreenshotCaption": "Enrichment of sc.exe executing query services with correct ATT&CK Technique (System Service Discovery)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The OverWatch team sent an email indicating they observed a Specific Behavior because the user Bob queried for a particular service on Creeper.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-16.J.1-1.png", "ScreenshotCaption": "Telemetry showing sc.exe execution to query the AdobeUpdater service on Creeper process tree view (tainted from previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-11.png", "ScreenshotCaption": "Email excerpt sent by OverWatch team indicating they observed Bob querying for a service (Specific Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed sc.exe executing with command-line arguments to query the AdobeUpdater service on Creeper. The process tree view showed sc.exe as tainted by a previous powershell.exe detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-16.J.1-1.png", "ScreenshotCaption": "Telemetry showing sc.exe execution to query the AdobeUpdater service on Creeper process tree view (tainted from previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-11.png", "ScreenshotCaption": "Email excerpt sent by OverWatch team indicating they observed Bob querying for a service (Specific Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed sc.exe executing with command-line arguments. The telemetry was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-16.J.1-10.png", "ScreenshotCaption": "Telemetry showing sc.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched sc.exe with the correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery). The enrichment was tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts. \u00a0[EG11]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-16-14.png", "ScreenshotCaption": "Enriched event tree showing enrichment of sc.exe execution with correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery) (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed sc.exe execution to query the AdobeUpdater service on Creeper. The telemetry was tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts.\u00a0[EG11]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-16-14.png", "ScreenshotCaption": "Enriched event tree showing enrichment of sc.exe execution with correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery) (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing sc.exe with command-line arguments"}, {"ScreenshotName": "CC-16.I.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed sc.exe execution with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing sc.exe with command-line arguments"}, {"ScreenshotName": "CC-16.I.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched sc.exe with an alert for SC Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery).[FE7]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-16.L.1-1.png", "ScreenshotCaption": "Enrichment of sc.exe with an alert for SC Execution (Weak Signal) (tagged with the correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-16.J.1-1.png", "ScreenshotCaption": "Additional details on enrichment of sc.exe with SC Execution alert"}], "Footnotes": [" All five of the sc.exe events are rolled under the same SC Execution alert."]}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability showed powershell.exe executing sc.exe to query the AdobeUpdater service on Creeper and enriched sc.exe with the condition SC QC Reconnaissance Command. The enrichment was tainted by the parent \\\"Powershell executed remote commands alert\\\".[CT8]", "Modifiers": ["Configuration Change", "Tainted"], "Screenshots": [{"ScreenshotName": "CT-16.J.1-1.png", "ScreenshotCaption": "Enrichment showing powershell.exe executing sc.exe query AdobeUpdater service on Creeper (enriched with condition SC QC Reconnaissance Command, tainted by the parent \\\"Powershell executed remote commands\\\" alert)"}], "Footnotes": ["The capability was modified after the start of the evaluation to allow the condition contributing to Enrichment to appear, so the detection is identified as a configuration change. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched sc.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that the configuration of a system service was queried.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-16.J.1-4.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing sc.exe (tainted by a trace detection on cmd.exe)"}, {"ScreenshotName": "MC-16.J.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that the configuration of a system service was queried."}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing sc.exe. The telemetry was tainted by a trace detection on cmd.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-16.J.1-4.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing sc.exe (tainted by a trace detection on cmd.exe)"}, {"ScreenshotName": "MC-16.J.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that the configuration of a system service was queried."}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry from CodeRed showed sc.exe remote service query on Creeper for the AdobeUpdater service (tainted by parent alert on PowerShell script with suspicious content).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-16.D.1-4.png", "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"}, {"ScreenshotName": "MS-16.J.1-1.png", "ScreenshotCaption": "Telemetry from CodeRed showing execution sequence of sc.exe service query for AdobeUpdater on Creeper"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched powershell.exe executing sc.exe as enumeration of services via the command line. The data was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-16.J.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing sc.exe with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.J.1-2.png", "ScreenshotCaption": "Enrichment of powershell.exe executing sc.exe as enumeration of services via the command line (tainted by a parent alert on wscript.exe)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing sc.exe with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-16.J.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing sc.exe with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.J.1-2.png", "ScreenshotCaption": "Enrichment of powershell.exe executing sc.exe as enumeration of services via the command line (tainted by a parent alert on wscript.exe)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of sc.exe to query for the AdobeUpdater service on 10.0.0.4 (Creeper).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-16-7.png", "ScreenshotCaption": "Telemetry showing execution of sc.exe to query the AdobeUpdater service on 10.0.0.4 (Creeper)"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of sc.exe to query the AdobeUpdater service on Creeper. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-16.J.1-1.png", "ScreenshotCaption": "Telemetry showing execution of sc.exe to query AdobeUpdater service on Creeper (tainted by relationship to threat story)"}], "Footnotes": []}]}]}]}, {"Substep": "16.K.1", "Procedure": "Empire: 'type' via PowerShell to remotely enumerate a specific file (update.vbs) on Creeper (10.0.0.4)", "Techniques": [{"TechniqueId": "T1083", "TechniqueName": "File and Directory Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing the type command with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing the type command with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability identified for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[CT5]", "Modifiers": [], "Screenshots": [], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a file read event for update.vbs. The telemetry was tainted by a parent alert on wscript.exe [PA7]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-16.K.1-1.png", "ScreenshotCaption": "Telemetry showing a file read event for update.vbs (tainted by a parent alert on wscript.exe)"}], "Footnotes": ["The process tree showing taintedness is visible within the same UI but did not fit within the current frame."]}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a remote access event on update.vbs.[SO91]", "Modifiers": [], "Screenshots": [], "Footnotes": ["MITRE verified telemetry was generated for the remote update.vbs file access event, but no screenshot was available."]}]}]}]}, {"Substep": "16.L.1", "Procedure": "Empire: 'sc start' via PowerShell to remotely launch a specific service on Creeper (10.0.0.4)", "Techniques": [{"TechniqueId": "T1035", "TechniqueName": "Service Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed execution of sc.exe with command-line arguments to start the AdobeUpdater service on Creeper.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-16.L.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing sc.exe execution to start the AdobeUpdater service on Creeper"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The OverWatch team sent an email indicating they observed a Specific Behavior because update.vbs executed following the start of the AdobeUpdater service.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-16.L.1-1.png", "ScreenshotCaption": "Telemetry showing sc start in the process tree view (tainted from previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-11.png", "ScreenshotCaption": "Email excerpt sent by OverWatch team indicating they observed execution of update.vbs following the AdobeUpdater service start (Specific Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed sc.exe executing with command-line arguments to start the AdobeUpdater service on Creeper. The process tree view showed sc.exe as tainted by a previous powershell.exe detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-16.L.1-1.png", "ScreenshotCaption": "Telemetry showing sc start in the process tree view (tainted from previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-11.png", "ScreenshotCaption": "Email excerpt sent by OverWatch team indicating they observed execution of update.vbs following the AdobeUpdater service start (Specific Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed cmd.exe executing the update.vbs from the Adobe Flash Updater service. Telemetry also showed\u00a0sc.exe executing the service. The telemetry was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-16.L.1-12.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing update.vbs"}, {"ScreenshotName": "CR-16.L.1-100.png", "ScreenshotCaption": "Telemetry showing sc.exe executing the service\u00a0(tainted by a parent PowerShell alert)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for the sc.exe command to start AdobeUpdater named \"Service Command Lateral Movement\". The alert was also tagged with the correct ATT&CK Technique (T1035 - Service Execution) and Tactic (Execution).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-16-14.png", "ScreenshotCaption": "Enriched event tree showing enrichment of sc.exe execution with correct ATT&CK Technique (T1035 - Service Execution) and Tactic (Execution) (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts, tree is initially available unenriched to show the base telemetry)"}, {"ScreenshotName": "EG-16-15.png", "ScreenshotCaption": "Specific Behavior alert \\\"Service Command Lateral Movement\\\" for the start of AdobeUpdater service on Creeper tagged with correct ATT&CK Technique (T1035 - Service Execution) and Tactic (Execution)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched sc.exe with the correct ATT&CK Technique (T1035 - Service Execution) and Tactic (Execution). The event was tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts. \u00a0[EG11]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-16-14.png", "ScreenshotCaption": "Enriched event tree showing enrichment of sc.exe execution with correct ATT&CK Technique (T1035 - Service Execution) and Tactic (Execution) (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts, tree is initially available unenriched to show the base telemetry)"}, {"ScreenshotName": "EG-16-15.png", "ScreenshotCaption": "Specific Behavior alert \\\"Service Command Lateral Movement\\\" for the start of AdobeUpdater service on Creeper tagged with correct ATT&CK Technique (T1035 - Service Execution) and Tactic (Execution)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed sc.exe execution to start the AdobeUpdater service on Creeper. The telemetry was tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts.\u00a0[EG11]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-16-14.png", "ScreenshotCaption": "Enriched event tree showing enrichment of sc.exe execution with correct ATT&CK Technique (T1035 - Service Execution) and Tactic (Execution) (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts, tree is initially available unenriched to show the base telemetry)"}, {"ScreenshotName": "EG-16-15.png", "ScreenshotCaption": "Specific Behavior alert \\\"Service Command Lateral Movement\\\" for the start of AdobeUpdater service on Creeper tagged with correct ATT&CK Technique (T1035 - Service Execution) and Tactic (Execution)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for sc.exe used with parameters typical for lateral movement.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing sc.exe with command-line arguments"}, {"ScreenshotName": "CC-16.I.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}, {"ScreenshotName": "CC-16.D.1-3.png", "ScreenshotCaption": "Specific Behavior alert for sc.exe used with parameters typical for lateral movement"}], "Footnotes": []}, {"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing sc.exe with command-line arguments"}, {"ScreenshotName": "CC-16.I.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}, {"ScreenshotName": "CC-16.D.1-3.png", "ScreenshotCaption": "Specific Behavior alert for sc.exe used with parameters typical for lateral movement"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed sc.exe execution with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing sc.exe with command-line arguments"}, {"ScreenshotName": "CC-16.I.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}, {"ScreenshotName": "CC-16.D.1-3.png", "ScreenshotCaption": "Specific Behavior alert for sc.exe used with parameters typical for lateral movement"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it observed the sc.exe command starting the adobeupdater service on Creeper. [FE5][FE7]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-16.L.1-1.png", "ScreenshotCaption": "Enrichment of sc.exe with an alert for SC Execution (tagged with related ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-16.I.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report showing sc.exe starting the adobeupdater service (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident.", " All five of the sc.exe events are rolled under the same SC Execution alert."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched sc.exe with an alert for SC Execution (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-16.L.1-1.png", "ScreenshotCaption": "Enrichment of sc.exe with an alert for SC Execution (tagged with related ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-16.I.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report showing sc.exe starting the adobeupdater service (Specific Behavior)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing sc.exe to start the AdobeUpdater service on Creeper. The telemetry was tainted by the parent \\\"Powershell executed remote commands\\\" alert. Telemetry from Creeper also showed services.exe creating cmd.exe, which executed the update.vbs file (showing AdobeUpdater service starting).[CT5]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-16.L.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing sc.exe start AdobeUpdater service on Creeper (tainted by the parent \\\"Powershell executed remote commands\\\" alert)"}, {"ScreenshotName": "CT-16.L.1-2.png", "ScreenshotCaption": "Telemetry showing AdobeUpdater service starting on Creeper (tainted by the parent \\\"\\\"New Windows service created\\\"\\\" alert)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched sc.exe with a relevant ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that a Windows service was manipulated via sc.exe/net.exe tool.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-16.J.1-4.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing sc.exe (tainted by a trace detection on cmd.exe)"}, {"ScreenshotName": "MC-16.J.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with a relevant ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Windows service was manipulated via sc.exe/net.exe tool"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing sc.exe. The telemetry was tainted by a trace detection on cmd.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-16.J.1-4.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing sc.exe (tainted by a trace detection on cmd.exe)"}, {"ScreenshotName": "MC-16.J.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with a relevant ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Windows service was manipulated via sc.exe/net.exe tool"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for a successful AdobeUpdater remote service execution attempt on Creeper.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-16.D.1-4.png", "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"}, {"ScreenshotName": "MS-16.L.1-1.png", "ScreenshotCaption": "Telemetry from CodeRed showing execution sequence of sc.exe service start for AdobeUpdater on Creeper"}, {"ScreenshotName": "MS-16.L.1-2.png", "ScreenshotCaption": "Telemetry showing service execution on Creeper and new Empire connection to www.freegoogleadsenseinfo.com (C2 domain) (C2 alert rule for BORON domain was added by the vendor earlier in Step 11)"}, {"ScreenshotName": "MS-16.L.1-3.png", "ScreenshotCaption": "Specific Behavior alert showing successful remote AdobeUpdater service execution attempt from CodeRed to Creeper"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry from CodeRed showed the sc.exe remote service start to execute the AdobeUpdater service on Creeper (tainted by parent alert on PowerShell script with suspicious content). Telemetry from Creeper showed the execution sequence of Empire and command and control connections.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-16.D.1-4.png", "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"}, {"ScreenshotName": "MS-16.L.1-1.png", "ScreenshotCaption": "Telemetry from CodeRed showing execution sequence of sc.exe service start for AdobeUpdater on Creeper"}, {"ScreenshotName": "MS-16.L.1-2.png", "ScreenshotCaption": "Telemetry showing service execution on Creeper and new Empire connection to www.freegoogleadsenseinfo.com (C2 domain) (C2 alert rule for BORON domain was added by the vendor earlier in Step 11)"}, {"ScreenshotName": "MS-16.L.1-3.png", "ScreenshotCaption": "Specific Behavior alert showing successful remote AdobeUpdater service execution attempt from CodeRed to Creeper"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched sc.exe executing with command-line arguments with the correct ATT&CK Technique (Service Execution).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-16.L.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing sc with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.L.1-2.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing update.vbs on 10.0.0.4 (Creeper)"}, {"ScreenshotName": "PA-16.L.1-3.png", "ScreenshotCaption": "Enrichment of sc.exe executing with command-line arguments with the correct ATT&CK Technique (Service Execution)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing sc with command-line arguments. As part of the service, telemetry also showed cmd.exe executing update.vbs on 10.0.0.4 (Creeper). The telemetry was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-16.L.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing sc with command-line arguments (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-16.L.1-2.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing update.vbs on 10.0.0.4 (Creeper)"}, {"ScreenshotName": "PA-16.L.1-3.png", "ScreenshotCaption": "Enrichment of sc.exe executing with command-line arguments with the correct ATT&CK Technique (Service Execution)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of sc.exe to start the AdobeUpdater service on 10.0.0.4 (Creeper). Telemetry on Creeper showed the execution of cmd.exe to run update.vbs.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-16-9.png", "ScreenshotCaption": "Telemetry showing the execution of sc.exe to start the AdobeUpdater service on 10.0.0.4 (Creeper)"}, {"ScreenshotName": "RSA-16-8.png", "ScreenshotCaption": "Telemetry showing the execution of update.vbs on 10.0.0.4 (Creeper)"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for the lateral movement activity. A new story grouping was generated for the event on Creeper to associate subsequent activity.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "S1-16.L.1-1.png", "ScreenshotCaption": "Telemetry showing execution of sc.exe to start the AdobeUpdater service on Creeper (tainted by relationship to threat story)"}, {"ScreenshotName": "S1-16.G.1-1.png", "ScreenshotCaption": "Lateral movement alert generated by the remote service start on Creeper"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of sc.exe to start the AdobeUpdater service on Creeper. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-16.L.1-1.png", "ScreenshotCaption": "Telemetry showing execution of sc.exe to start the AdobeUpdater service on Creeper (tainted by relationship to threat story)"}, {"ScreenshotName": "S1-16.G.1-1.png", "ScreenshotCaption": "Lateral movement alert generated by the remote service start on Creeper"}], "Footnotes": []}]}]}]}, {"Substep": "17.A.1", "Procedure": "Empire: 'reg query' via PowerShell to enumerate a specific Registry key associated with terminal services", "Techniques": [{"TechniqueId": "T1007", "TechniqueName": "System Service Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed reg.exe executing with command-line arguments to check if terminal services were enabled.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-17.A.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing reg.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed reg.exe executing with command-line arguments to check if terminal services are enabled. The process tree view showed reg.exe as tainted by a previous powershell.exe detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-17.A.1-1.png", "ScreenshotCaption": "Telemetry from process tree view showing reg.exe executing with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed reg.exe executing with command-line arguments indicating a check to see if terminal services were enabled. The telemetry was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-17.A.1-20.png", "ScreenshotCaption": "Telemetry of reg.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing reg.exe with command-line arguments indicating a check to see if terminal services was enabled. Telemetry was tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-17-2.png", "ScreenshotCaption": "Telemetry from event tree showing reg.exe"}, {"ScreenshotName": "EG-17-1.png", "ScreenshotCaption": "Event tree view showing tainted powershell.exe with reg.exe child process"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed reg.exe with command-line arguments to check if terminal services were enabled.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-17.A.1-1.png", "ScreenshotCaption": "Telemetry showing reg.exe with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed reg.exe executing with command-line arguments to check if terminal services are enabled. The telemetry was tainted by the parent Reg Execution (Weak Signal) alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "FE-17.A.1-1.png", "ScreenshotCaption": "Telemetry showing reg.exe executing with command-line arguments (tainted by parent Reg Execution alert)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing reg.exe with command-line arguments indicating a check to see if terminal services was enabled. The telemetry was tainted by the parent \\\"New Windows service created\\\" alert.[CT5]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-17.A.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing reg.exe (tainted by the parent \\\"New Windows service created\\\" alert)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Registry was queried for remote services RDP.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-17.A.1-2.png", "ScreenshotCaption": "Telemetry of reg.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "MC-17.A.1-9.png", "ScreenshotCaption": "Enrichment of powershell.exe that executed reg.exe with the ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that PowerShell queried terminal services Registry"}, {"ScreenshotName": "MC-17.A.1-99.png", "ScreenshotCaption": "Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Registry was queried for remote services RDP"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the powershell.exe that executed reg.exe with the ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that PowerShell queried terminal services Registry.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-17.A.1-2.png", "ScreenshotCaption": "Telemetry of reg.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "MC-17.A.1-9.png", "ScreenshotCaption": "Enrichment of powershell.exe that executed reg.exe with the ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that PowerShell queried terminal services Registry"}, {"ScreenshotName": "MC-17.A.1-99.png", "ScreenshotCaption": "Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Registry was queried for remote services RDP"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed reg.exe executing with command-line arguments. The telemetry was tainted by a parent cmd.exe alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-17.A.1-2.png", "ScreenshotCaption": "Telemetry of reg.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "MC-17.A.1-9.png", "ScreenshotCaption": "Enrichment of powershell.exe that executed reg.exe with the ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that PowerShell queried terminal services Registry"}, {"ScreenshotName": "MC-17.A.1-99.png", "ScreenshotCaption": "Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Registry was queried for remote services RDP"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed reg.exe executing with command-line arguments indicating a check to see if terminal services was enabled (tainted by prior alert on suspicious PowerShell command-line).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-17.A.1-1.png", "ScreenshotCaption": "Telemetry showing reg.exe query for terminal server setting"}, {"ScreenshotName": "MS-17.A.1-2.png", "ScreenshotCaption": "Process tree view of suspicious PowerShell command-line alert showing tainted relationship to reg.exe query"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched reg.exe executing with command-line arguments as the terminal server key queried by the reg utility. The data was tainted by a parent alert on cmd.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-17.A.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing reg with command-line arguments (tainted by a parent alert on cmd.exe)"}, {"ScreenshotName": "PA-17.A.1-2.png", "ScreenshotCaption": "Enrichment of reg.exe executing with command-line arguments as the terminal server key queried by the reg utility (tainted by a parent alert on cmd.exe)"}, {"ScreenshotName": "PA-17.A.1-3.png", "ScreenshotCaption": "Enrichment of reg.exe executing with command-line arguments with the correct ATT&CK Technique (System Service Discovery)."}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched reg.exe executing with command-line arguments with the correct ATT&CK Technique (System Service Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-17.A.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing reg with command-line arguments (tainted by a parent alert on cmd.exe)"}, {"ScreenshotName": "PA-17.A.1-2.png", "ScreenshotCaption": "Enrichment of reg.exe executing with command-line arguments as the terminal server key queried by the reg utility (tainted by a parent alert on cmd.exe)"}, {"ScreenshotName": "PA-17.A.1-3.png", "ScreenshotCaption": "Enrichment of reg.exe executing with command-line arguments with the correct ATT&CK Technique (System Service Discovery)."}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing reg with command-line arguments. The telemetry was tainted by a parent alert on cmd.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-17.A.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing reg with command-line arguments (tainted by a parent alert on cmd.exe)"}, {"ScreenshotName": "PA-17.A.1-2.png", "ScreenshotCaption": "Enrichment of reg.exe executing with command-line arguments as the terminal server key queried by the reg utility (tainted by a parent alert on cmd.exe)"}, {"ScreenshotName": "PA-17.A.1-3.png", "ScreenshotCaption": "Enrichment of reg.exe executing with command-line arguments with the correct ATT&CK Technique (System Service Discovery)."}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed reg.exe executing with command-line arguments indicating a check to see if terminal services was enabled.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-17-1.png", "ScreenshotCaption": "Telemetry showing reg.exe query for terminal server setting"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed reg.exe execution with command-line arguments indicating a check to see if terminal services was enabled. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-17.A.1-4.png", "ScreenshotCaption": "Threat story graph showing telemetry of reg.exe with query for terminal server setting (tainted by prior lateral movement alert by Group ID)"}], "Footnotes": []}]}]}]}, {"Substep": "17.A.1", "Procedure": "Empire: 'reg query' via PowerShell to enumerate a specific Registry key", "Techniques": [{"TechniqueId": "T1012", "TechniqueName": "Query Registry", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched reg.exe with the correct ATT&CK Technique (T1012 - Query Registry).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-17.A.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing reg.exe with command-line arguments"}, {"ScreenshotName": "CB-17.A.1-2.png", "ScreenshotCaption": "Enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed reg.exe executing with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-17.A.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing reg.exe with command-line arguments"}, {"ScreenshotName": "CB-17.A.1-2.png", "ScreenshotCaption": "Enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed reg.exe executing with command-line arguments. The process tree view showed reg.exe as tainted by a previous powershell.exe detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-17.A.1-1.png", "ScreenshotCaption": "Telemetry from process tree view showing reg.exe executing with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed reg.exe executing with command-line arguments. The telemetry was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-17.A.1-10.png", "ScreenshotCaption": "Telemetry of reg.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched reg.exe with the correct ATT&CK Technique (T1012 - Query Registry) and Tactic (Discovery). [EG11]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-17-1.png", "ScreenshotCaption": "Event tree view showing tainted powershell.exe with reg.exe child process"}, {"ScreenshotName": "EG-17-2.png", "ScreenshotCaption": "Enriched event tree showing enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry) and Tactic (Discovery) (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing reg.exe with command-line arguments. The telemetry was tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts. [EG11]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-17-1.png", "ScreenshotCaption": "Event tree view showing tainted powershell.exe with reg.exe child process"}, {"ScreenshotName": "EG-17-2.png", "ScreenshotCaption": "Enriched event tree showing enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry) and Tactic (Discovery) (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (reg) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-17.A.1-1.png", "ScreenshotCaption": "Telemetry showing reg.exe with command-line arguments"}, {"ScreenshotName": "CC-17.A.1-2.png", "ScreenshotCaption": "Enrichment of reg.exe indicating that a sensitive registry key was accessed for potential reconnaissance"}, {"ScreenshotName": "CC-17.A.1-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (reg) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched reg.exe indicating that a sensitive registry key was accessed for potential reconnaissance.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-17.A.1-1.png", "ScreenshotCaption": "Telemetry showing reg.exe with command-line arguments"}, {"ScreenshotName": "CC-17.A.1-2.png", "ScreenshotCaption": "Enrichment of reg.exe indicating that a sensitive registry key was accessed for potential reconnaissance"}, {"ScreenshotName": "CC-17.A.1-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (reg) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed reg.exe with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-17.A.1-1.png", "ScreenshotCaption": "Telemetry showing reg.exe with command-line arguments"}, {"ScreenshotName": "CC-17.A.1-2.png", "ScreenshotCaption": "Enrichment of reg.exe indicating that a sensitive registry key was accessed for potential reconnaissance"}, {"ScreenshotName": "CC-17.A.1-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (reg) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched reg.exe with an alert for Reg Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1012 - Query Registry) and Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-17.A.1-1.png", "ScreenshotCaption": "Enrichment of reg.exe with Reg Execution alert (tagged with correct ATT&CK Technique, T1012 - Query Registry, and Tactic, Discovery)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing reg.exe with command-line arguments. The telemetry was tainted by the parent \\\"New Windows service created\\\" alert.[CT5]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-17.A.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing reg.exe (tainted by the parent \\\"New Windows service created\\\" alert)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (Query Registry) and a suspicious indicator that the reg.exe utility queried the Registry.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-17.A.1-2.png", "ScreenshotCaption": "Telemetry of reg.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "MC-17.A.1-9.png", "ScreenshotCaption": "Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (Query Registry) and a suspicious indicator that the reg.exe utility queried the Registry"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing reg.exe. The telemetry was tainted by a trace detection on cmd.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-17.A.1-2.png", "ScreenshotCaption": "Telemetry of reg.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "MC-17.A.1-9.png", "ScreenshotCaption": "Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (Query Registry) and a suspicious indicator that the reg.exe utility queried the Registry"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed reg.exe executing with command-line arguments (tainted by prior alert on suspicious PowerShell command line).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-17.A.1-2.png", "ScreenshotCaption": "Process tree view of suspicious PowerShell command-line alert showing tainted relationship to reg.exe query"}, {"ScreenshotName": "MS-17.A.1-1.png", "ScreenshotCaption": "Telemetry showing reg.exe executing with command-line arguments"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched reg.exe executing with command-line arguments as the terminal server key queried by the reg utility. The data was tainted by a parent alert on cmd.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-17.A.1-2.png", "ScreenshotCaption": "Enrichment of reg.exe executing with command-line arguments as the terminal server key queried by the reg utility (tainted by a parent alert on cmd.exe)"}, {"ScreenshotName": "PA-17.A.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing reg with command-line arguments to check if terminal services were enabled. (tainted by a parent alert on cmd.exe)"}, {"ScreenshotName": "PA-17.A.1-3.png", "ScreenshotCaption": "Enrichment of reg.exe executing with command-line arguments with a related ATT&CK Technique (System Service Discovery)."}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched reg.exe executing with command-line arguments with a related ATT&CK Technique (System Service Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-17.A.1-2.png", "ScreenshotCaption": "Enrichment of reg.exe executing with command-line arguments as the terminal server key queried by the reg utility (tainted by a parent alert on cmd.exe)"}, {"ScreenshotName": "PA-17.A.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing reg with command-line arguments to check if terminal services were enabled. (tainted by a parent alert on cmd.exe)"}, {"ScreenshotName": "PA-17.A.1-3.png", "ScreenshotCaption": "Enrichment of reg.exe executing with command-line arguments with a related ATT&CK Technique (System Service Discovery)."}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing reg with command-line arguments to check if terminal services were enabled. The telemetry was tainted by a parent alert on cmd.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-17.A.1-2.png", "ScreenshotCaption": "Enrichment of reg.exe executing with command-line arguments as the terminal server key queried by the reg utility (tainted by a parent alert on cmd.exe)"}, {"ScreenshotName": "PA-17.A.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing reg with command-line arguments to check if terminal services were enabled. (tainted by a parent alert on cmd.exe)"}, {"ScreenshotName": "PA-17.A.1-3.png", "ScreenshotCaption": "Enrichment of reg.exe executing with command-line arguments with a related ATT&CK Technique (System Service Discovery)."}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed reg.exe executing with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-17-1.png", "ScreenshotCaption": "Telemetry showing reg.exe execution"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed reg.exe execution with command-line arguments. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-17.A.1-4.png", "ScreenshotCaption": "Threat story graph showing telemetry of reg.exe executing (tainted by prior lateral movement alert by Group ID)"}], "Footnotes": []}]}]}]}, {"Substep": "17.B.1", "Procedure": "Empire: 'takeown' via PowerShell to obtain ownership of magnify.exe", "Techniques": [{"TechniqueId": "T1222", "TechniqueName": "File and Directory Permissions Modification", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the execution of takeown.exe with \\\"Permission modifications\\\".[CB1]", "Modifiers": ["Configuration Change"], "Screenshots": [{"ScreenshotName": "CB-17.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing takeown.exe with command-line arguments"}, {"ScreenshotName": "CB-17.A.1-2.png", "ScreenshotCaption": "Enrichment of takeown.exe execution with tag \\\"Permission modifications\\\""}], "Footnotes": [" The enrichment was added as a configuration change during the action and was not part of the original set of detections when the evaluation started."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed execution of takeown.exe with command-line arguments on magnify.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-17.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing takeown.exe with command-line arguments"}, {"ScreenshotName": "CB-17.A.1-2.png", "ScreenshotCaption": "Enrichment of takeown.exe execution with tag \\\"Permission modifications\\\""}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team sent an email indicating a General Behavior was observed because takeown.exe was executed to bypass Windows logon.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-17.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree view showing execution of takeown.exe (tainted by previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-11.png", "ScreenshotCaption": "Email excerpt sent by OverWatch team indicating they observed takeown.exe executed to bypass Windows logon (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed takeown.exe executing with command-line arguments. The process tree view showed takeown.exe as tainted by a previous powershell.exe detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-17.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree view showing execution of takeown.exe (tainted by previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-11.png", "ScreenshotCaption": "Email excerpt sent by OverWatch team indicating they observed takeown.exe executed to bypass Windows logon (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for takeown.exe performing activity related to swapping an accessibility features binary. The telemetry was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-17.B.1-10.png", "ScreenshotCaption": "General Behavior alert for takeown.exe performing activity related to swapping an accessibility features binary (tainted by a parent PowerShell alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed takeown.exe executing with command-line arguments.[CR3]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-17.B.1-10.png", "ScreenshotCaption": "General Behavior alert for takeown.exe performing activity related to swapping an accessibility features binary (tainted by a parent PowerShell alert)"}], "Footnotes": [" For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing takeown.exe with command-line arguments. Telemetry was tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-17-1.png", "ScreenshotCaption": "Telemetry from event tree showing takeown.exe (tainted by parent alerts on powershell.exe)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for takeown.exe changing the ownership of an accessibility feature executable.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-17.A.1-1.png", "ScreenshotCaption": "Telemetry showing takeown.exe with command-line arguments"}, {"ScreenshotName": "CC-17.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert for takeown.exe changing the ownership of an accessibility feature executable"}, {"ScreenshotName": "CC-17.A.1-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (takeown) has been tagged for monitoring because its parent process has a detection (powershell.exe)."}], "Footnotes": []}, {"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (takeown) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-17.A.1-1.png", "ScreenshotCaption": "Telemetry showing takeown.exe with command-line arguments"}, {"ScreenshotName": "CC-17.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert for takeown.exe changing the ownership of an accessibility feature executable"}, {"ScreenshotName": "CC-17.A.1-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (takeown) has been tagged for monitoring because its parent process has a detection (powershell.exe)."}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed takeown.exe executing with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-17.A.1-1.png", "ScreenshotCaption": "Telemetry showing takeown.exe with command-line arguments"}, {"ScreenshotName": "CC-17.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert for takeown.exe changing the ownership of an accessibility feature executable"}, {"ScreenshotName": "CC-17.A.1-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (takeown) has been tagged for monitoring because its parent process has a detection (powershell.exe)."}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched takeown.exe with an alert for Takeown Execution. The alert described how takeown can be used to change file ownership.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-17.B.1-1.png", "ScreenshotCaption": "Enrichment of takeown.exe with Takeown Execution alert"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing takeown.exe to take ownership of magnify.exe. The telemetry was tainted by the parent \\\"New Windows service created\\\" alert.[CT5]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-17.B.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing takeown.exe (tainted by the parent \\\"New Windows service created\\\" alert)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched takeown.exe with a suspicious indicator that the takeown command was executed to obtain ownership of a file or directory.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-17.A.1-1.png", "ScreenshotCaption": "Telemetry of reg.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "MC-17.A.1-9.png", "ScreenshotCaption": "Enrichment of takeown.exe with a suspicious indicator that the takeown command was executed to obtain ownership of a file or directory"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing takeown.exe. The telemetry was tainted by a trace detection on cmd.exe..", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-17.A.1-1.png", "ScreenshotCaption": "Telemetry of reg.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "MC-17.A.1-9.png", "ScreenshotCaption": "Enrichment of takeown.exe with a suspicious indicator that the takeown command was executed to obtain ownership of a file or directory"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed takeown.exe execution to change the file permissions on magnify.exe (tainted by prior alert on suspicious PowerShell command-line).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-17.B.1-1.png", "ScreenshotCaption": "Telemetry showing takeown.exe execution with magnify.exe in command-line arguments"}, {"ScreenshotName": "MS-17.A.1-2.png", "ScreenshotCaption": "Process tree view of suspicious PowerShell command-line alert showing tainted relationship to takeown.exe"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched reg.exe executing with command-line arguments with the correct ATT&CK Technique (File Permissions Modification).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-17.B.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing takeown with command-line arguments (tainted by a parent alert on cmd.exe)"}, {"ScreenshotName": "PA-17.B.1-2.png", "ScreenshotCaption": "Enrichment of takeown.exe executing with command-line arguments as changing permission or ownership of a file or folder (tainted by a parent alert on cmd.exe)"}, {"ScreenshotName": "PA-17.B.1-3.png", "ScreenshotCaption": "Enrichment of takeown.exe executing with command-line arguments with the correct ATT&CK Technique (File Permissions Modification)."}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched takeown.exe executing with command-line arguments as changing permission or ownership of a file or folder. The data was tainted by a parent alert on cmd.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-17.B.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing takeown with command-line arguments (tainted by a parent alert on cmd.exe)"}, {"ScreenshotName": "PA-17.B.1-2.png", "ScreenshotCaption": "Enrichment of takeown.exe executing with command-line arguments as changing permission or ownership of a file or folder (tainted by a parent alert on cmd.exe)"}, {"ScreenshotName": "PA-17.B.1-3.png", "ScreenshotCaption": "Enrichment of takeown.exe executing with command-line arguments with the correct ATT&CK Technique (File Permissions Modification)."}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing takeown with command-line arguments. The telemetry was tainted by a parent alert on cmd.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-17.B.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing takeown with command-line arguments (tainted by a parent alert on cmd.exe)"}, {"ScreenshotName": "PA-17.B.1-2.png", "ScreenshotCaption": "Enrichment of takeown.exe executing with command-line arguments as changing permission or ownership of a file or folder (tainted by a parent alert on cmd.exe)"}, {"ScreenshotName": "PA-17.B.1-3.png", "ScreenshotCaption": "Enrichment of takeown.exe executing with command-line arguments with the correct ATT&CK Technique (File Permissions Modification)."}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed takeown.exe execution to change the file permissions on magnify.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-17-1.png", "ScreenshotCaption": "Telemetry showing takeown.exe execution with magnify.exe in command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "Telemetry showed takeown.exe execution with command-line arguments containing magnify.exe. The event was enriched to show that ownership of a file was taken over. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-17.A.1-1.png", "ScreenshotCaption": "Enrichment showing takeown.exe execution (tainted by prior lateral movement alert by Group ID)"}], "Footnotes": []}]}]}]}, {"Substep": "17.B.2", "Procedure": "Empire: 'icacls' via PowerShell to modify the DACL for magnify.exe", "Techniques": [{"TechniqueId": "T1222", "TechniqueName": "File and Directory Permissions Modification", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the execution of icacls.exe with \\\"Permission modifications\\\".[CB1]", "Modifiers": ["Configuration Change"], "Screenshots": [{"ScreenshotName": "CB-17.B.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing icacls.exe with command-line arguments"}, {"ScreenshotName": "CB-17.A.1-2.png", "ScreenshotCaption": "Enrichment of icacls.exe execution with tag \\\"Permission modifications\\\""}], "Footnotes": [" The enrichment was added as a configuration change during the action and was not part of the original set of detections when the evaluation started."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed execution of icacls.exe with command-line arguments on magnify.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-17.B.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing icacls.exe with command-line arguments"}, {"ScreenshotName": "CB-17.A.1-2.png", "ScreenshotCaption": "Enrichment of icacls.exe execution with tag \\\"Permission modifications\\\""}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "The OverWatch team sent an email indicating a General Behavior was observed because icacls.exe was executed to bypass Windows logon.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-17.B.2-1.png", "ScreenshotCaption": "Telemetry from process tree view showing execution of icacls.exe (tainted by previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-11.png", "ScreenshotCaption": "Email excerpt sent by OverWatch team indicating they observed icacls.exe executed to bypass Windows logon (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of icacls.exe with command-line arguments. The process tree view showed icacls.exe as tainted by a previous powershell.exe detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-17.B.2-1.png", "ScreenshotCaption": "Telemetry from process tree view showing execution of icacls.exe (tainted by previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-E-11.png", "ScreenshotCaption": "Email excerpt sent by OverWatch team indicating they observed icacls.exe executed to bypass Windows logon (General Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed icacls.exe executing with command-line arguments. The telemetry was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-17.B.2-10.png", "ScreenshotCaption": "Telemetry showing icacls.exe executing\u00a0 with command-line arguments (tainted by a parent PowerShell alert)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing icacls.exe with command-line arguments. Telemetry was tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-17-1.png", "ScreenshotCaption": "Telemetry from event tree showing icacls.exe (tainted by parent alerts on powershell.exe)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for icalcs.exe changing the permissions of an accessibility feature executable.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-17.A.1-1.png", "ScreenshotCaption": "Telemetry showing icacls.exe with command-line arguments"}, {"ScreenshotName": "CC-17.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert for icacls.exe changing the permissions of an accessibility feature executable"}, {"ScreenshotName": "CC-17.A.1-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (icacls) has been tagged for monitoring because its parent process has a detection (powershell.exe)."}], "Footnotes": []}, {"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (icacls) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-17.A.1-1.png", "ScreenshotCaption": "Telemetry showing icacls.exe with command-line arguments"}, {"ScreenshotName": "CC-17.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert for icacls.exe changing the permissions of an accessibility feature executable"}, {"ScreenshotName": "CC-17.A.1-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (icacls) has been tagged for monitoring because its parent process has a detection (powershell.exe)."}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed icacls.exe executing with command-line arguments.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-17.A.1-1.png", "ScreenshotCaption": "Telemetry showing icacls.exe with command-line arguments"}, {"ScreenshotName": "CC-17.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert for icacls.exe changing the permissions of an accessibility feature executable"}, {"ScreenshotName": "CC-17.A.1-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (icacls) has been tagged for monitoring because its parent process has a detection (powershell.exe)."}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched icacls.exe with an alert for Icacls Execution. The alert described how icacls can be used to display or change Windows file ACLs.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-17.B.2-1.png", "ScreenshotCaption": "Enrichment of icacls.exe with Icacls Execution alert"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe running icacls.exe to modify magnify.exe access controls. The telemetry was tainted by the parent \\\"New Windows service created\\\" alert.[CT5]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-17.B.2-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing icacls.exe (tainted by the parent \\\"New Windows service created\\\" alert)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched icacls.exe with a suspicious indicator that full access permissions were given to certain users.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-17.A.1-1.png", "ScreenshotCaption": "Telemetry of reg.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "MC-17.A.1-9.png", "ScreenshotCaption": "Enrichment of icacls.exe with a suspicious indicator that full access permissions were given to certain users"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing icacls.exe. The telemetry was tainted by a trace detection on cmd.exe..", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-17.A.1-1.png", "ScreenshotCaption": "Telemetry of reg.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "MC-17.A.1-9.png", "ScreenshotCaption": "Enrichment of icacls.exe with a suspicious indicator that full access permissions were given to certain users"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed icacls.exe execution to change permissions on magnify.exe granting discretionary access to SYSTEM (tainted by prior alert on suspicious PowerShell command-line).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-17.A.1-2.png", "ScreenshotCaption": "Process tree view of suspicious PowerShell command-line alert showing tainted relationship to reg.exe query"}, {"ScreenshotName": "MS-17.B.2-1.png", "ScreenshotCaption": "Telemetry showing icacls.exe execution with magnify.exe in command-line arguments"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched icalcs.exe executing with command-line arguments with the correct ATT&CK Technique (File Permissions Modification).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-17.B.2-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing icacls with command-line arguments (tainted by a parent alert on cmd.exe)"}, {"ScreenshotName": "PA-17.B.2-2.png", "ScreenshotCaption": "Enrichment of icacls.exe executing with command-line arguments with the correct ATT&CK Technique (File Permissions Modification)."}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing icalcs with command-line arguments. The telemetry was tainted by a parent alert on cmd.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-17.B.2-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing icacls with command-line arguments (tainted by a parent alert on cmd.exe)"}, {"ScreenshotName": "PA-17.B.2-2.png", "ScreenshotCaption": "Enrichment of icacls.exe executing with command-line arguments with the correct ATT&CK Technique (File Permissions Modification)."}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed icacls.exe execution to change permissions on magnify.exe granting discretionary access to SYSTEM.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-17-1.png", "ScreenshotCaption": "Telemetry showing icacls.exe execution with magnify.exe in command-line arguments"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed icacls.exe execution with command-line arguments containing magnify.exe. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-17.A.1-3.png", "ScreenshotCaption": "Telemetry showing icacls.exe execution (tainted by prior lateral movement alert by Group ID)"}], "Footnotes": []}]}]}]}, {"Substep": "17.C.1", "Procedure": "Empire: 'copy' via PowerShell to overwrite magnify.exe with cmd.exe", "Techniques": [{"TechniqueId": "T1015", "TechniqueName": "Accessibility Features", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for powershell.exe with a severity score of 51/100 when magnify.exe was replaced. The alert was also mapped to the correct ATT&CK Technique (T1015 - Accessibility Features).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-17.C.1-1.png", "ScreenshotCaption": "Telemetry showing creation and file write replacing magnify.exe in the system directory"}, {"ScreenshotName": "CB-17.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert on powershell.exe when it replaced magnify.exe (mapped to correct ATT&CK Technique, T1015 - Accessibility Features)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed filemod events overwriting magnify.exe in the system directory.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-17.C.1-1.png", "ScreenshotCaption": "Telemetry showing creation and file write replacing magnify.exe in the system directory"}, {"ScreenshotName": "CB-17.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert on powershell.exe when it replaced magnify.exe (mapped to correct ATT&CK Technique, T1015 - Accessibility Features)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a file write of magnify.exe by powershell.exe in the system directory. The telemetry was tainted by an alert on its parent powershell.exe process.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-17.C.1-1.png", "ScreenshotCaption": "Telemetry showing file write of magnify.exe by powershell.exe (tainted by parent powershell.exe high severity alert indicated by red icon)"}, {"ScreenshotName": "CS-17.C.1-2.png", "ScreenshotCaption": "Additional view of telemetry showing the magnify.exe file write"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed creation and file write events for magnify.exe. The telemetry was tainted by a parent PowerShell alert listed as the owner process.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-17.C.1-10.png", "ScreenshotCaption": "Telemetry showing creation and write events for magnify.exe (tainted by a parent PowerShell alert, listed as Owner process)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated named \"Persistence-Accessibility Features\" based on magnifier.exe being overwritten. The alert was tagged with the correct ATT&CK Technique (T1015 - Accessibility Features) and Tactic (Persistence).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-17-1.png", "ScreenshotCaption": "Specific Behavior alert on overwrite of magnify.exe named \\\"Persistence-Accessibility Features\\\" tagged with correct ATT&CK Technique (T1015 - Accessibility Features) and Tactic (Persistence) (tainted by parent alerts on powershell.exe)"}, {"ScreenshotName": "EG-17-2.png", "ScreenshotCaption": "Enriched event tree showing enrichment of magnify.exe overwrite with correct ATT&CK Technique (T1015 - Accessibility Features) and Tactic (Persistence) (tainted by parent alerts on powershell.exe, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the magnify.exe overwrite with the correct ATT&CK Technique (T1015 - Accessibility Features) and Tactic (Persistence). [EG11]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-17-1.png", "ScreenshotCaption": "Specific Behavior alert on overwrite of magnify.exe named \\\"Persistence-Accessibility Features\\\" tagged with correct ATT&CK Technique (T1015 - Accessibility Features) and Tactic (Persistence) (tainted by parent alerts on powershell.exe)"}, {"ScreenshotName": "EG-17-2.png", "ScreenshotCaption": "Enriched event tree showing enrichment of magnify.exe overwrite with correct ATT&CK Technique (T1015 - Accessibility Features) and Tactic (Persistence) (tainted by parent alerts on powershell.exe, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the overwrite of magnify.exe and was tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts. [EG11]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-17-1.png", "ScreenshotCaption": "Specific Behavior alert on overwrite of magnify.exe named \\\"Persistence-Accessibility Features\\\" tagged with correct ATT&CK Technique (T1015 - Accessibility Features) and Tactic (Persistence) (tainted by parent alerts on powershell.exe)"}, {"ScreenshotName": "EG-17-2.png", "ScreenshotCaption": "Enriched event tree showing enrichment of magnify.exe overwrite with correct ATT&CK Technique (T1015 - Accessibility Features) and Tactic (Persistence) (tainted by parent alerts on powershell.exe, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for the modification of an accessibility features binary known to be used for privilege escalation.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-17.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert for the modification of an accessibility features binary known to be used for privilege escalation"}, {"ScreenshotName": "CC-17.B.2-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe overwriting magnify.exe with cmd.exe via the copy command"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched cmd.exe as being renamed to another process and with a relevant ATT&CK Technique (Masquerading). [CC3]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-17.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert for the modification of an accessibility features binary known to be used for privilege escalation"}, {"ScreenshotName": "CC-17.B.2-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe overwriting magnify.exe with cmd.exe via the copy command"}], "Footnotes": ["Screenshot is not available due to sensitivity of rule logic."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe overwriting magnify.exe with cmd.exe via the copy command.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-17.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert for the modification of an accessibility features binary known to be used for privilege escalation"}, {"ScreenshotName": "CC-17.B.2-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe overwriting magnify.exe with cmd.exe via the copy command"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was also generated for Accessibility Features File Write (Weak Signal) based on magnifier.exe being overwritten. The alert was also tagged with the correct ATT&CK Technique (T1015 - Accessibility Features) and Tactic (Persistence).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-17.C.1-1.png", "ScreenshotCaption": "Specific Behavior alert on overwrite of magnify.exe for Suspicious Accessibility Features Replacement (BACKDOOR) (tagged with correct ATT&CK Technique, T1015 - Accessibility Features, and Tactic, Persistence)"}, {"ScreenshotName": "FE-17.C.1-2.png", "ScreenshotCaption": "Specific Behavior alert on overwrite of the magnify.exe for Accessibility Feature File Write (tagged with correct ATT&CK Technique, T1015 - Accessibility Features, and Tactic, Persistence)"}, {"ScreenshotName": "FE-17.C.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker overwrote magnifier.exe (Specific Behavior)"}], "Footnotes": []}, {"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for Suspicious Accessibility Features Replacement (BACKDOOR) based on magnifer.exe being overwritten. The alert was also tagged with the correct ATT&CK Technique (T1015 - Accessibility Features) and Tactic (Persistence).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-17.C.1-1.png", "ScreenshotCaption": "Specific Behavior alert on overwrite of magnify.exe for Suspicious Accessibility Features Replacement (BACKDOOR) (tagged with correct ATT&CK Technique, T1015 - Accessibility Features, and Tactic, Persistence)"}, {"ScreenshotName": "FE-17.C.1-2.png", "ScreenshotCaption": "Specific Behavior alert on overwrite of the magnify.exe for Accessibility Feature File Write (tagged with correct ATT&CK Technique, T1015 - Accessibility Features, and Tactic, Persistence)"}, {"ScreenshotName": "FE-17.C.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker overwrote magnifier.exe (Specific Behavior)"}], "Footnotes": []}, {"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified magnifer.exe being overwritten with cmd.exe. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-17.C.1-1.png", "ScreenshotCaption": "Specific Behavior alert on overwrite of magnify.exe for Suspicious Accessibility Features Replacement (BACKDOOR) (tagged with correct ATT&CK Technique, T1015 - Accessibility Features, and Tactic, Persistence)"}, {"ScreenshotName": "FE-17.C.1-2.png", "ScreenshotCaption": "Specific Behavior alert on overwrite of the magnify.exe for Accessibility Feature File Write (tagged with correct ATT&CK Technique, T1015 - Accessibility Features, and Tactic, Persistence)"}, {"ScreenshotName": "FE-17.C.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker overwrote magnifier.exe (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched powershell.exe creating and writing magnify.exe to the system directory with the condition \\\"Creation of Sticky Keys File.\\\" The enrichment was tainted by parent \\\"New Windows service created\\\" alerts.[CT12]", "Modifiers": ["Configuration Change", "Tainted"], "Screenshots": [{"ScreenshotName": "CT-17.C.1-1.png", "ScreenshotCaption": "Enrichment showing powershell.exe creating and writing magnify.exe (enriched with condition \\\"Creation of Sticky Keys File\\\", tainted by the parent \\\"New Windows service created\\\" alert)"}, {"ScreenshotName": "CT-17.C.1-2.png", "ScreenshotCaption": "Telemetry showing copy of cmd.exe to magnify.exe in the system directory (tainted by the parent \\\"New Windows service created\\\" alert)"}], "Footnotes": ["The condition contributing to Enrichment may have been added to the capability's detection after the start of the evaluation, so the detection is identified as a configuration change. See Configuration page for details."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry also showed a different view of the event with powershell.exe copying cmd.exe as magnify.exe in the system directory. The telemetry was tainted by parent \"New Windows service created\" alerts.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-17.C.1-1.png", "ScreenshotCaption": "Enrichment showing powershell.exe creating and writing magnify.exe (enriched with condition \\\"Creation of Sticky Keys File\\\", tainted by the parent \\\"New Windows service created\\\" alert)"}, {"ScreenshotName": "CT-17.C.1-2.png", "ScreenshotCaption": "Telemetry showing copy of cmd.exe to magnify.exe in the system directory (tainted by the parent \\\"New Windows service created\\\" alert)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for powershell.exe altering the attributes of an executable file under the Windows system folder.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-17.C.1-1.png", "ScreenshotCaption": "Telemetry showing a file modification event for Magnifier.exe"}, {"ScreenshotName": "MC-17.A.1-9.png", "ScreenshotCaption": "A General Behavior alert for powershell.exe altering the attributes of an executable file under the Windows system folder"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a file modification event for Magnifier.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-17.C.1-1.png", "ScreenshotCaption": "Telemetry showing a file modification event for Magnifier.exe"}, {"ScreenshotName": "MC-17.A.1-9.png", "ScreenshotCaption": "A General Behavior alert for powershell.exe altering the attributes of an executable file under the Windows system folder"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for overwrite of magnify.exe indicating a sticky keys binary hijack for persistence was detected.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-17.C.1-1.png", "ScreenshotCaption": "Telemetry showing overwrite of magnify.exe"}, {"ScreenshotName": "MS-17.C.1-2.png", "ScreenshotCaption": "Binary metadata and reputation information showing magnify.exe is cmd.exe due to names observed and common hash"}, {"ScreenshotName": "MS-17.C.1-3.png", "ScreenshotCaption": "Specific Behavior alert on sticky keys binary hijack for persistence when magnify.exe was overwritten"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe overwriting magnify.exe with the new file containing the same hash for cmd.exe. Reputation metadata confirms magnify.exe is cmd.exe under the file names observed.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-17.C.1-1.png", "ScreenshotCaption": "Telemetry showing overwrite of magnify.exe"}, {"ScreenshotName": "MS-17.C.1-2.png", "ScreenshotCaption": "Binary metadata and reputation information showing magnify.exe is cmd.exe due to names observed and common hash"}, {"ScreenshotName": "MS-17.C.1-3.png", "ScreenshotCaption": "Specific Behavior alert on sticky keys binary hijack for persistence when magnify.exe was overwritten"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed file write events overwriting magnify.exe in the system directory as well as the change in the hash of the file. The telemetry was tainted by a parent alert on cmd.exe.[PA7]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-17.C.1-1.png", "ScreenshotCaption": "Telemetry showing file write events overwriting magnify.exe in the system directory (tainted by a parent alert on cmd.exe)"}, {"ScreenshotName": "PA-17.C.1-2.png", "ScreenshotCaption": "Telemetry showing change in the hash of magnify.exe"}], "Footnotes": ["The process tree showing taintedness is visible within the same UI but did not fit within the current frame."]}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a file write event on magnify.exe in the system directory. A search for \"cmd\" on CodeRed shows the hash value of magnify.exe matches cmd.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-17-1.png", "ScreenshotCaption": "Telemetry showing file write to magnify.exe in the system directory"}, {"ScreenshotName": "RSA-17-2.png", "ScreenshotCaption": "Magnify.exe hash matches cmd.exe (top two hashes in Tracking pane, file names and full hash values cut off)"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed file write of magnify.exe in the system directory from a file copy event for cmd.exe with matching hash values. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-17.C.1-1.png", "ScreenshotCaption": "Telemetry showing file copy and write events of cmd.exe to overwrite magnify.exe with matching hash values (tainted by prior lateral movement threat story; Group ID not shown in this view)"}], "Footnotes": []}]}]}]}, {"Substep": "18.A.1", "Procedure": "Empire: 'Get-ChildItem' via PowerShell to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Techniques": [{"TechniqueId": "T1083", "TechniqueName": "File and Directory Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing the Get-ChildItem command.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-18.A.1-T1083-new.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing the Get-ChildItem command"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[CT5]", "Modifiers": [], "Screenshots": [], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the decoded PowerShell script that was executed to recursively search for .vsdx files on Conficker's remote file share.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-18.A.1-1.png", "ScreenshotCaption": "Query showing .vsdx PowerShell file search script that was executed"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed an event with the execution of the Get-ChildItem command. The telemetry was tainted by a parent alert on wscript.exe.[PA7]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-18.A.1-1.png", "ScreenshotCaption": "Telemetry showing an event with the execution of the Get-ChildItem command (tainted by a parent alert on wscript.exe)"}], "Footnotes": ["The process tree showing taintedness is visible within the same UI but did not fit within the current frame."]}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}]}, {"Substep": "18.B.1", "Procedure": "Empire: 'copy' via PowerShell staged a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5) in the Recycle Bin (C:\\$Recycle.Bin) on CodeRed (10.0.1.5)", "Techniques": [{"TechniqueId": "T1074", "TechniqueName": "Data Staged", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated with a severity score of 60/100 and was correctly mapped to correct ATT&CK Technique (T1074 - Data Staged).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-18.B.1-1.png", "ScreenshotCaption": "Telemetry showing creation of the .vsdx file in the Recycle Bin"}, {"ScreenshotName": "CB-18.B.1-2.png", "ScreenshotCaption": "Specific Behavior alert on the file write of the .vsdx file in the Recycle Bin (showing red severity score, mapped to correct ATT&CK Technique, T1074 - Data Staged)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed filemod events for the creation and write the .vsdx in the Recycle Bin.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-18.B.1-1.png", "ScreenshotCaption": "Telemetry showing creation of the .vsdx file in the Recycle Bin"}, {"ScreenshotName": "CB-18.B.1-2.png", "ScreenshotCaption": "Specific Behavior alert on the file write of the .vsdx file in the Recycle Bin (showing red severity score, mapped to correct ATT&CK Technique, T1074 - Data Staged)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The OverWatch team sent an email indicating a Specific Behavior was observed the .vsdx file being copied to the Recycle Bin, a \\\"likely location to stage files of interest.\\\"[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-18.B.1-1.png", "ScreenshotCaption": "Telemetry showing the .vsdx being written into the Recycle Bin (event_SimpleName of OoxmlFileWritten)"}, {"ScreenshotName": "CS-E-12.png", "ScreenshotCaption": "Email excerpt sent by OverWatch team indicating they observed the .vsdx file being copied to Recycle Bin for staging (Specific Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the .vsdx file being written into the Recycle Bin.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-18.B.1-1.png", "ScreenshotCaption": "Telemetry showing the .vsdx being written into the Recycle Bin (event_SimpleName of OoxmlFileWritten)"}, {"ScreenshotName": "CS-E-12.png", "ScreenshotCaption": "Email excerpt sent by OverWatch team indicating they observed the .vsdx file being copied to Recycle Bin for staging (Specific Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed creation of the .vsdx file in the Recycle Bin.\u00a0\u00a0The telemetry was tainted by a parent PowerShell alert listed as the owner process.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-18.B.1-10.png", "ScreenshotCaption": "Telemetry of file create/write of vsdx (tainted by a parent PowerShell alert, listed as Owner process)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed creation of the .vsdx file in the Recycle Bin. The telemetry was tainted by the parent powershell.exe alerts on \" PowerShell with Unusual Arguments\" and \"PowerShell Network\".", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-18-1.png", "ScreenshotCaption": "Telemetry showing the file creation of the .vsdx file in the Recycle Bin"}, {"ScreenshotName": "EG-18-2.png", "ScreenshotCaption": "Event tree showing creation of the .vsdx file (tainted by parent alerts on powershell.exe)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe copying the .vsdx file from the network shared drive on Conficker (10.0.0.5) to the Recycle Bin as well as a file create event.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-18.B.1-T1074-new.png", "ScreenshotCaption": "Telemetry showing the copy of the .vsdx file from the network drive to the Recycle Bin"}, {"ScreenshotName": "CC-18.A.1-4.png", "ScreenshotCaption": "Telemetry showing a file create event for the .vsdx file in the Recycle Bin"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated on the file write of the .vsdx named File Write To Root Of Recycle Bin (Weak Signal). The alert details explained how all legitimate files should be written to a subfolder of the recycle bin, and not to the root.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-18.B.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe file write of .vsdx to the Recycle Bin with PowerShell File Write alert"}, {"ScreenshotName": "FE-18.B.1-2.png", "ScreenshotCaption": "Additional telemetry showing file write of .vsdx with PowerShell File Write alert"}, {"ScreenshotName": "FE-18.B.1-3.png", "ScreenshotCaption": "Specific Behavior alert for File Write to Root of Recycle Bin"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the creation of the .vsdx file in the Recycle Bin. The telemetry was tainted by the parent PowerShell File Write alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "FE-18.B.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe file write of .vsdx to the Recycle Bin with PowerShell File Write alert"}, {"ScreenshotName": "FE-18.B.1-2.png", "ScreenshotCaption": "Additional telemetry showing file write of .vsdx with PowerShell File Write alert"}, {"ScreenshotName": "FE-18.B.1-3.png", "ScreenshotCaption": "Specific Behavior alert for File Write to Root of Recycle Bin"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe copying the .vsdx file from the network shared drive on Conficker to the Recycle Bin. The telemetry was tainted by the parent \"Powershell executed encoded commands\" alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-18.B.1-1.png", "ScreenshotCaption": "Telemetry showing PowerShell copying .vsdx file from network share to Recycle Bin (tainted by the parent \\\"Powershell executed encoded commands\\\" alert)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for PowerShell creating a file in the Recycle Bin. The alert was tagged with the correct ATT&CK Tactic (Collection) and Technique (Data Staged).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-18.B.1-1.png", "ScreenshotCaption": "Telemetry showing file creation in the Recycle Bin (tainted by parent alert on cmd.exe)"}, {"ScreenshotName": "MC-18.B.1-9.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell creating a file in the Recycle Bin, tagged with the correct ATT&CK Tactic (Collection) and Technique (Data Staged)."}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed creation of the .vsdx file in the Recycle Bin. The telemetry was tainted by a trace detection on cmd.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-18.B.1-1.png", "ScreenshotCaption": "Telemetry showing file creation in the Recycle Bin (tainted by parent alert on cmd.exe)"}, {"ScreenshotName": "MC-18.B.1-9.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell creating a file in the Recycle Bin, tagged with the correct ATT&CK Tactic (Collection) and Technique (Data Staged)."}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though data showed PowerShell Copy-Item cmdlet execution (no information available about what file is being copied or where the data is coming from).[MS50]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-18.B.1-1.png", "ScreenshotCaption": "Execution sequence showing PowerShell Copy-Item cmdlet execution (does not count as a detection)"}], "Footnotes": [" Vendor states that by default WDATP monitors activities around all the most used documents (doc, xls, ppt pdf, etc) at the time of test."]}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed file read and write events for the .vsdx file from the network shared drive on 10.0.0.5 (Conficker) to the Recycle Bin. The telemetry was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-18.B.1-1.png", "ScreenshotCaption": "Telemetry showing file read and write events for the .vsdx file from the network shared drive on 10.0.0.5 (Conficker) to the Recycle Bin (tainted by a parent alert on wscript.exe)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed file write of the .vsdx to the Recycle Bin. The activity seen during the lateral movement step tainted the telemetry because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-18.B.1-1.png", "ScreenshotCaption": "Exported telemetry of threat story (taints event) showing .vsdx file copy and write"}], "Footnotes": []}]}]}]}, {"Substep": "18.B.1", "Procedure": "Empire: 'copy' via PowerShell collected a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Techniques": [{"TechniqueId": "T1039", "TechniqueName": "Data from Network Shared Drive", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[CB90]", "Modifiers": [], "Screenshots": [], "Footnotes": ["Telemetry was available for the write file of the .vsdx file into the Recycle Bin, but no data was available that indicated it came from a network shared drive."]}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though telemetry was available for the write file of the .vsdx into the Recycle Bin (no data was available that indicated it came from a network shared drive).", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure. [EG16]", "Modifiers": [], "Screenshots": [], "Footnotes": [" Telemetry was available for the write file of shockwave_network.vsdx into the Recycle Bin, but no data was available that indicated it came from a network shared drive."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe copying the .vsdx file from the network shared drive on Conficker (10.0.0.5) to the Recycle Bin.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-18.A.1-3.png", "ScreenshotCaption": "Telemetry showing the copy of the .vsdx file from the network drive to the Recycle Bin"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe copying the .vsdx file from the network shared drive on Conficker to the Recycle Bin. The telemetry was tainted by the parent \"Powershell executed encoded commands\" alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-18.B.1-1.png", "ScreenshotCaption": "Telemetry showing PowerShell copying .vsdx file from network share to Recycle Bin (tainted by the parent \\\"Powershell executed encoded commands\\\" alert)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though data showed PowerShell Copy-Item cmdlet execution (no information available about what file is being copied or where the data is coming from).[MS50]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-18.B.1-1.png", "ScreenshotCaption": "Execution sequence showing PowerShell Copy-Item cmdlet execution (does not count as a detection)"}], "Footnotes": [" Vendor states that by default WDATP monitors activities around all the most used documents (doc, xls, ppt pdf, etc) at the time of test."]}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for a script engine reading files from network locations. The alert was tainted by a parent alert on wscript.exe.[PA7]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-18.B.1-1.png", "ScreenshotCaption": "Telemetry showing a file event for the .vsdx file from the network shared drive on 10.0.0.5 (Conficker) (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-18.B.1-2.png", "ScreenshotCaption": "Specific Behavior alert for a script engine reading files from network locations (tainted by a parent alert on wscript.exe)"}], "Footnotes": ["The process tree showing taintedness is visible within the same UI but did not fit within the current frame."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a file read event for the .vsdx file from the network shared drive on 10.0.0.5 (Conficker). The telemetry was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-18.B.1-1.png", "ScreenshotCaption": "Telemetry showing a file event for the .vsdx file from the network shared drive on 10.0.0.5 (Conficker) (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-18.B.1-2.png", "ScreenshotCaption": "Specific Behavior alert for a script engine reading files from network locations (tainted by a parent alert on wscript.exe)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the .vsdx file copied from a network shared drive on Conficker. The activity seen during the lateral movement step tainted the telemetry because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-18.B.1-1.png", "ScreenshotCaption": "Exported telemetry of threat story (taints event) showing .vsdx file copy from network shared drive on Conficker"}], "Footnotes": []}]}]}]}, {"Substep": "19.A.1", "Procedure": "Empire: File dropped to disk is a renamed copy of the WinRAR binary", "Techniques": [{"TechniqueId": "T1036", "TechniqueName": "Masquerading", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the creation of recycler.exe. Binary metadata on recycler.exe indicated it was masquerading and had a digital signature and file metadata that matched the WinRAR utility.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-19.A.1-1.png", "ScreenshotCaption": "Telemetry showing filemod creation of recycler.exe"}, {"ScreenshotName": "CB-19.A.1-2.png", "ScreenshotCaption": "Binary metadata showing recycler.exe is WinRAR.exe based on digital signature and file version information"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the SHA256 hash value of recycler.exe when it was written to disk, which an analyst could use to determine recycler.exe was actually WinRAR.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-19.A.1-2.png", "ScreenshotCaption": "Telemetry showing SHA256 hash of recycler.exe"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed that recycler.exe was WinRAR via file metadata. The telemetry was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-19.A.1-100.png", "ScreenshotCaption": "Telemetry showing recycler.exe identified as WinRAR via file metadata (tainted by a parent PowerShell alert)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[EG15]", "Modifiers": [], "Screenshots": [], "Footnotes": ["Telemetry later identified recycler.exe as WinRAR during execution, no detections identified it as WinRAR upon file copy."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified the attacker placing the WinRAR utility on the system as recycler.exe. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-19.A.1-2.png", "ScreenshotCaption": "Telemetry showing MD5 hash of recycler.exe"}, {"ScreenshotName": "FE-19.A.1-1.png", "ScreenshotCaption": "Parent alert for PowerShell File Write showing tainting of recycler.exe telemetry"}, {"ScreenshotName": "FE-19.A.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report of the attacker placing the WinRAR utility on the system as recycler.exe (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the MD5 hash value of recycler.exe when it was written to disk, which an analyst could use to determine recycler.exe was actually WinRAR. The telemetry was tainted by the parent PowerShell File Write alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "FE-19.A.1-2.png", "ScreenshotCaption": "Telemetry showing MD5 hash of recycler.exe"}, {"ScreenshotName": "FE-19.A.1-1.png", "ScreenshotCaption": "Parent alert for PowerShell File Write showing tainting of recycler.exe telemetry"}, {"ScreenshotName": "FE-19.A.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report of the attacker placing the WinRAR utility on the system as recycler.exe (Specific Behavior)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though telemetry later identified recycler.exe as WinRAR during execution (no detections identified it as WinRAR upon file copy).[CT5]", "Modifiers": [], "Screenshots": [], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the MD5/SHA256 hash value of recycler.exe when it was written to disk, which an analyst could use to determine recycler.exe was actually WinRAR.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-19.A.1-1.png", "ScreenshotCaption": "Telemetry showing the MD5/SHA256 hash value of recycler.exe"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed file creation of recycler.exe on CodeRed. Binary reputation and metadata for recycler.exe shows hash and publisher signature as win.rar GmbH indicating the file is actually the WinRAR utility.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-19.A.1-1.png", "ScreenshotCaption": "Telemetry showing file creation of recycler.exe by powershell.exe showing hash and signer information as win.rar GmbH"}, {"ScreenshotName": "MS-19.A.1-2.png", "ScreenshotCaption": "Binary reputation and metadata for recycler.exe showing WinRAR information"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the MD5 and SHA256 hash values of recycler.exe when it was written to disk, which an analyst could use to determine recycler.exe was actually WinRAR. The telemetry was tainted by a parent alert on wscript.exe.[PA7]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-19.A.1-1.png", "ScreenshotCaption": "Telemetry showing file create/write and hash values of recycler.exe (tainted by a parent alert on wscript.exe)"}], "Footnotes": ["The process tree showing taintedness is visible within the same UI but did not fit within the current frame."]}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.[RS30]", "Modifiers": [], "Screenshots": [], "Footnotes": ["Telemetry later identified recycler.exe as WinRAR during execution, no detections identified it as WinRAR upon file copy."]}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed file creation event for recycler.exe on CodeRed along with MD5, SHA1, and SHA256 hashes. Hashes could be used to look up information on the binary. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-19.A.1-2.png", "ScreenshotCaption": "Telemetry exported from threat story showing recycler.exe file write tainted by prior activity because it was under the same Group ID"}, {"ScreenshotName": "S1-19.A.1-1.png", "ScreenshotCaption": "Telemetry showing file write of recycler.exe with file hashes"}], "Footnotes": []}]}]}]}, {"Substep": "19.A.1", "Procedure": "Empire: Built-in upload module executed to write binary (recycler.exe) to disk on CodeRed (10.0.1.5)", "Techniques": [{"TechniqueId": "T1105", "TechniqueName": "Remote File Copy", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the creation of recycler.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-19.A.1-1.png", "ScreenshotCaption": "Telemetry showing filemod (file modification) creation of recycler.exe"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed file write of recycler.exe by powershell.exe as well as the network connection over which the download occurred. The process tree view showed the parent powershell.exe process as tainted by a previous wscript.exe detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-19.A.1-1.png", "ScreenshotCaption": "Telemetry showing file write of recycler.exe (parent powershell.exe tainted by previous wscript.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-19.A.1-3.png", "ScreenshotCaption": "Telemetry showing network connection from 192.168.0.5 (C2 server) used by powershell.exe to transfer recycler.exe (parent powershell.exe tainted by previous wscript.exe detection by red line indicating high severity)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the file creation of recycler.exe by powershell.exe. The telemetry was tainted by a parent PowerShell alert listed as the owner process.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-19.A.1-20.png", "ScreenshotCaption": "Telemetry showing file create/write of recycler.exe (tainted by a parent PowerShell alert, listed as Owner process)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the file creation of recycler.exe by powershell.exe. The telemetry was tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-19-1.png", "ScreenshotCaption": "Telemetry showing file creation of recycler.exe by powershell.exe (tainted by parent PowerShell alerts)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe creating recycler.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-19.B.1-2.png", "ScreenshotCaption": "Telemetry showing the creation of recycler.exe"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it indicated the attacker placed recycler.exe on the system.[FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-19.A.1-1.png", "ScreenshotCaption": "Enrichment of powershell.exe writing recycler.exe with PowerShell File Write alert (tagged with correct ATT&CK Technique, T1105 - Remote File Copy and Tactics, Command and Control, Lateral Movement)"}, {"ScreenshotName": "FE-19.A.1-2.png", "ScreenshotCaption": "Continued enrichment of powershell.exe writing recycler.exe with PowerShell File Write alert"}, {"ScreenshotName": "FE-19.A.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker placed recycler.exe on the system (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched powershell.exe writing recycler.exe with an alert for PowerShell File Write (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1105 - Remote File Copy) and Tactics (Command and Control, Lateral Movement).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-19.A.1-1.png", "ScreenshotCaption": "Enrichment of powershell.exe writing recycler.exe with PowerShell File Write alert (tagged with correct ATT&CK Technique, T1105 - Remote File Copy and Tactics, Command and Control, Lateral Movement)"}, {"ScreenshotName": "FE-19.A.1-2.png", "ScreenshotCaption": "Continued enrichment of powershell.exe writing recycler.exe with PowerShell File Write alert"}, {"ScreenshotName": "FE-19.A.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker placed recycler.exe on the system (Specific Behavior)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert called \"Policy Dropper Behavior\" was generated based on three events occurring in the same parent process within a set time frame, a network connection (TCP Outbound to 192.168.0.5 over 443) followed by an executable file create (powershell.exe creating recycler.exe) followed by a process spawning from that executable (powershell.exe creating the recycler.exe process).", "Modifiers": ["Configuration Change"], "Screenshots": [{"ScreenshotName": "CT-19.A.1-1.png", "ScreenshotCaption": "General Behavior alert for \\\"Policy Dropper Behavior\\\" based on three correlated events"}, {"ScreenshotName": "CT-19.A.1-2.png", "ScreenshotCaption": "Telemetry showing creation of recycler.exe (tainted by \\\"Powershell executed encoded commands\\\" and \\\"Policy Dropper Behavior\\\" alerts) and powershell.exe behavior contributing to \\\"Policy Dropper Behavior\\\" alert"}], "Footnotes": ["The capability may have been modified after the start of the evaluation to create this alert, so the detection is identified as a configuration change. See Configuration page for details."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe creating recycler.exe. The telemetry was tainted by parent \\\"Powershell executed encoded commands\\\" and \\\"Policy Dropper Behavior\\\" alerts.[CT5]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-19.A.1-1.png", "ScreenshotCaption": "General Behavior alert for \\\"Policy Dropper Behavior\\\" based on three correlated events"}, {"ScreenshotName": "CT-19.A.1-2.png", "ScreenshotCaption": "Telemetry showing creation of recycler.exe (tainted by \\\"Powershell executed encoded commands\\\" and \\\"Policy Dropper Behavior\\\" alerts) and powershell.exe behavior contributing to \\\"Policy Dropper Behavior\\\" alert"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed file creation event for recycler.exe", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-19.A.1-1.png", "ScreenshotCaption": "Telemetry showing file creation event for recycler.exe"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe creating recycler.exe file (tainted by alert on\u00a0PowerShell script with a suspicious command-line was generated by numerous scripts).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-19.A.1-1.png", "ScreenshotCaption": "Telemetry showing file creation of recycler.exe by powershell.exe showing hash and signer information as win.rar GmbH"}, {"ScreenshotName": "MS-19.A.1-3.png", "ScreenshotCaption": "Alert description for PowerShell script with a suspicious command-line that tainted this event (alert specific to this instance not shown)"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for executables created to disk by the Windows scripting engine. The alert was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-19.A.1-1.png", "ScreenshotCaption": "Telemetry showing the file create and write events for recycler.exe (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-19.A.1-2.png", "ScreenshotCaption": "General Behavior alert for PowerShell dropping an executable file to disk (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-19.A.1-3.png", "ScreenshotCaption": "General Behavior alert for executables created to disk by the Windows scripting engine (tainted by a parent alert on wscript.exe)"}], "Footnotes": []}, {"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for PowerShell dropping an executable file to disk. The alert was tainted by a parent alert on wscript.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-19.A.1-1.png", "ScreenshotCaption": "Telemetry showing the file create and write events for recycler.exe (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-19.A.1-2.png", "ScreenshotCaption": "General Behavior alert for PowerShell dropping an executable file to disk (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-19.A.1-3.png", "ScreenshotCaption": "General Behavior alert for executables created to disk by the Windows scripting engine (tainted by a parent alert on wscript.exe)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the file create and write events for recycler.exe. The telemetry was tainted by a parent alert on wscript.exe.[PA7]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-19.A.1-1.png", "ScreenshotCaption": "Telemetry showing the file create and write events for recycler.exe (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-19.A.1-2.png", "ScreenshotCaption": "General Behavior alert for PowerShell dropping an executable file to disk (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-19.A.1-3.png", "ScreenshotCaption": "General Behavior alert for executables created to disk by the Windows scripting engine (tainted by a parent alert on wscript.exe)"}], "Footnotes": ["The process tree showing taintedness is visible within the same UI but did not fit within the current frame."]}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a write file event for recycler.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-19-1.png", "ScreenshotCaption": "Telemetry showing file write of recycler.exe"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed file write of recycler.exe with hash value. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-19.A.1-1.png", "ScreenshotCaption": "Telemetry showing file write of recycler.exe"}, {"ScreenshotName": "S1-19.A.1-2.png", "ScreenshotCaption": "Telemetry exported from threat story showing recycler.exe file write tainted by prior activity because it was under the same Group ID"}], "Footnotes": []}]}]}]}, {"Substep": "19.B.1", "Procedure": "Empire: Executed binary (recycler.exe) created compressed archive (old.rar) of previously collected file", "Techniques": [{"TechniqueId": "T1002", "TechniqueName": "Data Compressed", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched recycler.exe with the correct ATT&CK Technique (1002 - Data Compressed).", "Modifiers": [], "Screenshots": [], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution of recycler.exe with command-line arguments indicating it was WinRAR and file compression and encryption was used to create an encrypted archive. Telemetry also showed the creation of old.rar as the output of recycler.exe running.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for a RAR archive \"written by a process with suspicious command line arguments.\" The alert showed the command-line details and was tagged with the correct ATT&CK Technique (Data Compressed) and Tactic (Exfiltration). The process tree view showed the recycler.exe alert as tainted by a previous powershell.exe detection.", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": []}, {"DetectionType": "Specific Behavior", "DetectionNote": "The OverWatch team sent an email indicating they observed a Specific Behavior because a .vsdx file was archived for likely exfiltration using the renamed RAR binary, recycler.exe.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the alert showed the command-line details for the execution of recycler.exe, and would also be available in a separate view.[CS2]", "Modifiers": [], "Screenshots": [], "Footnotes": ["For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use. The telemetry was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated on execution of recycler.exe named \"Exfiltration-Encrypting Files with WinRar\". The alert was tainted by parent Windows Script Executing PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched recycler.exe with a related ATT&CK Technique (T1022 - Data Encrypted) and Tactic (Exfiltration). The enrichment was tainted by a parent Windows Script Executing PowerShell alert. [EG11]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data. The telemetry was tainted by parent Windows Script Executing PowerShell alert. [EG11]", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (recycler) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "Modifiers": [], "Screenshots": [], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use. Additionally recycler.exe was identified as WinRAR via file metadata, including executable product and description. Telemetry also showed the creation of old.rar as the output of recycler.exe running.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it indicated the attacker executed recycler.exe to create an encrypted RAR file old.rar.[FE5]", "Modifiers": ["Delayed"], "Screenshots": [], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert called File Write To Root Of Recycle Bin (Weak Signal) was generated for old.rar being written to the root of the Recycle Bin. The alerted noted that all legitimate files should be written to a subfolder of the Recycle Bin.", "Modifiers": [], "Screenshots": [], "Footnotes": []}, {"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for Execution from Suspicious Directory (Weak Signal). The alert detected processes running from uncommon locations, and included recycler.exe executing with full command-line arguments, including the use of the -hp flag to encrypt and compress data.", "Modifiers": [], "Screenshots": [], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the command line output containing -hp with an alert for Possible Encrypted RAR Archive Command (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1002 - Data Compressed).", "Modifiers": [], "Screenshots": [], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the file write of RAR with an alert for Rar Archive Created (Weak Signal) based on the header values of the file. The alert was also tagged with the correct ATT&CK Technique (T1002 - Data Compressed) and Tactic (Exfiltration).", "Modifiers": [], "Screenshots": [], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the file write of RAR with a second alert for Rar Archive Created (Weak Signal) based on the header values of the file. The alert was also tagged with the correct ATT&CK Technique (T1002 - Data Compressed) and Tactic (Exfiltration).", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability showed recycler.exe creating old.rar in the Recycle Bin and enriched the data with \"Data Exfiltration Archiving\" due to the archive file being created. The enrichment was tainted by parent \"Powershell executed encoded command\" alerts.", "Modifiers": ["Configuration Change", "Tainted"], "Screenshots": [], "Footnotes": ["The conditions contributing to Enrichment may have been added to the capability's detection after the start of the evaluation, so the detection is identified as a configuration change. See Configuration page for details."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe creating recycler.exe and executing the command-line arguments including the -hp flag indicating WinRAR utility execution with compression and encryption. The telemetry was tainted by parent \"Powershell executed encoded commands\" and \"Policy Dropper Behavior\" alerts", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution of recycler.exe with command-line arguments indicating it was WinRAR and file compression and encryption was used to create an encrypted archive. Telemetry also showed the creation of old.rar as the output of recycler.exe running. The telemetry was tainted by a trace detection on cmd.exe.", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution sequence for recycler.exe with WinRAR command-line arguments, including the -hp flag, for data encryption and compression (tainted by alert on\u00a0PowerShell script with a suspicious command-line was generated by numerous scripts).", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use. The telemetry was tainted by a parent alert on wscript.exe", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of recycler.exe with full command-line arguments, including -hp flag, indicating compression and encryption was used with a WinRAR utility.[RS3]", "Modifiers": [], "Screenshots": [], "Footnotes": ["Vendor stated alert logic exists for many files being accessed in a short period of time, which was not triggered in the evaluation because only one file was accessed."]}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of recycler.exe with command-line arguments, including the -hp flag, indicating use of encryption and compression with a WinRAR utility. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": []}]}]}]}, {"Substep": "19.B.1", "Procedure": "Empire: Executed binary (recycler.exe) created encrypted archive (old.rar) of previously collected file", "Techniques": [{"TechniqueId": "T1022", "TechniqueName": "Data Encrypted", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched recycler.exe with the correct ATT&CK Technique (1022 - Data Encrypted).", "Modifiers": [], "Screenshots": [], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution of recycler.exe with command-line arguments indicating it was WinRAR and file compression and encryption was used to create an encrypted archive.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was created for a RAR archive \"written by a process with suspicious command line arguments.\" Details showed the flags -hp within the command line that indicated use of encryption, and the alert was mapped to a related ATT&CK Technique (Data Compressed) and the correct Tactic (Exfiltration). The process tree view showed the recycler.exe alert as tainted by a previous powershell.exe detection.", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": []}, {"DetectionType": "Specific Behavior", "DetectionNote": "The OverWatch team sent an email indicating a Specific Behavior was observed because a .vsdx file was archived for likely exfiltration using the renamed WinRAR binary, recycler.exe.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the alert showed the command-line details for the execution of recycler.exe, and would also be available in a separate view.[CS2]", "Modifiers": [], "Screenshots": [], "Footnotes": ["For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use. The telemetry was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated on execution of recycler.exe named \"Exfiltration-Encrypting Files with WinRar\". The alert was tainted by parent Windows Script Executing PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched recycler.exe with the correct ATT&CK Technique (T1022 - Data Encrypted) and Tactic (Exfiltration). The enrichment was tainted by parent Windows Script Executing PowerShell alert. [EG11]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data. The telemetry was tainted by parent Windows Script Executing PowerShell alert. [EG11]", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (recycler) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "Modifiers": [], "Screenshots": [], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it observed recycler.exe creating an encrypted RAR archive. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert called File Write To Root Of Recycle Bin (Weak Signal) was generated for old.rar being written to the root of the Recycle Bin. The alerted noted that all legitimate files should be written to a subfolder of the Recycle Bin.", "Modifiers": [], "Screenshots": [], "Footnotes": []}, {"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for Execution from Suspicious Directory (Weak Signal). The alert detected processes running from uncommon locations, and included recycler.exe executing with full command-line arguments, including the use of the -hp flag to encrypt and compress data.", "Modifiers": [], "Screenshots": [], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched an alert for Possible Encrypted RAR Archive Command (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1022 - Data Encrypted).", "Modifiers": [], "Screenshots": [], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched recycler.exe writing old.rar to the root of the Recycle Bin with an alert for Rar Archive Created (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1002 - Data Compressed) and Tactic (Exfiltration).", "Modifiers": [], "Screenshots": [], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the file write of RAR with an alert for Rar Archive Created (Weak Signal) based on the header values of the file. The alert was also tagged with a related ATT&CK Technique (T1002 - Data Compressed) and Tactic (Exfiltration).", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability showed recycler.exe creating old.rar in the Recycle Bin and enriched the data with \"Data Exfiltration Archiving\" due to the archive file being created. The enrichment was tainted by parent \"Powershell executed encoded command\" alerts.", "Modifiers": ["Configuration Change", "Tainted"], "Screenshots": [], "Footnotes": ["The conditions contributing to Enrichment may have been added to the capability's detection after the start of the evaluation, so the detection is identified as a configuration change. See Configuration page for details."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe creating recycler.exe and executing the command-line arguments including the -hp flag indicating WinRAR utility execution with compression and encryption. The telemetry was tainted by parent \"Powershell executed encoded commands\" and \"Policy Dropper Behavior\" alerts", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution of recycler.exe with command-line arguments indicating it was WinRAR and file compression and encryption was used to create an encrypted archive. Telemetry also showed the creation of old.rar as the output of recycler.exe running. The telemetry was tainted by a trace detection on cmd.exe.", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution sequence for recycler.exe with WinRAR command-line arguments, including the -hp flag, for data encryption and compression (tainted by alert on\u00a0PowerShell script with a suspicious command-line was generated by numerous scripts).", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use. tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of recycler.exe with full command-line arguments, including -hp flag, indicating compression and encryption was used with a WinRAR utility.[RS3]", "Modifiers": [], "Screenshots": [], "Footnotes": ["Vendor stated alert logic exists for many files being accessed in a short period of time, which was not triggered in the evaluation because only one file was accessed."]}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of recycler.exe with command-line arguments, including the -hp flag, indicating use of encryption and compression with a WinRAR utility. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": []}]}]}]}, {"Substep": "19.B.1", "Procedure": "Empire: Executed binary (recycler.exe) is a renamed copy of the WinRAR binary", "Techniques": [{"TechniqueId": "T1036", "TechniqueName": "Masquerading", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated on execution of recycler.exe indicating it was WinRAR and was masquerading as a renamed process.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-19.A.1-1.png", "ScreenshotCaption": "Telemetry showing recycler.exe and command-line arguments with arguments indicating it is WinRAR"}, {"ScreenshotName": "CB-19.B.1-5.png", "ScreenshotCaption": "Specific Behavior alert for recycler.exe masquerading as a renamed WinRAR process"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution of recycler.exe with command-line arguments indicating it was WinRAR and file compression and encryption was used to create an encrypted archive.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-19.A.1-1.png", "ScreenshotCaption": "Telemetry showing recycler.exe and command-line arguments with arguments indicating it is WinRAR"}, {"ScreenshotName": "CB-19.B.1-5.png", "ScreenshotCaption": "Specific Behavior alert for recycler.exe masquerading as a renamed WinRAR process"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was created for a RAR archive \"written by a process with suspicious command line arguments.\". Details showed that recycler.exe wrote a RAR archive and that recycler.exe was signed by win.rar GmbH. The process tree view showed the recycler.exe alert as tainted by a previous powershell.exe detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-19.B.1-1.png", "ScreenshotCaption": "Specific Behavior alert showing recycler.exe was identified as WinRAR (tainted by previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-19.B.1-3.png", "ScreenshotCaption": "Additional alert details showing recycler.exe was signed by win.rar GmbH"}, {"ScreenshotName": "CS-E-12.png", "ScreenshotCaption": "Email excerpt sent by OverWatch team indicating they observed a .vsdx file archived using the renamed RAR binary, recycler.exe (Specific Behavior)"}], "Footnotes": []}, {"DetectionType": "Specific Behavior", "DetectionNote": "The OverWatch team sent an email indicating a Specific Behavior was observed because a .vsdx file was archived for likely exfiltration using the renamed WinRAR binary, recycler.exe.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-19.B.1-1.png", "ScreenshotCaption": "Specific Behavior alert showing recycler.exe was identified as WinRAR (tainted by previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-19.B.1-3.png", "ScreenshotCaption": "Additional alert details showing recycler.exe was signed by win.rar GmbH"}, {"ScreenshotName": "CS-E-12.png", "ScreenshotCaption": "Email excerpt sent by OverWatch team indicating they observed a .vsdx file archived using the renamed RAR binary, recycler.exe (Specific Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the alert showed the command-line details for the execution of recycler.exe, and would also be available in a separate view.[CS2]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-19.B.1-1.png", "ScreenshotCaption": "Specific Behavior alert showing recycler.exe was identified as WinRAR (tainted by previous powershell.exe detection by red line indicating high severity)"}, {"ScreenshotName": "CS-19.B.1-3.png", "ScreenshotCaption": "Additional alert details showing recycler.exe was signed by win.rar GmbH"}, {"ScreenshotName": "CS-E-12.png", "ScreenshotCaption": "Email excerpt sent by OverWatch team indicating they observed a .vsdx file archived using the renamed RAR binary, recycler.exe (Specific Behavior)"}], "Footnotes": ["For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use. The telemetry was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-19.B.1-20.png", "ScreenshotCaption": "Telemetry showing recycler.exe execution\u00a0(tainted by a parent PowerShell alert)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated on execution of recycler.exe named \"Exfiltration-Encrypting Files with WinRar\". The alert was tainted by parent Windows Script Executing PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-19-4.png", "ScreenshotCaption": "Specific Behavior alert for the execution of recycler.exe named \\\"Exfiltration-Encrypting Files with WinRar\\\" (tainted by Windows Script Executing PowerShell alert)"}, {"ScreenshotName": "EG-19-1.png", "ScreenshotCaption": "Telemetry showing execution of recycler.exe with command-line arguments and creation of old.rar output (tainted by Windows Script Executing PowerShell alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use. The telemetry was tainted by parent Windows Script Executing PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-19-4.png", "ScreenshotCaption": "Specific Behavior alert for the execution of recycler.exe named \\\"Exfiltration-Encrypting Files with WinRar\\\" (tainted by Windows Script Executing PowerShell alert)"}, {"ScreenshotName": "EG-19-1.png", "ScreenshotCaption": "Telemetry showing execution of recycler.exe with command-line arguments and creation of old.rar output (tainted by Windows Script Executing PowerShell alert)"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use. Additionally recycler.exe was identified as WinRAR via file metadata, including executable product and description.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-19.B.1-4.png", "ScreenshotCaption": "Telemetry showing recycler.exe metadata, which identified it as WinRAR"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it observed recycler.exe creating an encrypted RAR archive.[FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-19.B.1-1.png", "ScreenshotCaption": "General Behavior alert for Execution from Suspicious Directory"}, {"ScreenshotName": "FE-19.B.1-2.png", "ScreenshotCaption": "Enrichment of -hp command line with Possible Encrypted RAR Archive Command alert (tagged with related ATT&CK Techniques, T1022 - Data Encrypted and T1002 - Data Compressed)"}, {"ScreenshotName": "FE-19.B.1-3.png", "ScreenshotCaption": "Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)"}, {"ScreenshotName": "FE-19.B.1-4.png", "ScreenshotCaption": "General Behavior alert for File Write To Root Of Recycle Bin"}, {"ScreenshotName": "FE-19.B.1-5.png", "ScreenshotCaption": "Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)"}, {"ScreenshotName": "FE-19.A.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker executed recycler.exe to create an encrypted RAR file (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert called File Write To Root Of Recycle Bin (Weak Signal) was generated for old.rar being written to the root of the Recycle Bin. The alerted noted that all legitimate files should be written to a subfolder of the Recycle Bin.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-19.B.1-1.png", "ScreenshotCaption": "General Behavior alert for Execution from Suspicious Directory"}, {"ScreenshotName": "FE-19.B.1-2.png", "ScreenshotCaption": "Enrichment of -hp command line with Possible Encrypted RAR Archive Command alert (tagged with related ATT&CK Techniques, T1022 - Data Encrypted and T1002 - Data Compressed)"}, {"ScreenshotName": "FE-19.B.1-3.png", "ScreenshotCaption": "Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)"}, {"ScreenshotName": "FE-19.B.1-4.png", "ScreenshotCaption": "General Behavior alert for File Write To Root Of Recycle Bin"}, {"ScreenshotName": "FE-19.B.1-5.png", "ScreenshotCaption": "Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)"}, {"ScreenshotName": "FE-19.A.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker executed recycler.exe to create an encrypted RAR file (Specific Behavior)"}], "Footnotes": []}, {"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for Execution from Suspicious Directory (Weak Signal). The alert detected processes running from uncommon locations, and included recycler.exe executing with full command-line arguments, including the use of the -hp flag to encrypt and compress data.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-19.B.1-1.png", "ScreenshotCaption": "General Behavior alert for Execution from Suspicious Directory"}, {"ScreenshotName": "FE-19.B.1-2.png", "ScreenshotCaption": "Enrichment of -hp command line with Possible Encrypted RAR Archive Command alert (tagged with related ATT&CK Techniques, T1022 - Data Encrypted and T1002 - Data Compressed)"}, {"ScreenshotName": "FE-19.B.1-3.png", "ScreenshotCaption": "Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)"}, {"ScreenshotName": "FE-19.B.1-4.png", "ScreenshotCaption": "General Behavior alert for File Write To Root Of Recycle Bin"}, {"ScreenshotName": "FE-19.B.1-5.png", "ScreenshotCaption": "Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)"}, {"ScreenshotName": "FE-19.A.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker executed recycler.exe to create an encrypted RAR file (Specific Behavior)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched an alert for Possible Encrypted RAR Archive Command (Weak Signal). The alert was also tagged with related ATT&CK Techniques (T1022 - Data Encrypted and T1002 - Data Compressed).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-19.B.1-1.png", "ScreenshotCaption": "General Behavior alert for Execution from Suspicious Directory"}, {"ScreenshotName": "FE-19.B.1-2.png", "ScreenshotCaption": "Enrichment of -hp command line with Possible Encrypted RAR Archive Command alert (tagged with related ATT&CK Techniques, T1022 - Data Encrypted and T1002 - Data Compressed)"}, {"ScreenshotName": "FE-19.B.1-3.png", "ScreenshotCaption": "Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)"}, {"ScreenshotName": "FE-19.B.1-4.png", "ScreenshotCaption": "General Behavior alert for File Write To Root Of Recycle Bin"}, {"ScreenshotName": "FE-19.B.1-5.png", "ScreenshotCaption": "Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)"}, {"ScreenshotName": "FE-19.A.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker executed recycler.exe to create an encrypted RAR file (Specific Behavior)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched recycler.exe writing old.rar to the root of the Recycle Bin with an alert for Rar Archive Created (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1002 - Data Compressed) and Tactic (Exfiltration).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-19.B.1-1.png", "ScreenshotCaption": "General Behavior alert for Execution from Suspicious Directory"}, {"ScreenshotName": "FE-19.B.1-2.png", "ScreenshotCaption": "Enrichment of -hp command line with Possible Encrypted RAR Archive Command alert (tagged with related ATT&CK Techniques, T1022 - Data Encrypted and T1002 - Data Compressed)"}, {"ScreenshotName": "FE-19.B.1-3.png", "ScreenshotCaption": "Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)"}, {"ScreenshotName": "FE-19.B.1-4.png", "ScreenshotCaption": "General Behavior alert for File Write To Root Of Recycle Bin"}, {"ScreenshotName": "FE-19.B.1-5.png", "ScreenshotCaption": "Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)"}, {"ScreenshotName": "FE-19.A.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker executed recycler.exe to create an encrypted RAR file (Specific Behavior)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched the file write of RAR with an alert for Rar Archive Created (Weak Signal) based on the header values of the file. The alert was also tagged with a related ATT&CK Technique (T1002 - Data Compressed) and Tactic (Exfiltration).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-19.B.1-1.png", "ScreenshotCaption": "General Behavior alert for Execution from Suspicious Directory"}, {"ScreenshotName": "FE-19.B.1-2.png", "ScreenshotCaption": "Enrichment of -hp command line with Possible Encrypted RAR Archive Command alert (tagged with related ATT&CK Techniques, T1022 - Data Encrypted and T1002 - Data Compressed)"}, {"ScreenshotName": "FE-19.B.1-3.png", "ScreenshotCaption": "Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)"}, {"ScreenshotName": "FE-19.B.1-4.png", "ScreenshotCaption": "General Behavior alert for File Write To Root Of Recycle Bin"}, {"ScreenshotName": "FE-19.B.1-5.png", "ScreenshotCaption": "Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)"}, {"ScreenshotName": "FE-19.A.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker executed recycler.exe to create an encrypted RAR file (Specific Behavior)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability showed recycler.exe creating old.rar in the Recycle Bin and enriched the data with \"Data Exfiltration Archiving\" due to the archive file being created. The enrichment was tainted by parent \"Powershell executed encoded command\" alerts.", "Modifiers": ["Configuration Change", "Tainted"], "Screenshots": [{"ScreenshotName": "CT-19.B.1-1.png", "ScreenshotCaption": "Enrichment showing recycler.exe creating old.rar (enriched with \\\"Data Exfiltration Archiving\\\", tainted by parent \\\"Powershell executed encoded command\\\" alerts)"}, {"ScreenshotName": "CT-19.B.1-3.png", "ScreenshotCaption": "Telemetry showing recycler.exe with full command-line (tainted by parent \\\"Powershell executed encoded commands\\\" and \\\"Policy Dropper Behavior\\\" alerts)"}], "Footnotes": ["The conditions contributing to Enrichment may have been added to the capability's detection after the start of the evaluation, so the detection is identified as a configuration change. See Configuration page for details."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe creating recycler.exe and executing the command-line arguments including the -hp flag indicating WinRAR utility execution with compression and encryption. The telemetry was tainted by parent \"Powershell executed encoded commands\" and \"Policy Dropper Behavior\" alerts.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-19.B.1-1.png", "ScreenshotCaption": "Enrichment showing recycler.exe creating old.rar (enriched with \\\"Data Exfiltration Archiving\\\", tainted by parent \\\"Powershell executed encoded command\\\" alerts)"}, {"ScreenshotName": "CT-19.B.1-3.png", "ScreenshotCaption": "Telemetry showing recycler.exe with full command-line (tainted by parent \\\"Powershell executed encoded commands\\\" and \\\"Policy Dropper Behavior\\\" alerts)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution of recycler.exe with command-line arguments indicating it was WinRAR and file compression and encryption was used to create an encrypted archive. Telemetry also showed the creation of old.rar as the output of recycler.exe running. The telemetry was tainted by a trace detection on cmd.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-19.A.1-2.png", "ScreenshotCaption": "Telemetry showing the execution of recycler.exe with command-line arguments (tainted by a parent alert on cmd.exe)"}, {"ScreenshotName": "MC-19.A.1-3.png", "ScreenshotCaption": "Telemetry showing the creation of old.rar (tainted by a parent alert on cmd.exe)"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution sequence for recycler.exe with RAR command-line arguments, including the -hp flag, for data encryption and compression indicating it was actually WinRAR masquerading as a different file (tainted by alert on\u00a0PowerShell script with a suspicious command-line was generated by numerous scripts).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-19.A.1-3.png", "ScreenshotCaption": "Alert description for PowerShell script with a suspicious command-line that tainted this event (alert specific to this instance not shown)"}, {"ScreenshotName": "MS-19.B.1-1.png", "ScreenshotCaption": "Telemetry showing execution of recycler.exe with command-line arguments for file encryption and compression indicating it is WinRAR"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched recylcer.exe executing with command-line arguments with a related ATT&CK Technique (Masquerading).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-19.B.1-1.png", "ScreenshotCaption": "Telemetry showing recycler.exe execution (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-19.B.1-2.png", "ScreenshotCaption": "Enrichment of recylcer.exe executing with command-line arguments with a related ATT&CK Technique (Masquerading)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use. The telemetry was tainted by a parent alert on wscript.exe", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-19.B.1-1.png", "ScreenshotCaption": "Telemetry showing recycler.exe execution (tainted by a parent alert on wscript.exe)"}, {"ScreenshotName": "PA-19.B.1-2.png", "ScreenshotCaption": "Enrichment of recylcer.exe executing with command-line arguments with a related ATT&CK Technique (Masquerading)"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of recycler.exe with full command-line arguments, including -hp flag, indicating compression and encryption was used with a WinRAR utility.[RS4][RS3]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-19-1.png", "ScreenshotCaption": "Telemetry showing execution of recycler.exe with command-line arguments indicating it is WinRAR"}], "Footnotes": ["Vendor stated file hash is also available that could be used with sources like Virustotal to identify the binary. YARA is also supported and rules could be created to identify WinRAR.", "Vendor stated alert logic exists for many files being accessed in a short period of time, which was not triggered in the evaluation because only one file was accessed."]}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "Telemetry showed execution of recycler.exe with command-line arguments, including the -hp flag, indicating use of encryption and compression with a WinRAR utility. The Process Name field in the row for recycler.exe enriched the event with \"Command line RAR\". The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-19.B.1-1.png", "ScreenshotCaption": "Enrichment showing the execution of recycler.exe with process name identified as \\\"Command line RAR\\\""}, {"ScreenshotName": "S1-19.A.1-2.png", "ScreenshotCaption": "Telemetry exported from threat story showing execution of recycler.exe was tainted by prior activity because it was under the same Group ID"}], "Footnotes": []}]}]}]}, {"Substep": "19.C.1", "Procedure": "Empire: Sequence of 'echo' commands via PowerShell to populate commands in text file (ftp.txt), which is then executed by FTP to exfil data through network connection separate of existing C2 channel", "Techniques": [{"TechniqueId": "T1048", "TechniqueName": "Exfiltration Over Alternative Protocol", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched ftp.exe with the correct ATT&CK Technique (Exfil Over Alternate Protocol).", "Modifiers": [], "Screenshots": [], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a process tree for ftp.exe being executed with command-line arguments including ftp.txt.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The OverWatch team sent an email indicating a Specific Behavior was observed because collected files were exfiltrated via FTP.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "General Behavior", "DetectionNote": "OverWatch generated a General Behavior alert indicating ftp.exe executing with ftp.txt was suspicious. The process tree view showed ftp.exe as tainted by a previous powershell.exe detection.[CS1]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the OverWatch alert showed ftp.exe executing with ftp.txt.[CS2]", "Modifiers": [], "Screenshots": [], "Footnotes": ["For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched ftp.exe execution with a related ATT&CK Tactic (Command and Control) and Techniques (Commonly Used Port, Standard Application Layer Protocol). The data was tainted by a parent PowerShell alert.", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution of ftp.exe and command-line arguments. [CR5]", "Modifiers": [], "Screenshots": [], "Footnotes": [" The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the creation of ftp.txt and ftp.exe executing with command-line arguments. Telemetry also showed the FTP connection to 192.168.0.4 (C2 server) on port 21.", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for the execution of ftp.exe with a command file option by an unusual parent process and could be used for exfiltration.", "Modifiers": [], "Screenshots": [], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed ftp.exe with ftp.txt as an argument as well as an outbound FTP connection to 192.168.0.4 (C2 server) on TCP port 21.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it observed the ftp commands being written to ftp.txt and the subsequent execution of ftp.exe with the file. The old.rar file was seen uploaded to 192.168.0.4 (C2 server). [FE5]", "Modifiers": ["Delayed"], "Screenshots": [], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched a TCP port 21 connection to 192.168.0.4 (C2 server) with an alert for FTP Network Connection (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1048 - Exfiltration Over Alternative Protocol) and Tactic (Exfiltration).", "Modifiers": [], "Screenshots": [], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched ftp.exe execution with an alert for FTP Utility Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Software (T0095 - FTP).", "Modifiers": [], "Screenshots": [], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched ftp.exe with the -s argument with a separate alert for FTP Utility Execution (Weak Signal).", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing ftp.exe with ftp.txt as an argument as well as an outbound FTP connection to 192.168.0.4 (C2 server) on TCP port 21. The telemetry was tainted by the parent \\\"Powershell executed encoded commands\\\" alert.[CT5]", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched powershell.exe executing ftp.exe with the correct ATT&CK Tactic (Exfiltration) and Technique (Exfiltration over Alternative Protocol) and a suspicious indicator that a connection was made to a remove server via the ftp protocol.", "Modifiers": [], "Screenshots": [], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing ftp.exe, which made an outbound FTP connection to 192.168.0.4 (C2 server) on TCP port 21. The telemetry was tainted by a trace detection on cmd.exe.", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution sequence for ftp.exe with command-line arguments including ftp.txt (tainted by alert on\u00a0PowerShell script with a suspicious command-line was generated by numerous scripts). Telemetry also showed connections to 192.168.0.4 (C2 server) on ports 20 and 21 for the FTP connection.", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched ftp.exe as the execution of a CLI file transfer/copy utility. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution of ftp.exe and command-line arguments as well as a an outbound FTP connection to 192.168.0.4 (C2 server) on TCP port 21. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution of ftp.exe with command-line arguments, including ftp.txt, for exfiltration. The contents of ftp.txt was not seen.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed ftp.exe running with ftp.txt as an argument. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": []}]}]}]}, {"Substep": "19.D.1", "Procedure": "Empire: 'del C:\\\"$\"Recycle.bin\\old.rar'", "Techniques": [{"TechniqueId": "T1107", "TechniqueName": "File Deletion", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the deletion of old.rar.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-19.D.1-1.png", "ScreenshotCaption": "Telemetry showing filemod (file modification) deletion of old.rar"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The OverWatch team sent an email indicating a Specific Behavior was observed because files (including old.rar) were deleted from the host CodeRed.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-19.D.1-1.png", "ScreenshotCaption": "Telemetry showing deletion of old.rar"}, {"ScreenshotName": "CS-E-12.png", "ScreenshotCaption": "Email excerpt sent by OverWatch team indicating they observed old.rar being deleted (Specific Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the deletion of old.rar with an event name of FileDeleted.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-19.D.1-1.png", "ScreenshotCaption": "Telemetry showing deletion of old.rar"}, {"ScreenshotName": "CS-E-12.png", "ScreenshotCaption": "Email excerpt sent by OverWatch team indicating they observed old.rar being deleted (Specific Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a deletion event for old.rar via powershell.exe. The telemetry was tainted by a parent PowerShell alert listed as the owner process.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-19.D.1-10.png", "ScreenshotCaption": "Telemetry showing a deletion event for old.rar via powershell.exe (tainted by a parent PowerShell alert, listed as Owner process)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though there was telemetry to show the creation of old.rar. A host query for the file showed the old.rar no longer exists, but no deletion event was seen.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing the command to delete old.rar.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-19.D.1-1.png", "ScreenshotCaption": "Telemetry showing the deletion of old.rar"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe deleting old.rar from the Recycle Bin. The telemetry was tainted by the parent \\\"PowerShell executed encoded commands\\\" alert.[CT5]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-19.D.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe deleting old.rar (tainted by the parent \\\"PowerShell executed encoded commands\\\" alert)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure, though data showed execution sequence for the PowerShell \"Remove-Item\" cmdlet (no arguments were available to indicate what was deleted).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-19.D.1-1.png", "ScreenshotCaption": "Telemetry showing PowerShell executing the Remove-Item cmdlet (does not count as a detection)"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the file delete event for old.rar. The telemetry was tainted by a parent alert on wscript.exe.[PA7]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-19.D.1-1.png", "ScreenshotCaption": "Telemetry showing the file delete event for old.rar (tainted by a parent alert on wscript.exe)"}], "Footnotes": ["The process tree showing taintedness is visible within the same UI but did not fit within the current frame."]}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure. [RS2]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-19-3.png", "ScreenshotCaption": "Master file table on 10.0.1.5 (CodeRed) shows old.rar listed under deleted files (does not count as a detection)"}], "Footnotes": ["The master file table on 10.0.1.5 (CodeRed) was\u00a0inspected through the capability to look for deleted files, showing old.rar."]}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the file deletion of old.rar. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-19.D.1-1.png", "ScreenshotCaption": "Telemetry exported from threat story showing the deletion of old.rar was tainted by prior activity because it was under the same Group ID"}], "Footnotes": []}]}]}]}, {"Substep": "19.D.2", "Procedure": "Empire: 'del recycler.exe'", "Techniques": [{"TechniqueId": "T1107", "TechniqueName": "File Deletion", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the deletion of recycler.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-19.D.1-1.png", "ScreenshotCaption": "Telemetry showing filemod (file modification) deletion of recycler.exe"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The OverWatch team sent an email indicating a Specific Behavior was observed because files (including recycler.exe) were deleted from the host CodeRed.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-19.D.1-2.png", "ScreenshotCaption": "Telemetry showing deletion of recycler.exe"}, {"ScreenshotName": "CS-E-12.png", "ScreenshotCaption": "Email excerpt sent by OverWatch team indicating they observed recycler.exe being deleted (Specific Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the deletion of recycler.exe with an event name of ExecutableDeleted.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-19.D.1-2.png", "ScreenshotCaption": "Telemetry showing deletion of recycler.exe"}, {"ScreenshotName": "CS-E-12.png", "ScreenshotCaption": "Email excerpt sent by OverWatch team indicating they observed recycler.exe being deleted (Specific Behavior)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a deletion event for recycler.exe via powershell.exe. The telemetry was tainted by a parent PowerShell alert listed as the owner process.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-19.D.2-10.png", "ScreenshotCaption": "Telemetry showing a deletion event for recycler.exe via powershell.exe (tainted by a parent PowerShell alert, listed as Owner process)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a deletion event for recycler.exe caused by powershell.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-19-3.png", "ScreenshotCaption": "Telemetry showing file deletion of recycler.exe"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe executing the command to delete recycler.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-19.D.1-1.png", "ScreenshotCaption": "Telemetry showing the deletion of recycler.exe"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed powershell.exe deleting recycler.exe. The telemetry was tainted by the parent \\\"PowerShell executed encoded commands alert\\\".[CT5]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-19.D.2-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe deleting recycler.exe (tainted by the parent \\\"PowerShell executed encoded commands\\\" alert)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched PowerShell deleting recylcer.exe with the correct ATT&CK Tactic (Defense Evasion) and Technique (File Deletion) and a suspicious indicator that an executable file was deleted from the system root folder.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-19.D.1-1.png", "ScreenshotCaption": "Telemetry showing file deletion event for recycler.exe (tainted by a parent alert on cmd.exe)"}, {"ScreenshotName": "MC-19.D.1-9.png", "ScreenshotCaption": "Enrichment of PowerShell deleting recylcer.exe with the correct ATT&CK Tactic (Defense Evasion) and Technique (File Deletion) and a suspicious indicator that an executable file was deleted from the system root folder"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed file deletion event for recycler.exe. The telemetry was tainted by a trace detection on cmd.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-19.D.1-1.png", "ScreenshotCaption": "Telemetry showing file deletion event for recycler.exe (tainted by a parent alert on cmd.exe)"}, {"ScreenshotName": "MC-19.D.1-9.png", "ScreenshotCaption": "Enrichment of PowerShell deleting recylcer.exe with the correct ATT&CK Tactic (Defense Evasion) and Technique (File Deletion) and a suspicious indicator that an executable file was deleted from the system root folder"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the file delete event for recycler.exe. The telemetry was tainted by a parent alert on wscript.exe.[PA7]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "PA-19.D.1-1.png", "ScreenshotCaption": "Telemetry showing the file delete event for recycler.exe (tainted by a parent alert on wscript.exe)"}], "Footnotes": ["The process tree showing taintedness is visible within the same UI but did not fit within the current frame."]}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the file deletion of recycler.exe. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-19.D.1-1.png", "ScreenshotCaption": "Telemetry exported from threat story showing the deletion of recycler.exe was tainted by prior activity because it was under the same Group ID"}], "Footnotes": []}]}]}]}, {"Substep": "20.A.1", "Procedure": "magnifer.exe previously overwritten by cmd.exe launched through RDP connection made to Creeper (10.0.0.4)", "Techniques": [{"TechniqueId": "T1015", "TechniqueName": "Accessibility Features", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated on execution of magnify.exe named \"Suspicious screen magnifier\u00a0process\" with a 76/100 severity score.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-20.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree telemetry showing magnify.exe execution"}, {"ScreenshotName": "CB-20.B.1-2.png", "ScreenshotCaption": "Three alerts (one Specific Behavior and two General Behavior alerts) from execution of magnify.exe\u00a0showing red severity scores"}], "Footnotes": []}, {"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated named \"Execution of cmd from non-standard path\" with a 60/100 severity score.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-20.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree telemetry showing magnify.exe execution"}, {"ScreenshotName": "CB-20.B.1-2.png", "ScreenshotCaption": "Three alerts (one Specific Behavior and two General Behavior alerts) from execution of magnify.exe\u00a0showing red severity scores"}], "Footnotes": []}, {"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated named \"Suspicious renamed cmd process\" with a 72/100 severity score.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-20.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree telemetry showing magnify.exe execution"}, {"ScreenshotName": "CB-20.B.1-2.png", "ScreenshotCaption": "Three alerts (one Specific Behavior and two General Behavior alerts) from execution of magnify.exe\u00a0showing red severity scores"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree that showed magnify.exe executing from utilman.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-20.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree telemetry showing magnify.exe execution"}, {"ScreenshotName": "CB-20.B.1-2.png", "ScreenshotCaption": "Three alerts (one Specific Behavior and two General Behavior alerts) from execution of magnify.exe\u00a0showing red severity scores"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated on utilman.exe executing magnify.exe, noting that \"a process chain bypassed Windows logon security.\" The alert was marked critical and was mapped to the correct ATT&CK Technique (Accessibility Features) and Tactic (Persistence). Data in the alert also showed that magnify.exe was identified as cmd.exe based on hash value in the common name field.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-20.A.1-1.png", "ScreenshotCaption": "Specific Behavior alert showing magnify.exe executing from utilman.exe (mapped to correct ATT&CK Technique, Accessibility Features, and Tactic, Persistence; pink indicates critical severity)"}, {"ScreenshotName": "CS-20.A.1-2.png", "ScreenshotCaption": "File details of magnify.exe in Accessibility Features Specific Behavior alert identifying it as cmd.exe by hash and common name"}, {"ScreenshotName": "CS-E-12.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating they observed a Windows logon bypass (General Behavior)"}], "Footnotes": []}, {"DetectionType": "General Behavior", "DetectionNote": "OverWatch generated a General Behavior alert indicating a Windows logon bypass on Creeper was observed.[CS9]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "CS-20.A.1-1.png", "ScreenshotCaption": "Specific Behavior alert showing magnify.exe executing from utilman.exe (mapped to correct ATT&CK Technique, Accessibility Features, and Tactic, Persistence; pink indicates critical severity)"}, {"ScreenshotName": "CS-20.A.1-2.png", "ScreenshotCaption": "File details of magnify.exe in Accessibility Features Specific Behavior alert identifying it as cmd.exe by hash and common name"}, {"ScreenshotName": "CS-E-12.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating they observed a Windows logon bypass (General Behavior)"}], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the alert showed the details for magnify.exe, and would also be available in a separate view.[CS2]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-20.A.1-1.png", "ScreenshotCaption": "Specific Behavior alert showing magnify.exe executing from utilman.exe (mapped to correct ATT&CK Technique, Accessibility Features, and Tactic, Persistence; pink indicates critical severity)"}, {"ScreenshotName": "CS-20.A.1-2.png", "ScreenshotCaption": "File details of magnify.exe in Accessibility Features Specific Behavior alert identifying it as cmd.exe by hash and common name"}, {"ScreenshotName": "CS-E-12.png", "ScreenshotCaption": "Email excerpt from the OverWatch team indicating they observed a Windows logon bypass (General Behavior)"}], "Footnotes": ["For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated based on a new process masquerading as a Windows accessibility feature, mapped to the correct ATT&CK Tactic (Persistence) and Technique (Accessibility Features).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-20.A.1-10.png", "ScreenshotCaption": "Specific Behavior alert for magnify.exe\u00a0masquerading as a Windows accessibility feature, mapped to the correct ATT&CK Tactic (Persistence) and Technique (Accessibility Features)"}, {"ScreenshotName": "CR-20.A.1-11.png", "ScreenshotCaption": "Specific Behavior alert for magnify.exe, in process tree,\u00a0masquerading as a Windows accessibility feature, mapped to the correct ATT&CK Tactic (Persistence) and Technique (Accessibility Features)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution of magnify.exe. [CR3]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-20.A.1-10.png", "ScreenshotCaption": "Specific Behavior alert for magnify.exe\u00a0masquerading as a Windows accessibility feature, mapped to the correct ATT&CK Tactic (Persistence) and Technique (Accessibility Features)"}, {"ScreenshotName": "CR-20.A.1-11.png", "ScreenshotCaption": "Specific Behavior alert for magnify.exe, in process tree,\u00a0masquerading as a Windows accessibility feature, mapped to the correct ATT&CK Tactic (Persistence) and Technique (Accessibility Features)"}], "Footnotes": [" For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated on Windows File Name Mismatch between magnify.exe and cmd.exe, indicating this could be used for accessibility features in the description. The alert is tagged with the correct ATT&CK Technique (T1015 - Accessibility Features) and Tactics (Defense Evasion, Execution).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-20-1.png", "ScreenshotCaption": "Specific Behavior alert on Windows File Name Mismatch showing magnify.exe was renamed from cmd.exe and tagged with correct ATT&CK Technique (T1015 - Accessibility Features) and Tactics (Defense Evasion, Execution)"}, {"ScreenshotName": "EG-20-2.png", "ScreenshotCaption": "Enrichment of magnify.exe with correct ATT&CK Technique (T1015 - Accessibility Features) and Tactics (Defense Evasion, Execution) (tainted by Windows File Name Mismatch alert, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched magnify.exe with the correct ATT&CK Technique (T1015 - Accessibility Features) and Tactics (Defense Evasion, Execution) (tainted by the Windows File Name Mismatch alert). [EG11]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-20-1.png", "ScreenshotCaption": "Specific Behavior alert on Windows File Name Mismatch showing magnify.exe was renamed from cmd.exe and tagged with correct ATT&CK Technique (T1015 - Accessibility Features) and Tactics (Defense Evasion, Execution)"}, {"ScreenshotName": "EG-20-2.png", "ScreenshotCaption": "Enrichment of magnify.exe with correct ATT&CK Technique (T1015 - Accessibility Features) and Tactics (Defense Evasion, Execution) (tainted by Windows File Name Mismatch alert, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry in the event tree showed the execution of magnify.exe by utilman.exe (tainted by the Windows File Name Mismatch alert). [EG11]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-20-1.png", "ScreenshotCaption": "Specific Behavior alert on Windows File Name Mismatch showing magnify.exe was renamed from cmd.exe and tagged with correct ATT&CK Technique (T1015 - Accessibility Features) and Tactics (Defense Evasion, Execution)"}, {"ScreenshotName": "EG-20-2.png", "ScreenshotCaption": "Enrichment of magnify.exe with correct ATT&CK Technique (T1015 - Accessibility Features) and Tactics (Defense Evasion, Execution) (tainted by Windows File Name Mismatch alert, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for magnify.exe executing as a process with a renamed executable.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-20.A.1-3.png", "ScreenshotCaption": "Telemetry showing me magnify.exe executing from utilman.exe"}, {"ScreenshotName": "CC-20.A.1-4.png", "ScreenshotCaption": "General Behavior alert for magnify.exe executing as a process with a renamed executable"}, {"ScreenshotName": "CC-20.A.1-7.png", "ScreenshotCaption": "Enrichment of utilman.exe executing magnify.exe with a tag indicating that magnify was a persistent backdoor"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched utilman.exe executing magnify.exe with a tag indicating that magnify was a persistent backdoor.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-20.A.1-3.png", "ScreenshotCaption": "Telemetry showing me magnify.exe executing from utilman.exe"}, {"ScreenshotName": "CC-20.A.1-4.png", "ScreenshotCaption": "General Behavior alert for magnify.exe executing as a process with a renamed executable"}, {"ScreenshotName": "CC-20.A.1-7.png", "ScreenshotCaption": "Enrichment of utilman.exe executing magnify.exe with a tag indicating that magnify was a persistent backdoor"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed magnify.exe executing from utilman.exe with the original file name of cmd.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-20.A.1-3.png", "ScreenshotCaption": "Telemetry showing me magnify.exe executing from utilman.exe"}, {"ScreenshotName": "CC-20.A.1-4.png", "ScreenshotCaption": "General Behavior alert for magnify.exe executing as a process with a renamed executable"}, {"ScreenshotName": "CC-20.A.1-7.png", "ScreenshotCaption": "Enrichment of utilman.exe executing magnify.exe with a tag indicating that magnify was a persistent backdoor"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for Accessibility Features Child Process due to whoami.exe spawning from magnify.exe. The alert was also tagged with the correct ATT&CK Technique (T1015 - Accessibility Features) and Tactics (Persistence, Privilege Escalation).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-20.A.1-3.png", "ScreenshotCaption": "General Behavior alert for RENAMED CMD.EXE"}, {"ScreenshotName": "FE-20.A.1-4.png", "ScreenshotCaption": "Continued details for General Behavior alert for RENAMED CMD.EXE"}, {"ScreenshotName": "FE-20.A.1-5.png", "ScreenshotCaption": "Specific Behavior alert for Accessibility Features Child Process due to magnify.exe spawning whoami.exe (tagged with the correct ATT&CK Technique, T1015 - Accessibility Features, and Tactics, Persistence, Privilege Escalation)"}, {"ScreenshotName": "FE-20.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker replaced the magnifier.exe accessibility feature to launch a privileged command shell (Specific Behavior)"}], "Footnotes": []}, {"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that the attacker replaced the magnifier.exe accessibility feature to launch a privileged command shell. [FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-20.A.1-3.png", "ScreenshotCaption": "General Behavior alert for RENAMED CMD.EXE"}, {"ScreenshotName": "FE-20.A.1-4.png", "ScreenshotCaption": "Continued details for General Behavior alert for RENAMED CMD.EXE"}, {"ScreenshotName": "FE-20.A.1-5.png", "ScreenshotCaption": "Specific Behavior alert for Accessibility Features Child Process due to magnify.exe spawning whoami.exe (tagged with the correct ATT&CK Technique, T1015 - Accessibility Features, and Tactics, Persistence, Privilege Escalation)"}, {"ScreenshotName": "FE-20.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker replaced the magnifier.exe accessibility feature to launch a privileged command shell (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated for RENAMED CMD.EXE, with a description explaining how attackers will sometimes rename cmd.exe to other filenames to try to bypass detections.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-20.A.1-3.png", "ScreenshotCaption": "General Behavior alert for RENAMED CMD.EXE"}, {"ScreenshotName": "FE-20.A.1-4.png", "ScreenshotCaption": "Continued details for General Behavior alert for RENAMED CMD.EXE"}, {"ScreenshotName": "FE-20.A.1-5.png", "ScreenshotCaption": "Specific Behavior alert for Accessibility Features Child Process due to magnify.exe spawning whoami.exe (tagged with the correct ATT&CK Technique, T1015 - Accessibility Features, and Tactics, Persistence, Privilege Escalation)"}, {"ScreenshotName": "FE-20.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker replaced the magnifier.exe accessibility feature to launch a privileged command shell (Specific Behavior)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed magnify.exe executing from parent process utilman.exe (PID 3996). The telemetry was tainted by the parent POS Interactive Login Event alert.[CT5]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-20.B.1-1.png", "ScreenshotCaption": "Telemetry showing magnify.exe (tainted by the parent POS Interactive Login Event alert)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for the command prompt tool executed by masquerading an accessibility tool. The alert was tagged with the correct ATT&CK Tactics (Persistence, Privilege Escalation) and Technique (Accessibility Features).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-20.A.1-2.png", "ScreenshotCaption": "Telemetry showing magnify.exe (original name identified as cmd.exe) executing from utilman.exe (tainted by a trace detection on magnify.exe)"}, {"ScreenshotName": "MC-20.A.1-3.png", "ScreenshotCaption": "Specific Behavior alert for the command prompt tool executed by masquerading an accessibility tool. The alert was tagged with the correct ATT&CK Tactics (Persistence, Privilege Escalation) and Technique (Accessibility Features)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed magnify.exe (original name identified as cmd.exe) executing from utilman.exe. The telemetry was tainted by a trace detection on magnify.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-20.A.1-2.png", "ScreenshotCaption": "Telemetry showing magnify.exe (original name identified as cmd.exe) executing from utilman.exe (tainted by a trace detection on magnify.exe)"}, {"ScreenshotName": "MC-20.A.1-3.png", "ScreenshotCaption": "Specific Behavior alert for the command prompt tool executed by masquerading an accessibility tool. The alert was tagged with the correct ATT&CK Tactics (Persistence, Privilege Escalation) and Technique (Accessibility Features)"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated on a successful sticky keys binary hijack because magnify.exe was executing as cmd.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-20.A.1-1.png", "ScreenshotCaption": "Telemetry showing sequence of magnify.exe executing from utilman.exe"}, {"ScreenshotName": "MS-20.A.1-4.png", "ScreenshotCaption": "Specific Behavior alert on sticky keys binary hijack of magnify.exe"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of magnify.exe from utilman.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-20.A.1-1.png", "ScreenshotCaption": "Telemetry showing sequence of magnify.exe executing from utilman.exe"}, {"ScreenshotName": "MS-20.A.1-4.png", "ScreenshotCaption": "Specific Behavior alert on sticky keys binary hijack of magnify.exe"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed magnify.exe executing from utilman.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-20.A.1-1.png", "ScreenshotCaption": "Telemetry showing magnify.exe executing from utilman.exe"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of magnify.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-20-1.png", "ScreenshotCaption": "Telemetry showing magnify.exe execution"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of magnify.exe which was identified as a Windows Command Processor within the interface. Activity associated with a new story (Group ID).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "S1-20.B.1-1.png", "ScreenshotCaption": "Telemetry showing magnify.exe execution (identified as Windows Command Processor)"}], "Footnotes": []}]}]}]}, {"Substep": "20.A.1", "Procedure": "RDP connection made to Creeper (10.0.0.4) as part of execution of persistence mechanism", "Techniques": [{"TechniqueId": "T1076", "TechniqueName": "Remote Desktop Protocol", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a logon type 10 (remote interactive logon) for Kmitnick on Creeper, indicating a RDP session was established and logged into.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CS-20.A.1-3.png", "ScreenshotCaption": "Telemetry showing logon type 10 (remote interactive logon) for Kmitnick on Creeper"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched a RDP connection with information that the connection was made to a RDP port, as well as a related ATT&CK Tactic (Command and Control) and Techniques (Commonly Used Port, Standard Application Layer Protocol).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-20.A.1-21.png", "ScreenshotCaption": "Enrichment of RDP connection to\u00a0Creeper (10.0.0.4) identified as using RDP Port and related ATT&CK Tactic (Command and Control) and Technique (Commonly Used Port, Standard Application Layer Protocol)"}, {"ScreenshotName": "CR-20.A.1-20.png", "ScreenshotCaption": "Telemetry of connection to port 3389 on Creeper (10.0.0.4)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed creation of a RDP session on Creeper (10.0.0.4).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-20.A.1-21.png", "ScreenshotCaption": "Enrichment of RDP connection to\u00a0Creeper (10.0.0.4) identified as using RDP Port and related ATT&CK Tactic (Command and Control) and Technique (Commonly Used Port, Standard Application Layer Protocol)"}, {"ScreenshotName": "CR-20.A.1-20.png", "ScreenshotCaption": "Telemetry of connection to port 3389 on Creeper (10.0.0.4)"}], "Footnotes": []}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed a connection to port 3389 on Creeper (10.0.0.4) with information transmitted in bytes indicating a RDP session was established.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "EG-20-3.png", "ScreenshotCaption": "Telemetry showing connection to Creeper (10.0.0.4) on port 3389"}], "Footnotes": []}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched a Remote Desktop connection indicating a successful login to Remote Desktop Services.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-20.A.1-2.png", "ScreenshotCaption": "Enrichment of a Remote Desktop connection indicating a successful login to Remote Desktop Services."}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified the use of the Remote Desktop Protocol to connect to Creeper.[FE5]", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-20.A.1-1.png", "ScreenshotCaption": "Enrichment of TCP port 3389 connection with RDP Network Connection alert (tagged with correct ATT&CK Technique T10176 - Remote Desktop Protocol, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-20.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating Remote Desktop Protocol was used to connect to Creeper (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched a TCP port 3389 connection with an alert for RDP Network Connection (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1076 - Remote Desktop Protocol) and Tactic (Lateral Movement).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-20.A.1-1.png", "ScreenshotCaption": "Enrichment of TCP port 3389 connection with RDP Network Connection alert (tagged with correct ATT&CK Technique T10176 - Remote Desktop Protocol, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-20.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating Remote Desktop Protocol was used to connect to Creeper (Specific Behavior)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed an inbound connection to Creeper (10.0.0.4) on port 3389.[CT5]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CT-20.A.1-1.png", "ScreenshotCaption": "Telemetry showing connection to Creeper (10.0.0.4) on port 3389"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed creation of a terminal services session on Creeper from CodeRed with corresponding logon by Kmitnick.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MS-20.A.1-2.png", "ScreenshotCaption": "Telemetry showing svchost.exe starting terminal service session on Creeper from CodeRed (10.0.1.5)"}, {"ScreenshotName": "MS-20.A.1-3.png", "ScreenshotCaption": "Telemetry showing Kmitnick RDP logon from CodeRed to Creeper"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed an inbound connection to Creeper (10.0.0.4) on port 3389.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-20.A.1-2.png", "ScreenshotCaption": "Telemetry showing an inbound connection to Creeper (10.0.0.4) on port 3389"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "None", "DetectionNote": "No detection capability demonstrated for this procedure.", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}]}, {"Substep": "20.B.1", "Procedure": "Executed 'whoami' via cmd persistence mechanism through RDP connection made to Creeper (10.0.0.4)", "Techniques": [{"TechniqueId": "T1033", "TechniqueName": "System Owner/User Discovery", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Vendors": [{"VendorName": "Carbon Black", "DisplayName": "Carbon Black", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched whoami.exe with the correct ATT&CK Technique (T1033 - System Owner/User Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-20.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree with telemetry showing whoami.exe execution"}, {"ScreenshotName": "CB-20.B.1-2.png", "ScreenshotCaption": "Enrichment of whoami.exe\u00a0with correct ATT&CK Technique (T1033 - System Owner/User Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry within the process tree showed magnify.exe executing whoami.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CB-20.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree with telemetry showing whoami.exe execution"}, {"ScreenshotName": "CB-20.B.1-2.png", "ScreenshotCaption": "Enrichment of whoami.exe\u00a0with correct ATT&CK Technique (T1033 - System Owner/User Discovery)"}], "Footnotes": []}]}, {"VendorName": "CrowdStrike", "DisplayName": "CrowdStrike", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of whoami.exe. The process tree view showed whoami.exe was tainted by a previous magnify.exe detection.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CS-20.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing magnify.exe child process whoami.exe (tainted by pink line indicating critical severity)"}], "Footnotes": []}]}, {"VendorName": "Cybereason", "DisplayName": "Cybereason", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated based on whoami.exe performing Reconnaissance as a SYSTEM user. The alert was tagged with the correct ATT&CK Tactic (Discovery) and Technique (System Owner/User Discovery). The alert was tainted by a parent Accessibility Features alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-20.B.1-10.png", "ScreenshotCaption": "Specific Behavior alert for whoami.exe execution with the correct ATT&CK Tactic (Discovery) and Technique (System Owner/User Discovery) (tainted by a parent Accessibility Features alert)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed the execution of whoami.exe. [CR3]", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CR-20.B.1-10.png", "ScreenshotCaption": "Specific Behavior alert for whoami.exe execution with the correct ATT&CK Tactic (Discovery) and Technique (System Owner/User Discovery) (tainted by a parent Accessibility Features alert)"}], "Footnotes": [" For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"VendorName": "Elastic", "DisplayName": "Elastic", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched whoami.exe with the correct ATT&CK Technique (T1033 - System Owner/User Discovery) and Tactic (Discovery). The enrichment was tainted by an alert on Windows File Name Mismatch-Accessibility Features. [EG11]", "Modifiers": ["Delayed", "Tainted"], "Screenshots": [{"ScreenshotName": "EG-20-1.png", "ScreenshotCaption": "Telemetry from event tree showing execution of whoami.exe (tainted by parent alert on magnify.exe)"}, {"ScreenshotName": "EG-20-2.png", "ScreenshotCaption": "Enrichment of whoami.exe with correct ATT&CK Technique (T1033 - System Owner/User Discovery) and Tactic (Discovery)\u00a0(tainted by Windows File Name Mismatch alert, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed whoami.exe was executed from magnify.exe. The telemetry was tainted by an alert on Windows File Name Mismatch-Accessibility Features. [EG11]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "EG-20-1.png", "ScreenshotCaption": "Telemetry from event tree showing execution of whoami.exe (tainted by parent alert on magnify.exe)"}, {"ScreenshotName": "EG-20-2.png", "ScreenshotCaption": "Enrichment of whoami.exe with correct ATT&CK Technique (T1033 - System Owner/User Discovery) and Tactic (Discovery)\u00a0(tainted by Windows File Name Mismatch alert, tree is initially available unenriched to show the base telemetry)"}], "Footnotes": [" Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections."]}]}, {"VendorName": "F-Secure", "DisplayName": "F-Secure", "Detections": [{"DetectionType": "General Behavior", "DetectionNote": "A General Behavior alert was generated showing that a spawned process (whoami) has been tagged for monitoring because its parent process has a detection (magnify.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-20.A.1-5.png", "ScreenshotCaption": "Telemetry showing the execution of whoami"}, {"ScreenshotName": "CC-20.A.1-6.png", "ScreenshotCaption": "Enrichment of whoami.exe with a tag identifying the command as enumeration"}, {"ScreenshotName": "CC-20.A.1-7.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (whoami) has been tagged for monitoring because its parent process has a detection (magnify.exe)"}], "Footnotes": []}, {"DetectionType": "Enrichment", "DetectionNote": "The capability enriched whoami.exe with a tag identifying the command as enumeration.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-20.A.1-5.png", "ScreenshotCaption": "Telemetry showing the execution of whoami"}, {"ScreenshotName": "CC-20.A.1-6.png", "ScreenshotCaption": "Enrichment of whoami.exe with a tag identifying the command as enumeration"}, {"ScreenshotName": "CC-20.A.1-7.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (whoami) has been tagged for monitoring because its parent process has a detection (magnify.exe)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed whoami.exe was executed from magnify.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CC-20.A.1-5.png", "ScreenshotCaption": "Telemetry showing the execution of whoami"}, {"ScreenshotName": "CC-20.A.1-6.png", "ScreenshotCaption": "Enrichment of whoami.exe with a tag identifying the command as enumeration"}, {"ScreenshotName": "CC-20.A.1-7.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (whoami) has been tagged for monitoring because its parent process has a detection (magnify.exe)"}], "Footnotes": []}]}, {"VendorName": "FireEye", "DisplayName": "FireEye", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched whoami.exe with an alert for Whoami Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1033 - System Owner/User Discovery) and Tactic (Discovery).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FE-20.A.1-5.png", "ScreenshotCaption": "Telemetry showing whoami.exe executing as a child process of magnify.exe (tainted by parent Accessibility Features Child Process alert)"}, {"ScreenshotName": "FE-20.A.1-6.png", "ScreenshotCaption": "Enrichment of whoami.exe with Whoami Execution alert (tagged with correct ATT&CK Technique, T1033 - System Owner/User Discovery, and Tactic, Discovery)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed whoami.exe executing from magnify.exe within an alert for Accessibility Features Child Process. The telemetry was tainted by the Accessibility Features Child Process (METHODOLOGY) alert.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "FE-20.A.1-5.png", "ScreenshotCaption": "Telemetry showing whoami.exe executing as a child process of magnify.exe (tainted by parent Accessibility Features Child Process alert)"}, {"ScreenshotName": "FE-20.A.1-6.png", "ScreenshotCaption": "Enrichment of whoami.exe with Whoami Execution alert (tagged with correct ATT&CK Technique, T1033 - System Owner/User Discovery, and Tactic, Discovery)"}], "Footnotes": []}]}, {"VendorName": "GoSecure", "DisplayName": "GoSecure", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed magnify.exe executing whoami.exe. The telemetry was tainted by the parent POS Interactive Login Event alert.[CT5]", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CT-20.B.1-1.png", "ScreenshotCaption": "Telemetry showing magnify.exe executing whoami.exe (tainted by the parent POS Interactive Login Event alert)"}], "Footnotes": ["Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details."]}]}, {"VendorName": "McAfee", "DisplayName": "McAfee", "Detections": [{"DetectionType": "Specific Behavior", "DetectionNote": "A Specific Behavior alert was generated for the whoami command was executed through a masqueraded tool (magnify.exe).", "Modifiers": [], "Screenshots": [{"ScreenshotName": "MC-20.A.1-2.png", "ScreenshotCaption": "Telemetry showing magnify.exe (original name identified as cmd.exe) executing whoami.exe (tainted by a trace detection on magnify.exe)"}, {"ScreenshotName": "MC-20.A.1-3.png", "ScreenshotCaption": "Specific Behavior alert for the whoami command was executed through a masqueraded tool (magnify.exe)"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed magnify.exe (original name identified as cmd.exe) executing whoami.exe. The telemetry was tainted by a trace detection on magnify.exe.", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MC-20.A.1-2.png", "ScreenshotCaption": "Telemetry showing magnify.exe (original name identified as cmd.exe) executing whoami.exe (tainted by a trace detection on magnify.exe)"}, {"ScreenshotName": "MC-20.A.1-3.png", "ScreenshotCaption": "Specific Behavior alert for the whoami command was executed through a masqueraded tool (magnify.exe)"}], "Footnotes": []}]}, {"VendorName": "Microsoft", "DisplayName": "Microsoft", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed whoami.exe executing from magnify.exe (tainted by sticky keys binary hijack alert).", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "MS-20.A.1-1.png", "ScreenshotCaption": "Execution sequence showing whoami.exe executing from magnify.exe"}, {"ScreenshotName": "MS-20.A.1-4.png", "ScreenshotCaption": "Process tree view of sticky keys binary hijack alert showing tainted relationship to whoami.exe"}], "Footnotes": []}]}, {"VendorName": "Palo Alto Networks", "DisplayName": "Palo Alto Networks", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "The capability enriched whoami.exe executing as an enumeration command.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-20.B.1-1.png", "ScreenshotCaption": "Telemetry showing magnify.exe executing whoami.exe"}, {"ScreenshotName": "PA-20.B.1-2.png", "ScreenshotCaption": "Enrichment of whoami.exe executing as an enumeration command"}], "Footnotes": []}, {"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed magnify.exe executing whoami.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "PA-20.B.1-1.png", "ScreenshotCaption": "Telemetry showing magnify.exe executing whoami.exe"}, {"ScreenshotName": "PA-20.B.1-2.png", "ScreenshotCaption": "Enrichment of whoami.exe executing as an enumeration command"}], "Footnotes": []}]}, {"VendorName": "RSA", "DisplayName": "RSA", "Detections": [{"DetectionType": "Telemetry", "DetectionNote": "Telemetry showed execution of whoami.exe.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "RSA-20-1.png", "ScreenshotCaption": "Telemetry showing whoami.exe execution"}], "Footnotes": []}]}, {"VendorName": "SentinelOne", "DisplayName": "SentinelOne", "Detections": [{"DetectionType": "Enrichment", "DetectionNote": "Enrichment showed execution of the whoami command (enriched with description \"whoami - displays logged on user information\"). Execution of whoami was associated to the story (Group ID) created from the execution of magnify.exe, but was not considered tainted because an alert was not generated when magnify.exe was executed.", "Modifiers": [], "Screenshots": [{"ScreenshotName": "S1-20.B.1-1.png", "ScreenshotCaption": "Enrichment of whoami command (displays logged on user information)"}], "Footnotes": []}]}]}]}]}