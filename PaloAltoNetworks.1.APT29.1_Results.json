{"PublicRelease": "2020 The MITRE Corporation. ALL RIGHTS RESERVED. Approved for Public Release; Distribution Unlimited. Public Release Case Number 19-03607-4", "Techniques": [{"TechniqueId": "T1003", "TechniqueName": "Credential Dumping", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "6.A.2", "Procedure": "Executed the CryptUnprotectedData API call to decrypt Chrome passwords", "Criteria": "accesschk.exe executing the CryptUnprotectedData API", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "6.C.1", "Procedure": "Dumped password hashes from the Windows Registry by injecting a malicious DLL into Lsass.exe", "Criteria": "powershell.exe injecting into lsass.exe OR lsass.exe\u00a0reading Registry keys under HKLM:\\SAM\\SAM\\Domains\\Account\\Users\\", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) called \"Credentials in Registry\" was generated due to a group owner child process querying the User SAM registry keys. Detection incurred a delay based on additional data processing to generate the behavioral threat.", "DetectionType": "Technique", "Modifiers": ["Delayed (Processing)", "Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2959.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-2958.png"}]}, {"DetectionNote": "An MSSP detection for \"Mimikatz\" was received that described PowerShell dumping credentials from LSASS process memory.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13216.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13214.png"}]}]}, {"SubStep": "14.B.4", "Procedure": "Dumped plaintext credentials using Mimikatz (m.exe)", "Criteria": "m.exe injecting into lsass.exe to dump credentials", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Detections": [{"DetectionNote": "A Technique alert detection (high severity) for Credential Dumping was generated for PowerShell reading credentials from Lsass memory.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3192.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3191.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3193.png"}]}, {"DetectionNote": "A Technique alert detection (red indicator) called \"Command line arguments matching Mimikatz execution\" was generated for m.exe with command-line arguments indicative of Mimikatz credential dumping. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3190.png"}], "Footnotes": ["According to the vendor, payload execution would have been prevented as Wildfire labeled the payload as malicious/malware."]}, {"DetectionNote": "A General alert was generated identifying m.exe as malware.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13719.png"}]}, {"DetectionNote": "An MSSP detection contained evidence of the creation of m.exe in the System32 folder.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13250.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13246.png"}]}]}, {"SubStep": "16.D.2", "Procedure": "Dumped the KRBTGT hash on the domain controller host NewYork (10.0.0.4) using Mimikatz (m.exe)", "Criteria": "m.exe injecting into lsass.exe to dump credentials", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) called \"Command line arguments matching Mimikatz execution\" was generated for m.exe with command-line arguments indicative of Mimikatz credential dumping.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3282.png"}], "Footnotes": ["According to the vendor, payload execution would have been prevented as Wildfire labeled the payload as malicious/malware."]}, {"DetectionNote": "A Technique alert detection (red indicator) called \"Credential Dumping\" was generated for m.exe reading lsass.exe process memory.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3271.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3273.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3272.png"}], "Footnotes": ["According to the vendor, payload execution would have been prevented as Wildfire labeled the payload as malicious/malware."]}, {"DetectionNote": "A General alert detection called \"heuristic.b.mimikatz_lsadump_inject\" was generated for possible Mimikatz activity.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3285.png"}]}, {"DetectionNote": "A General alert detection (red indicator) was generated for a rare child process spawned from wsmprovhost.exe.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3282.png"}]}, {"DetectionNote": "An MSSP detection contained evidence of Mimikatz command-line arguments to dump credentials.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13258.png"}]}, {"DetectionNote": "Telemetry showed m.exe injecting a thread into lsass.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3283.png"}]}]}]}, {"TechniqueId": "T1032", "TechniqueName": "Standard Cryptographic Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.A.4", "Procedure": "Used RC4 stream cipher to encrypt C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed rcs.3aka3.doc loading cryptographic libraries.", "DetectionType": "None", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2656.png"}]}]}, {"SubStep": "3.B.5", "Procedure": "Used HTTPS to encrypt C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "11.A.15", "Procedure": "Used HTTPS to encrypt C2 (192.168.0.4) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1047", "TechniqueName": "Windows Management Instrumentation", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "14.B.1", "Procedure": "Created and executed a WMI class using PowerShell", "Criteria": "WMI Process (WmiPrvSE.exe) executing powershell.exe", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executed by WMI. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3383.png"}], "Footnotes": ["The way this data was presented was altered after the start of the evaluation so the detection is identified as a Detection Configuration Change."]}]}]}, {"TechniqueId": "T1085", "TechniqueName": "Rundll32", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "20.A.1", "Procedure": "Executed Run key persistence payload on user login using RunDll32", "Criteria": "rundll32.exe executing kxwn.lock", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Detections": [{"DetectionNote": "An MSSP detection was generated containing evidence of rundll32.exe executing kxwn.lock.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-15751.png"}]}, {"DetectionNote": "Telemetry showed rundll32.exe executing kxwn.lock.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3322.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3325.png"}]}]}]}, {"TechniqueId": "T1115", "TechniqueName": "Clipboard Data", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "7.A.2", "Procedure": "Captured clipboard contents using PowerShell", "Criteria": "powershell.exe executing Get-Clipboard", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Detections": [{"DetectionNote": "A Technique alert detection called \"clipboard data accessed\" was generated due to the use of getclipboarddata API.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2964.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-2965.png"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell capturing clipboard data.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13217.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-Clipboard.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}]}, {"TechniqueId": "T1033", "TechniqueName": "System Owner/User Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.2", "Procedure": "Enumerated the current username using PowerShell", "Criteria": "powershell.exe executing $env:USERNAME", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing $env:USERNAME. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13646.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13645.png"}]}]}, {"SubStep": "11.A.6", "Procedure": "Checked that the username is not related to admin or a generic value (ex: user) using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Detections": [{"DetectionNote": "A Tactic alert detection called WMI virtualization sandbox discovery was generated for a PowerShell gwmi query for Win32_ComputerSystem.", "DetectionType": "Tactic", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3132.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3132.png"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of execution of an WMI query for Win32_ComputerSystem.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13236.png"}]}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13687.png"}]}]}, {"SubStep": "13.C.1", "Procedure": "Enumerated the current username using the GetUserNameEx API", "Criteria": "powershell.exe executing the GetUserNameEx API", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Detections": [{"DetectionNote": "Telemetry showed PowerShell calling the GetUserNameEx API. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13689.png"}]}]}, {"SubStep": "15.A.1", "Procedure": "Enumerated logged on users using PowerShell", "Criteria": "powershell.exe executing $env:UserName", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Detections": [{"DetectionNote": "An MSSP detection occurred for PowerShell executing $env:UserName.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13248.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13254.png"}]}, {"DetectionNote": "Telemetry showed PowerShell script block executing $env:UserName. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3400.png"}]}]}, {"SubStep": "16.B.1", "Procedure": "Enumerated the domain SID (from current user SID) using\u00a0the ConvertSidToStringSid API", "Criteria": "powershell.exe executing the ConvertSidToStringSid API", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of the execution of the ConvertSidToStringSid API.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13255.png"}]}, {"DetectionNote": "Telemetry showed PowerShell executing the ConvertSidToStringSid API function. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3390.png"}]}]}]}, {"TechniqueId": "T1071", "TechniqueName": "Standard Application Layer Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "3.B.4", "Procedure": "Used HTTPS to transport\u00a0C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is HTTPS", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "11.A.14", "Procedure": "Used HTTPS to transport\u00a0C2 (192.168.0.4) traffic", "Criteria": "Established network channel over the HTTPS protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1134", "TechniqueName": "Access Token Manipulation", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "10.B.3", "Procedure": "Manipulated the token of the PowerShell payload via the CreateProcessWithToken API", "Criteria": "hostui.exe manipulating the token of powershell.exe via the CreateProcessWithToken API OR \npowershell.exe executing with the stolen token of explorer.exe", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) for \"Access Token Manipulation\" was generated for thread impersonation.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3102.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3110.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3103.png"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of powershell.exe executing with the explorer.exe token via the CreateProcessWithToken API.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13233.png"}]}]}]}, {"TechniqueId": "T1112", "TechniqueName": "Modify Registry", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "3.C.1", "Procedure": "Modified the Registry to remove artifacts of COM hijacking", "Criteria": "Deletion of of\u00a0the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command subkey", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Detections": [{"DetectionNote": "An MSSP detection for Modify Registry \"(T1070)\" occurred for the Deletion of the registry value.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13198.png"}]}, {"DetectionNote": "Telemetry showed the deletion of the command subkey. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2768.png"}]}]}, {"SubStep": "14.A.3", "Procedure": "Modified the Registry to remove artifacts of COM hijacking using PowerShell", "Criteria": "Deletion of\u00a0the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command\u00a0subkey", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Detections": [{"DetectionNote": "Telemetry showed the deletion of the Registry value. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3187.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3186.png"}]}]}]}, {"TechniqueId": "T1140", "TechniqueName": "Deobfuscate/Decode Files or Information", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "4.A.3", "Procedure": "Decompressed ZIP (SysinternalsSuite.zip) file using PowerShell", "Criteria": "powershell.exe executing Expand-Archive", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of powershell.exe decompressing SysinternalsSuite.zip via Expand-Archive.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13208.png"}]}, {"DetectionNote": "Telemetry showed PowerShell decompressing the ZIP via Expand-Archive and the corresponding file writes. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13644.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-2789.png"}]}]}, {"SubStep": "11.A.10", "Procedure": "Decoded an embedded DLL payload to disk using certutil.exe", "Criteria": "certutil.exe decoding kxwn.lock", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Detections": [{"DetectionNote": "A General alert detection (red indicator) for \"encoding information using Windows certificate management tool\" was generated due to certutil decoding the kwxn.lock payload.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3149.png"}]}, {"DetectionNote": "A MSSP detection occurred for certutil.exe decoding kxwn.lock.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13237.png"}]}, {"DetectionNote": "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3153.png"}]}]}, {"SubStep": "14.B.6", "Procedure": "Read and decoded Mimikatz output from a WMI class property using PowerShell", "Criteria": "powershell.exe executing Get-WmiInstance", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Detections": [{"DetectionNote": "An MSSP detection occurred for PowerShell Get-WmiInstance reading encoded content from Win32_AuditCode.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13252.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13247.png"}]}]}]}, {"TechniqueId": "T1145", "TechniqueName": "Private Keys", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "6.B.1", "Procedure": "Exported a local certificate to a PFX file using PowerShell", "Criteria": "powershell.exe creating a certificate file exported from the system", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) called \"New certificate file has been created\" was generated for the file creation event of the lotu40lg.b0j.pfx file.  The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2954.png"}]}, {"DetectionNote": "An MSSP detection was generated for the creation of the $RandomFileName.pfx file. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13215.png"}]}, {"DetectionNote": "Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2979.png"}]}]}]}, {"TechniqueId": "T1077", "TechniqueName": "Windows Admin Shares", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "8.C.2", "Procedure": "Established SMB session to remote host Scranton's (10.0.1.4) IPC$ share using PsExec", "Criteria": "SMB session to Scranton (10.0.1.4) over TCP port 445/135 OR evidence of usage of a Windows share", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Detections": [{"DetectionNote": "A Technique alert detection for network share access was generated due to remote access to a Windows admin share.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3018.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3019.png"}]}, {"DetectionNote": "A Technique alert detection was generated for an executable being copied to a remote host via a share. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3016.png"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 445.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13225.png"}]}, {"DetectionNote": "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over port 135. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3022.png"}]}]}]}, {"TechniqueId": "T1088", "TechniqueName": "Bypass User Account Control", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "3.B.2", "Procedure": "Executed elevated PowerShell payload", "Criteria": "High integrity powershell.exe spawning from\u00a0control.exe\u200b\u200b (spawned from sdclt.exe)", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) was generated for for \"Bypass User Account Control VIA registry hijack T1088\" for control.exe creating a high integrity powershell.exe.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2744.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-2741.png"}]}, {"DetectionNote": "An MSSP detection for \"UAC bypass (T1088)\" occurred for a new high hntegrity PowerShell callback spawning from control.exe\u200b\u200b.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13197.png"}]}, {"DetectionNote": "Telemetry showed control.exe creating a high integrity powershell.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"SubStep": "14.A.2", "Procedure": "Executed elevated PowerShell payload", "Criteria": "High integrity powrshell.exe spawning from\u00a0control.exe\u200b\u200b (spawned from sdclt.exe)", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Detections": [{"DetectionNote": "An MSSP detection contained evidence of High Integrity PowerShell process spawned from control.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13244.png"}]}, {"DetectionNote": "Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe).", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3379.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3380.png"}]}]}]}, {"TechniqueId": "T1048", "TechniqueName": "Exfiltration Over Alternative Protocol", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "7.B.4", "Procedure": "Exfiltrated collection (OfficeSupplies.7z) to WebDAV network share using PowerShell", "Criteria": "powershell executing Copy-Item pointing to an attack-controlled WebDav\u00a0network share (192.168.0.4:80)", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Detections": [{"DetectionNote": "A General alert detection (red indicator) called \"File being written to remote path\" was generated for the file OfficeSupplies.7z being written a WebDav share at 192.168.0.4.  The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "General", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2977.png"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of OfficeSupplies.7z being copied over the network via WebDav to 192.168.0.4. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13219.png"}]}, {"DetectionNote": "Telemetry showed PowerShell creating OfficeSupplies.7z on a remote adversary WebDav network share (192.168.0.4). The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2975.png"}]}]}, {"SubStep": "18.A.2", "Procedure": "Exfiltrated staged collection to an online OneDrive account using PowerShell", "Criteria": "powershell.exe executing Copy-Item pointing to drive mapped to an attack-controlled OneDrive account", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Detections": [{"DetectionNote": "An MSSP detection contained evidence  WindowsParentalControlMigration.tmp file was written to the mapped OneDrive network share.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13260.png"}]}, {"DetectionNote": "Telemetry showed the creation of the exfiltrated data within the mapped OneDrive directory. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3321.png"}]}]}]}, {"TechniqueId": "T1099", "TechniqueName": "Timestomp", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "12.A.2", "Procedure": "Modified the time attributes of the kxwn.lock persistence payload using PowerShell", "Criteria": "powershell.exe modifying the creation, last access, and last write times of kxwn.lock", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Detections": [{"DetectionNote": "A Technique alert detection called \"ioc.Timestomp_T1099\" (high severity) was generated due to PowerShell modifying timestamps on kxwn.lock file. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13688.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3178.png"}]}, {"DetectionNote": "Telemetry showed scriptblock with commands to timestomp kxwn.lock.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}]}, {"TechniqueId": "T1005", "TechniqueName": "Data from Local System", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "2.A.3", "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Detections": [{"DetectionNote": "An MSSP detection for Data From Local System \"(T1005)\" occurred containing evidence that a discovery script was executed file read operations on local folder \u200bC:\\Users\\Pam. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13202.png"}]}, {"DetectionNote": "Telemetry showed file reads of C:\\Users\\Pam\\*. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2679.png"}]}]}, {"SubStep": "7.B.1", "Procedure": "Read data in the user's Downloads directory using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\pam\\Downloads\\", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of  powershell.exe accessing files from C:\\Users\\pam\\Downloads.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13219.png"}]}, {"DetectionNote": "Telemetry showed Powershell.exe reading files from C:\\Users\\pam\\Downloads. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2983.png"}]}]}, {"SubStep": "9.B.4", "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Detections": [{"DetectionNote": "A MSSP detection occurred for powershell.exe reading files in C:\\Users\\Pam.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13228.png"}]}, {"DetectionNote": "Telemetry showed file reads of C:\\Users\\Pam\\*. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3045.png"}]}]}, {"SubStep": "17.B.1", "Procedure": "Read and collected a local file using PowerShell", "Criteria": "powershell.exe reading the file MITRE-ATTACK-EVALS.HTML", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1113", "TechniqueName": "Screen Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "7.A.1", "Procedure": "Captured and saved screenshots using PowerShell", "Criteria": "powershell.exe executing the CopyFromScreen function from System.Drawing.dll", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Detections": [{"DetectionNote": "A Technique alert detection called \"Screen Capture - T1056\" was generated for powershell.exe making the GdiBitBlt API call. ", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2967.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-2969.png"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of powershell.exe executing performing a Screen Capture.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13217.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}]}, {"TechniqueId": "T1084", "TechniqueName": "Windows Management Instrumentation Event Subscription", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "15.A.2", "Procedure": "Established WMI event subscription persistence using PowerShell", "Criteria": "powershell.exe creating the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Detections": [{"DetectionNote": "A Technique alert detection was generated for PowerShell creating a WMI event subscription.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13724.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-14507.png"}]}, {"DetectionNote": "An MSSP detection contained evidence of WMI persistence established for user Oscar.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13254.png"}]}, {"DetectionNote": "Telemetry showed the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3400.png"}]}]}, {"SubStep": "20.A.2", "Procedure": "Executed WMI persistence on user login", "Criteria": "The WMI process (wmiprvse.exe) executing powershell.exe", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Detections": [{"DetectionNote": "A Technique alert detection (high severity) called was generated for PowerShell executing as part of a Windows Management Instrumentation Event Subscription.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3326.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3327.png"}]}, {"DetectionNote": "An MSSP detection was generated containing evidence of powershell.exe executing from Windows Management Instrumentation Event Subscription.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-15752.png"}]}]}]}, {"TechniqueId": "T1027", "TechniqueName": "Obfuscated Files or Information", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "3.A.2", "Procedure": "Embedded PowerShell payload in monkey.png using steganography", "Criteria": "Evidence that a PowerShell payload was within\u00a0monkey.png", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Detections": [{"DetectionNote": "An MSSP detection for \"Obfuscated Files or Information\" occurred containing evidence of the PowerShell script contained within monkey.png.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13195.png"}]}, {"DetectionNote": "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2719.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-2757.png"}]}]}, {"SubStep": "14.B.5", "Procedure": "Encoded and wrote Mimikatz output to a WMI class property using PowerShell", "Criteria": "powershell.exe executing Set-WmiInstance", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Detections": [{"DetectionNote": "An MSSP detection contained evidence of PowerShell executing Set-WmiInstance to write encoded content to Win32_AuditCode.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13251.png"}]}, {"DetectionNote": "Telemetry showed PowerShell writing encoded content into the WMI class. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13715.png"}]}]}, {"SubStep": "17.C.2", "Procedure": "Prepended the GIF file header to a compressed staging file using PowerShell", "Criteria": "powershell.exe executing Set-Content", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Detections": [{"DetectionNote": "An MSSP detection occurred contained evidence that WindowsParentalControlMigration.tmp was a zip archive that had its file header modified to begin with a GIF image header.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13259.png"}]}, {"DetectionNote": "Telemetry showed PowerShell appending the GIF file header to the compressed file. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13729.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-17857.png"}]}]}]}, {"TechniqueId": "T1057", "TechniqueName": "Process Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.B.1", "Procedure": "Enumerated current running processes using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of powershell.exe executing Get-Process.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13209.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-Process. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2833.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-2832.png"}]}]}, {"SubStep": "4.C.5", "Procedure": "Enumerated the current process ID using PowerShell", "Criteria": "powershell.exe executing $PID", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing $PID. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13646.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13645.png"}]}]}, {"SubStep": "8.A.3", "Procedure": "Enumerated processes on remote host Scranton (10.0.1.4) using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) called \"Process Discovery with PowerShell\" was generated due to powershell.exe executing Get-Process.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3005.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3004.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3003.png"}]}, {"DetectionNote": "An MSSP detection occurred for powershell.exe executing Get-Process.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13221.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-Process.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3007.png"}]}]}, {"SubStep": "11.A.8", "Procedure": "Checked that processes such as procexp.exe, taskmgr.exe, or wireshark.exe are not running using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_Process", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Detections": [{"DetectionNote": "A Technique alert detection called \"process discovery - T1057\" was generated for a PowerShell gwmi query for Win32_Process.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3137.png"}]}, {"DetectionNote": "An MSSP detection contained evidence of PowerShell executing a gwmi query for Win32_Process.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13236.png"}]}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_Process.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"SubStep": "13.D.1", "Procedure": "Enumerated running processes using the CreateToolhelp32Snapshot API", "Criteria": "powershell.exe executing the CreateToolhelp32Snapshot API", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Detections": [{"DetectionNote": "Telemetry showed PowerShell calling the CreateToolhelp32Snapshot API. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13689.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-14501.png"}]}]}, {"SubStep": "14.B.2", "Procedure": "Enumerated and tracked PowerShell processes using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1204", "TechniqueName": "User Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.A.1", "Procedure": "User Pam executed payload rcs.3aka3.doc", "Criteria": "The rcs.3aka3.doc process spawning from explorer.exe", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Detections": [{"DetectionNote": "A General alert detection (medium severity) was generated for rcs.3aka3.doc being tagged as malware.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2611.png"}], "Footnotes": ["According to the vendor, payload execution would have been prevented as Wildfire labeled the payload as malicious/malware."]}, {"DetectionNote": "An MSSP detection occurred containing evidence of the user Pam executing the malicious document rcs.3aka3.doc file.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13200.png"}]}, {"DetectionNote": "Telemetry showed explorer.exe executing rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2605.png"}]}]}, {"SubStep": "11.A.1", "Procedure": "User Oscar executed payload 37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk", "Criteria": "powershell.exe spawning from explorer.exe", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Detections": [{"DetectionNote": "A General alert detection (red indicator) was generated for a suspicious Powershell process being spawned by explorer.exe.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3125.png"}]}, {"DetectionNote": "An MSSP detection was generated containing evidence user Oscar executed 37486-the-shockingtruth-about-election-rigging-in-america.rtf.lnk.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13234.png"}]}, {"DetectionNote": "Telemetry showed explorer.exe executing powershell.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3125.png"}]}]}]}, {"TechniqueId": "T1497", "TechniqueName": "Virtualization/Sandbox Evasion", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "11.A.3", "Procedure": "Checked that the BIOS version and serial number are not associated with VirtualBox or VMware using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject\nquery for Win32_BIOS", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Detections": [{"DetectionNote": "A Technique alert detection called \"System Information Discovery\" was generated for a PowerShell gwmi query for Win32_BIOS.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3129.png"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of execution of an WMI query for Win32_BIOS.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13236.png"}]}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_BIOS.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}]}, {"TechniqueId": "T1002", "TechniqueName": "Data Compressed", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "2.A.4", "Procedure": "Compressed and stored files into ZIP (Draft.zip) using PowerShell", "Criteria": "powershell.exe executing\u00a0Compress-Archive", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) called \"Scripting engine creates compressed file under suspicious folder\" was generated due identifying Draft.zip as compressed. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2674.png"}]}, {"DetectionNote": "An MSSP detection for Data Compressed \"(T1002)\" occurred containing evidence that the files \"C:\\Users\\pam\\Links\\Downloads.lnk, C:\\Users\\pam\\Links\\Desktop.lnk, C:\\Users\\pam\\Favorites\\Bing.url, and C:\\Users\\pam\\Desktop\\Microsoft Edge.lnk\" were compressed into a zip file draft.zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13202.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe compressing via Compress-Archive. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13640.png"}]}]}, {"SubStep": "7.B.2", "Procedure": "Compressed\u00a0data from the user's Downloads directory into a ZIP file (OfficeSupplies.7z) using PowerShell", "Criteria": "powershell.exe creating the file OfficeSupplies.7z", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) called \"Scripting engine creates compressed file under suspicious location\" was generated for the file creation event of a .7z file in %APPDATA%. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2976.png"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of the file create of OfficeSupplies.7z.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13219.png"}]}, {"DetectionNote": "Telemetry showed the file create event for OfficeSupplies.7z. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2975.png"}]}]}, {"SubStep": "9.B.7", "Procedure": "Compressed staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "Criteria": "powershell.exe executing rar.exe", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) for \"Scripting engine creates compressed file under suspicious folder\" was generated when rar.exe was used to create an compressed zip archive in %APPDATA%. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3051.png"}]}, {"DetectionNote": "An MSSP detection contained evidence of execution of rar.exe with command line arguments to compress working.zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13229.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3050.png"}]}]}, {"SubStep": "17.C.1", "Procedure": "Compressed a staging directory using PowerShell", "Criteria": "powershell.exe executing the ZipFile.CreateFromDirectory .NET method", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Detections": [{"DetectionNote": "A General alert detection for Data Staged was generated when the WindowsParentalControlMigration.tmp file was compressed.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3305.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3303.png"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of data compression.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13259.png"}]}, {"DetectionNote": "Telemetry showed PowerShell compressing collection via the ZipFile.CreateFromDirectory .NET method. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-17857.png"}]}]}]}, {"TechniqueId": "T1106", "TechniqueName": "Execution through API", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "4.C.10", "Procedure": "Executed API call by reflectively loading Netapi32.dll", "Criteria": "The NetUserGetGroups API function loaded into powershell.exe from Netapi32.dll", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Detections": [{"DetectionNote": "Telemetry showed the NetUserGetGroups API function loaded into PowerShell from Netapi32.dll. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13651.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13650.png"}]}]}, {"SubStep": "4.C.12", "Procedure": "Executed API call by reflectively loading Netapi32.dll", "Criteria": "The NetUserGetLocalGroups API function loaded into powershelle.exe from Netapi32.dll", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Detections": [{"DetectionNote": "Telemetry showed Netapi32.dll loaded into powershell.exe. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13651.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13652.png"}]}]}, {"SubStep": "10.B.2", "Procedure": "Executed PowerShell payload via the CreateProcessWithToken API", "Criteria": "hostui.exe executing the\nCreateProcessWithToken API", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of powershell.exe executing with the explorer.exe token via the CreateProcessWithToken API.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13233.png"}]}]}, {"SubStep": "16.B.2", "Procedure": "Executed the ConvertSidToStringSid API call by reflectively loading Advapi32.dll", "Criteria": "powershell.exe executing the ConvertSidToStringSid API function by loading Advapi32.dll", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of the execution of the ConvertSidToStringSid API.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13255.png"}]}, {"DetectionNote": "Telemetry showed PowerShell executing the ConvertSidToStringSid API function. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3390.png"}]}]}]}, {"TechniqueId": "T1069", "TechniqueName": "Permission Groups Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.9", "Procedure": "Enumerated user's domain group membership via the NetUserGetGroups API", "Criteria": "powershell.exe\u00a0executing the NetUserGetGroups\u00a0API", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Detections": [{"DetectionNote": "A MSSP detection occurred for powershell.exe executing the NetUserGetGroups API.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13212.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing the NetUserGetGroups API. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13650.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13651.png"}]}]}, {"SubStep": "4.C.11", "Procedure": "Enumerated user's local group membership via\u00a0the NetUserGetLocalGroups API", "Criteria": "powershell.exe\u00a0executing the NetUserGetLocalGroups\u00a0API", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing the NetUserGetLocalGroups API. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13651.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13652.png"}]}]}]}, {"TechniqueId": "T1050", "TechniqueName": "New Service", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "5.A.1", "Procedure": "Created a new service (javamtsup) that executes a service binary (javamtsup.exe) at system startup", "Criteria": "powershell.exe creating the Javamtsup service", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Detections": [{"DetectionNote": "Telemetry showed PowerShell created the new service javamtsup. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13653.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13656.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13666.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13654.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13655.png"}]}]}]}, {"TechniqueId": "T1120", "TechniqueName": "Peripheral Device Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "11.A.5", "Procedure": "Enumerated devices/adapters to check for presence of VirtualBox driver(s) using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_PnPEntity", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence execution of an WMI query for Win32_PnPEntity.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13236.png"}]}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_PnPEntity.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13686.png"}]}]}]}, {"TechniqueId": "T1083", "TechniqueName": "File and Directory Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.A.1", "Procedure": "Searched filesystem for document and media files using PowerShell\u00a0", "Criteria": "powershell.exe executing (Get-)ChildItem", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Detections": [{"DetectionNote": "A Technique alert detection was generated for PowerShell executing suspicious File and Directory Discovery commands. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-14305.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-14307.png"}]}, {"DetectionNote": "An MSSP detection for File and Directory Discovery \"(T1083)\" occurred containing evidence that a discovery script was using get-childitem to search the filesystem to specific file patterns.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13202.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-ChildItem. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13640.png"}]}]}, {"SubStep": "4.C.1", "Procedure": "Enumerated user's temporary directory path using PowerShell", "Criteria": "powershell.exe executing\u00a0$env:TEMP", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing $env:TEMP. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13646.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13645.png"}]}]}, {"SubStep": "9.B.2", "Procedure": "Searched filesystem for document and media files using PowerShell", "Criteria": "powershell.exe executing (Get-)ChildItem\u200b", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Detections": [{"DetectionNote": "A MSSP detection occurred for PowerShell looking for certain files in a directory. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13228.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-ChildItem. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3042.png"}]}]}, {"SubStep": "11.A.9", "Procedure": "Checked that the payload is not inside a folder path that contains \"sample\" or is the length of a hash value using PowerShell", "Criteria": "powershell.exe executing (Get-Item -Path \".\\\" -Verbose).FullName", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though events showed PowerShell executing the Get-Item cmdlet.", "DetectionType": "None", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3394.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3395.png"}]}]}, {"SubStep": "12.A.1", "Procedure": "Enumerated the System32 directory using PowerShell", "Criteria": "powershell.exe executing (gci ((gci env:windir).Value + '\\system32')", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Detections": [{"DetectionNote": "An MSSP detection for Timestomping was generated containing evidence of PowerShell enumeration of System32.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13239.png"}]}]}]}, {"TechniqueId": "T1119", "TechniqueName": "Automated Collection", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "2.A.2", "Procedure": "Scripted search of filesystem for document and media files using PowerShell\u00a0", "Criteria": "powershell.exe executing (Get-)ChildItem", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Detections": [{"DetectionNote": "An MSSP detection for Automated Collection \"(T1119)\" occurred containing evidence that a discovery script was using Get-Childitem to search the filesystem to specific file patterns.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13202.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-ChildItem. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13640.png"}]}]}, {"SubStep": "9.B.3", "Procedure": "Scripted search of filesystem for document and media files using PowerShell\u00a0", "Criteria": "powershell.exe executing (Get-)ChildItem\u200b", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Detections": [{"DetectionNote": "An MSSP detection for Automated Collection \"(T1119)\" occurred containing evidence that a discovery script was using get-childitem to search the filesystem to specific file patterns.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13228.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13228.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-ChildItem. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3041.png"}]}]}]}, {"TechniqueId": "T1018", "TechniqueName": "Remote System Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "8.A.1", "Procedure": "Enumerated remote systems using LDAP queries", "Criteria": "powershell.exe making LDAP queries over port 389 to the Domain Controller (10.0.0.4)", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Detections": [{"DetectionNote": "Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over port 389. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3000.png"}]}]}, {"SubStep": "16.A.1", "Procedure": "Enumerated the domain controller host NewYork (10.0.0.4) using LDAP queries", "Criteria": "powershell.exe making LDAP queries over port 389 via functions from System.DirectoryServices.dll", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though events showed the execution of the PowerShell Get-DomainController function.", "DetectionType": "None", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13726.png"}]}]}]}, {"TechniqueId": "T1041", "TechniqueName": "Exfiltration Over Command and Control Channel", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "2.B.1", "Procedure": "Read and downloaded ZIP (Draft.zip) over C2 channel (192.168.0.5 over TCP port 1234)", "Criteria": "The rcs.3aka3.doc process reading the file draft.zip while connected to the C2 channel", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Detections": [{"DetectionNote": "An MSSP detection for Exfiltration Over Command and Control Channel \"(T1041)\" occurred containing evidence that \"After the zip file is created, it\u2019s read by \u200bcod.3aka3.scr... [and] the timeline view shows a C2 connection from \u200bnashua \u200bto \u200b192.168.0.5,\u200b in which cod.3aka3.scr s\u200bent 319,936 Bytes.\"", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13203.png"}]}, {"DetectionNote": "Telemetry showed file read event for Draft.zip and an existing C2 channel (192.168.0.5 over port 1234). The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2651.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-2699.png"}]}]}, {"SubStep": "9.B.8", "Procedure": "Read and downloaded ZIP (working.zip on Desktop) over C2 channel (192.168.0.5 over TCP port 8443)", "Criteria": "python.exe\u00a0reading the file working.zip while connected to the C2 channel", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Detections": [{"DetectionNote": "Telemetry showed file read event for working.zip and an existing C2 channel (192.168.0.4 over port 8443). The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3057.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3058.png"}]}]}]}, {"TechniqueId": "T1081", "TechniqueName": "Credentials in Files", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "6.A.1", "Procedure": "Read the Chrome SQL database file to extract encrypted credentials", "Criteria": "accesschk.exe reading files within %APPDATALOCAL%\\Google\\chrome\\user data\\default\\", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) for \"Browser login data access by non-browser process\" was generated when accesschk.exe accessed the Chrome database file for credentials. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2943.png"}]}, {"DetectionNote": "An MSSP detection occurred for accesschk.exe reading the Chrome database file for credentials.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13214.png"}]}, {"DetectionNote": "Telemetry showed accesschk.exe reading the Chrome database file for credentials. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2942.png"}]}]}]}, {"TechniqueId": "T1097", "TechniqueName": "Pass the Ticket", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "20.B.1", "Procedure": "Created Kerberos Golden Ticket using\u00a0Invoke-Mimikatz", "Criteria": "powershell.exe executing Invoke-Mimikatz with command-line arguments to create a golden ticket", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Detections": [{"DetectionNote": "An MSSP detection was generated containing evidence of powershell.exe executing Invoke-Mimikatz (kerberos::golden) to create and inject ticket into current session.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-15752.png"}]}]}]}, {"TechniqueId": "T1136", "TechniqueName": "Create Account", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "20.B.3", "Procedure": "Added a new user to the remote host Scranton (10.0.1.4) using net.exe", "Criteria": "net.exe adding the user Toby ", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Detections": [{"DetectionNote": "A Technique alert detection called \"created account T1136\" (high severity) was generated for net.exe with the command-line arguments to add the new user Toby.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3348.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3349.png"}]}, {"DetectionNote": "An MSSP detection contained evidence of the creation of the user Toby on Scranton (10.0.1.4).", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13261.png"}]}, {"DetectionNote": "Telemetry showed wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3350.png"}]}]}]}, {"TechniqueId": "T1063", "TechniqueName": "Security Software Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.7", "Procedure": "Enumerated anti-virus software using PowerShell", "Criteria": "powershell.exe\u00a0executing\u200b Get-WmiObject ...\u200b -Class\u00a0AntiVirusProduct", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Detections": [{"DetectionNote": "A Technique alert detection (high severity) was generated for PowerShell performing suspicious Security Software Discovery.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13648.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13649.png"}]}, {"DetectionNote": "A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13212.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-WmiObject...\u200b -Class AntiVirusProduct. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2858.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-2868.png"}]}]}, {"SubStep": "4.C.8", "Procedure": "Enumerated firewall software using PowerShell", "Criteria": "powershell.exe\u00a0executing Get-WmiObject\u00a0...\u200b\u200b -Class\u00a0FireWallProduct", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Detections": [{"DetectionNote": "A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13212.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-WmiObject...\u200b -Class FireWallProduct. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2869.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-2858.png"}]}]}, {"SubStep": "12.B.1", "Procedure": "Enumerated registered AV products using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for AntiVirusProduct", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Detections": [{"DetectionNote": "A Technique alert detection (high severity) called \"Security Software Discovery\" was generated due to powershell executing a gwmi query for AntiVirusProduct.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3183.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3180.png"}]}, {"DetectionNote": "A MSSP detection occurred containing evidence of security software discovery attempts. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13240.png"}]}, {"DetectionNote": "Telemetry showed PowerShell gwmi query for AntiVirusProduct.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}]}, {"TechniqueId": "T1065", "TechniqueName": "Uncommonly Used Port", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.A.3", "Procedure": "Established C2 channel (192.168.0.5) via rcs.3aka3.doc payload over TCP port 1234", "Criteria": "Established network channel over port 1234", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Detections": [{"DetectionNote": "An MSSP detection for an Uncommonly used port \"(T1065)\" occurred containing evidence of rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13200.png"}]}, {"DetectionNote": "Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2651.png"}]}]}]}, {"TechniqueId": "T1107", "TechniqueName": "File Deletion", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "4.B.2", "Procedure": "Deleted rcs.3aka3.doc on disk using SDelete", "Criteria": "sdelete64.exe deleting the file rcs.3aka3.doc", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of sdelete64.exe deleting ?cod.3aka.scr.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13211.png"}]}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2835.png"}]}]}, {"SubStep": "4.B.3", "Procedure": "Deleted Draft.zip on disk using SDelete", "Criteria": "sdelete64.exe deleting the file draft.zip", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of sdelete64.exe deleting Draft.zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13211.png"}]}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2830.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-2831.png"}]}]}, {"SubStep": "4.B.4", "Procedure": "Deleted SysinternalsSuite.zip on disk using SDelete", "Criteria": "sdelete64.exe deleting the file SysinternalsSuite.zip", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of sdelete64.exe deleting SysinternalsSuite.zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13211.png"}]}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2829.png"}]}]}, {"SubStep": "9.C.1", "Procedure": "Deleted rar.exe on disk using SDelete", "Criteria": "sdelete64.exe deleting the file rar.exe", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Detections": [{"DetectionNote": "An MSSP detection contained evidence of the deletion of Rar.exe by SDelete64.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13230.png"}]}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3066.png"}]}]}, {"SubStep": "9.C.2", "Procedure": "Deleted working.zip (from Desktop) on disk using SDelete", "Criteria": "sdelete64.exe deleting the file \\Desktop\\working.zip", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Detections": [{"DetectionNote": "A Technique alert detection called \"file deletion T1107\"  was generated when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3086.png"}]}, {"DetectionNote": "An MSSP detection contained evidence of the deletion of Desktop\\working.zip by SDelete64.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13230.png"}]}, {"DetectionNote": "Telemetry showed file delete event for sdelete64.exe deleting Desktop\\working.zip. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3088.png"}]}]}, {"SubStep": "9.C.3", "Procedure": "Deleted working.zip (from AppData directory) on disk using SDelete", "Criteria": "sdelete64.exe deleting the file \\AppData\\Roaming\\working.zip", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Detections": [{"DetectionNote": "An MSSP detection contained evidence of the deletion of roaming\\working.zip by SDelete64.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13230.png"}]}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3085.png"}]}]}, {"SubStep": "9.C.4", "Procedure": "Deleted SDelete on disk using cmd.exe del command", "Criteria": "cmd.exe deleting the file sdelete64.exe", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Detections": [{"DetectionNote": "A Technique alert detection called \"file deletion T1107\" was generated when cmd.exe deleted sdelete.exe.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13664.png"}]}, {"DetectionNote": "An MSSP detection contained evidence of the deletion of SDelete64.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13230.png"}]}, {"DetectionNote": "Telemetry showed cmd.exe deleting sdelete64.exe and file deletion event. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3089.png"}]}]}, {"SubStep": "19.A.1", "Procedure": "Deleted Mimikatz (m.exe) on disk using SDelete", "Criteria": "File delete event for C:\\Windows\\System32\\m.exe", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.B.1", "Procedure": "Deleted exfiltrated data on disk using SDelete", "Criteria": "File delete event for C:\\Windows\\Temp\\WindowsParentalControlMigration.tmp", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.C.1", "Procedure": "Deleted staged data on disk using SDelete", "Criteria": "File delete event for C:\\Windows\\Temp\\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}]}, {"TechniqueId": "T1043", "TechniqueName": "Commonly Used Port", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "3.B.3", "Procedure": "Established C2 channel (192.168.0.5) via PowerShell payload over TCP port 443", "Criteria": "Established network channel over port 443", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Detections": [{"DetectionNote": "An MSSP detection for Commonly Used Port was\ngenerated containing evidence monkey.png performed C&C over port 443 to IP address 192.168.0.5.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13197.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe connecting to 192.168.0.5 on TCP port 443. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2745.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-2757.png"}]}]}, {"SubStep": "11.A.13", "Procedure": "Established C2 channel (192.168.0.4) via PowerShell payload over port 443", "Criteria": "Established network channel over port 443", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Detections": [{"DetectionNote": "An MSSP detection contained evidence of PowerShell establishing C2 with 192.168.0.4 over TCP port 443.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13238.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3142.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3140.png"}]}]}]}, {"TechniqueId": "T1059", "TechniqueName": "Command-Line Interface", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.B.1", "Procedure": "Spawned interactive cmd.exe", "Criteria": "cmd.exe\u00a0spawning from the rcs.3aka3.doc\u200b process", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Detections": [{"DetectionNote": "A Technique alert detection was generated for a command line interface spawned from a process identified as malware with an active network connection.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-14271.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-14274.png"}]}, {"DetectionNote": "An MSSP detection for Command Line Interfaces \"(T1059)\" occurred containing evidence of cmd.exe spawning from rcs.3aka3.doc\u200b.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13201.png"}]}, {"DetectionNote": "Telemetry showed rcs.3aka3.doc spawning from cmd.exe. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2666.png"}]}]}]}, {"TechniqueId": "T1028", "TechniqueName": "Windows Remote Management", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "8.A.2", "Procedure": "Established WinRM connection to remote host Scranton (10.0.1.4)", "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}, {"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Detections": [{"DetectionNote": "An MSSP detection occurred for the WinRM connection to remote host Scranton (10.0.1.4) over port 5985.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13221.png"}]}, {"DetectionNote": "Telemetry showed a connection to Scranton (10.0.1.4) over port 5985. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from a temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3001.png"}]}]}, {"SubStep": "16.C.1", "Procedure": "Established a WinRM connection to the domain controller host NewYork (10.0.0.4) ", "Criteria": "Network connection to NewYork (10.0.0.4) over port 5985", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}, {"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Detections": [{"DetectionNote": "An MSSP detection for Windows Remote Management occurred containing evidence of the connection to remote host NewYork (10.0.0.4) over port 5985.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13256.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3249.png"}]}]}, {"SubStep": "20.B.2", "Procedure": "Established a WinRM connection to the remote host Scranton (10.0.1.4) using the Golden Ticket as credentials", "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}, {"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Detections": [{"DetectionNote": "An MSSP detection contained evidence of a WinRM session to remote host SchruteFarms (10.0.1.7).", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13261.png"}]}, {"DetectionNote": "Telemetry showed PowerShell with an open network connection to the remote host Scranton (10.0.1.4) over port 5985. Telemetry also showed the WinRM process on Scranton (10.0.1.4) exchanging data with Utica (10.0.1.5).", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13732.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3351.png"}]}]}]}, {"TechniqueId": "T1114", "TechniqueName": "Email Collection", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "17.A.1", "Procedure": "Dumped messages from the local Outlook inbox using PowerShell", "Criteria": "outlook.exe spawning from svchost.exe or powershell.exe", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Detections": [{"DetectionNote": "Telemetry showed outlook.exe spawning from powershell.exe, which is indicative of programmatic access to Outlook emails. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13727.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3291.png"}]}]}]}, {"TechniqueId": "T1096", "TechniqueName": "NTFS File Attributes", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "11.A.2", "Procedure": "Executed an alternate data stream (ADS) using PowerShell", "Criteria": "powershell.exe executing the schemas ADS via Get-Content and IEX", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Detections": [{"DetectionNote": "An MSSP detection contained evidence of PowerShell executing schemas ADS via Get-Content and IEX.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13234.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3126.png"}]}]}]}, {"TechniqueId": "T1035", "TechniqueName": "Service Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "8.C.3", "Procedure": "Executed python.exe using PSExec", "Criteria": "python.exe spawned by PSEXESVC.exe", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Detections": [{"DetectionNote": "A Technique alert detection called \"Service Execution Start service T1050\" was generated due to psexec.exe spawning python.exe.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3023.png"}]}, {"DetectionNote": "A General alert detection (low severity) was generated due to an unsigned process running from a temporary directory.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3025.png"}]}, {"DetectionNote": "A General alert detection (red indicator) for \"Lateral Movement\" was generated due to PSEXE64.exe execution with plain-text credentials from Nashua as the user Pam. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3016.png"}]}, {"DetectionNote": "A General alert detection was generated for PSEXESVC.exe being copied to a remote host. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3016.png"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of python.exe being spawned by PSEXESVC.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13225.png"}]}, {"DetectionNote": "Telemetry showed python.exe spawned by PSEXESVC.exe and originated from a RPC call originating on the remote host Nashua (10.0.1.6).", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13658.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3025.png"}]}]}, {"SubStep": "10.A.1", "Procedure": "Executed persistent service (javamtsup) on system startup", "Criteria": "javamtsup.exe spawning from services.exe", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1102", "TechniqueName": "Web Service", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "18.A.1", "Procedure": "Mapped a network drive to an online OneDrive account using PowerShell", "Criteria": "net.exe with command-line arguments then making a network connection to a public IP over port 443", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Detections": [{"DetectionNote": "A General alert detection (red indicator) called \"Non-browser access to a web service\" was generated when net.exe made an HTTPS connection to a OneDrive URL. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "DetectionType": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3318.png"}]}, {"DetectionNote": "A General alert detection (red indicator) called \"WebDAV drive mount from net.exe over HTTPS\" was generated when net.exe made an HTTPS connection. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "DetectionType": "General", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3318.png"}]}, {"DetectionNote": "An MSSP detection contained evidence of net.exe connection to OneDrive over TCP port 443.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13260.png"}]}, {"DetectionNote": "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3318.png"}]}]}]}, {"TechniqueId": "T1105", "TechniqueName": "Remote File Copy", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}, {"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "3.A.1", "Procedure": "Dropped stage 2 payload (monkey.png) to disk", "Criteria": "The rcs.3aka3.doc process creating the file monkey.png", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Detections": [{"DetectionNote": "An MSSP detection for Remote File Copy \"(T1105)\" occurred containing evidence that cod.3aka3.scr\u200b has downloaded and wrote a file named\u200b monkey.png\u200b to \u200bC:\\Users\\pam\\Downloads.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13195.png"}]}, {"DetectionNote": "Telemetry showed rcs.3aka3.doc creating monkey.png. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-17855.png"}]}]}, {"SubStep": "4.A.1", "Procedure": "Dropped additional tools (SysinternalsSuite.zip) to disk over C2 channel (192.168.0.5)", "Criteria": "powershell.exe creating the file SysinternalsSuite.zip", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Detections": [{"DetectionNote": "A General alert detection was generated for the creation of a file identified as compressed. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-14322.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-14323.png"}]}, {"DetectionNote": "An MSSP detection for Remote File Copy \"(T1105)\" was received. The alert stated the privileged Powershell.exe created a zip file named SysInternalsSuite.zip in the Downloads folder.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13205.png"}]}, {"DetectionNote": "Telemetry showed the file write of the ZIP by PowerShell.  The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2784.png"}]}]}, {"SubStep": "8.B.1", "Procedure": "Copied python.exe payload from a WebDAV share (192.168.0.4) to remote host Scranton (10.0.1.4)", "Criteria": "The file python.exe created on Scranton (10.0.1.4)", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) called \u201cExecutable copied to remote host via $ share\u201d was generated for python.exe being copied from Nashua to Scranton. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3008.png"}]}, {"DetectionNote": "A Technique alert detection (red indicator) called \"Remote File Copy\" was generated for python.exe being copied Scranton (10.0.1.4).", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3010.png"}]}, {"DetectionNote": "An MSSP detection contained evidence of remote file copy of python.exe to Scranton (10.0.1.4).", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13222.png"}]}, {"DetectionNote": "Telemetry showed the file create event of python.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"]}]}, {"SubStep": "9.A.1", "Procedure": "Dropped rar.exe to disk on remote host Scranton (10.0.1.4)\u00a0", "Criteria": "python.exe creating the file rar.exe", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Detections": [{"DetectionNote": "A General alert detection (red indicator) was generated for python.exe writing rar.exe to C:\\Windows\\Temp. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "DetectionType": "General", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3032.png"}]}, {"DetectionNote": "An MSSP detection occurred for python.exe creating rar.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13226.png"}]}, {"DetectionNote": "Telemetry showed a file write event for python.exe creating rar.exe from a named pipe. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13659.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13661.png"}]}]}, {"SubStep": "9.A.2", "Procedure": "Dropped sdelete.exe to disk on remote host Scranton (10.0.1.4)\u00a0", "Criteria": "python.exe creating the file sdelete64.exe", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Detections": [{"DetectionNote": "A MSSP detection occurred for python.exe creating sdelete64.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13226.png"}]}, {"DetectionNote": "Telemetry showed File Write/Create events for python.exe creating sdelete64.exe. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3036.png"}]}]}, {"SubStep": "14.B.3", "Procedure": "Downloaded and dropped Mimikatz (m.exe) to disk", "Criteria": "powershell.exe downloading and/or the file write of m.exe", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) was generated for an executable created by a Windows scripting engine. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13720.png"}]}, {"DetectionNote": "An MSSP detection contained evidence of the creation of m.exe in the System32 folder.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13245.png"}]}, {"DetectionNote": "Telemetry showed the PowerShell command to download m.exe as well as the file create event for m.exe into the System32 folder. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13715.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3189.png"}], "Footnotes": ["According to the vendor, payload execution would have been prevented as Wildfire labeled the payload as malicious/malware."]}]}, {"SubStep": "16.D.1", "Procedure": "Dropped Mimikatz (m.exe) to disk on the domain controller host NewYork (10.0.0.4) over a WinRM connection", "Criteria": "File write of m.exe by the WinRM process (wsmprovhost.exe)", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Detections": [{"DetectionNote": "An MSSP detection contained evidence of the write of m.exe to the System32 directory by wsmprovhost.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13257.png"}]}, {"DetectionNote": "Telemetry showed the creation of m.exe in the System32 directory by wsmprovhost.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3280.png"}]}]}]}, {"TechniqueId": "T1016", "TechniqueName": "System Network Configuration Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.4", "Procedure": "Enumerated the current domain name using PowerShell", "Criteria": "powershell.exe executing $env:USERDOMAIN", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing $env:USERDOMAIN. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13645.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13646.png"}]}]}, {"SubStep": "11.A.7", "Procedure": "Checked that the computer is joined to a domain using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Detections": [{"DetectionNote": "A Tactic alert detection called WMI virtualization sandbox discovery was generated for a PowerShell gwmi query for Win32_ComputerSystem.", "DetectionType": "Tactic", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3132.png"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of execution of an WMI query for Win32_ComputerSystem.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13236.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe gwmi query for Win32_ComputerSystem.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13687.png"}]}]}, {"SubStep": "13.B.1", "Procedure": "Enumerated the domain name using the NetWkstaGetInfo API", "Criteria": "powershell.exe executing the NetWkstaGetInfo API", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Detections": [{"DetectionNote": "Telemetry showed PowerShell calling the NetWkstaGetInfo API. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13689.png"}]}]}]}, {"TechniqueId": "T1060", "TechniqueName": "Registry Run Keys / Startup Folder", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "5.B.1", "Procedure": "Created a LNK file (hostui.lnk) in the Startup folder that executes on login", "Criteria": "powershell.exe creating the file hostui.lnk in the Startup folder", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) called \"registry run key or file in start up folder created - T1060\" was generated due to powershell.exe creating the hostui.lnk file. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2935.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-2924.png"}]}, {"DetectionNote": "An MSSP detection occurred for the creation of the hostui.lnk file in the Startup folder.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13199.png"}]}, {"DetectionNote": "Telemetry showed a file create event for hostui.lnk in the Startup folder. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2933.png"}]}]}, {"SubStep": "10.B.1", "Procedure": "Executed LNK payload (hostui.lnk) in Startup Folder on user login", "Criteria": "Evidence that the file hostui.lnk (which executes hostui.bat as a byproduct) was executed from the Startup Folder", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Detections": [{"DetectionNote": "An MSSP detection occurred for hostui.lnk executing from Startup Folder. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13232.png"}]}]}, {"SubStep": "11.A.11", "Procedure": "Established Registry Run key persistence using PowerShell", "Criteria": "Addition of the Webcache subkey in HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) called \"commonly abused process creates a new autostart Registry key\" was generated for powershell.exe adding Run key persistence into the Registry.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3163.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3164.png"}]}, {"DetectionNote": "A Technique alert detection (red indicator) called \"New entry added to startup related Registry keys by signed binary\" was generated for powershell.exe adding Run key persistence into the Registry.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3164.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3163.png"}]}, {"DetectionNote": "An MSSP detection contained evidence of the Webcache subkey added to the Registry to establish persistence.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13237.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe adding Run key persistence into the Registry.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}]}, {"TechniqueId": "T1122", "TechniqueName": "Component Object Model Hijacking", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "3.B.1", "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "Criteria": "Addition of\u00a0the DelegateExecute\u00a0\u200bsubkey in\u00a0\u200bHKCU\\Software\\Classes\\Folder\\shell\\open\\\u200b\u200bcommand\u200b\u200b", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Detections": [{"DetectionNote": "A General alert detection was generated identifying the Registry modification as a malware behavior threat. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13642.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13643.png"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of addition of DelegateExecute \u200bsubkey.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13197.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13196.png"}]}, {"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry Value. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2767.png"}]}]}, {"SubStep": "14.A.1", "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "Criteria": "Addition of the DelegateExecute subkey in HKCU\\Software\\Classes\\Folder\\shell\\open\\command", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of the addition of DelegateExecute subkey.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13244.png"}]}, {"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry value. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3186.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3187.png"}]}]}]}, {"TechniqueId": "T1022", "TechniqueName": "Data Encrypted", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "7.B.3", "Procedure": "Encrypted data from the user's Downloads directory using PowerShell", "Criteria": "powershell.exe executing Compress-7Zip with the password argument used for encryption", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "9.B.6", "Procedure": "Encrypted staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "Criteria": "powershell.exe executing rar.exe with the -a parameter for a password to use for encryption", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Detections": [{"DetectionNote": "An MSSP detection contained evidence of execution of rar.exe with command line arguments to encrypt working.zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13229.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3050.png"}]}]}]}, {"TechniqueId": "T1078", "TechniqueName": "Valid Accounts", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}, {"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "8.C.1", "Procedure": "Logged on to remote host Scranton (10.0.1.4) using\u00a0valid credentials for user Pam", "Criteria": "Successful logon as user Pam on\u00a0Scranton (10.0.1.4) ", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "16.C.2", "Procedure": "Logged on to the domain controller host NewYork (10.0.0.4) using\u00a0valid credentials for user MScott\u00a0", "Criteria": "Successful logon as user MScott on NewYork (10.0.0.4) ", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Detections": [{"DetectionNote": "Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3302.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3300.png"}]}]}]}, {"TechniqueId": "T1036", "TechniqueName": "Masquerading", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "1.A.2", "Procedure": "Used unicode right-to-left override (RTLO) character to obfuscate file name rcs.3aka3.doc (originally cod.3aka.scr)", "Criteria": "Evidence of the right-to-left override character (U+202E) in the rcs.3aka.doc process \u200bOR the original filename (cod.3aka.scr)", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Detections": [{"DetectionNote": "A Technique alert detection (low severity) was generated for rcs.3aka3.doc, identified as a screensaver process, executing from users or temporary folder.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2649.png"}]}, {"DetectionNote": "An MSSP detection for Masquerading \"(T1036\u200b)\" occurred containing evidence of of the RLO character to obfuscate payload file name\u200b.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13200.png"}]}]}, {"SubStep": "6.A.3", "Procedure": "Masqueraded a Chrome password dump tool as accesscheck.exe, a legitimate Sysinternals tool", "Criteria": "Evidence that accesschk.exe is not the legitimate Sysinternals tool", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) called \"Windows process masquerading by an unsigned process\" was generated when accesschk.exe was identified as an unsigned executable and the hash did not match the valid accesschk.exe hash. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2944.png"}]}, {"DetectionNote": "An MSSP detection occurred indicating that accesschk.exe is not the legitimate Sysinternals tool.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13214.png"}]}, {"DetectionNote": "Telemetry showed accesschk.exe is not a signed Microsoft binary with hash values provided. This can be used to verify it is not the legitimate Sysinternals tool. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2942.png"}]}]}]}, {"TechniqueId": "T1074", "TechniqueName": "Data Staged", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "2.A.5", "Procedure": "Staged files for exfiltration into ZIP (Draft.zip) using PowerShell", "Criteria": "powershell.exe creating the file draft.zip", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Detections": [{"DetectionNote": "An MSSP detection for Data Staged \"(T1074)\" occurred containing evidence that there was a compressed zip file created named Draft.zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13202.png"}]}, {"DetectionNote": "Telemetry showed the creation of Draft.Zip. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2678.png"}]}]}, {"SubStep": "9.B.5", "Procedure": "Staged files for exfiltration into ZIP (working.zip in AppData directory) using PowerShell", "Criteria": "powershell.exe creating the file working.zip", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Detections": [{"DetectionNote": "A Tactic alert detection called \"Collection\" was generated due to working.zip file creation in %APPDATA%\\roaming folder. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "DetectionType": "Tactic", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3049.png"}]}, {"DetectionNote": "An MSSP detection contained evidence of the creation of working.zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13228.png"}]}, {"DetectionNote": "Telemetry showed the file create of working.zip. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13663.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3052.png"}]}]}, {"SubStep": "17.B.2", "Procedure": "Staged collected file into directory using PowerShell", "Criteria": "powershell.exe creating the file \\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Detections": [{"DetectionNote": "Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3297.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3298.png"}]}]}]}, {"TechniqueId": "T1086", "TechniqueName": "PowerShell", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.B.2", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe\u00a0spawning from cmd.exe", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Detections": [{"DetectionNote": "An MSSP detection for Powershell \"(T1086)\" occurred containing evidence of powershell.exe spawning from cmd.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13201.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe spawning from cmd.exe. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2666.png"}]}]}, {"SubStep": "4.A.2", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe spawning from powershell.exe", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of a new interactive session of PowerShell being created.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13205.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13208.png"}]}, {"DetectionNote": "Telemetry showed a new powershell.exe spawning from powershell.exe. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2786.png"}]}]}, {"SubStep": "9.B.1", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe\u200b spawning from python.exe", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Detections": [{"DetectionNote": "An MSSP detection contained evidence of python spawning powershell.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13228.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13228.png"}]}, {"DetectionNote": "Telemetry showed python.exe executing powershell.exe. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3041.png"}]}]}, {"SubStep": "11.A.12", "Procedure": "Executed PowerShell stager payload", "Criteria": "powershell.exe spawning from from the schemas ADS (powershell.exe)", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Detections": [{"DetectionNote": "An MSSP detection contained evidence of PowerShell executing from schemas ADS.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13238.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe spawned from a PowerShell stager.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3142.png"}]}]}, {"SubStep": "20.A.3", "Procedure": "Executed PowerShell payload from WMI event subscription persistence", "Criteria": "SYSTEM-level powershell.exe spawned from the powershell.exe", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Detections": [{"DetectionNote": "An MSSP detection was generated containing evidence of powershell.exe executing another powershell.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-15752.png"}]}, {"DetectionNote": "Telemetry showed a SYSTEM-level PowerShell spawning from a svchost.exe associated with the WMI service.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13731.png"}]}]}]}, {"TechniqueId": "T1045", "TechniqueName": "Software Packing", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "8.B.2", "Procedure": "python.exe payload was packed with UPX", "Criteria": "Evidence that the file python.exe is packed", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) for \"Software Packing - T1045\" was generated for the file creation event for python.exe. ", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3013.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3012.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3014.png"}]}, {"DetectionNote": "An MSSP detection was generated containing evidence of observed UPX packing on a Python payload.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13223.png"}]}]}]}, {"TechniqueId": "T1082", "TechniqueName": "System Information Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.3", "Procedure": "Enumerated the computer hostname using PowerShell", "Criteria": "powershell.exe executing $env:COMPUTERNAME", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing $env:COMPUTERNAME. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13646.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13645.png"}]}]}, {"SubStep": "4.C.6", "Procedure": "Enumerated the OS version using PowerShell", "Criteria": "powershell.exe executing\u200b Gwmi Win32_OperatingSystem", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Detections": [{"DetectionNote": "A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13212.png"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing Gwmi Win32_OperatingSystem. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2870.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-2838.png"}]}]}, {"SubStep": "11.A.4", "Procedure": "Enumerated computer manufacturer, model, and version information using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject gwmi queries for Win32_BIOS and Win32_ComputerSystem", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Detections": [{"DetectionNote": "A Technique alert detection called \"System Information Discovery\" was generated for a PowerShell gwmi query for Win32_BIOS.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3129.png"}]}, {"DetectionNote": "A Tactic alert detection called WMI virtualization sandbox discovery was generated for a PowerShell gwmi query for Win32_ComputerSystem.", "DetectionType": "Tactic", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3132.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3132.png"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of execution of WMI queries for Win32_BIOS and Win32_ComputerSystem.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13236.png"}]}, {"DetectionNote": "Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13687.png"}]}]}, {"SubStep": "13.A.1", "Procedure": "Enumerated the computer name using the GetComputerNameEx API", "Criteria": "powershell.exe executing the GetComputerNameEx API", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Detections": [{"DetectionNote": "Telemetry showed PowerShell calling the GetComputerNameEx API. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13689.png"}]}]}]}, {"TechniqueId": "T1055", "TechniqueName": "Process Injection", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "19.A.2", "Procedure": "Reflectively injected SDelete binary into PowerShell", "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.B.2", "Procedure": "Reflectively injected SDelete binary into PowerShell", "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.C.2", "Procedure": "Reflectively injected SDelete binary into PowerShell", "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}]}, {"TechniqueId": "T1056", "TechniqueName": "Input Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "7.A.3", "Procedure": "Captured user keystrokes using the GetAsyncKeyState API", "Criteria": "powershell.exe executing the GetAsyncKeyState API", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Detections": [{"DetectionNote": "A Technique alert detection called \"Input Capture\" was generated due to powershell.exe making the GetAsyncKeyState API call. ", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-2961.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-2963.png"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of key logging.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13218.png"}]}, {"DetectionNote": "Telemetry showed PowerShell calling the GetAsyncKeyState API.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}]}, {"TechniqueId": "T1012", "TechniqueName": "Query Registry", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "12.C.1", "Procedure": "Enumerated installed software via the Registry (Wow6432 Uninstall key) using PowerShell", "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Detections": [{"DetectionNote": "A Technique alert detection was generated for PowerShell querying the registry. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-14500.png"}]}, {"DetectionNote": "A Tactic alert detection (high severity) called for Discovery was generated when the software function was executed.", "DetectionType": "Tactic", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3183.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3180.png"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of the registry query for installed software.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13241.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13242.png"}]}, {"DetectionNote": "Telemetry showed script block with registry query for installed software.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"SubStep": "12.C.2", "Procedure": "Enumerated installed software via the Registry (Uninstall key) using PowerShell", "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Detections": [{"DetectionNote": "A Technique alert detection was generated for PowerShell querying the registry. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-14500.png"}]}, {"DetectionNote": "A Tactic alert detection (high severity) for Discovery was generated when the software function was executed.", "DetectionType": "Tactic", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-3180.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-3183.png"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of the registry query for installed software.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Palo Alto Networks-APT29-13241.png"}, {"ScreenshotName": "Palo Alto Networks-APT29-13242.png"}]}, {"DetectionNote": "Telemetry showed scriptblock with registry query for installed software.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}]}]}