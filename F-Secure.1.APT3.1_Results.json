{"PublicRelease": "\u00a92019 The MITRE Corporation. ALL RIGHTS RESERVED. Approved for Public Release; Distribution Unlimited. Public Release Case Number 19-00646-3", "T1204": {"TechniqueName": "User Execution", "TacticGroup": "Execution", "PrimaryEnabling": "Primary", "Steps": {"1.A.1": {"Procedure": "Legitimate user Debbie clicked and executed malicious self-extracting archive (Resume Viewer.exe) on 10.0.1.6 (Nimda)", "DetectionCategories": [{"General Behavior": "A General Behavior alert was generated for the execution of a rare file (Resume Viewer.exe). [CC1] [CC4] "}, {" Telemetry": " Telemetry showed the execution of Resume Viewer.exe as a process.\u00a0"}], "Screenshots": {"CC-1.A.1-4.png": "Telemetry showing the execution of Resume Viewer.exe", "": ""}}}}, "T1064": {"TechniqueName": "Scripting", "TacticGroup": "Defense Evasion, Execution", "PrimaryEnabling": "Primary", "Steps": {"1.A.1": {"Procedure": "Previously executed self-extracting archive (Resume Viewer.exe) launched an embedded batch file (pdfhelper.cmd)", "DetectionCategories": [{"General Behavior ": "A General Behavior alert was generated showing that a spawned process (cmd.exe running pdfhelper.cmd) has been tagged for monitoring because its parent process has a detection (Resume Viewer.exe). [CC4] "}, {" Telemetry": " Telemetry showed pdfhelper.cmd was executed by cmd.exe.\u00a0"}], "Screenshots": {"CC-1.A.1-4.png": "Telemetry showing the execution of pdfhelper.cmd", "": ""}}, "11.A.1": {"Procedure": "Legitimate user Bob clicked and executed malicious VBScript (autoupdate.vbs) on 10.0.1.5 (CodeRed)", "DetectionCategories": [{"Telemetry": "Telemetry showed wscript.exe executing autoupdate.vbs and subsequently powershell.exe."}, {" Enrichment ": " The capability enriched wscript.exe executing powershell.exe with a tag indicating that wscript executed code."}, {" Specific Behavior": " A Specific Behavior alert was generated for PowerShell executing a long, encoded command."}], "Screenshots": {"CC-11.A.1-3.png": "Telemetry showing wscript.exe executing autoupdate.vbs and subsequently powershell.exe", "CC-11.A.1-1.png": "Enrichment of wscript.exe executing powershell.exe with a tag indicating that wscript executed code", "CC-11.A.1-5.png": "Specific Behavior alert for PowerShell executing a long, encoded command", "": ""}}, "12.E.1": {"Procedure": "Empire: Built-in WinEnum module executed to programmatically execute a series of enumeration techniques", "DetectionCategories": [{"Telemetry": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function."}], "Screenshots": {"CC-12.E.1-2.png": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function", "": ""}}}}, "T1085": {"TechniqueName": "Rundll32", "TacticGroup": "Execution", "PrimaryEnabling": "Primary", "Steps": {"1.A.1": {"Procedure": "Previously executed batch file (pdfhelper.cmd) launched a DLL payload (update.dat) using Rundll32", "DetectionCategories": [{"General Behavior": "A General Behavior alert was generated for an unusual call to rundll32.exe. [CC4]"}, {" Specific Behavior ": " A Specific Behavior alert was generated for rundll32.exe executing in a way typical for rundll32 injections. [CC4] "}, {" Telemetry": " Telemetry showed rundll32.exe executing update.dat.\u00a0"}], "Screenshots": {"CC-1.A.1-4.png": "Telemetry showing rundll32.exe executing update.dat", "": ""}}}}, "T1060": {"TechniqueName": "Registry Run Keys / Startup Folder", "TacticGroup": "Persistence", "PrimaryEnabling": "Primary", "Steps": {"1.B.1": {"Procedure": "Previously executed batch file (pdfhelper.cmd) moved a separate batch file (autoupdate.bat) to the Startup folder", "DetectionCategories": [{"Telemetry": "Telemetry showed cmd.exe executing autoupdate.bat from within the Startup folder."}], "Screenshots": {"CC-1.B.1-T1060-new.png": "Telemetry showing the autoupdate.bat within the Startup folder", "": ""}}, "10.A.1": {"Procedure": "Batch file (autoupdate.bat) previously written to Startup folder executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (update.dat) using Rundll32", "DetectionCategories": [{"Specific Behavior ": "A Specific Behavior alert was generated for a batch file automatically being started from the Startup folder. "}, {" Telemetry": " Telemetry showed cmd.exe executing autoupdate.bat from the Startup folder."}], "Screenshots": {"CC-10.A.1-1.png": "Specific Behavior alert for a batch file automatically being started from the Startup folder.", "CC-10.A.1-2.png": "Telemetry showing cmd.exe executing autoupdate.bat from the Startup folder", "": ""}}}}, "T1043": {"TechniqueName": "Commonly Used Port", "TacticGroup": "Command and Control", "PrimaryEnabling": "Primary", "Steps": {"1.C.1": {"Procedure": "Cobalt Strike: C2 channel established using port 53", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "6.B.1": {"Procedure": "Cobalt Strike: C2 channel modified to use port 80", "DetectionCategories": [{"Telemetry": "Telemetry showed network connections over port 80 to 192.168.0.4 (C2 server) initiated from rundll32.exe."}], "Screenshots": {"CC-6.B.1-T1043-new.png": "Telemetry showing network connections over port 80 to 192.168.0.4 (C2 server)", "": ""}}, "11.B.1": {"Procedure": "Empire: C2 channel established using port 443", "DetectionCategories": [{"Telemetry": "Telemetry showed a network connection over port 443 to www.freegoogleadsenseinfo.com (C2 domain)."}], "Screenshots": {"CC-11.A.1-4.png": "Telemetry showing a network connection over TCP port 443 to www.freegoogleadsenseinfo.com (C2 domain)", "": ""}}, "14.A.1": {"Procedure": "Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over port 8080", "DetectionCategories": [{"Telemetry": "Telemetry showed powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass."}], "Screenshots": {"CC-14.A.1-2.png": "Telemetry showing powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass", "": ""}}}}, "T1071": {"TechniqueName": "Standard Application Layer Protocol", "TacticGroup": "Command and Control", "PrimaryEnabling": "Primary", "Steps": {"1.C.1": {"Procedure": "Cobalt Strike: C2 channel established using DNS traffic to freegoogleadsenseinfo.com", "DetectionCategories": [{"Telemetry": "Telemetry showed a trace of DNS queries being made by rundll32.exe to freegoogleadsenseinfo.com (C2 domain)."}], "Screenshots": {"CC-1.C.1-T1071-new.png": "Telemetry showing rundll32 making DNS queries", "": ""}}, "6.B.1": {"Procedure": "Cobalt Strike: C2 channel modified to use HTTP traffic to freegoogleadsenseinfo.com", "DetectionCategories": [{"Telemetry": "Telemetry showed a trace of HTTP connections being made by rundll32.exe to freegoogleadsenseinfo.com (C2 domain)."}], "Screenshots": {"CC-6.B.1-2.png": "Telemetry showing rundll32 making HTTP connections", "": ""}}, "11.B.1": {"Procedure": "Empire: C2 channel established using HTTPS traffic to freegoogleadsenseinfo.com", "DetectionCategories": [{"Telemetry": "Telemetry showed powershell.exe making a connection over port 443 to freegoogleadsenseinfo.com (C2 domain). [CC2]"}], "Screenshots": {"CC-11.B.1-T1071-new.png": "Telemetry showing a network connection over TCP port 443 to www.freegoogleadsenseinfo.com (C2 domain)", "CC-11.A.1-5.png": "An alert for PowerShell downloading a significant amount of data using HTTP(S) (does not count as a detection since it was based on port)", "": ""}}, "14.A.1": {"Procedure": "Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over HTTP", "DetectionCategories": [{"Telemetry": "Telemetry showed powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass."}], "Screenshots": {"CC-14.A.1-2.png": "Telemetry showing powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass", "": ""}}}}, "T1132": {"TechniqueName": "Data Encoding", "TacticGroup": "Command and Control", "PrimaryEnabling": "Primary", "Steps": {"1.C.1": {"Procedure": "Cobalt Strike: C2 channel established using both NetBIOS and base64 encoding", "DetectionCategories": [{"Telemetry": "Telemetry showed a trace of encoded DNS queries being made by rundll32.exe to freegoogleadsenseinfo.com (C2 domain)."}], "Screenshots": {"CC-1.C.1-T1071-new.png": "Telemetry showing rundll32 making encoded DNS queries", "": ""}}}}, "T1059": {"TechniqueName": "Command-Line Interface", "TacticGroup": "Execution", "PrimaryEnabling": "Enabling", "Steps": {"2.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.A.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.C.2 ": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.D.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.D.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.E.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.E.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.F.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.F.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.F.3": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.G.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.G.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.H.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "4.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "4.A.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "4.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "4.C.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "6.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "7.C.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "8.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "8.A.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "16.F.1": {"Procedure": "Empire: Built-in runas module executed to launch malicious VBScript (autoupdate.vbs) as user Kmitnick\u00a0", "DetectionCategories": [{"Telemetry": "Telemetry showed cmd.exe executing autoupdate.vbs through wscript.exe, and the associated user context change between user Bob and user Kmitnick."}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (cmd.exe) has been tagged for monitoring because its parent process has a detection (powershell.exe)."}], "Screenshots": {"CC-16.F.1-1.png": "Telemetry showing cmd.exe executing autoupdate.vbs through wscript.exe, and the associated user context change between user Bob and user Kmitnick", "CC-20.A.1-4.png": "General Behavior alert was generated showing that a spawned process (cmd.exe) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "": ""}}}}, "T1016": {"TechniqueName": "System Network Configuration Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"2.A.1": {"Procedure": "Cobalt Strike: 'ipconfig /all' via cmd", "DetectionCategories": [{"General Behavior ": "A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing ipconfig) which was identified as extremely rare and suspicious. "}, {" Enrichment": " The capability enriched ipconfig.exe with a tag identifying the command as enumeration."}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (cmd.exe running ipconfig) has been tagged for monitoring because its parent process has a detection (rundll32.exe)."}], "Screenshots": {"CC-2.A.1-1.png": "General Behavior alert for rundll32.exe launching cmd.exe (executing ipconfig) ", "CC-2.A.1-2.png": "Enrichment of ipconfig.exe with a tag identifying the command as enumeration", "CC-2.A.1-99.png": "General Behavior alert showing that a spawned process (cmd.exe running ipconfig) has been tagged for monitoring because its parent process has a detection (rundll32.exe)", "": ""}}, "2.A.2": {"Procedure": "Cobalt Strike: 'arp -a' via cmd", "DetectionCategories": [{"Enrichment": "The capability enriched arp.exe indicating its usage can be a sign of reconnaissance."}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (cmd.exe running arp) has been tagged for monitoring because its parent process has a detection (cmd.exe)."}], "Screenshots": {"CC-2.A.2-2.png": "Enrichment of arp.exe indicating its usage can be a sign of reconnaissance", "CC-2.A.2-99.png": "General Behavior alert showing that a spawned process (cmd.exe running arp) has been tagged for monitoring because its parent process has a detection (cmd.exe)", "": ""}}, "4.B.1": {"Procedure": "Cobalt Strike: 'netsh advfirewall show allprofiles' via cmd", "DetectionCategories": [{"Telemetry": "Telemetry showed cmd.exe executing netsh.exe with command-line arguments."}], "Screenshots": {"CC-4.B.1-2.png": "Telemetry showing netsh.exe with command-line arguments", "": ""}}, "12.A.1": {"Procedure": "Empire: 'route print' via PowerShell", "DetectionCategories": [{"Enrichment": "The capability enriched route.exe indicating that it could be used to print the routing table as part of reconnaissance. "}, {" Telemetry": " Telemetry showed powershell.exe executing route.exe with command-line arguments. "}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (route) has been tagged for monitoring because its parent process has a detection (powershell.exe)."}], "Screenshots": {"CC-12.A.1-1.png": "Enrichment of route.exe indicating that it could be used to print the routing table as part of reconnaissance", "CC-12.A.1-2.png": "Telemetry showing route.exe with command-line arguments", "CC-11.B.1-1.png": "General Behavior alert showing that a spawned process (route) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "": ""}}, "12.A.2": {"Procedure": "Empire: 'ipconfig /all' via PowerShell", "DetectionCategories": [{"Enrichment": "The capability identified powershell.exe executing ipconfig.exe with a tag identifying the command as enumeration."}, {" Telemetry": " Telemetry showed ipconfig.exe with command-line arguments. "}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (ipconfig) has been tagged for monitoring because its parent process has a detection (powershell.exe)."}], "Screenshots": {"CC-12.A.2-4.png": "Enrichment of powershell.exe executing ipconfig.exe with a tag identifying the command as enumeration", "CC-12.A.2-3.png": "Telemetry showing ipconfig.exe with command line arguments", "CC-11.B.1-1.png": "General Behavior alert showing that a spawned process (ipconfig) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "": ""}}, "12.E.1.11": {"Procedure": "Empire: WinEnum module included enumeration of network adapters", "DetectionCategories": [{"Telemetry": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of network adapters."}, {" Enrichment": " The capability enriched powershell.exe making a WMI query with a tag identifying the command as WMI enumerating adapters."}], "Screenshots": {"CC-12.E.1-2.png": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function", "CC-12.E.1-3.png": "Enrichment of powershell.exe making a WMI query with a tag identifying the command as WMI enumerating adapters", "": ""}}}}, "T1033": {"TechniqueName": "System Owner/User Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"2.B.1": {"Procedure": "Cobalt Strike: 'echo' via cmd to enumerate specific environment variables", "DetectionCategories": [{"General Behavior": "A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing the echo command) which was identified as extremely rare and suspicious."}, {" Telemetry": " Telemetry showed cmd.exe executing the echo command."}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (cmd.exe running echo) has been tagged for monitoring because its parent process has a detection (rundll32.exe)."}], "Screenshots": {"CC-2.B.1-1.png": "General Behavior alert for rundll32.exe launching cmd.exe (executing the echo command) ", "CC-2.B.1-2.png": "Telemetry showing cmd.exe executing the echo command", "CC-2.B.1-99.png": "A General Behavior alert showing that a spawned process (cmd.exe running echo) has been tagged for monitoring because its parent process has a detection (rundll32.exe)", "": ""}}, "12.B.1": {"Procedure": "Empire: 'whoami /all /fo list' via PowerShell", "DetectionCategories": [{"Enrichment ": "The capability enriched powershell.exe executing whoami.exe indicating a sign of reconnaissance before privilege escalation. "}, {" Telemetry": " Telemetry showed powershell.exe executing whoami.exe with command-line arguments. "}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (whoami) has been tagged for monitoring because its parent process has a detection (powershell.exe)."}], "Screenshots": {"CC-12.A.1-1.png": "Enrichment of powershell.exe executing whoami.exe indicating a sign of reconnaissance before privilege escalation", "CC-12.B.1-1.png": "Telemetry showing powershell.exe executing whoami.exe with command-line arguments", "CC-11.B.1-1.png": "General Behavior alert showing that a spawned process (whoami) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "": ""}}, "12.E.1.1": {"Procedure": "Empire: WinEnum module included enumeration of user information", "DetectionCategories": [{"Telemetry": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of user information."}], "Screenshots": {"CC-12.E.1-2.png": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function", "": ""}}, "20.B.1": {"Procedure": "Executed 'whoami' via cmd persistence mechanism through RDP connection made to Creeper (10.0.0.4)", "DetectionCategories": [{"Telemetry": "Telemetry showed whoami.exe was executed from magnify.exe."}, {" Enrichment ": " The capability enriched whoami.exe with a tag identifying the command as enumeration."}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (whoami) has been tagged for monitoring because its parent process has a detection (magnify.exe)."}], "Screenshots": {"CC-20.A.1-5.png": "Telemetry showing the execution of whoami", "CC-20.A.1-6.png": "Enrichment of whoami.exe with a tag identifying the command as enumeration", "CC-20.A.1-7.png": "General Behavior alert showing that a spawned process (whoami) has been tagged for monitoring because its parent process has a detection (magnify.exe)", "": ""}}}}, "T1106": {"TechniqueName": "Execution through API", "TacticGroup": "Execution", "PrimaryEnabling": "Enabling", "Steps": {"2.C.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "3.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "8.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "8.C.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "8.D.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "9.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "9.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.E.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}}}, "T1057": {"TechniqueName": "Process Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"2.C.1": {"Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "2.C.2 ": {"Procedure": "Cobalt Strike: 'tasklist /v' via cmd", "DetectionCategories": [{"General Behavior ": "A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing tasklist) which was identified as extremely rare and suspicious. "}, {"Telemetry": "Telemetry showed cmd.exe executing tasklist.exe along with command-line arguments."}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (cmd.exe running tasklist) has been tagged for monitoring because its parent process has a detection (cmd.exe)."}], "Screenshots": {"CC-2.D.2-2.png": "General Behavior alert for rundll32.exe launching cmd.exe (executing tasklist) ", "CC-2.C.2-2.png": "Telemetry showing tasklist.exe with command-line arguments", "CC-2.D.2-99.png": "General Behavior alert showing that a spawned process (cmd.exe running tasklist) has been tagged for monitoring because its parent process has a detection (cmd.exe)", "": ""}}, "3.B.1": {"Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "8.B.1": {"Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "12.C.1": {"Procedure": "Empire: 'qprocess *' via PowerShell", "DetectionCategories": [{"Enrichment": "The capability enriched qprocess.exe as listing running processes and possibly a sign of reconnaissance. "}, {" Telemetry": " Telemetry showed powershelll.exe executing qprocess.exe with command-line arguments."}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (qprocess) has been tagged for monitoring because its parent process has a detection (powershell.exe)."}], "Screenshots": {"CC-12.A.1-1.png": "Enrichment of qprocess.exe as listing running processes and possibly a sign of reconnaissance", "CC-12.C.1-1.png": "Telemetry showing powershell.exe executing qprocess.exe with command-line arguments", "CC-12.A.1-99.png": "General Behavior alert showing that a spawned process (qprocess) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "": ""}}}}, "T1007": {"TechniqueName": "System Service Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"2.D.1": {"Procedure": "Cobalt Strike: 'sc query' via cmd", "DetectionCategories": [{"Telemetry": "Telemetry showed cmd.exe executing sc with command-line arguments."}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (cmd.exe running sc) has been tagged for monitoring because its parent process has a detection (rundll32.exe)."}], "Screenshots": {"CC-2.D.2-1.png": "General Behavior alert showing that a spawned process (cmd.exe running sc) has been tagged for monitoring because its parent process has a detection (rundll32.exe)", "": ""}}, "2.D.2": {"Procedure": "Cobalt Strike: 'net start' via cmd", "DetectionCategories": [{"General Behavior": "A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing the net) which was identified as extremely rare and suspicious."}, {" Telemetry": " Telemetry showed cmd.exe executing net.exe with command-line arguments."}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)."}], "Screenshots": {"CC-2.D.2-1.png": "General Behavior alert for rundll32.exe launching cmd.exe (executing net) ", "CC-2.D.2-3.png": "Telemetry showing net.exe with command-line arguments", "CC-2.D.2-98.png": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)", "": ""}}, "12.D.1": {"Procedure": "Empire: 'net start' via PowerShell", "DetectionCategories": [{"Telemetry": "Telemetry showed powershell.exe executing net.exe with command-line arguments."}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)."}], "Screenshots": {"CC-12.D.1-1.png": "Telemetry showing powershell.exe executing net.exe with command-line arguments", "CC-11.B.1-1.png": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "": ""}}, "12.E.1.8": {"Procedure": "Empire: WinEnum module included enumeration of services", "DetectionCategories": [{"Telemetry": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of services."}], "Screenshots": {"CC-12.E.1-2.png": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function", "": ""}}, "16.H.1": {"Procedure": "Empire: 'sc query' via PowerShell to remotely enumerate services on Creeper (10.0.0.4)", "DetectionCategories": [{"Telemetry": "Telemetry showed powershell.exe executing sc.exe with command-line arguments."}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)."}], "Screenshots": {"CC-16.D.1-1.png": "Telemetry showing powershell.exe executing sc.exe with command-line arguments", "CC-16.H.1-2.png": "General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "": ""}}, "16.J.1": {"Procedure": "Empire: 'sc qc' via PowerShell to remotely enumerate a specific service on Creeper (10.0.0.4)", "DetectionCategories": [{"Telemetry": "Telemetry showed sc.exe execution with command-line arguments."}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)."}], "Screenshots": {"CC-16.D.1-1.png": "Telemetry showing sc.exe with command-line arguments", "CC-16.I.1-1.png": "General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "": ""}}, "17.A.1": {"Procedure": "Empire: 'reg query' via PowerShell to enumerate a specific Registry key associated with terminal services", "DetectionCategories": [{"Telemetry": "Telemetry showed reg.exe with command-line arguments to check if terminal services were enabled."}], "Screenshots": {"CC-17.A.1-1.png": "Telemetry showing reg.exe with command-line arguments", "": ""}}}}, "T1082": {"TechniqueName": "System Information Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"2.E.1": {"Procedure": "Cobalt Strike: 'systeminfo' via cmd", "DetectionCategories": [{"Enrichment": "The capability enriched systeminfo.exe indicating it could be used for reconnaissance."}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (cmd.exe running systeminfo) has been tagged for monitoring because its parent process has a detection (rundll32.exe)."}], "Screenshots": {"CC-2.E.1-1.png": "Enrichment of systeminfo.exe indicating it could be used for reconnaissance.", "CC-2.B.1-1.png": "General Behavior alert showing that a spawned process (cmd.exe running systeminfo) has been tagged for monitoring because its parent process has a detection (rundll32.exe)", "": ""}}, "2.E.2": {"Procedure": "Cobalt Strike: 'net config workstation' via cmd", "DetectionCategories": [{"General Behavior": "A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing the net) which was identified as extremely rare and suspicious."}, {" Enrichment": " The capability enriched net.exe indicating it is commonly used for reconnaissance."}, {" Telemetry": " Telemetry showed cmd.exe executing net.exe with command-line arguments."}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)."}], "Screenshots": {"CC-2.A.1-1.png": "General Behavior alert for rundll32.exe launching cmd.exe (executing net) ", "CC-2.A.2-2.png": "Enrichment of net.exe indicating it is commonly used for reconnaissance", "CC-2.E.2-2.png": "Telemetry showing net.exe with command-line arguments", "CC-2.A.1-99.png": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)", "": ""}}, "12.E.1.6.1": {"Procedure": "Empire: WinEnum module included enumeration of system information", "DetectionCategories": [{"Telemetry": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of system information."}], "Screenshots": {"CC-12.E.1-2.png": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function", "": ""}}, "12.E.1.6.2": {"Procedure": "Empire: WinEnum module included enumeration of Windows update information", "DetectionCategories": [{"Telemetry": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of Windows update information."}], "Screenshots": {"CC-12.E.1-2.png": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function", "": ""}}}}, "T1069": {"TechniqueName": "Permission Groups Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"2.F.1": {"Procedure": "Cobalt Strike: 'net localgroup administrators' via cmd", "DetectionCategories": [{"General Behavior": "A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing the net) which was identified as extremely rare and suspicious."}, {" Enrichment": " The capability enriched net.exe indicating it is commonly used for reconnaissance."}, {" Telemetry": " Telemetry showed cmd.exe executing net with command-line arguments."}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)."}], "Screenshots": {"CC-2.F.1-1.png": "General Behavior alert for rundll32.exe launching cmd.exe (executing net) ", "CC-2.F.1-99.png": "Enrichment of net.exe indicating it is commonly used for reconnaissance", "CC-2.F.1-2.png": "Telemetry showing net.exe with command-line arguments", "CC-2.F.1-98.png": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)", "": ""}}, "2.F.2": {"Procedure": "Cobalt Strike: 'net localgroup administrators /domain' via cmd", "DetectionCategories": [{"General Behavior": "A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing the net) which was identified as extremely rare and suspicious."}, {" Enrichment": " The capability enriched net.exe indicating it is commonly used for reconnaissance. "}, {" Telemetry": " Telemetry showed cmd.exe executing net with command-line arguments."}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (cmd.exe)."}], "Screenshots": {"CC-2.F.2-1.png": "General Behavior alert for rundll32.exe launching cmd.exe (executing net) ", "CC-2.F.2-99.png": "Enrichment of net.exe indicating it is commonly used for reconnaissance", "CC-2.F.2-2.png": "Telemetry showing net.exe with command-line arguments", "CC-2.F.2-98.png": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (cmd.exe)", "": ""}}, "2.F.3": {"Procedure": "Cobalt Strike: 'net group \"Domain Admins\" /domain' via cmd", "DetectionCategories": [{"Enrichment ": "The capability enriched net.exe indicating it is commonly used for reconnaissance. "}, {" Telemetry": " Telemetry showed cmd.exe executing net with command-line arguments. "}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)."}], "Screenshots": {"CC-2.F.3-1.png": "Enrichment of net.exe indicating it is commonly used for reconnaissance", "CC-2.F.3-2.png": "Telemetry showing net.exe with command-line arguments", "CC-2.F.3-3.png": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)", "": ""}}, "12.E.1.2": {"Procedure": "Empire: WinEnum module included enumeration of AD group memberships", "DetectionCategories": [{"Telemetry": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of AD group memberships."}], "Screenshots": {"CC-12.E.1-2.png": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function", "": ""}}, "12.F.1": {"Procedure": "Empire: 'net group \"Domain Admins\" /domain' via PowerShell", "DetectionCategories": [{"General Behavior ": "A General Behavior alert was generated showing that a spawned process (net.exe) has been tagged for monitoring because its parent process has a detection (powershell.exe). "}, {" Telemetry": " Telemetry showed powershell.exe executing net.exe with command-line arguments."}], "Screenshots": {"CC-12.F.1-T1069-new.png": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "CC-12.F.1-3.png": "Telemetry showing powershell.exe executing net.exe with command-line arguments", "": ""}}, "12.F.2": {"Procedure": "Empire: 'net\u00a0localgroup\u00a0administrators' via PowerShell", "DetectionCategories": [{"General Behavior ": "A General Behavior alert was generated showing that a spawned process (net1.exe) has been tagged for monitoring because its parent process has a detection (powershell.exe). "}, {" Telemetry": " Telemetry showed powershell.exe executing net.exe with command-line arguments."}], "Screenshots": {"CC-12.F.2-T1069-new.png": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "CC-12.F.1-3.png": "Telemetry showing powershell.exe executing net.exe with command-line arguments", "": ""}}}}, "T1087": {"TechniqueName": "Account Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"2.G.1": {"Procedure": "Cobalt Strike: 'net user /domain' via cmd", "DetectionCategories": [{"General Behavior": "A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing the net) which was identified as extremely rare and suspicious."}, {" Enrichment": " The capability enriched net.exe with a tag identifying the command as enumeration."}], "Screenshots": {"CC-2.G.1-1.png": "General Behavior alert for rundll32.exe launching cmd.exe (executing net) ", "CC-2.G.1-2.png": "Enrichment of net.exe with a tag identifying the command as enumeration", "": ""}}, "2.G.2": {"Procedure": "Cobalt Strike: 'net user George /domain' via cmd", "DetectionCategories": [{"Enrichment": "The capability enriched net.exe with a tag identifying the command as enumeration."}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (cmd.exe)."}], "Screenshots": {"CC-2.H.1-2.png": "Enrichment of net.exe with a tag identifying the command as enumeration", "CC-2.G.1-1.png": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (cmd.exe)", "": ""}}, "7.A.1": {"Procedure": "Microsoft Management Console (Local Users and Groups snap-in) GUI utility displayed user account information", "DetectionCategories": [{"Telemetry": "Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the lusrmgr.msc (Local Users and Groups snap-in), which displays local account information."}], "Screenshots": {"CC-7.A.1-1.png": "Telemetry showing mmc.exe running lursmgr.msc", "": ""}}, "12.G.1": {"Procedure": "Empire: 'net user' via PowerShell", "DetectionCategories": [{"General Behavior ": "A General Behavior alert was generated showing that a spawned process (net.exe) has been tagged for monitoring because its parent process has a detection (powershell.exe). "}, {" Telemetry": " Telemetry showed powershell.exe executing net.exe with command-line arguments."}], "Screenshots": {"CC-12.G.1-T1087-new.png": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "CC-12.F.1-3.png": "Telemetry showing powershell.exe executing net.exe with command-line arguments", "": ""}}, "12.G.2": {"Procedure": "Empire: 'net user /domain' via PowerShell", "DetectionCategories": [{"General Behavior ": "A General Behavior alert was generated showing that a spawned process (net.exe) has been tagged for monitoring because its parent process has a detection (powershell.exe). "}, {" Telemetry": " Telemetry showed powershell.exe executing net.exe with command-line arguments."}], "Screenshots": {"CC-12.G.2-T1087-new.png": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "CC-12.F.1-3.png": "Telemetry showing powershell.exe executing net.exe with command-line arguments", "": ""}}}}, "T1012": {"TechniqueName": "Query Registry", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"2.H.1": {"Procedure": "Cobalt Strike: 'reg query' via cmd to enumerate a specific Registry key", "DetectionCategories": [{"Enrichment ": "The capability enriched reg.exe indicating that a sensitive registry key was accessed, possibly as part of reconnaissance."}, {" General Behavior": " A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing the reg) which was identified as extremely rare and suspicious."}, {" Telemetry": " Telemetry showed cmd.exe executing reg with command-line arguments."}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (cmd.exe running reg) has been tagged for monitoring because its parent process has a detection (rundll32.exe)."}], "Screenshots": {"CC-2.H.1-1.png": "Enrichment of reg.exe indicating that a sensitive registry key was accessed, possibly as part of reconnaissance", "CC-2.G.2-1.png": "General Behavior alert for rundll32.exe launching cmd.exe (executing reg) ", "CC-2.H.1-2.png": "Telemetry showing reg.exe with command-line arguments", "CC-2.G.2-99.png": "General Behavior alert showing that a spawned process (cmd.exe running reg) has been tagged for monitoring because its parent process has a detection (rundll32.exe)", "": ""}}, "6.A.1": {"Procedure": "Cobalt Strike: 'reg query' via cmd to remotely enumerate a specific Registry key on Conficker (10.0.0.5)", "DetectionCategories": [{"Enrichment": "The capability enriched reg.exe identifying that a sensitive Registry key was accessed which could be used for recon. "}, {" Telemetry": " Telemetry showed cmd.exe executing reg with command-line arguments."}], "Screenshots": {"CC-6.A.1-1.png": "Enrichment of reg.exe identifying that a sensitive Registry key was accessed which could be used for recon", "CC-6.A.1-2.png": "Telemetry showing reg.exe with command-line arguments", "": ""}}, "12.E.1.7": {"Procedure": "Empire: WinEnum module included enumeration of system information via a Registry query", "DetectionCategories": [{"Telemetry": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of system information via a Registry query."}], "Screenshots": {"CC-12.E.1-2.png": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function", "": ""}}, "13.C.1": {"Procedure": "Empire:\u00a0'reg query' via PowerShell to enumerate a specific Registry key", "DetectionCategories": [{"Telemetry ": "Telemetry showed powershell.exe executing reg.exe with command-line arguments. "}, {" Enrichment": " The capability enriched reg.exe indicating that a sensitive registry key was accessed for potential reconnaissance."}], "Screenshots": {"CC-12.G.1-2.png": "Telemetry showing powershell.exe executing reg.exe with command-line arguments", "CC-13.A.1-1.png": "Enrichment of reg.exe indicating that a sensitive registry key was accessed for potential reconnaissance", "": ""}}, "17.A.1": {"Procedure": "Empire: 'reg query' via PowerShell to enumerate a specific Registry key", "DetectionCategories": [{"Telemetry ": "Telemetry showed reg.exe with command-line arguments. "}, {" Enrichment ": " The capability enriched reg.exe indicating that a sensitive registry key was accessed for potential reconnaissance. "}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (reg) has been tagged for monitoring because its parent process has a detection (powershell.exe)."}], "Screenshots": {"CC-17.A.1-1.png": "Telemetry showing reg.exe with command-line arguments", "CC-17.A.1-2.png": "Enrichment of reg.exe indicating that a sensitive registry key was accessed for potential reconnaissance", "CC-17.A.1-3.png": "General Behavior alert showing that a spawned process (reg) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "": ""}}}}, "T1134": {"TechniqueName": "Access Token Manipulation", "TacticGroup": "Defense Evasion, Privilege Escalation", "PrimaryEnabling": "Primary", "Steps": {"3.A.1": {"Procedure": "Cobalt Strike: Built-in UAC bypass token duplication capability executed to modify current process token", "DetectionCategories": [{"Telemetry": "Telemetry showed svchost.exe executed with the seclogon command-line argument and a subsequent logon event for user Debbie with an elevated token, indicating token manipulation."}], "Screenshots": {"CC-3.A.1-3.png": "Telemetry showing svchost.exe executed with the seclogon command-line argument ", "CC-3.A.1-1.png": "Telemetry showing logon event for user Debbie with an elevated token", "": ""}}, "5.B.1": {"Procedure": "Cobalt Strike: Built-in token theft capability executed to change user context to George", "DetectionCategories": [{"Telemetry": "Telemetry showed a cmd.exe associated with user Debbie spawn a cmd.exe associated with user George, indicating user context change via token manipulation."}], "Screenshots": {"CC-5.B.1-T1134-new.png": "Telemetry showing a cmd.exe associated with user Debbie spawn a cmd.exe associated with user George, indicating user context change via token manipulation", "": ""}}}}, "T1088": {"TechniqueName": "Bypass User Account Control", "TacticGroup": "Defense Evasion, Privilege Escalation", "PrimaryEnabling": "Primary", "Steps": {"3.A.1": {"Procedure": "Cobalt Strike: Built-in UAC bypass token duplication capability executed to elevate process integrity level", "DetectionCategories": [{"Enrichment": "The capability enriched an unelevated svchost.exe spawning an elevated powershell.exe process with a tag indicating a possible UAC Bypass."}], "Screenshots": {"CC-3.A.1-2.png": "Enrichment of an unelevated svchost.exe spawning an elevated powershell.exe process with a tag indicating a possible UAC Bypass.", "": ""}}, "14.A.1": {"Procedure": "Empire: Built-in UAC bypass token duplication module executed to launch new callback with elevated process integrity level", "DetectionCategories": [{"General Behavior ": "A General Behavior alert was generated for a possible PowerShell privilege escalation based on the elevation of a child process from a non-elevated parent. "}, {"Telemetry": " Telemetry showed an elevated PowerShell spawned under the context of user Bob from an unelevated parent process. "}], "Screenshots": {"CC-14.A.1-1.png": "General Behavior alert for a possible PowerShell privilege escalation based on the elevation of a child process from a non-elevated parent", "CC-14.A.1-T1088-new.png": "Telemetry showing an elevated PowerShell being spawned under the context of user Bob from an unelevated parent process", "": ""}}}}, "T1055": {"TechniqueName": "Process Injection", "TacticGroup": "Defense Evasion, Privilege Escalation", "PrimaryEnabling": "Primary", "Steps": {"3.C.1": {"Procedure": "Cobalt Strike: Built-in process injection capability executed to inject callback into cmd.exe", "DetectionCategories": [{"Specific Behavior": "A Specific Behavior alert was generated for PowerShell opening a handle to a system process with access rights typical for a known PowerShell injection pattern, identified as a sign of code injection."}], "Screenshots": {"CC-3.C.1-1.png": "Specific Behavior alert for PowerShell opening a handle to a system process with access rights typical for a known PowerShell injection pattern, identified as a sign of code injection", "": ""}}, "5.A.1": {"Procedure": "Cobalt Strike: Credential dump capability involved process injection into lsass", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "5.A.2": {"Procedure": "Cobalt Strike: Hash dump capability involved process injection into lsass.exe", "DetectionCategories": [{"Enrichment": "The capability enriched svchost.exe injecting a thread into lsass.exe with a tag identifying thread injection."}], "Screenshots": {"CC-5.A.2-1.png": "Enrichment of svchost.exe injecting a thread into lsass.exe with a tag identifying thread injection", "": ""}}, "8.D.1": {"Procedure": "Cobalt Strike: Screen capture capability involved process injection into explorer.exe", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}}}, "T1018": {"TechniqueName": "Remote System Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"4.A.1": {"Procedure": "Cobalt Strike: 'net group \"Domain Controllers\" /domain' via cmd", "DetectionCategories": [{"Enrichment": "The capability enriched net.exe indicating that it was run with commands commonly used for reconnaissance. "}, {" Telemetry": " Telemetry showed cmd.exe executing net with command-line arguments."}], "Screenshots": {"CC-4.A.1-1.png": "Enrichment of net.exe indicating that it was run with commands commonly used for reconnaissance", "CC-4.A.1-2.png": "Telemetry showing net.exe with command-line arguments", "": ""}}, "4.A.2": {"Procedure": "Cobalt Strike: 'net group \"Domain Computers\" /domain' via cmd", "DetectionCategories": [{"Enrichment": "The capability enriched net.exe indicating that it was run with commands commonly used for reconnaissance. "}, {" Telemetry": " Telemetry showed cmd.exe executing net with command-line arguments."}], "Screenshots": {"CC-4.A.1-1.png": "Enrichment of net.exe indicating that it was run with commands commonly used for reconnaissance", "CC-4.A.1-2.png": "Telemetry showing net.exe with command-line arguments", "": ""}}, "13.A.1": {"Procedure": "Empire: 'net group \"Domain Computers\" /domain' via PowerShell", "DetectionCategories": [{"Telemetry": "Telemetry showed powershell.exe executing net.exe with command-line arguments."}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)."}], "Screenshots": {"CC-12.F.1-3.png": "Telemetry showing powershell.exe executing net.exe with command-line arguments", "CC-13.A.1-1.png": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "": ""}}}}, "T1049": {"TechniqueName": "System Network Connections Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"4.C.1": {"Procedure": "Cobalt Strike: 'netstat -ano' via cmd", "DetectionCategories": [{"Enrichment": "The capability enriched netstat.exe with a tag identifying the command as enumeration."}], "Screenshots": {"CC-4.C.1-2.png": "Enrichment of netstat.exe with a tag identifying the command as enumeration", "": ""}}, "12.E.1.12": {"Procedure": "Empire: WinEnum module included enumeration of established network connections", "DetectionCategories": [{"Telemetry": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of established network connections."}], "Screenshots": {"CC-12.E.1-2.png": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function", "": ""}}, "13.B.1": {"Procedure": "Empire: 'net use' via PowerShell", "DetectionCategories": [{"Telemetry": "Telemetry showed powershell.exe executing net.exe with command-line arguments."}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)."}], "Screenshots": {"CC-12.F.1-3.png": "Telemetry showing powershell.exe executing net.exe with command-line arguments", "CC-13.A.1-1.png": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "": ""}}, "13.B.2": {"Procedure": "Empire: 'netstat -ano' via PowerShell", "DetectionCategories": [{"Telemetry": "Telemetry showed powershell.exe executing netstat.exe with command-line arguments. "}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (netstat) has been tagged for monitoring because its parent process has a detection (powershell.exe)."}], "Screenshots": {"CC-12.G.1-2.png": "Telemetry showing powershell.exe executing netstat.exe with command-line arguments", "CC-13.A.1-1.png": "General Behavior alert showing that a spawned process (netstat) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "": ""}}}}, "T1003": {"TechniqueName": "Credential Dumping", "TacticGroup": "Credential Access", "PrimaryEnabling": "Primary", "Steps": {"5.A.1": {"Procedure": "Cobalt Strike: Built-in Mimikatz credential dump capability executed", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "5.A.2": {"Procedure": "hashdump", "DetectionCategories": [{"Enrichment": "The capability enriched svchost.exe injecting a thread into lsass.exe with a tag identifying credential dumping."}], "Screenshots": {"CC-5.A.2-1.png": "Enrichment of svchost.exe injecting a thread into lsass.exe with a tag identifying credential dumping", "": ""}}}}, "T1026": {"TechniqueName": "Multiband Communication", "TacticGroup": "Command and Control", "PrimaryEnabling": "Primary", "Steps": {"6.B.1": {"Procedure": "Cobalt Strike: C2 channel modified to split communications between both HTTP and DNS", "DetectionCategories": [{"Telemetry": "Telemetry showed rundll32.exe making network connections over port 80 to 192.168.0.4 (C2 server) as well as earlier identified DNS queries, which could indicate multiband communication."}], "Screenshots": {"CC-6.B.1-T1043-new.png": "Telemetry showing rundll32.exe making network connections over port 80 to 192.168.0.4 (C2 server)", "CC-1.C.1-1.png": "Telemetry showing rundll32.exe making DNS queries", "": ""}}}}, "T1076": {"TechniqueName": "Remote Desktop Protocol", "TacticGroup": "Lateral Movement", "PrimaryEnabling": "Primary", "Steps": {"6.C.1": {"Procedure": "Cobalt Strike: C2 channel modified to proxy RDP connection to Conficker (10.0.0.5)", "DetectionCategories": [{"Telemetry": "Telemetry showed rundll32.exe making network connections to 10.0.0.5 (Conficker) over port 3389."}], "Screenshots": {"CC-6.C.1-T1076-new.png": "Telemetry showing rundll32.exe making network connections to 10.0.0.5 (Conficker) over port 3389", "": ""}}, "10.B.1": {"Procedure": "RDP connection made to Conficker (10.0.0.5) as part of execution of persistence mechanism", "DetectionCategories": [{"Telemetry": "Telemetry showed a remote interactive logon event for the account Jesse logging on to Conficker (10.0.0.5) over port 3389. "}], "Screenshots": {"CC-10.B.1-T1076-new.png": "Telemetry showing a RemoteInteractive connection over port 3389 to Conficker (10.0.0.5)", "": ""}}, "20.A.1": {"Procedure": "RDP connection made to Creeper (10.0.0.4) as part of execution of persistence mechanism", "DetectionCategories": [{"Enrichment": "The capability enriched a Remote Desktop connection indicating a successful login to Remote Desktop Services. "}], "Screenshots": {"CC-20.A.1-2.png": "Enrichment of a Remote Desktop connection indicating a successful login to Remote Desktop Services. ", "": ""}}}}, "T1136": {"TechniqueName": "Create Account", "TacticGroup": "Persistence", "PrimaryEnabling": "Primary", "Steps": {"7.A.1": {"Procedure": "Added user Jesse to Conficker (10.0.0.5) through RDP connection", "DetectionCategories": [{"Telemetry": "Telemetry showed the creation of the new user Jesse."}], "Screenshots": {"CC-7.A.1-2.png": "Telemetry showing the creation of the new user Jesse", "": ""}}}}, "T1061": {"TechniqueName": "Graphical User Interface", "TacticGroup": "Execution", "PrimaryEnabling": "Primary", "Steps": {"7.A.1": {"Procedure": "Microsoft Management Console (Local Users and Groups snap-in) GUI utility used to add new user through RDP connection", "DetectionCategories": [{"Telemetry": "Telemetry showed mmc.exe, the Microsoft Management Console, executing the GUI-based lusrmgr.msc (Local Users and Groups snap-in)."}], "Screenshots": {"CC-7.A.1-T1061-new.png": "Telemetry showing mmc.exe running lursmgr.msc", "": ""}}}}, "T1105": {"TechniqueName": "Remote File Copy", "TacticGroup": "Command and Control, Lateral Movement", "PrimaryEnabling": "Primary", "Steps": {"7.B.1": {"Procedure": "Cobalt Strike: Built-in upload capability executed to write a DLL payload (updater.dll) to disk on Nimda (10.0.1.6)", "DetectionCategories": [{"Enrichment": "The capability enriched the creation of updater.dll identifying that a command prompt modified an unknown DLL."}], "Screenshots": {"CC-7.B.1-1.png": "Enrichment of the creation of updater.dll identifying that a command prompt modified an unknown DLL", "": ""}}, "14.A.1": {"Procedure": "Empire: UAC bypass module downloaded and wrote a new Empire stager (wdbypass) to disk", "DetectionCategories": [{"Telemetry": "Telemetry showed powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass."}, {" Specific Behavior": " A Specific Behavior alert was generated for PowerShell downloading a significant amount of data using HTTP(S)."}], "Screenshots": {"CC-14.A.1-2.png": "Telemetry showing powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass", "CC-14.A.1-1.png": "Specific Behavior alert for PowerShell downloading a significant amount of data using HTTP(S)", "": ""}}, "16.E.1": {"Procedure": "Empire: Built-in upload module executed to write malicious VBScript (autoupdate.vbs) to disk on CodeRed (10.0.1.5)", "DetectionCategories": [{"Telemetry": "Telemetry showed the file creation of autoupdate.vbs."}], "Screenshots": {"CC-16.D.1-6.png": "Telemetry showing the creation of autoupdate.vbs", "": ""}}, "16.G.1": {"Procedure": "Empire: Built-in move capability executed to write malicious VBScript (update.vbs) to disk on Creeper (10.0.0.4)", "DetectionCategories": [{"Telemetry": "Telemetry showed the file creation of update.vbs."}], "Screenshots": {"CC-16.D.1-6.png": "Telemetry showing the creation of update.vbs", "": ""}}, "19.A.1": {"Procedure": "Empire: Built-in upload module executed to write binary (recycler.exe) to disk on CodeRed (10.0.1.5)", "DetectionCategories": [{"Telemetry": "Telemetry showed powershell.exe creating recycler.exe."}], "Screenshots": {"CC-19.B.1-2.png": "Telemetry showing the creation of recycler.exe", "": ""}}}}, "T1053": {"TechniqueName": "Scheduled Task", "TacticGroup": "Execution", "PrimaryEnabling": "Primary", "Steps": {"7.C.1": {"Procedure": "Cobalt Strike: 'schtasks' via cmd to create scheduled task that executes a DLL payload (updater.dll)", "DetectionCategories": [{"Telemetry": "Telemetry showed cmd.exe registering the \"Resume Viewer Update Checker\" scheduled task."}], "Screenshots": {"CC-7.C.1-2.png": "Telemetry showing schtasks.exe with command-line arguments scheduling a task for persistence", "": ""}}, "10.A.2": {"Procedure": "Scheduled task executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (updater.dll) using Rundll32", "DetectionCategories": [{"Telemetry": "Telemetry showed rundll32.exe executing updater.dll."}], "Screenshots": {"CC-10.A.1-2.png": "Telemetry showing rundll32 starting updater.dll, tainted by an \"abnormal rundll32 launch\" alert", "": ""}}}}, "T1083": {"TechniqueName": "File and Directory Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"8.A.1": {"Procedure": "Cobalt Strike: 'dir /s /b \"\\\\conficker\\wormshare\"' via cmd", "DetectionCategories": [{"General Behavior": "A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing dir) which was identified as extremely rare and suspicious. "}, {" Enrichment": " The capability enriched cmd.exe executing the dir command indicating that the parameter was a directory listing of a network drive associated with potential reconnaissance."}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (cmd.exe running dir) has been tagged for monitoring because its parent process has a detection (rundll32.exe)."}], "Screenshots": {"CC-8.A.1-1.png": "General Behavior alert for rundll32.exe launching cmd.exe (executing dir) ", "CC-8.A.1-99.png": "Enrichment of cmd.exe executing the dir command indicating that the parameter was a directory listing of a network drive associated with potential reconnaissance.", "CC-8.A.1-98.png": "General Behavior alert showing that a spawned process (cmd.exe running dir) has been tagged for monitoring because its parent process has a detection (rundll32.exe)", "": ""}}, "8.A.2": {"Procedure": "Cobalt Strike: 'tree \"C:\\Users\\debbie\"' via cmd", "DetectionCategories": [{"General Behavior": "A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing tree) which was identified as extremely rare and suspicious. "}, {" Enrichment": " The capability enriched cmd.exe executing the tree command with a tag identifying the command as enumeration."}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (cmd.exe running tree) has been tagged for monitoring because its parent process has a detection (rundll32.exe)."}], "Screenshots": {"CC-8.A.1-1.png": "General Behavior alert for rundll32.exe launching cmd.exe (executing tree) ", "CC-8.A.2-2.png": "Enrichment of tree.exe with a tag identifying the command as enumeration", "CC-8.A.1-99.png": "General Behavior alert showing that a spawned process (cmd.exe running tree) has been tagged for monitoring because its parent process has a detection (rundll32.exe)", "": ""}}, "9.A.1": {"Procedure": "Cobalt Strike: 'ls' (List) via Win32 APIs to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "12.E.1.4.1": {"Procedure": "Empire: WinEnum module included enumeration of recently opened files", "DetectionCategories": [{"Telemetry": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of recently opened files."}], "Screenshots": {"CC-12.E.1-2.png": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function", "": ""}}, "12.E.1.4.2": {"Procedure": "Empire: WinEnum module included enumeration of interesting files", "DetectionCategories": [{"Telemetry": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of interesting files."}], "Screenshots": {"CC-12.E.1-2.png": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function", "": ""}}, "16.K.1": {"Procedure": "Empire: 'type' via PowerShell to remotely enumerate a specific file (update.vbs) on Creeper (10.0.0.4)", "DetectionCategories": [{"Telemetry": "Telemetry showed powershell.exe executing the type command with command-line arguments."}], "Screenshots": {"CC-16.D.1-1.png": "Telemetry showing powershell.exe executing the type command with command-line arguments", "": ""}}, "18.A.1": {"Procedure": "Empire: 'Get-ChildItem' via PowerShell to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)", "DetectionCategories": [{"Telemetry": "Telemetry showed powershell.exe executing the Get-ChildItem command. "}], "Screenshots": {"CC-18.A.1-T1083-new.png": "Telemetry showing powershell.exe executing the Get-ChildItem command ", "": ""}}}}, "T1056": {"TechniqueName": "Input Capture", "TacticGroup": "collection, Credential Access", "PrimaryEnabling": "Primary", "Steps": {"8.C.1": {"Procedure": "Cobalt Strike: Built-in keylogging capability executed to capture keystrokes of user Debbie", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "15.A.1": {"Procedure": "Empire: Built-in keylogging module executed to capture keystrokes of user Bob", "DetectionCategories": [{"Telemetry ": "Telemetry showed powershell.exe executing the GetAsyncKeyState method, indicating keylogging. "}, {" Enrichment": " The capability enriched powershell.exe with a tag indicating .NET keylogging."}], "Screenshots": {"CC-15.A.1-1.png": "Telemetry showing powershell.exe executing the GetAsyncKeyState method", "CC-15.B.1-3.png": "Enrichment of powershell.exe with a tag indicating .NET keylogging", "": ""}}}}, "T1010": {"TechniqueName": "Application Window Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"8.C.1": {"Procedure": "Cobalt Strike: Keylogging capability included residual enumeration of application windows", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "15.A.1": {"Procedure": "Empire: Built-in keylogging module included residual enumeration of application windows", "DetectionCategories": [{"Telemetry": "Telemetry showed powershell.exe executing the GetForegroundWindow method."}], "Screenshots": {"CC-15.A.1-1.png": "Telemetry showing powershell.exe executing the GetForegroundWindow method", "": ""}}}}, "T1113": {"TechniqueName": "Screen Capture", "TacticGroup": "Collection", "PrimaryEnabling": "Primary", "Steps": {"8.D.1": {"Procedure": "Cobalt Strike: Built-in screen capture capability executed to capture screenshot of current window of user Debbie", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}}}, "T1039": {"TechniqueName": "Data from Network Shared Drive", "TacticGroup": "Collection", "PrimaryEnabling": "Primary", "Steps": {"9.B.1": {"Procedure": "Cobalt Strike: Built-in download capability executed to a collect file (Shockwave_rackb_diagram.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "18.B.1": {"Procedure": "Empire: 'copy' via PowerShell staged a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5) in the Recycle Bin (C:\\$Recycle.Bin) on CodeRed (10.0.1.5)", "DetectionCategories": [{"Telemetry": "Telemetry showed powershell.exe copying the .vsdx file from the network shared drive on Conficker (10.0.0.5) to the Recycle Bin. "}], "Screenshots": {"CC-18.A.1-3.png": "Telemetry showing the copy of the .vsdx file from the network drive to the Recycle Bin", "": ""}}}}, "T1041": {"TechniqueName": "Exfiltration Over Command and Control Channel", "TacticGroup": "Exfiltration", "PrimaryEnabling": "Primary", "Steps": {"9.B.1": {"Procedure": "Cobalt Strike: Download capability exfiltrated data through existing C2 channel", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}}}, "T1078": {"TechniqueName": "Valid Accounts", "TacticGroup": "Defense Evasion, Persistence, Privilege Escalation, Initial Access", "PrimaryEnabling": "Primary", "Steps": {"10.B.1": {"Procedure": "RDP connection to Conficker (10.0.0.5) authenticated using previously added user Jesse", "DetectionCategories": [{"Telemetry": "Telemetry showed a remote interactive logon event for the account Jesse logging on to Conficker (10.0.0.5) over port 3389. "}], "Screenshots": {"CC-10.B.1-T1076-new.png": "Telemetry showing a RemoteInteractive connection as Jesse over port 3389 to Conficker (10.0.0.5)", "": ""}}, "16.B.1": {"Procedure": "Empire: 'net use' via PowerShell to successfully authenticate to Conficker (10.0.0.5) using credentials of user Kmitnick", "DetectionCategories": [{"Telemetry": "Telemetry showed a logon attempt via net.exe with command-line arguments to connect using the valid credentials of user Kmitnick. Telemetry also showed a logon event for user Kmitnick on Conficker (10.0.0.5)."}], "Screenshots": {"CC-16.C.1-1.png": "Telemetry showing net.exe logon attempt", "CC-16.C.1-2.png": "Telemetry showing a logon event for user Kmitnick on Conficker (10.0.0.5)", "": ""}}, "16.D.1": {"Procedure": "Empire: 'net use' via PowerShell to successfully authenticate to Creeper (10.0.0.4) using credentials of user Kmitnick", "DetectionCategories": [{"Enrichment ": "The capability enriched the net.exe connection using valid credentials of Kmitnick with an alert for possible lateral movement. "}, {" Telemetry": " Telemetry showed a logon attempt via net.exe with command-line arguments targeting C$ on 10.0.0.4 (Creeper) using valid credentials for user Kmitnick. Telemetry also showed a logon event for user Kmitnick on Creeper (10.0.0.4)."}], "Screenshots": {"CC-16.C.1-1.png": "Telemetry showing net.exe with command-line arguments", "CC-16.C.1-2.png": "Telemetry showing a logon event for user Kmitnick on Creeper (10.0.0.4)", "CC-16.D.1-T1078-new.png": "The capability enriching the net.exe connection using valid credentials of Kmitnick with an alert for possible lateral movement", "": ""}}}}, "T1086": {"TechniqueName": "PowerShell", "TacticGroup": "Execution", "PrimaryEnabling": "Enabling", "Steps": {"11.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.A.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.C.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.D.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.E.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.F.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.F.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.G.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.G.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "13.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "13.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "13.B.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "13.C.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "15.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "16.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "16.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "16.C.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "16.D.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "16.E.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "16.G.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "16.H.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "16.I.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "16.J.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "16.K.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "16.L.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "17.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "17.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "17.B.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "17.C.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "18.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "18.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "19.D.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "19.D.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}}}, "T1032": {"TechniqueName": "Standard Cryptographic Protocol", "TacticGroup": "Command and Control", "PrimaryEnabling": "Primary", "Steps": {"11.B.1": {"Procedure": "Empire: Encrypted C2 channel established using HTTPS", "DetectionCategories": [{"Specific Behavior": "A Specific Behavior alert was generated for PowerShell downloading a significant amount of data using HTTP(S)."}], "Screenshots": {"CC-11.A.1-5.png": "Specific Behavior alert for PowerShell downloading a significant amount of data using HTTP(S)", "": ""}}}}, "T1201": {"TechniqueName": "Password Policy Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"12.E.1.3": {"Procedure": "Empire: WinEnum module included enumeration of password policy information", "DetectionCategories": [{"Telemetry": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of password policy information."}], "Screenshots": {"CC-12.E.1-2.png": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function", "": ""}}}}, "T1115": {"TechniqueName": "Clipboard Data", "TacticGroup": "Collection", "PrimaryEnabling": "Primary", "Steps": {"12.E.1.5": {"Procedure": "Empire: WinEnum module included enumeration of clipboard contents", "DetectionCategories": [{"Telemetry": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of clipboard contents."}, {" Indicator of Compromise": " An Indicator of Compromise alert was generated for PowerShell Empire accessing the clipboard."}], "Screenshots": {"CC-12.E.1-2.png": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function", "CC-12.E.1-4.png": "Indicator of Compromise alert for PowerShell Empire accessing the clipboard.", "": ""}}}}, "T1135": {"TechniqueName": "Network Share Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"12.E.1.9.1": {"Procedure": "Empire: WinEnum module included enumeration of available shares", "DetectionCategories": [{"Telemetry": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of available shares."}], "Screenshots": {"CC-12.E.1-2.png": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function", "": ""}}, "12.E.1.9.2": {"Procedure": "Empire: WinEnum module included enumeration of mapped network drives", "DetectionCategories": [{"Telemetry": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of mapped network drives."}], "Screenshots": {"CC-12.E.1-2.png": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function", "": ""}}}}, "T1063": {"TechniqueName": "Security Software Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"12.E.1.10.1": {"Procedure": "Empire: WinEnum module included enumeration of AV solutions", "DetectionCategories": [{"Telemetry": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of AV solutions."}], "Screenshots": {"CC-12.E.1-2.png": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function", "": ""}}, "12.E.1.10.2": {"Procedure": "Empire: WinEnum module included enumeration of firewall rules", "DetectionCategories": [{"Telemetry": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of firewall rules."}], "Screenshots": {"CC-12.E.1-2.png": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function", "": ""}}}}, "T1081": {"TechniqueName": "Credentials in Files", "TacticGroup": "Execution", "PrimaryEnabling": "Primary", "Steps": {"15.B.1": {"Procedure": "Empire: 'get-content' via PowerShell to collect sensitive file (it_tasks.txt) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "DetectionCategories": [{"Telemetry": "Telemetry showed powershell.exe executing the Get-Content cmdlet on IT_tasks.txt."}], "Screenshots": {"CC-15.A.1-4.png": "Telemetry showing powershell.exe executing the Get-Content cmdlet on IT_tasks.txt", "": ""}}}}, "T1110": {"TechniqueName": "Brute Force", "TacticGroup": "Credential Access", "PrimaryEnabling": "Primary", "Steps": {"16.A.1": {"Procedure": "Empire: 'net use' via PowerShell to brute force password spraying authentication attempts to Morris (10.0.1.4) and Nimda (10.0.1.6) targeting credentials of users\u00a0Kmitnick, Bob, and Frieda", "DetectionCategories": [{"Telemetry": "Telemetry showed repeated logon attempts via net.exe with command-line arguments indicative of password spraying."}, {" Enrichment": " The capability enriched multiple occurrences of net.exe usage as indicative of brute forcing a remote system as well as the correct ATT&CK Technique ID (Brute Force). [CC3]"}], "Screenshots": {"CC-16.A.1-2.png": "Telemetry showing net.exe logon attempts", "": ""}}, "16.B.1": {"Procedure": "Empire: Successful authentication to Conficker (10.0.0.5) using credentials of user Kmitnick as a result of the brute force password spraying", "DetectionCategories": [{"Telemetry": "Telemetry showed a logon attempt via net.exe with command-line arguments to connect using the valid credentials of user Kmitnick. "}, {" Enrichment": " The capability enriched multiple occurrences of net.exe usage as indicative of brute forcing a remote system as well as the correct ATT&CK Technique ID (Brute Force). [CC3]"}], "Screenshots": {"CC-16.C.1-1.png": "Telemetry showing net.exe logon attempt", "": ""}}}}, "T1077": {"TechniqueName": "Windows Admin Shares", "TacticGroup": "Lateral Movement", "PrimaryEnabling": "Primary", "Steps": {"16.A.1": {"Procedure": "Empire: Brute force password spraying attempts targeted Windows admin shares on Morris (10.0.1.4) and Nimda (10.0.1.6)", "DetectionCategories": [{"Telemetry ": "Telemetry showed repeated logon attempts targeting ADMIN$ via net.exe and command-line arguments. "}, {" Specific Behavior": " Specific Behavior alerts were generated for net.exe connecting to a remote administrative share."}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)."}], "Screenshots": {"CC-16.A.1-2.png": "Telemetry showing net use logon attempts to ADMIN$ shares", "CC-16.A.1-1.png": "Specific Behavior alerts for net.exe connecting to a remote administrative share", "CC-16.A.1-99.png": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "": ""}}, "16.B.1": {"Procedure": "Empire: Successful authentication targeted Windows admin share on Conficker (10.0.0.5)\u00a0", "DetectionCategories": [{"Telemetry ": "Telemetry showed repeated logon attempts targeting ADMIN$ via net.exe and command-line arguments. "}, {" Specific Behavior": " Specific Behavior alerts were generated for net.exe connecting to a remote administrative share."}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)."}], "Screenshots": {"CC-16.C.1-1.png": "Telemetry showing a net use logon attempt to ADMIN$ shares", "CC-16.B.1-2.png": "Specific Behavior alerts for net.exe connecting to a remote administrative share", "CC-16.B.1-3.png": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "": ""}}, "16.D.1": {"Procedure": "Empire: Successful authentication targeted Windows admin shares on Conficker (10.0.0.5)", "DetectionCategories": [{"Telemetry": "Telemetry showed a logon attempt via net.exe with command-line arguments targeting C$ on 10.0.0.4 (Creeper) using valid credentials for user Kmitnick."}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)."}], "Screenshots": {"CC-16.C.1-1.png": "Telemetry showing net.exe with command-line arguments", "CC-16.C.1-3.png": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "": ""}}}}, "T1126": {"TechniqueName": "Network Share Connection Removal", "TacticGroup": "Defense Evasion", "PrimaryEnabling": "Primary", "Steps": {"16.C.1": {"Procedure": "Empire: 'net use /delete' via PowerShell", "DetectionCategories": [{"Telemetry": "Telemetry showed powershell.exe executing net.exe with command-line arguments."}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)."}], "Screenshots": {"CC-16.C.1-1.png": "Telemetry showing powershell.exe executing net.exe with command-line arguments", "CC-16.C.1-3.png": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "": ""}}}}, "T1036": {"TechniqueName": "Masquerading", "TacticGroup": "Defense Evasion", "PrimaryEnabling": "Primary", "Steps": {"16.I.1": {"Procedure": "Empire: 'sc description' via PowerShell to remotely disguise a service on Creeper (10.0.0.4)", "DetectionCategories": [{"Telemetry": "Telemetry within the process trees showed execution of sc.exe with command-line arguments to create the AdobeUpdater service with binPath pointed to cmd.exe with arguments to execute update.vbs and a suspicious service description, which could indicate masquerading."}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)."}], "Screenshots": {"CC-16.D.1-1.png": "Telemetry showing sc.exe with command-line arguments", "CC-16.I.1-1.png": "General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "": ""}}, "19.A.1": {"Procedure": "Empire: File dropped to disk is a renamed copy of the WinRAR binary", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "19.B.1": {"Procedure": "Empire: Executed binary (recycler.exe) is a renamed copy of the WinRAR binary", "DetectionCategories": [{"Telemetry": "Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use. Additionally recycler.exe was identified as WinRAR via file metadata, including executable product and description. "}], "Screenshots": {"CC-19.B.1-4.png": "Telemetry showing recycler.exe metadata, which identified it as WinRAR", "": ""}}}}, "T1050": {"TechniqueName": "New Service", "TacticGroup": "Persistence, Privilege Escalation", "PrimaryEnabling": "Primary", "Steps": {"16.I.1": {"Procedure": "Empire: 'sc create' via PowerShell to remotely create a service on Creeper (10.0.0.4)", "DetectionCategories": [{"Telemetry ": "Telemetry showed sc.exe execution with command-line arguments. "}, {" Specific Behavior": " A Specific Behavior alert was generated for sc.exe used with parameters typical for lateral movement."}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)."}], "Screenshots": {"CC-16.D.1-1.png": "Telemetry showing sc.exe with command-line arguments", "CC-16.D.1-2.png": "Specific Behavior alert for sc.exe used with parameters typical for lateral movement", "CC-16.I.1-1.png": "General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "": ""}}}}, "T1035": {"TechniqueName": "Service Execution", "TacticGroup": "Execution", "PrimaryEnabling": "Primary", "Steps": {"16.L.1": {"Procedure": "Empire: 'sc start' via PowerShell to remotely launch a specific service on Creeper (10.0.0.4)", "DetectionCategories": [{"Telemetry ": "Telemetry showed sc.exe execution with command-line arguments. "}, {" Specific Behavior": " A Specific Behavior alert was generated for sc.exe used with parameters typical for lateral movement."}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)."}], "Screenshots": {"CC-16.D.1-1.png": "Telemetry showing sc.exe with command-line arguments", "CC-16.D.1-3.png": "Specific Behavior alert for sc.exe used with parameters typical for lateral movement", "CC-16.I.1-1.png": "General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "": ""}}}}, "T1222": {"TechniqueName": "File Permissions Modification", "TacticGroup": "Defense Evasion", "PrimaryEnabling": "Primary", "Steps": {"17.B.1": {"Procedure": "Empire: 'takeown' via PowerShell to obtain ownership of magnify.exe", "DetectionCategories": [{"Telemetry": "Telemetry showed takeown.exe executing with command-line arguments."}, {" Specific Behavior": " A Specific Behavior alert was generated for takeown.exe changing the ownership of an accessibility feature executable."}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (takeown) has been tagged for monitoring because its parent process has a detection (powershell.exe)."}], "Screenshots": {"CC-17.A.1-1.png": "Telemetry showing takeown.exe with command-line arguments", "CC-17.A.1-2.png": "Specific Behavior alert for takeown.exe changing the ownership of an accessibility feature executable", "CC-17.A.1-3.png": "General Behavior alert showing that a spawned process (takeown) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "": ""}}, "17.B.2": {"Procedure": "Empire: 'icacls' via PowerShell to modify the DACL for magnify.exe", "DetectionCategories": [{"Telemetry": "Telemetry showed icacls.exe executing with command-line arguments."}, {" Specific Behavior": " A Specific Behavior alert was generated for icalcs.exe changing the permissions of an accessibility feature executable."}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (icacls) has been tagged for monitoring because its parent process has a detection (powershell.exe)."}], "Screenshots": {"CC-17.A.1-1.png": "Telemetry showing icacls.exe with command-line arguments", "CC-17.A.1-2.png": "Specific Behavior alert for icacls.exe changing the permissions of an accessibility feature executable", "CC-17.A.1-3.png": "General Behavior alert showing that a spawned process (icacls) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "": ""}}}}, "T1015": {"TechniqueName": "Accessibility Features", "TacticGroup": "Persistence, Privilege Escalation", "PrimaryEnabling": "Primary", "Steps": {"17.C.1": {"Procedure": "Empire: 'copy' via PowerShell to overwrite magnify.exe with cmd.exe", "DetectionCategories": [{"Specific Behavior ": "A Specific Behavior alert was generated for the modification of an accessibility features binary known to be used for privilege escalation."}, {" Telemetry ": " Telemetry showed powershell.exe overwriting magnify.exe with cmd.exe via the copy command."}, {" Enrichment": " The capability enriched cmd.exe as being renamed to another process and with a relevant ATT&CK Technique (Masquerading). [CC3]"}], "Screenshots": {"CC-17.A.1-2.png": "Specific Behavior alert for the modification of an accessibility features binary known to be used for privilege escalation", "CC-17.B.2-1.png": "Telemetry showing powershell.exe overwriting magnify.exe with cmd.exe via the copy command", "": ""}}, "20.A.1": {"Procedure": "magnifer.exe previously overwritten by cmd.exe launched through RDP connection made to Creeper (10.0.0.4)", "DetectionCategories": [{"Telemetry": "Telemetry showed magnify.exe executing from utilman.exe with the original file name of cmd.exe."}, {" General Behavior": " A General Behavior alert was generated for magnify.exe executing as a process with a renamed executable."}, {" Enrichment": " The capability enriched utilman.exe executing magnify.exe with a tag indicating that magnify was a persistent backdoor."}], "Screenshots": {"CC-20.A.1-3.png": "Telemetry showing me magnify.exe executing from utilman.exe", "CC-20.A.1-4.png": "General Behavior alert for magnify.exe executing as a process with a renamed executable", "CC-20.A.1-7.png": "Enrichment of utilman.exe executing magnify.exe with a tag indicating that magnify was a persistent backdoor", "": ""}}}}, "T1074": {"TechniqueName": "Data Staged", "TacticGroup": "Collection", "PrimaryEnabling": "Primary", "Steps": {"18.B.1": {"Procedure": "Empire: 'copy' via PowerShell collected a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "DetectionCategories": [{"Telemetry": "Telemetry showed powershell.exe copying the .vsdx file from the network shared drive on Conficker (10.0.0.5) to the Recycle Bin as well as a file create event."}], "Screenshots": {"CC-18.B.1-T1074-new.png": "Telemetry showing the copy of the .vsdx file from the network drive to the Recycle Bin", "CC-18.A.1-4.png": "Telemetry showing a file create event for the .vsdx file in the Recycle Bin", "": ""}}}}, "T1002": {"TechniqueName": "Data Compressed", "TacticGroup": "Exfiltration", "PrimaryEnabling": "Primary", "Steps": {"19.B.1": {"Procedure": "Empire: Executed binary (recycler.exe) created compressed archive (old.rar) of previously collected file", "DetectionCategories": [{"Telemetry": "Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use. Additionally recycler.exe was identified as WinRAR via file metadata, including executable product and description. Telemetry also showed the creation of old.rar as the output of recycler.exe running."}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (recycler) has been tagged for monitoring because its parent process has a detection (powershell.exe)."}], "Screenshots": {"CC-19.B.1-4.png": "Telemetry showing recycler.exe execution", "CC-19.B.1-5.png": "Telemetry showing the creation of old.rar as the output of recycler.exe running", "CC-19.C.1-1.png": "General Behavior alert showing that a spawned process (recycler) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "": ""}}}}, "T1022": {"TechniqueName": "Data Encrypted", "TacticGroup": "Exfiltration", "PrimaryEnabling": "Primary", "Steps": {"19.B.1": {"Procedure": "Empire: Executed binary (recycler.exe) created encrypted archive (old.rar) of previously collected file", "DetectionCategories": [{"Telemetry": "Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use."}, {" General Behavior": " A General Behavior alert was generated showing that a spawned process (recycler) has been tagged for monitoring because its parent process has a detection (powershell.exe)."}], "Screenshots": {"CC-19.B.1-4.png": "Telemetry showing recycler.exe execution", "CC-19.C.1-1.png": "General Behavior alert showing that a spawned process (recycler) has been tagged for monitoring because its parent process has a detection (powershell.exe)", "": ""}}}}, "T1048": {"TechniqueName": "Exfiltration Over Alternative Protocol", "TacticGroup": "Exfiltration", "PrimaryEnabling": "Primary", "Steps": {"19.C.1": {"Procedure": "Empire: Sequence of 'echo' commands via PowerShell to populate commands in text file (ftp.txt), which is then executed by FTP to exfil data through network connection separate of existing C2 channel", "DetectionCategories": [{"Specific Behavior": "A Specific Behavior alert was generated for the execution of ftp.exe with a command file option by an unusual parent process and could be used for exfiltration."}, {" Telemetry": " Telemetry showed ftp.exe with ftp.txt as an argument as well as an outbound FTP connection to 192.168.0.4 (C2 server) on TCP port 21."}], "Screenshots": {"CC-19.C.1-1.png": "A Specific Behavior alert for the execution of ftp.exe with a command file option by an unusual parent process and could be used for exfiltration", "CC-19.C.1-2.png": "Telemetry showing ftp.exe with ftp.txt as an argument as well as an outbound FTP connection to 192.168.0.4 (C2 server) on TCP port 21", "": ""}}}}, "T1107": {"TechniqueName": "File Deletion", "TacticGroup": "Defense Evasion", "PrimaryEnabling": "Primary", "Steps": {"19.D.1": {"Procedure": "Empire: 'del C:\\\"$\"Recycle.bin\\old.rar'", "DetectionCategories": [{"Telemetry": "Telemetry showed powershell.exe executing the command to delete old.rar. "}], "Screenshots": {"CC-19.D.1-1.png": "Telemetry showing the deletion of old.rar", "": ""}}, "19.D.2": {"Procedure": "Empire: 'del recycler.exe'", "DetectionCategories": [{"Telemetry": "Telemetry showed powershell.exe executing the command to delete recycler.exe."}], "Screenshots": {"CC-19.D.1-1.png": "Telemetry showing the deletion of recycler.exe", "": ""}}}}}